/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e,t,r={84:(e,t,r)=>{"use strict";e.exports=r.p+"build/encodedecode_bg.wasm"},374:(e,t,r)=>{"use strict";let n;function i(e){const t=n.__externref_table_alloc();return n.__wbindgen_export_2.set(t,e),t}function s(e,t){try{return e.apply(this,t)}catch(e){const t=i(e);n.__wbindgen_exn_store(t)}}r.d(t,{AG:()=>S,Ay:()=>C,L3:()=>P,L4:()=>v,M8:()=>m,Ph:()=>E,aj:()=>A,lb:()=>K,u3:()=>_,vu:()=>k,wO:()=>b}),e=r.hmd(e);let a=null;function o(){return null!==a&&0!==a.byteLength||(a=new Uint8Array(n.memory.buffer)),a}let c="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&c.decode();const u=2146435072;let l=0;function h(e,t){return function(e,t){return l+=t,l>=u&&(c="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}},c.decode(),l=t),c.decode(o().subarray(e,e+t))}(e>>>=0,t)}function y(e){return null==e}let p=0;const f="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},d="function"==typeof f.encodeInto?function(e,t){return f.encodeInto(e,t)}:function(e,t){const r=f.encode(e);return t.set(r),{read:e.length,written:r.length}};function g(e,t,r){if(void 0===r){const r=f.encode(e),n=t(r.length,1)>>>0;return o().subarray(n,n+r.length).set(r),p=r.length,n}let n=e.length,i=t(n,1)>>>0;const s=o();let a=0;for(;a<n;a++){const t=e.charCodeAt(a);if(t>127)break;s[i+a]=t}if(a!==n){0!==a&&(e=e.slice(a)),i=r(i,n,n=a+3*e.length,1)>>>0;const t=o().subarray(i+a,i+n);a+=d(e,t).written,i=r(i,n,a,1)>>>0}return p=a,i}function w(e){const t=n.__wbindgen_export_2.get(e);return n.__externref_table_dealloc(e),t}function m(e,t){let r,i;try{const o=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),c=p,u=g(t,n.__wbindgen_malloc,n.__wbindgen_realloc),l=p,y=n.encrypt_aes256_cbc(o,c,u,l);var s=y[0],a=y[1];if(y[3])throw s=0,a=0,w(y[2]);return r=s,i=a,h(s,a)}finally{n.__wbindgen_free(r,i,1)}}function b(e,t){let r,i;try{const o=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),c=p,u=g(t,n.__wbindgen_malloc,n.__wbindgen_realloc),l=p,y=n.decrypt_aes256_cbc(o,c,u,l);var s=y[0],a=y[1];if(y[3])throw s=0,a=0,w(y[2]);return r=s,i=a,h(s,a)}finally{n.__wbindgen_free(r,i,1)}}function v(e){let t,r;try{const i=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),s=p,a=n.inv_encode(i,s);return t=a[0],r=a[1],h(a[0],a[1])}finally{n.__wbindgen_free(t,r,1)}}function k(e){let t,r;try{const i=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),s=p,a=n.inv_decode(i,s);return t=a[0],r=a[1],h(a[0],a[1])}finally{n.__wbindgen_free(t,r,1)}}function A(e){const t=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),r=p;return 0!==n.inv_detect(t,r)}function S(e){let t,r;try{const i=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),s=p,a=n.to_base64(i,s);return t=a[0],r=a[1],h(a[0],a[1])}finally{n.__wbindgen_free(t,r,1)}}function E(e){let t,r;try{const a=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),o=p,c=n.from_base64(a,o);var i=c[0],s=c[1];if(c[3])throw i=0,s=0,w(c[2]);return t=i,r=s,h(i,s)}finally{n.__wbindgen_free(t,r,1)}}function K(e){let t,r;try{const i=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),s=p,a=n.ext_encode(i,s);return t=a[0],r=a[1],h(a[0],a[1])}finally{n.__wbindgen_free(t,r,1)}}function _(e){let t,r;try{const i=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),s=p,a=n.to_unicode_escape(i,s);return t=a[0],r=a[1],h(a[0],a[1])}finally{n.__wbindgen_free(t,r,1)}}function P(e){let t,r;try{const a=g(e,n.__wbindgen_malloc,n.__wbindgen_realloc),o=p,c=n.from_unicode_escape(a,o);var i=c[0],s=c[1];if(c[3])throw i=0,s=0,w(c[2]);return t=i,r=s,h(i,s)}finally{n.__wbindgen_free(t,r,1)}}const U=new Set(["basic","cors","default"]);function x(){const t={wbg:{}};return t.wbg.__wbg_buffer_a1a27a0dfa70165d=function(e){return e.buffer},t.wbg.__wbg_call_f2db6205e5c51dc8=function(){return s(function(e,t,r){return e.call(t,r)},arguments)},t.wbg.__wbg_call_fbe8be8bf6436ce5=function(){return s(function(e,t){return e.call(t)},arguments)},t.wbg.__wbg_crypto_574e78ad8b13b65f=function(e){return e.crypto},t.wbg.__wbg_getRandomValues_b8f5dbd5f3995a9e=function(){return s(function(e,t){e.getRandomValues(t)},arguments)},t.wbg.__wbg_msCrypto_a61aeb35a24c1329=function(e){return e.msCrypto},t.wbg.__wbg_new_e52b3efaaa774f96=function(e){return new Uint8Array(e)},t.wbg.__wbg_newnoargs_ff528e72d35de39a=function(e,t){return new Function(h(e,t))},t.wbg.__wbg_newwithbyteoffsetandlength_3b01ecda099177e8=function(e,t,r){return new Uint8Array(e,t>>>0,r>>>0)},t.wbg.__wbg_newwithlength_08f872dc1e3ada2e=function(e){return new Uint8Array(e>>>0)},t.wbg.__wbg_node_905d3e251edff8a2=function(e){return e.node},t.wbg.__wbg_process_dc0fbacc7c1c06f7=function(e){return e.process},t.wbg.__wbg_randomFillSync_ac0988aba3254290=function(){return s(function(e,t){e.randomFillSync(t)},arguments)},t.wbg.__wbg_require_60cc747a6bc5215a=function(){return s(function(){return e.require},arguments)},t.wbg.__wbg_set_fe4e79d1ed3b0e9b=function(e,t,r){e.set(t,r>>>0)},t.wbg.__wbg_static_accessor_GLOBAL_487c52c58d65314d=function(){const e=void 0===r.g?null:r.g;return y(e)?0:i(e)},t.wbg.__wbg_static_accessor_GLOBAL_THIS_ee9704f328b6b291=function(){const e="undefined"==typeof globalThis?null:globalThis;return y(e)?0:i(e)},t.wbg.__wbg_static_accessor_SELF_78c9e3071b912620=function(){const e="undefined"==typeof self?null:self;return y(e)?0:i(e)},t.wbg.__wbg_static_accessor_WINDOW_a093d21393777366=function(){const e="undefined"==typeof window?null:window;return y(e)?0:i(e)},t.wbg.__wbg_subarray_dd4ade7d53bd8e26=function(e,t,r){return e.subarray(t>>>0,r>>>0)},t.wbg.__wbg_versions_c01dfd4722a88165=function(e){return e.versions},t.wbg.__wbindgen_init_externref_table=function(){const e=n.__wbindgen_export_2,t=e.grow(4);e.set(0,void 0),e.set(t+0,void 0),e.set(t+1,null),e.set(t+2,!0),e.set(t+3,!1)},t.wbg.__wbindgen_is_function=function(e){return"function"==typeof e},t.wbg.__wbindgen_is_object=function(e){return"object"==typeof e&&null!==e},t.wbg.__wbindgen_is_string=function(e){return"string"==typeof e},t.wbg.__wbindgen_is_undefined=function(e){return void 0===e},t.wbg.__wbindgen_memory=function(){return n.memory},t.wbg.__wbindgen_string_new=function(e,t){return h(e,t)},t.wbg.__wbindgen_throw=function(e,t){throw new Error(h(e,t))},t}async function D(e){if(void 0!==n)return n;void 0!==e&&(Object.getPrototypeOf(e)===Object.prototype?({module_or_path:e}=e):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===e&&(e=new URL(r(84),r.b));const t=x();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:i,module:s}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if(!e.ok||!U.has(e.type)||"application/wasm"===e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}(await e,t);return function(e,t){return n=e.exports,D.__wbindgen_wasm_module=t,a=null,n.__wbindgen_start(),n}(i,s)}const C=D},508:e=>{function t(e){var r,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e)){var s=e.length;for(r=0;r<s;r++)e[r]&&(n=t(e[r]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function r(){for(var e,r,n=0,i="",s=arguments.length;n<s;n++)(e=arguments[n])&&(r=t(e))&&(i&&(i+=" "),i+=r);return i}e.exports=r,e.exports.clsx=r}},n={};function i(e){var t=n[e];if(void 0!==t)return t.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return r[e](s,s.exports,i),s.loaded=!0,s.exports}i.m=r,i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce((t,r)=>(i.f[r](e,t),t),[])),i.u=e=>e+"."+e+".js",i.miniCssF=e=>{},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="svelte-app:",i.l=(r,n,s,a)=>{if(e[r])e[r].push(n);else{var o,c;if(void 0!==s)for(var u=document.getElementsByTagName("script"),l=0;l<u.length;l++){var h=u[l];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){o=h;break}}o||(c=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,i.nc&&o.setAttribute("nonce",i.nc),o.setAttribute("data-webpack",t+s),o.src=r),e[r]=[n];var y=(t,n)=>{o.onerror=o.onload=null,clearTimeout(p);var i=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach(e=>e(n)),t)return t(n)},p=setTimeout(y.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=y.bind(null,o.onerror),o.onload=y.bind(null,o.onload),c&&document.head.appendChild(o)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=r[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e+"../"})(),(()=>{i.b=document.baseURI||self.location.href;var e={572:0};i.f.j=(t,r)=>{var n=i.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var s=new Promise((r,i)=>n=e[t]=[r,i]);r.push(n[2]=s);var a=i.p+i.u(t),o=new Error;i.l(a,r=>{if(i.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var s=r&&("load"===r.type?"missing":r.type),a=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+a+")",o.name="ChunkLoadError",o.type=s,o.request=a,n[1](o)}},"chunk-"+t,t)}};var t=(t,r)=>{var n,s,[a,o,c]=r,u=0;if(a.some(t=>0!==e[t])){for(n in o)i.o(o,n)&&(i.m[n]=o[n]);c&&c(i)}for(t&&t(r);u<a.length;u++)s=a[u],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunksvelte_app=self.webpackChunksvelte_app||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})(),(()=>{"use strict";var e={};i.r(e),i.d(e,{exclude:()=>ll,extract:()=>il,parse:()=>sl,parseUrl:()=>ol,pick:()=>ul,stringify:()=>al,stringifyUrl:()=>cl}),"undefined"!=typeof window&&((window.__svelte??={}).v??=new Set).add("5");const t={},r=Symbol(),n=Symbol("filename"),s=(Symbol("hmr"),globalThis.process?.env?.NODE_ENV),a=s&&!s.toLowerCase().startsWith("prod");var o=Array.isArray,c=Array.prototype.indexOf,u=Array.from,l=Object.keys,h=Object.defineProperty,y=Object.getOwnPropertyDescriptor,p=Object.getOwnPropertyDescriptors,f=Object.prototype,d=Array.prototype,g=Object.getPrototypeOf,w=Object.isExtensible;function m(e){for(var t=0;t<e.length;t++)e[t]()}const b=256,v=1024,k=2048,A=4096,S=8192,E=16384,K=32768,_=65536,P=1<<17,U=1<<19,x=1<<21,D=1<<22,C=1<<23,I=Symbol("$state"),T=Symbol("legacy props"),B=Symbol(""),$=Symbol("proxy path"),N=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function L(){if(a){const e=new Error("bind_invalid_checkbox_value\nUsing `bind:value` together with a checkbox input is not allowed. Use `bind:checked` instead\nhttps://svelte.dev/e/bind_invalid_checkbox_value");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/bind_invalid_checkbox_value")}var F="font-weight: bold",O="font-weight: normal";function R(e){a?console.warn(`%c[svelte] hydration_mismatch\n%c${e?`Hydration failed because the initial UI does not match what was rendered on the server. The error occurred near ${e}`:"Hydration failed because the initial UI does not match what was rendered on the server"}\nhttps://svelte.dev/e/hydration_mismatch`,F,O):console.warn("https://svelte.dev/e/hydration_mismatch")}function M(e){a?console.warn(`%c[svelte] state_proxy_equality_mismatch\n%cReactive \`$state(...)\` proxies and the values they proxy have different identities. Because of this, comparisons with \`${e}\` will produce unexpected results\nhttps://svelte.dev/e/state_proxy_equality_mismatch`,F,O):console.warn("https://svelte.dev/e/state_proxy_equality_mismatch")}let j,z=!1;function H(e){z=e}function G(e){if(null===e)throw R(),t;return j=e}function q(){return G(pt(j))}function W(e){if(z){if(null!==pt(j))throw R(),t;j=e}}function V(e=1){if(z){for(var t=e,r=j;t--;)r=pt(r);j=r}}function X(e){return e===this.v}function Q(e){return!function(e,t){return e!=e?t==t:e!==t||null!==e&&"object"==typeof e||"function"==typeof e}(e,this.v)}function Y(e){let t=Error();const r=t.stack;if(!r)return null;const n=r.split("\n"),i=["\n"];for(let e=0;e<n.length;e++){const t=n[e];if("Error"!==t){if(t.includes("validate_each_keys"))return null;t.includes("svelte/src/internal")||i.push(t)}}return 1===i.length?null:(h(t,"stack",{value:i.join("\n")}),h(t,"name",{value:`${e}Error`}),t)}function Z(e,t){return e.label=t,J(e.v,t),e}function J(e,t){return e?.[$]?.(t),e}let ee=null;function te(e){ee=e}let re=null;function ne(e){re=e}let ie=null;function se(e){ie=e}function ae(e,t=!1,r){ee={p:ee,c:null,e:null,s:e,x:null,l:null},a&&(ee.function=r,ie=r)}function oe(e){var t=ee,r=t.e;if(null!==r)for(var n of(t.e=null,r))Et(n);return void 0!==e&&(t.x=e),ee=t.p,a&&(ie=ee?.function??null),e??{}}const ce=new WeakMap;function ue(e,t){for(;null!==t;){if(128&t.f)try{return void t.b.error(e)}catch(t){e=t}t=t.parent}throw e instanceof Error&&le(e),e}function le(e){const t=ce.get(e);t&&(h(e,"message",{value:t.message}),h(e,"stack",{value:t.stack}))}const he="undefined"==typeof requestIdleCallback?e=>setTimeout(e,1):requestIdleCallback;let ye=[],pe=[];function fe(){var e=ye;ye=[],m(e)}function de(){var e=pe;pe=[],m(e)}function ge(){return ye.length>0||pe.length>0}function we(){ye.length>0&&fe(),pe.length>0&&de()}let me=null;function be(e){me=e}const ve=new Set;function ke(e){var t=2050,n=null!==Mt&&2&Mt.f?Mt:null;null===Ht||null!==n&&0!==(n.f&b)?t|=b:Ht.f|=U;const i={ctx:ee,deps:null,effects:null,equals:X,f:t,fn:e,reactions:null,rv:0,v:r,wv:0,parent:n??Ht,ac:null};return i}function Ae(e){var t=e.effects;if(null!==t){e.effects=null;for(var r=0;r<t.length;r+=1)Dt(t[r])}}let Se=[];function Ee(e){var t,r=Ht;if(Gt(function(e){for(var t=e.parent;null!==t;){if(!(2&t.f))return t;t=t.parent}return null}(e)),a){let n=ze;Ge(new Set);try{Se.includes(e)&&function(){if(a){const e=new Error("derived_references_self\nA derived value cannot reference itself recursively\nhttps://svelte.dev/e/derived_references_self");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/derived_references_self")}(),Se.push(e),Ae(e),t=ir(e)}finally{Gt(r),Ge(n),Se.pop()}}else try{Ae(e),t=ir(e)}finally{Gt(r)}return t}function Ke(e){var t=Ee(e);e.equals(t)||(e.v=t,e.wv=tr()),Ot||(null!==De?De.set(e,e.v):yr(e,!er&&0===(e.f&b)||null===e.deps?v:A))}function _e(){Gt(null),zt(null),te(null),a&&be(null)}const Pe=new Set;let Ue=null,xe=null,De=null,Ce=new Set,Ie=[],Te=null,Be=!1,$e=!1;class Ne{current=new Map;#e=new Map;#t=new Set;#r=0;#n=null;#i=!1;#s=[];#a=[];#o=[];#c=[];#u=[];#l=[];#h=[];skipped_effects=new Set;process(e){Ie=[],xe=null;var t=null;for(const t of e)this.#y(t);if(0===this.#s.length&&0===this.#r){this.#p();var r=this.#o,n=this.#c;this.#o=[],this.#c=[],this.#u=[],xe=Ue,Ue=null,Me(r),Me(n),null===Ue?Ue=this:Pe.delete(this),this.#n?.resolve()}else this.#f(this.#o),this.#f(this.#c),this.#f(this.#u);if(t){for(const[e,{v:r,wv:n}]of t)e.wv<=n&&(e.v=r);De=null}for(const e of this.#s)or(e);for(const e of this.#a)or(e);this.#s=[],this.#a=[]}#y(e){e.f^=v;for(var t=e.first;null!==t;){var r=t.f,n=!!(96&r);if(!(n&&0!==(r&v)||0!==(r&S)||this.skipped_effects.has(t))&&null!==t.fn){n?t.f^=v:4&r?this.#c.push(t):0===(r&v)&&(0!==(r&D)?(t.b?.is_pending()?this.#a:this.#s).push(t):rr(t)&&(!!(16&t.f)&&this.#u.push(t),or(t)));var i=t.first;if(null!==i){t=i;continue}}var s=t.parent;for(t=t.next;null===t&&null!==s;)t=s.next,s=s.parent}}#f(e){for(const t of e)(0!==(t.f&k)?this.#l:this.#h).push(t),yr(t,v);e.length=0}capture(e,t){this.#e.has(e)||this.#e.set(e,t),this.current.set(e,e.v)}activate(){Ue=this}deactivate(){Ue=null,xe=null;for(const e of Ce)if(Ce.delete(e),e(),null!==Ue)break}neuter(){this.#i=!0}flush(){Ie.length>0?Fe():this.#p(),Ue===this&&(0===this.#r&&Pe.delete(this),this.deactivate())}#p(){if(!this.#i)for(const e of this.#t)e();this.#t.clear()}increment(){this.#r+=1}decrement(){if(this.#r-=1,0===this.#r){for(const e of this.#l)yr(e,k),je(e);for(const e of this.#h)yr(e,A),je(e);this.#o=[],this.#c=[],this.flush()}else this.deactivate()}add_callback(e){this.#t.add(e)}settled(){return(this.#n??={promise:new Promise((r,n)=>{e=r,t=n}),resolve:e,reject:t}).promise;var e,t}static ensure(){if(null===Ue){const e=Ue=new Ne;Pe.add(Ue),$e||Ne.enqueue(()=>{Ue===e&&e.flush()})}return Ue}static enqueue(e){!function(e){if(0===ye.length&&!$e){var t=ye;queueMicrotask(()=>{t===ye&&fe()})}ye.push(e)}(e)}}function Le(e){var t=$e;$e=!0;try{var r;for(e&&(Fe(),r=e());;){if(we(),0===Ie.length&&!ge()&&(Ue?.flush(),0===Ie.length))return Te=null,r;Fe()}}finally{$e=t}}function Fe(){var e=Lt;Be=!0;try{var t=0;for(Ft(!0);Ie.length>0;){var r=Ne.ensure();if(t++>1e3){if(a){var n=new Map;for(const e of r.current.keys())for(const[t,r]of e.updated??[]){var i=n.get(t);i||(i={error:r.error,count:0},n.set(t,i)),i.count+=r.count}for(const e of n.values())console.error(e.error)}Oe()}r.process(Ie),He.clear()}}finally{Be=!1,Ft(e),Te=null}}function Oe(){try{!function(){if(a){const e=new Error("effect_update_depth_exceeded\nMaximum update depth exceeded. This typically indicates that an effect reads and writes the same piece of state\nhttps://svelte.dev/e/effect_update_depth_exceeded");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(e){a&&h(e,"stack",{value:""}),ue(e,Te)}}let Re=null;function Me(e){var t=e.length;if(0!==t){for(var r=0;r<t;){var n=e[r++];if(!(24576&n.f)&&rr(n)&&(Re=[],or(n),null===n.deps&&null===n.first&&null===n.nodes_start&&(null===n.teardown&&null===n.ac?Ct(n):n.fn=null),Re?.length>0)){He.clear();for(const e of Re)or(e);Re=[]}}Re=null}}function je(e){for(var t=Te=e;null!==t.parent;){var r=(t=t.parent).f;if(Be&&t===Ht&&16&r)return;if(96&r){if(0===(r&v))return;t.f^=v}}Ie.push(t)}let ze=new Set;const He=new Map;function Ge(e){ze=e}let qe=!1;function We(e,t){var r={f:0,v:e,reactions:null,equals:X,rv:0,wv:0};return r}function Ve(e,t){const r=We(e);var n;return n=r,null!==Mt&&(null===qt?qt=[n]:qt.push(n)),r}function Xe(e,t,r=!1){null!==Mt&&(!jt||0!==(Mt.f&P))&&4325394&Mt.f&&!qt?.includes(e)&&function(){if(a){const e=new Error("state_unsafe_mutation\nUpdating state inside `$derived(...)`, `$inspect(...)` or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\nhttps://svelte.dev/e/state_unsafe_mutation");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/state_unsafe_mutation")}();let n=r?tt(t):t;return a&&J(n,e.label),Qe(e,n)}function Qe(e,t){if(!e.equals(t)){var r=e.v;if(Ot?He.set(e,t):He.set(e,r),e.v=t,Ne.ensure().capture(e,r),a){if(null!==Ht){const t=Y("UpdatedAt");if(null!==t){e.updated??=new Map;let r=e.updated.get(t.stack);r||(r={error:t,count:0},e.updated.set(t.stack,r)),r.count++}}null!==Ht&&(e.set_during_effect=!0)}2&e.f&&(0!==(e.f&k)&&Ee(e),yr(e,0===(e.f&b)?v:A)),e.wv=tr(),Je(e,k),null===Ht||0===(Ht.f&v)||96&Ht.f||(null===Xt?function(e){Xt=e}([e]):Xt.push(e)),a&&ze.size>0&&!qe&&Ye()}return t}function Ye(){qe=!1;const e=Array.from(ze);for(const t of e)0!==(t.f&v)&&yr(t,A),rr(t)&&or(t);ze.clear()}function Ze(e){Xe(e,e.v+1)}function Je(e,t){var r=e.reactions;if(null!==r)for(var n=r.length,i=0;i<n;i++){var s=r[i],o=s.f;if(a&&0!==(o&P))ze.add(s);else{var c=0===(o&k);c&&yr(s,t),2&o?Je(s,A):c&&(!!(16&o)&&null!==Re&&Re.push(s),je(s))}}}const et=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function tt(e){if("object"!=typeof e||null===e||I in e)return e;const t=g(e);if(t!==f&&t!==d)return e;var n=new Map,i=o(e),s=Ve(0),c=Zt,u=e=>{if(Zt===c)return e();var t=Mt,r=Zt;zt(null),Jt(c);var n=e();return zt(t),Jt(r),n};i&&(n.set("length",Ve(e.length)),a&&(e=new Proxy(e,{get(e,t,r){var n=Reflect.get(e,t,r);return st.has(t)?function(...e){qe=!0;var t=n.apply(this,e);return Ye(),t}:n}})));var l="";let h=!1;function p(e){if(!h){h=!0,Z(s,`${l=e} version`);for(const[e,t]of n)Z(t,rt(l,e));h=!1}}return new Proxy(e,{defineProperty(e,t,r){"value"in r&&!1!==r.configurable&&!1!==r.enumerable&&!1!==r.writable||function(){if(a){const e=new Error("state_descriptors_fixed\nProperty descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\nhttps://svelte.dev/e/state_descriptors_fixed");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/state_descriptors_fixed")}();var i=n.get(t);return void 0===i?i=u(()=>{var e=Ve(r.value);return n.set(t,e),a&&"string"==typeof t&&Z(e,rt(l,t)),e}):Xe(i,r.value,!0),!0},deleteProperty(e,t){var i=n.get(t);if(void 0===i){if(t in e){const e=u(()=>Ve(r));n.set(t,e),Ze(s),a&&Z(e,rt(l,t))}}else Xe(i,r),Ze(s);return!0},get(t,i,s){if(i===I)return e;if(a&&i===$)return p;var o=n.get(i),c=i in t;if(void 0!==o||c&&!y(t,i)?.writable||(o=u(()=>{var e=Ve(tt(c?t[i]:r));return a&&Z(e,rt(l,i)),e}),n.set(i,o)),void 0!==o){var h=cr(o);return h===r?void 0:h}return Reflect.get(t,i,s)},getOwnPropertyDescriptor(e,t){var i=Reflect.getOwnPropertyDescriptor(e,t);if(i&&"value"in i){var s=n.get(t);s&&(i.value=cr(s))}else if(void 0===i){var a=n.get(t),o=a?.v;if(void 0!==a&&o!==r)return{enumerable:!0,configurable:!0,value:o,writable:!0}}return i},has(e,t){if(t===I)return!0;var i=n.get(t),s=void 0!==i&&i.v!==r||Reflect.has(e,t);return!((void 0!==i||null!==Ht&&(!s||y(e,t)?.writable))&&(void 0===i&&(i=u(()=>{var n=Ve(s?tt(e[t]):r);return a&&Z(n,rt(l,t)),n}),n.set(t,i)),cr(i)===r))&&s},set(e,t,o,c){var h=n.get(t),p=t in e;if(i&&"length"===t)for(var f=o;f<h.v;f+=1){var d=n.get(f+"");void 0!==d?Xe(d,r):f in e&&(d=u(()=>Ve(r)),n.set(f+"",d),a&&Z(d,rt(l,f)))}void 0===h?p&&!y(e,t)?.writable||(h=u(()=>Ve(void 0)),a&&Z(h,rt(l,t)),Xe(h,tt(o)),n.set(t,h)):(p=h.v!==r,Xe(h,u(()=>tt(o))));var g=Reflect.getOwnPropertyDescriptor(e,t);if(g?.set&&g.set.call(c,o),!p){if(i&&"string"==typeof t){var w=n.get("length"),m=Number(t);Number.isInteger(m)&&m>=w.v&&Xe(w,m+1)}Ze(s)}return!0},ownKeys(e){cr(s);var t=Reflect.ownKeys(e).filter(e=>{var t=n.get(e);return void 0===t||t.v!==r});for(var[i,a]of n)a.v===r||i in e||t.push(i);return t},setPrototypeOf(){!function(){if(a){const e=new Error("state_prototype_fixed\nCannot set prototype of `$state` object\nhttps://svelte.dev/e/state_prototype_fixed");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/state_prototype_fixed")}()}})}function rt(e,t){return"symbol"==typeof t?`${e}[Symbol(${t.description??""})]`:et.test(t)?`${e}.${t}`:/^\d+$/.test(t)?`${e}[${t}]`:`${e}['${t}']`}function nt(e){try{if(null!==e&&"object"==typeof e&&I in e)return e[I]}catch{}return e}function it(e,t){return Object.is(nt(e),nt(t))}const st=new Set(["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"]);var at,ot,ct,ut;function lt(){if(void 0===at){at=window,document,ot=/Firefox/.test(navigator.userAgent);var e=Element.prototype,t=Node.prototype,r=Text.prototype;ct=y(t,"firstChild").get,ut=y(t,"nextSibling").get,w(e)&&(e.__click=void 0,e.__className=void 0,e.__attributes=null,e.__style=void 0,e.__e=void 0),w(r)&&(r.__t=void 0),a&&(e.__svelte_meta=null,function(){const e=Array.prototype,t=Array.__svelte_cleanup;t&&t();const{indexOf:r,lastIndexOf:n,includes:i}=e;e.indexOf=function(e,t){const n=r.call(this,e,t);if(-1===n)for(let r=t??0;r<this.length;r+=1)if(nt(this[r])===e){M("array.indexOf(...)");break}return n},e.lastIndexOf=function(e,t){const r=n.call(this,e,t??this.length-1);if(-1===r)for(let r=0;r<=(t??this.length-1);r+=1)if(nt(this[r])===e){M("array.lastIndexOf(...)");break}return r},e.includes=function(e,t){const r=i.call(this,e,t);if(!r)for(let t=0;t<this.length;t+=1)if(nt(this[t])===e){M("array.includes(...)");break}return r},Array.__svelte_cleanup=()=>{e.indexOf=r,e.lastIndexOf=n,e.includes=i}}())}}function ht(e=""){return document.createTextNode(e)}function yt(e){return ct.call(e)}function pt(e){return ut.call(e)}function ft(e,t){if(!z)return yt(e);var r=yt(j);if(null===r)r=j.appendChild(ht());else if(t&&3!==r.nodeType){var n=ht();return r?.before(n),G(n),n}return G(r),r}function dt(e,t){if(!z){var r=yt(e);return r instanceof Comment&&""===r.data?pt(r):r}if(t&&3!==j?.nodeType){var n=ht();return j?.before(n),G(n),n}return j}function gt(e,t=1,r=!1){let n=z?j:e;for(var i;t--;)i=n,n=pt(n);if(!z)return n;if(r&&3!==n?.nodeType){var s=ht();return null===n?i?.after(s):n.before(s),G(s),s}return G(n),n}function wt(e){e.textContent=""}function mt(e){z&&null!==yt(e)&&wt(e)}let bt=!1;function vt(){bt||(bt=!0,document.addEventListener("reset",e=>{Promise.resolve().then(()=>{if(!e.defaultPrevented)for(const t of e.target.elements)t.__on_r?.()})},{capture:!0}))}function kt(e){var t=Mt,r=Ht;zt(null),Gt(null);try{return e()}finally{zt(t),Gt(r)}}function At(e,t,r,n=r){e.addEventListener(t,()=>kt(r));const i=e.__on_r;e.__on_r=i?()=>{i(),n(!0)}:()=>n(!0),vt()}function St(e,t,r,n=!0){var i=Ht;if(a)for(;null!==i&&0!==(i.f&P);)i=i.parent;null!==i&&0!==(i.f&S)&&(e|=S);var s={ctx:ee,deps:null,nodes_start:null,nodes_end:null,f:e|k,first:null,fn:t,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(a&&(s.component_function=ie),r)try{or(s),s.f|=K}catch(o){throw Dt(s),o}else null!==t&&je(s);if(n){var o=s;if(r&&null===o.deps&&null===o.teardown&&null===o.nodes_start&&o.first===o.last&&0===(o.f&U)&&(o=o.first),null!==o&&(o.parent=i,null!==i&&function(e,t){var r=t.last;null===r?t.last=t.first=e:(r.next=e,e.prev=r,t.last=e)}(o,i),null!==Mt&&2&Mt.f&&!(64&e))){var c=Mt;(c.effects??=[]).push(o)}}return s}function Et(e){return St(1048580,e,!1)}function Kt(e,t=0){return St(8|t,e,!0)}function _t(e,t=[],n=[]){!function(e,t,n){const i=ke;if(0!==t.length){var s=Ue,o=Ht,c=function(){var e=Ht,t=Mt,r=ee,n=Ue;return function(){Gt(e),zt(t),te(r),n?.activate(),a&&be(null)}}(),u=function(){const e=Ht.b;return null===e&&function(){if(a){const e=new Error("await_outside_boundary\nCannot await outside a `<svelte:boundary>` with a `pending` snippet\nhttps://svelte.dev/e/await_outside_boundary");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/await_outside_boundary")}(),e}();Promise.all(t.map(e=>function(e,t){let n=Ht;null===n&&function(){if(a){const e=new Error("async_derived_orphan\nCannot create a `$derived(...)` with an `await` expression outside of an effect tree\nhttps://svelte.dev/e/async_derived_orphan");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/async_derived_orphan")}();var i=n.b,s=void 0,o=We(r),c=null,u=!Mt;return function(e){St(4718592,e,!0)}(()=>{a&&(me=Ht);try{var r=e();c&&Promise.resolve(r).catch(()=>{})}catch(e){r=Promise.reject(e)}a&&(me=null);var n=()=>r;s=c?.then(n,n)??Promise.resolve(r),c=s;var l=Ue,h=i.is_pending();u&&(i.update_pending_count(1),h||l.increment());const y=(e,r=void 0)=>{c=null,me=null,h||l.activate(),r?r!==N&&(o.f|=C,Qe(o,r)):(0!==(o.f&C)&&(o.f^=C),Qe(o,e),a&&void 0!==t&&(ve.add(o),setTimeout(()=>{ve.has(o)&&(function(e,t){a?console.warn(`%c[svelte] await_waterfall\n%cAn async derived, \`${e}\` (${t}) was not read immediately after it resolved. This often indicates an unnecessary waterfall, which can slow down your app\nhttps://svelte.dev/e/await_waterfall`,F,O):console.warn("https://svelte.dev/e/await_waterfall")}(o.label,t),ve.delete(o))}))),u&&(i.update_pending_count(-1),h||l.decrement()),_e()};if(s.then(y,e=>y(null,e||"unknown")),l)return()=>{queueMicrotask(()=>l.neuter())}}),a&&(o.f|=D),new Promise(e=>{!function t(r){function n(){r===s?e(o):t(s)}r.then(n,n)}(s)})}(e))).then(t=>{s?.activate(),c();try{n([...e.map(i),...t])}catch(e){0===(o.f&E)&&ue(e,o)}s?.deactivate(),_e()}).catch(e=>{u.error(e)})}else n(e.map(i))}(t,n,t=>{St(8,()=>e(...t.map(cr)),!0)})}function Pt(e,t=!0){return St(524320,e,!0,t)}function Ut(e){var t=e.teardown;if(null!==t){const e=Ot,r=Mt;Rt(!0),zt(null);try{t.call(null)}finally{Rt(e),zt(r)}}}function xt(e,t=!1){var r=e.first;for(e.first=e.last=null;null!==r;){const e=r.ac;null!==e&&kt(()=>{e.abort(N)});var n=r.next;64&r.f?r.parent=null:Dt(r,t),r=n}}function Dt(e,t=!0){var r=!1;(t||262144&e.f)&&null!==e.nodes_start&&null!==e.nodes_end&&(function(e,t){for(;null!==e;){var r=e===t?null:pt(e);e.remove(),e=r}}(e.nodes_start,e.nodes_end),r=!0),xt(e,t&&!r),ar(e,0),yr(e,E);var n=e.transitions;if(null!==n)for(const e of n)e.stop();Ut(e);var i=e.parent;null!==i&&null!==i.first&&Ct(e),a&&(e.component_function=null),e.next=e.prev=e.teardown=e.ctx=e.deps=e.fn=e.nodes_start=e.nodes_end=e.ac=null}function Ct(e){var t=e.parent,r=e.prev,n=e.next;null!==r&&(r.next=n),null!==n&&(n.prev=r),null!==t&&(t.first===e&&(t.first=n),t.last===e&&(t.last=r))}function It(e,t){var r=[];Tt(e,r,!0),function(e,t){var r=e.length;if(r>0){var n=()=>--r||t();for(var i of e)i.out(n)}else t()}(r,()=>{Dt(e),t&&t()})}function Tt(e,t,r){if(0===(e.f&S)){if(e.f^=S,null!==e.transitions)for(const n of e.transitions)(n.is_global||r)&&t.push(n);for(var n=e.first;null!==n;){var i=n.next;Tt(n,t,!!(0!==(n.f&_)||32&n.f)&&r),n=i}}}function Bt(e){$t(e,!0)}function $t(e,t){if(0!==(e.f&S)){e.f^=S,0===(e.f&v)&&(yr(e,k),je(e));for(var r=e.first;null!==r;){var n=r.next;$t(r,!!(0!==(r.f&_)||32&r.f)&&t),r=n}if(null!==e.transitions)for(const r of e.transitions)(r.is_global||t)&&r.in()}}let Nt=null,Lt=!1;function Ft(e){Lt=e}let Ot=!1;function Rt(e){Ot=e}let Mt=null,jt=!1;function zt(e){Mt=e}let Ht=null;function Gt(e){Ht=e}let qt=null,Wt=null,Vt=0,Xt=null,Qt=1,Yt=0,Zt=Yt;function Jt(e){Zt=e}let er=!1;function tr(){return++Qt}function rr(e){var t=e.f;if(0!==(t&k))return!0;if(0!==(t&A)){var r=e.deps,n=0!==(t&b);if(null!==r){var i,s,a=!!(512&t),o=n&&null!==Ht&&!er,c=r.length;if((a||o)&&(null===Ht||0===(Ht.f&E))){var u=e,l=u.parent;for(i=0;i<c;i++)s=r[i],!a&&s?.reactions?.includes(u)||(s.reactions??=[]).push(u);a&&(u.f^=512),o&&null!==l&&0===(l.f&b)&&(u.f^=b)}for(i=0;i<c;i++)if(rr(s=r[i])&&Ke(s),s.wv>e.wv)return!0}n&&(null===Ht||er)||yr(e,v)}return!1}function nr(e,t,r=!0){var n=e.reactions;if(null!==n&&!qt?.includes(e))for(var i=0;i<n.length;i++){var s=n[i];2&s.f?nr(s,t,!1):t===s&&(r?yr(s,k):0!==(s.f&v)&&yr(s,A),je(s))}}function ir(e){var t=Wt,r=Vt,i=Xt,s=Mt,o=er,c=qt,u=ee,l=jt,h=Zt,p=e.f;Wt=null,Vt=0,Xt=null,er=0!==(p&b)&&(jt||!Lt||null===Mt),Mt=96&p?null:e,qt=null,te(e.ctx),jt=!1,Zt=++Yt,null!==e.ac&&(kt(()=>{e.ac.abort(N)}),e.ac=null);try{e.f|=x;var f=(0,e.fn)(),d=e.deps;if(null!==Wt){var g;if(ar(e,Vt),null!==d&&Vt>0)for(d.length=Vt+Wt.length,g=0;g<Wt.length;g++)d[Vt+g]=Wt[g];else e.deps=d=Wt;if(!er||2&p&&null!==e.reactions)for(g=Vt;g<d.length;g++)(d[g].reactions??=[]).push(e)}else null!==d&&Vt<d.length&&(ar(e,Vt),d.length=Vt);if(!(null===Xt||jt||null===d||6146&e.f))for(g=0;g<Xt.length;g++)nr(Xt[g],e);return null!==s&&s!==e&&(Yt++,null!==Xt&&(null===i?i=Xt:i.push(...Xt))),0!==(e.f&C)&&(e.f^=C),f}catch(e){return function(e){var t=Ht;if(null===t)return Mt.f|=C,e;if(a&&e instanceof Error&&!ce.has(e)&&ce.set(e,function(e,t){const r=y(e,"message");if(!r||r.configurable){for(var i=ot?"  ":"\t",s=`\n${i}in ${t.fn?.name||"<unknown>"}`,a=t.ctx;null!==a;)s+=`\n${i}in ${a.function?.[n].split("/").pop()}`,a=a.p;return{message:e.message+`\n${s}\n`,stack:e.stack?.split("\n").filter(e=>!e.includes("svelte/src/internal")).join("\n")}}}(e,t)),0===(t.f&K)){if(!(128&t.f))throw!t.parent&&e instanceof Error&&le(e),e;t.b.error(e)}else ue(e,t)}(e)}finally{e.f^=x,Wt=t,Vt=r,Xt=i,Mt=s,er=o,qt=c,te(u),jt=l,Zt=h}}function sr(e,t){let r=t.reactions;if(null!==r){var n=c.call(r,e);if(-1!==n){var i=r.length-1;0===i?r=t.reactions=null:(r[n]=r[i],r.pop())}}null===r&&2&t.f&&(null===Wt||!Wt.includes(t))&&(yr(t,A),768&t.f||(t.f^=512),Ae(t),ar(t,0))}function ar(e,t){var r=e.deps;if(null!==r)for(var n=t;n<r.length;n++)sr(e,r[n])}function or(e){var t=e.f;if(0===(t&E)){yr(e,v);var r=Ht,n=Lt;if(Ht=e,Lt=!0,a){var i=ie;se(e.component_function);var s=re;ne(e.dev_stack??re)}try{16&t?function(e){for(var t=e.first;null!==t;){var r=t.next;!(32&t.f)&&Dt(t),t=r}}(e):xt(e),Ut(e);var o=ir(e);e.teardown="function"==typeof o?o:null,e.wv=Qt}finally{Lt=n,Ht=r,a&&(se(i),ne(s))}}}function cr(e){var t,r=!!(2&e.f);if(Nt?.add(e),null===Mt||jt){if(r&&null===e.deps&&null===e.effects){var n=e,i=n.parent;null!==i&&0===(i.f&b)&&(n.f^=b)}}else if((null===Ht||0===(Ht.f&E))&&!qt?.includes(e)){var s=Mt.deps;if(0!==(Mt.f&x))e.rv<Yt&&(e.rv=Yt,null===Wt&&null!==s&&s[Vt]===e?Vt++:null===Wt?Wt=[e]:er&&Wt.includes(e)||Wt.push(e));else{(Mt.deps??=[]).push(e);var o=e.reactions;null===o?e.reactions=[Mt]:o.includes(Mt)||o.push(Mt)}}if(a){if(me){var c=0!==(me.f&x),u=me.deps?.includes(e);if(!c&&!jt&&!u){t=e.label,a?console.warn(`%c[svelte] await_reactivity_loss\n%cDetected reactivity loss when reading \`${t}\`. This happens when state is read in an async function after an earlier \`await\`\nhttps://svelte.dev/e/await_reactivity_loss`,F,O):console.warn("https://svelte.dev/e/await_reactivity_loss");var l=Y("TracedAt");l&&console.warn(l)}}ve.delete(e)}if(Ot){if(He.has(e))return He.get(e);if(r){var h=(n=e).v;return(0===(n.f&v)&&null!==n.reactions||ur(n))&&(h=Ee(n)),He.set(n,h),h}}else if(r){if(n=e,De?.has(n))return De.get(n);rr(n)&&Ke(n)}if(0!==(e.f&C))throw e.v;return e.v}function ur(e){if(e.v===r)return!0;if(null===e.deps)return!1;for(const t of e.deps){if(He.has(t))return!0;if(2&t.f&&ur(t))return!0}return!1}function lr(e){var t=jt;try{return jt=!0,e()}finally{jt=t}}const hr=-7169;function yr(e,t){e.f=e.f&hr|t}const pr=new Set,fr=new Set;let dr,gr=null;function wr(e){var t=this,r=t.ownerDocument,n=e.type,i=e.composedPath?.()||[],s=i[0]||e.target;gr=e;var a=0,c=gr===e&&e.__root;if(c){var u=i.indexOf(c);if(-1!==u&&(t===document||t===window))return void(e.__root=t);var l=i.indexOf(t);if(-1===l)return;u<=l&&(a=u)}if((s=i[a]||e.target)!==t){h(e,"currentTarget",{configurable:!0,get:()=>s||r});var y=Mt,p=Ht;zt(null),Gt(null);try{for(var f,d=[];null!==s;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var w=s["__"+n];if(null!=w&&(!s.disabled||e.target===s))if(o(w)){var[m,...b]=w;m.apply(s,[e,...b])}else w.call(s,e)}catch(e){f?d.push(e):f=e}if(e.cancelBubble||g===t||null===g)break;s=g}if(f){for(let e of d)queueMicrotask(()=>{throw e});throw f}}finally{e.__root=t,delete e.currentTarget,zt(y),Gt(p)}}}function mr(e,t){var r=Ht;null===r.nodes_start&&(r.nodes_start=e,r.nodes_end=t)}function br(e,t){var r,n=!!(1&t),i=!!(2&t),s=!e.startsWith("<!>");return()=>{if(z)return mr(j,null),j;var t,a;void 0===r&&(t=s?e:"<!>"+e,(a=document.createElement("template")).innerHTML=t.replaceAll("<!>","\x3c!----\x3e"),r=a.content,n||(r=yt(r)));var o=i||ot?document.importNode(r,!0):r.cloneNode(!0);return n?mr(yt(o),o.lastChild):mr(o,o),o}}function vr(){if(z)return mr(j,null),j;var e=document.createDocumentFragment(),t=document.createComment(""),r=ht();return e.append(t,r),mr(t,r),e}function kr(e,t){if(z)return Ht.nodes_end=j,void q();null!==e&&e.before(t)}const Ar=["touchstart","touchmove"];function Sr(e){return Ar.includes(e)}let Er=!0;function Kr(e,t){return Ur(e,t)}function _r(e,r){lt(),r.intro=r.intro??!1;const n=r.target,i=z,s=j;try{for(var o=yt(n);o&&(8!==o.nodeType||"["!==o.data);)o=pt(o);if(!o)throw t;H(!0),G(o),q();const i=Ur(e,{...r,anchor:o});if(null===j||8!==j.nodeType||"]"!==j.data)throw R(),t;return H(!1),i}catch(i){if(i instanceof Error&&i.message.split("\n").some(e=>e.startsWith("https://svelte.dev/e/")))throw i;return i!==t&&console.warn("Failed to hydrate: ",i),!1===r.recover&&function(){if(a){const e=new Error("hydration_failed\nFailed to hydrate the application\nhttps://svelte.dev/e/hydration_failed");throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/hydration_failed")}(),lt(),wt(n),H(!1),Kr(e,r)}finally{H(i),G(s),dr=void 0}}const Pr=new Map;function Ur(e,{target:t,anchor:r,props:n={},events:i,context:s,intro:a=!0}){lt();var o=new Set,c=e=>{for(var r=0;r<e.length;r++){var n=e[r];if(!o.has(n)){o.add(n);var i=Sr(n);t.addEventListener(n,wr,{passive:i});var s=Pr.get(n);void 0===s?(document.addEventListener(n,wr,{passive:i}),Pr.set(n,1)):Pr.set(n,s+1)}}};c(u(pr)),fr.add(c);var l=void 0,h=function(){Ne.ensure();const u=St(524352,()=>{var u=r??t.appendChild(ht());return Pt(()=>{s&&(ae({}),ee.c=s),i&&(n.$$events=i),z&&mr(u,null),Er=a,l=e(u,n)||{},Er=!0,z&&(Ht.nodes_end=j),s&&oe()}),()=>{for(var e of o){t.removeEventListener(e,wr);var n=Pr.get(e);0===--n?(document.removeEventListener(e,wr),Pr.delete(e)):Pr.set(e,n)}fr.delete(c),u!==r&&u.parentNode?.removeChild(u)}},!0);return(e={})=>new Promise(t=>{e.outro?It(u,()=>{Dt(u),t(void 0)}):(Dt(u),t(void 0))})}();return xr.set(l,h),l}let xr=new WeakMap;if(a){function Fl(e){if(!(e in globalThis)){let t;Object.defineProperty(globalThis,e,{configurable:!0,get:()=>{if(void 0!==t)return t;!function(e){if(a){const t=new Error(`rune_outside_svelte\nThe \`${e}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files\nhttps://svelte.dev/e/rune_outside_svelte`);throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/rune_outside_svelte")}(e)},set:e=>{t=e}})}}Fl("$state"),Fl("$effect"),Fl("$derived"),Fl("$inspect"),Fl("$props"),Fl("$bindable")}function Dr(e,n,i=!1){z&&q();var s=e,o=null,c=null,u=r,l=!1;const h=(e,t=!0)=>{l=!0,f(t,e)};var y=null;function p(){null!==y&&(y.lastChild.remove(),s.before(y),y=null);var e=u?o:c,t=u?c:o;e&&Bt(e),t&&It(t,()=>{u?c=null:o=null})}const f=(e,r)=>{if(u===(u=e))return;let n=!1;if(z){const e="[!"===function(e){if(!e||8!==e.nodeType)throw R(),t;return e.data}(s);!!u===e&&(s=function(){for(var e=0,t=j;;){if(8===t.nodeType){var r=t.data;if("]"===r){if(0===e)return t;e-=1}else"["!==r&&"[!"!==r||(e+=1)}var n=pt(t);t.remove(),t=n}}(),G(s),H(!1),n=!0)}var i=s;u?o??=r&&Pt(()=>r(i)):c??=r&&Pt(()=>r(i)),p(),n&&H(!0)};!function(e,t=0){var r=St(16|t,e,!0);a&&(r.dev_stack=re)}(()=>{l=!1,n(h),l||f(null,null)},i?_:0),z&&(s=j)}function Cr(e,t,r=!1){if(e.multiple){if(null==t)return;if(!o(t))return void(a?console.warn("%c[svelte] select_multiple_invalid_value\n%cThe `value` property of a `<select multiple>` element should be an array, but it received a non-array value. The selection will be kept as is.\nhttps://svelte.dev/e/select_multiple_invalid_value",F,O):console.warn("https://svelte.dev/e/select_multiple_invalid_value"));for(var n of e.options)n.selected=t.includes(Br(n))}else{for(n of e.options)if(it(Br(n),t))return void(n.selected=!0);r&&void 0===t||(e.selectedIndex=-1)}}function Ir(e){var t=new MutationObserver(()=>{Cr(e,e.__value)});t.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),function(){const e=St(8,null,!1);yr(e,v),e.teardown=()=>{t.disconnect()}}()}function Tr(e,t,r=t){var n=!0;At(e,"change",t=>{var n,i=t?"[selected]":":checked";if(e.multiple)n=[].map.call(e.querySelectorAll(i),Br);else{var s=e.querySelector(i)??e.querySelector("option:not([disabled])");n=s&&Br(s)}r(n)}),St(4,()=>{var i=t();if(Cr(e,i,n),n&&void 0===i){var s=e.querySelector(":checked");null!==s&&(i=Br(s),r(i))}e.__value=i,n=!1},!1),Ir(e)}function Br(e){return"__value"in e?e.__value:e.value}new Map,i(508),new Map([[!0,"yes"],[!1,"no"]]),Symbol("class"),Symbol("style");const $r=Symbol("is custom element"),Nr=Symbol("is html");function Lr(e){if(z){var t=!1,r=()=>{if(!t){if(t=!0,e.hasAttribute("value")){var r=e.value;Fr(e,"value",null),e.value=r}if(e.hasAttribute("checked")){var n=e.checked;Fr(e,"checked",null),e.checked=n}}};e.__on_r=r,function(e){0===pe.length&&he(de),pe.push(e)}(r),vt()}}function Fr(e,t,r,n){var i=Or(e);z&&(i[t]=e.getAttribute(t),"src"===t||"srcset"===t||"href"===t&&"LINK"===e.nodeName)?n||function(e,t,r){a&&("srcset"===t&&function(e,t){var r=jr(e.srcset),n=jr(t);return n.length===r.length&&n.every(([e,t],n)=>t===r[n][1]&&(Mr(r[n][0],e)||Mr(e,r[n][0])))}(e,r)||Mr(e.getAttribute(t)??"",r)||function(e,t,r){a?console.warn(`%c[svelte] hydration_attribute_changed\n%cThe \`${e}\` attribute on \`${t}\` changed its value between server and client renders. The client value, \`${r}\`, will be ignored in favour of the server value\nhttps://svelte.dev/e/hydration_attribute_changed`,F,O):console.warn("https://svelte.dev/e/hydration_attribute_changed")}(t,e.outerHTML.replace(e.innerHTML,e.innerHTML&&"..."),String(r)))}(e,t,r??""):i[t]!==(i[t]=r)&&("loading"===t&&(e[B]=r),null==r?e.removeAttribute(t):"string"!=typeof r&&function(e){var t,r=e.getAttribute("is")||e.nodeName,n=Rr.get(r);if(n)return n;Rr.set(r,n=[]);for(var i=e,s=Element.prototype;s!==i;){for(var a in t=p(i))t[a].set&&n.push(a);i=g(i)}return n}(e).includes(t)?e[t]=r:e.setAttribute(t,r))}function Or(e){return e.__attributes??={[$r]:e.nodeName.includes("-"),[Nr]:"http://www.w3.org/1999/xhtml"===e.namespaceURI}}var Rr=new Map;function Mr(e,t){return e===t||new URL(e,document.baseURI).href===new URL(t,document.baseURI).href}function jr(e){return e.split(",").map(e=>e.trim().split(" ").filter(Boolean))}function zr(e,t,r=t){var n=new WeakSet;At(e,"input",async i=>{a&&"checkbox"===e.type&&L();var s=i?e.defaultValue:e.value;if(s=Gr(e)?qr(s):s,r(s),null!==Ue&&n.add(Ue),await async function(){await Promise.resolve(),Le()}(),s!==(s=t())){var o=e.selectionStart,c=e.selectionEnd;e.value=s??"",null!==c&&(e.selectionStart=o,e.selectionEnd=Math.min(c,e.value.length))}}),(z&&e.defaultValue!==e.value||null==lr(t)&&e.value)&&(r(Gr(e)?qr(e.value):e.value),null!==Ue&&n.add(Ue)),Kt(()=>{a&&"checkbox"===e.type&&L();var r=t();if(e===document.activeElement){var i=xe??Ue;if(n.has(i))return}Gr(e)&&r===qr(e.value)||("date"!==e.type||r||e.value)&&r!==e.value&&(e.value=r??"")})}function Hr(e,t,r=t){At(e,"change",t=>{var n=t?e.defaultChecked:e.checked;r(n)}),(z&&e.defaultChecked!==e.checked||null==lr(t))&&r(e.checked),Kt(()=>{var r=t();e.checked=Boolean(r)})}function Gr(e){var t=e.type;return"number"===t||"range"===t}function qr(e){return""===e?null:+e}new Set,new Set,new WeakMap,Symbol();class Wr{#d;#g;constructor(e){var t=new Map,r=(e,r)=>{var n=function(e,t=!1){const r=We(e);return t||(r.equals=Q),r}(r,!1,!1);return t.set(e,n),n};const n=new Proxy({...e.props||{},$$events:{}},{get:(e,n)=>cr(t.get(n)??r(n,Reflect.get(e,n))),has:(e,n)=>n===T||(cr(t.get(n)??r(n,Reflect.get(e,n))),Reflect.has(e,n)),set:(e,n,i)=>(Xe(t.get(n)??r(n,i),i),Reflect.set(e,n,i))});this.#g=(e.hydrate?_r:Kr)(e.component,{target:e.target,anchor:e.anchor,props:n,context:e.context,intro:e.intro??!1,recover:e.recover}),e?.props?.$$host&&!1!==e.sync||Le(),this.#d=n.$$events;for(const e of Object.keys(this.#g))"$set"!==e&&"$destroy"!==e&&"$on"!==e&&h(this,e,{get(){return this.#g[e]},set(t){this.#g[e]=t},enumerable:!0});this.#g.$set=e=>{Object.assign(n,e)},this.#g.$destroy=()=>{!function(e,t){const r=xr.get(e);r?(xr.delete(e),r(t)):(a&&(a?console.warn("%c[svelte] lifecycle_double_unmount\n%cTried to unmount a component that was not mounted\nhttps://svelte.dev/e/lifecycle_double_unmount",F,O):console.warn("https://svelte.dev/e/lifecycle_double_unmount")),Promise.resolve())}(this.#g)}}$set(e){this.#g.$set(e)}$on(e,t){this.#d[e]=this.#d[e]||[];const r=(...e)=>t.call(this,...e);return this.#d[e].push(r),()=>{this.#d[e]=this.#d[e].filter(e=>e!==r)}}$destroy(){this.#g.$destroy()}}let Vr;function Xr(e,t,r,n){const i=r[e]?.type;if(t="Boolean"===i&&"boolean"!=typeof t?null!=t:t,!n||!r[e])return t;if("toAttribute"===n)switch(i){case"Object":case"Array":return null==t?null:JSON.stringify(t);case"Boolean":return t?"":null;case"Number":return null==t?null:t;default:return t}else switch(i){case"Object":case"Array":return t&&JSON.parse(t);case"Boolean":default:return t;case"Number":return null!=t?+t:t}}"function"==typeof HTMLElement&&(Vr=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;$$me;constructor(e,t,r){super(),this.$$ctor=e,this.$$s=t,r&&this.attachShadow({mode:"open"})}addEventListener(e,t,r){if(this.$$l[e]=this.$$l[e]||[],this.$$l[e].push(t),this.$$c){const r=this.$$c.$on(e,t);this.$$l_u.set(t,r)}super.addEventListener(e,t,r)}removeEventListener(e,t,r){if(super.removeEventListener(e,t,r),this.$$c){const e=this.$$l_u.get(t);e&&(e(),this.$$l_u.delete(t))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function t(e){return t=>{const r=document.createElement("slot");"default"!==e&&(r.name=e),kr(t,r)}}const r={},n=function(e){const t={};return e.childNodes.forEach(e=>{t[e.slot||"default"]=!0}),t}(this);for(const i of this.$$s)i in n&&("default"!==i||this.$$d.children?r[i]=t(i):(this.$$d.children=t(i),r.default=!0));for(const s of this.attributes){const a=this.$$g_p(s.name);a in this.$$d||(this.$$d[a]=Xr(a,s.value,this.$$p_d,"toProp"))}for(const o in this.$$p_d)o in this.$$d||void 0===this[o]||(this.$$d[o]=this[o],delete this[o]);this.$$c=(e={component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:r,$$host:this}},new Wr(e)),this.$$me=function(e){Ne.ensure();const t=St(524352,e,!0);return()=>{Dt(t)}}(()=>{Kt(()=>{this.$$r=!0;for(const e of l(this.$$c)){if(!this.$$p_d[e]?.reflect)continue;this.$$d[e]=this.$$c[e];const t=Xr(e,this.$$d[e],this.$$p_d,"toAttribute");null==t?this.removeAttribute(this.$$p_d[e].attribute||e):this.setAttribute(this.$$p_d[e].attribute||e,t)}this.$$r=!1})});for(const c in this.$$l)for(const u of this.$$l[c]){const h=this.$$c.$on(c,u);this.$$l_u.set(u,h)}this.$$l={}}var e}attributeChangedCallback(e,t,r){this.$$r||(e=this.$$g_p(e),this.$$d[e]=Xr(e,r,this.$$p_d,"toProp"),this.$$c?.$set({[e]:this.$$d[e]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)})}$$g_p(e){return l(this.$$p_d).find(t=>this.$$p_d[t].attribute===e||!this.$$p_d[t].attribute&&t.toLowerCase()===e)||e}});var Qr=i(374);const Yr="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Zr=Symbol("doneWritingPromise"),Jr=Symbol("doneWritingResolve"),en=Symbol("doneWritingReject"),tn=Symbol("readingIndex");class rn extends Array{constructor(){super(),Object.setPrototypeOf(this,rn.prototype),this[Zr]=new Promise((e,t)=>{this[Jr]=e,this[en]=t}),this[Zr].catch(()=>{})}}function nn(e){return e&&e.getReader&&Array.isArray(e)}function sn(e){if(!nn(e)){const t=e.getWriter(),r=t.releaseLock;return t.releaseLock=()=>{t.closed.catch(function(){}),r.call(t)},t}this.stream=e}function an(e){if(nn(e))return"array";if(Yr.ReadableStream&&Yr.ReadableStream.prototype.isPrototypeOf(e))return"web";if(e&&!(Yr.ReadableStream&&e instanceof Yr.ReadableStream)&&"function"==typeof e._read&&"object"==typeof e._readableState)throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!e||!e.getReader)&&"web-like"}function on(e){return Uint8Array.prototype.isPrototypeOf(e)}function cn(e){if(1===e.length)return e[0];let t=0;for(let r=0;r<e.length;r++){if(!on(e[r]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");t+=e[r].length}const r=new Uint8Array(t);let n=0;return e.forEach(function(e){r.set(e,n),n+=e.length}),r}rn.prototype.getReader=function(){return void 0===this[tn]&&(this[tn]=0),{read:async()=>(await this[Zr],this[tn]===this.length?{value:void 0,done:!0}:{value:this[this[tn]++],done:!1})}},rn.prototype.readToEnd=async function(e){await this[Zr];const t=e(this.slice(this[tn]));return this.length=0,t},rn.prototype.clone=function(){const e=new rn;return e[Zr]=this[Zr].then(()=>{e.push(...this)}),e},sn.prototype.write=async function(e){this.stream.push(e)},sn.prototype.close=async function(){this.stream[Jr]()},sn.prototype.abort=async function(e){return this.stream[en](e),e},sn.prototype.releaseLock=function(){},"object"==typeof Yr.process&&Yr.process.versions;const un=new WeakSet,ln=Symbol("externalBuffer");function hn(e){if(this.stream=e,e[ln]&&(this[ln]=e[ln].slice()),nn(e)){const t=e.getReader();return this._read=t.read.bind(t),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(an(e)){const t=e.getReader();return this._read=t.read.bind(t),this._releaseLock=()=>{t.closed.catch(function(){}),t.releaseLock()},void(this._cancel=t.cancel.bind(t))}let t=!1;this._read=async()=>t||un.has(e)?{value:void 0,done:!0}:(t=!0,{value:e,done:!1}),this._releaseLock=()=>{if(t)try{un.add(e)}catch(e){}}}function yn(e){return an(e)?e:new ReadableStream({start(t){t.enqueue(e),t.close()}})}function pn(e){if(an(e))return e;const t=new rn;return(async()=>{const r=xn(t);await r.write(e),await r.close()})(),t}function fn(e){return e.some(e=>an(e)&&!nn(e))?function(e){e=e.map(yn);const t=wn(async function(e){await Promise.all(n.map(t=>_n(t,e)))});let r=Promise.resolve();const n=e.map((n,i)=>bn(n,(n,s)=>(r=r.then(()=>dn(n,t.writable,{preventClose:i!==e.length-1})),r)));return t.readable}(e):e.some(e=>nn(e))?function(e){const t=new rn;let r=Promise.resolve();return e.forEach((n,i)=>(r=r.then(()=>dn(n,t,{preventClose:i!==e.length-1})),r)),t}(e):"string"==typeof e[0]?e.join(""):cn(e)}async function dn(e,t,{preventClose:r=!1,preventAbort:n=!1,preventCancel:i=!1}={}){if(an(e)&&!nn(e)){e=yn(e);try{if(e[ln]){const r=xn(t);for(let t=0;t<e[ln].length;t++)await r.ready,await r.write(e[ln][t]);r.releaseLock()}await e.pipeTo(t,{preventClose:r,preventAbort:n,preventCancel:i})}catch(e){}return}const s=Un(e=pn(e)),a=xn(t);try{for(;;){await a.ready;const{done:e,value:t}=await s.read();if(e){r||await a.close();break}await a.write(t)}}catch(e){n||await a.abort(e)}finally{s.releaseLock(),a.releaseLock()}}function gn(e,t){const r=new TransformStream(t);return dn(e,r.writable),r.readable}function wn(e){let t,r,n,i=!1,s=!1;return{readable:new ReadableStream({start(e){n=e},pull(){t?t():i=!0},async cancel(t){s=!0,e&&await e(t),r&&r(t)}},{highWaterMark:0}),writable:new WritableStream({write:async function(e){if(s)throw Error("Stream is cancelled");n.enqueue(e),i?i=!1:(await new Promise((e,n)=>{t=e,r=n}),t=null,r=null)},close:n.close.bind(n),abort:n.error.bind(n)})}}function mn(e,t=()=>{},r=()=>{}){if(nn(e)){const n=new rn;return(async()=>{const i=xn(n);try{const n=await Kn(e),s=t(n),a=r();let o;o=void 0!==s&&void 0!==a?fn([s,a]):void 0!==s?s:a,await i.write(o),await i.close()}catch(e){await i.abort(e)}})(),n}if(an(e))return gn(e,{async transform(e,r){try{const n=await t(e);void 0!==n&&r.enqueue(n)}catch(e){r.error(e)}},async flush(e){try{const t=await r();void 0!==t&&e.enqueue(t)}catch(t){e.error(t)}}});const n=t(e),i=r();return void 0!==n&&void 0!==i?fn([n,i]):void 0!==n?n:i}function bn(e,t){if(an(e)&&!nn(e)){let r;const n=new TransformStream({start(e){r=e}}),i=dn(e,n.writable),s=wn(async function(e){r.error(e),await i,await new Promise(setTimeout)});return t(n.readable,s.writable),s.readable}e=pn(e);const r=new rn;return t(e,r),r}function vn(e,t){let r;const n=bn(e,(e,i)=>{const s=Un(e);s.remainder=()=>(s.releaseLock(),dn(e,i),n),r=t(s)});return r}function kn(e){if(nn(e))return e.clone();if(an(e)){const t=function(e){if(nn(e))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(an(e)){const t=yn(e).tee();return t[0][ln]=t[1][ln]=e[ln],t}return[En(e),En(e)]}(e);return Sn(e,t[0]),t[1]}return En(e)}function An(e){return nn(e)?kn(e):an(e)?new ReadableStream({start(t){const r=bn(e,async(e,r)=>{const n=Un(e),i=xn(r);try{for(;;){await i.ready;const{done:r,value:s}=await n.read();if(r){try{t.close()}catch(e){}return void await i.close()}try{t.enqueue(s)}catch(e){}await i.write(s)}}catch(e){t.error(e),await i.abort(e)}});Sn(e,r)}}):En(e)}function Sn(e,t){Object.entries(Object.getOwnPropertyDescriptors(e.constructor.prototype)).forEach(([r,n])=>{"constructor"!==r&&(n.value?n.value=n.value.bind(t):n.get=n.get.bind(t),Object.defineProperty(e,r,n))})}function En(e,t=0,r=1/0){if(nn(e))throw Error("Not implemented");if(an(e)){if(t>=0&&r>=0){let n=0;return gn(e,{transform(e,i){n<r?(n+e.length>=t&&i.enqueue(En(e,Math.max(t-n,0),r-n)),n+=e.length):i.terminate()}})}if(t<0&&(r<0||r===1/0)){let n=[];return mn(e,e=>{e.length>=-t?n=[e]:n.push(e)},()=>En(fn(n),t,r))}if(0===t&&r<0){let n;return mn(e,e=>{const i=n?fn([n,e]):e;if(i.length>=-r)return n=En(i,r),En(i,t,r);n=i})}return console.warn(`stream.slice(input, ${t}, ${r}) not implemented efficiently.`),Pn(async()=>En(await Kn(e),t,r))}return e[ln]&&(e=fn(e[ln].concat([e]))),on(e)?e.subarray(t,r===1/0?e.length:r):e.slice(t,r)}async function Kn(e,t=fn){return nn(e)?e.readToEnd(t):an(e)?Un(e).readToEnd(t):e}async function _n(e,t){if(an(e)){if(e.cancel){const r=await e.cancel(t);return await new Promise(setTimeout),r}if(e.destroy)return e.destroy(t),await new Promise(setTimeout),t}}function Pn(e){const t=new rn;return(async()=>{const r=xn(t);try{await r.write(await e()),await r.close()}catch(e){await r.abort(e)}})(),t}function Un(e){return new hn(e)}function xn(e){return new sn(e)}hn.prototype.read=async function(){return this[ln]&&this[ln].length?{done:!1,value:this[ln].shift()}:this._read()},hn.prototype.releaseLock=function(){this[ln]&&(this.stream[ln]=this[ln]),this._releaseLock()},hn.prototype.cancel=function(e){return this._cancel(e)},hn.prototype.readLine=async function(){let e,t=[];for(;!e;){let{done:r,value:n}=await this.read();if(n+="",r)return t.length?fn(t):void 0;const i=n.indexOf("\n")+1;i&&(e=fn(t.concat(n.substr(0,i))),t=[]),i!==n.length&&t.push(n.substr(i))}return this.unshift(...t),e},hn.prototype.readByte=async function(){const{done:e,value:t}=await this.read();if(e)return;const r=t[0];return this.unshift(En(t,1)),r},hn.prototype.readBytes=async function(e){const t=[];let r=0;for(;;){const{done:n,value:i}=await this.read();if(n)return t.length?fn(t):void 0;if(t.push(i),r+=i.length,r>=e){const r=fn(t);return this.unshift(En(r,e)),En(r,0,e)}}},hn.prototype.peekBytes=async function(e){const t=await this.readBytes(e);return this.unshift(t),t},hn.prototype.unshift=function(...e){this[ln]||(this[ln]=[]),1===e.length&&on(e[0])&&this[ln].length&&e[0].length&&this[ln][0].byteOffset>=e[0].length?this[ln][0]=new Uint8Array(this[ln][0].buffer,this[ln][0].byteOffset-e[0].length,this[ln][0].byteLength+e[0].length):this[ln].unshift(...e.filter(e=>e&&e.length))},hn.prototype.readToEnd=async function(e=fn){const t=[];for(;;){const{done:e,value:r}=await this.read();if(e)break;t.push(r)}return e(t)};const Dn=Symbol("byValue");var Cn={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(e,t){if("number"==typeof t&&(t=this.read(e,t)),void 0!==e[t])return e[t];throw Error("Invalid enum value.")},read:function(e,t){if(e[Dn]||(e[Dn]=[],Object.entries(e).forEach(([t,r])=>{e[Dn][r]=t})),void 0!==e[Dn][t])return e[Dn][t];throw Error("Invalid enum value.")}},In={preferredHashAlgorithm:Cn.hash.sha512,preferredSymmetricAlgorithm:Cn.symmetric.aes256,preferredCompressionAlgorithm:Cn.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:Cn.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:Cn.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([Cn.symmetric.aes128,Cn.symmetric.aes192,Cn.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,enforceGrammar:!0,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.2.2",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([Cn.hash.md5,Cn.hash.ripemd]),rejectMessageHashAlgorithms:new Set([Cn.hash.md5,Cn.hash.ripemd,Cn.hash.sha1]),rejectPublicKeyAlgorithms:new Set([Cn.publicKey.elgamal,Cn.publicKey.dsa]),rejectCurves:new Set([Cn.curve.secp256k1])};const Tn=(()=>{try{return!1}catch(e){}return!1})(),Bn={isString:function(e){return"string"==typeof e||e instanceof String},nodeRequire:()=>{},isArray:function(e){return e instanceof Array},isUint8Array:on,isStream:an,getNobleCurve:async(e,t)=>{if(!In.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:r}=await i.e(523).then(i.bind(i,523));switch(e){case Cn.publicKey.ecdh:case Cn.publicKey.ecdsa:{const e=r.get(t);if(!e)throw Error("Unsupported curve");return e}case Cn.publicKey.x448:return r.get("x448");case Cn.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(e){let t=0;for(let r=0;r<e.length;r++)t+=256**r*e[e.length-1-r];return t},writeNumber:function(e,t){const r=new Uint8Array(t);for(let n=0;n<t;n++)r[n]=e>>8*(t-n-1)&255;return r},readDate:function(e){const t=Bn.readNumber(e);return new Date(1e3*t)},writeDate:function(e){const t=Math.floor(e.getTime()/1e3);return Bn.writeNumber(t,4)},normalizeDate:function(e=Date.now()){return null===e||e===1/0?e:new Date(1e3*Math.floor(+e/1e3))},readMPI:function(e){const t=7+(e[0]<<8|e[1])>>>3;return Bn.readExactSubarray(e,2,2+t)},readExactSubarray:function(e,t,r){if(e.length<r-t)throw Error("Input array too short");return e.subarray(t,r)},leftPad(e,t){if(e.length>t)throw Error("Input array too long");const r=new Uint8Array(t),n=t-e.length;return r.set(e,n),r},uint8ArrayToMPI:function(e){const t=Bn.uint8ArrayBitLength(e);if(0===t)throw Error("Zero MPI");const r=e.subarray(e.length-Math.ceil(t/8)),n=new Uint8Array([(65280&t)>>8,255&t]);return Bn.concatUint8Array([n,r])},uint8ArrayBitLength:function(e){let t;for(t=0;t<e.length&&0===e[t];t++);if(t===e.length)return 0;const r=e.subarray(t);return 8*(r.length-1)+Bn.nbits(r[0])},hexToUint8Array:function(e){const t=new Uint8Array(e.length>>1);for(let r=0;r<e.length>>1;r++)t[r]=parseInt(e.substr(r<<1,2),16);return t},uint8ArrayToHex:function(e){const t="0123456789abcdef";let r="";return e.forEach(e=>{r+=t[e>>4]+t[15&e]}),r},stringToUint8Array:function(e){return mn(e,e=>{if(!Bn.isString(e))throw Error("stringToUint8Array: Data must be in the form of a string");const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t})},uint8ArrayToString:function(e){const t=[],r=16384,n=(e=new Uint8Array(e)).length;for(let i=0;i<n;i+=r)t.push(String.fromCharCode.apply(String,e.subarray(i,i+r<n?i+r:n)));return t.join("")},encodeUTF8:function(e){const t=new TextEncoder("utf-8");function r(e,r=!1){return t.encode(e,{stream:!r})}return mn(e,r,()=>r("",!0))},decodeUTF8:function(e){const t=new TextDecoder("utf-8");function r(e,r=!1){return t.decode(e,{stream:!r})}return mn(e,r,()=>r(new Uint8Array,!0))},concat:fn,concatUint8Array:cn,equalsUint8Array:function(e,t){if(!Bn.isUint8Array(e)||!Bn.isUint8Array(t))throw Error("Data must be in the form of a Uint8Array");if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0},findLastIndex:function(e,t){for(let r=e.length;r>=0;r--)if(t(e[r],r,e))return r;return-1},writeChecksum:function(e){let t=0;for(let r=0;r<e.length;r++)t=t+e[r]&65535;return Bn.writeNumber(t,2)},printDebug:function(e){Tn&&console.log("[OpenPGP.js debug]",e)},printDebugError:function(e){Tn&&console.error("[OpenPGP.js debug]",e)},nbits:function(e){let t=1,r=e>>>16;return 0!==r&&(e=r,t+=16),r=e>>8,0!==r&&(e=r,t+=8),r=e>>4,0!==r&&(e=r,t+=4),r=e>>2,0!==r&&(e=r,t+=2),r=e>>1,0!==r&&(e=r,t+=1),t},double:function(e){const t=new Uint8Array(e.length),r=e.length-1;for(let n=0;n<r;n++)t[n]=e[n]<<1^e[n+1]>>7;return t[r]=e[r]<<1^135*(e[0]>>7),t},shiftRight:function(e,t){if(t)for(let r=e.length-1;r>=0;r--)e[r]>>=t,r>0&&(e[r]|=e[r-1]<<8-t);return e},getWebCrypto:function(){const e=void 0!==Yr&&Yr.crypto&&Yr.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!e)throw Error("The WebCrypto API is not available");return e},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return"undefined"!=typeof navigator?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(e){return!!Bn.isString(e)&&/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(e)},canonicalizeEOL:function(e){let t=!1;return mn(e,e=>{let r;t&&(e=Bn.concatUint8Array([new Uint8Array([13]),e])),13===e[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;const n=[];for(let t=0;r=e.indexOf(10,t)+1,r;t=r)13!==e[r-2]&&n.push(r);if(!n.length)return e;const i=new Uint8Array(e.length+n.length);let s=0;for(let t=0;t<n.length;t++){const r=e.subarray(n[t-1]||0,n[t]);i.set(r,s),s+=r.length,i[s-1]=13,i[s]=10,s++}return i.set(e.subarray(n[n.length-1]||0),s),i},()=>t?new Uint8Array([13]):void 0)},nativeEOL:function(e){let t=!1;return mn(e,e=>{let r;13===(e=t&&10!==e[0]?Bn.concatUint8Array([new Uint8Array([13]),e]):new Uint8Array(e))[e.length-1]?(t=!0,e=e.subarray(0,-1)):t=!1;let n=0;for(let t=0;t!==e.length;t=r){r=e.indexOf(13,t)+1,r||(r=e.length);const i=r-(10===e[r]?1:0);t&&e.copyWithin(n,t,i),n+=i-t}return e.subarray(0,n)},()=>t?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(e){return e.split("\n").map(e=>{let t=e.length-1;for(;t>=0&&(" "===e[t]||"\t"===e[t]||"\r"===e[t]);t--);return e.substr(0,t+1)}).join("\n")},wrapError:function(e,t){if(!t)return e instanceof Error?e:Error(e);if(e instanceof Error){try{e.message+=": "+t.message,e.cause=t}catch(e){}return e}return Error(e+": "+t.message,{cause:t})},constructAllowedPackets:function(e){const t={};return e.forEach(e=>{if(!e.tag)throw Error("Invalid input: expected a packet class");t[e.tag]=e}),t},anyPromise:function(e){return new Promise(async(t,r)=>{let n;await Promise.all(e.map(async e=>{try{t(await e)}catch(e){n=e}})),r(n)})},selectUint8Array:function(e,t,r){const n=Math.max(t.length,r.length),i=new Uint8Array(n);let s=0;for(let n=0;n<i.length;n++)i[n]=t[n]&256-e|r[n]&255+e,s+=e&n<t.length|1-e&n<r.length;return i.subarray(0,s)},selectUint8:function(e,t,r){return t&256-e|r&255+e},isAES:function(e){return e===Cn.symmetric.aes128||e===Cn.symmetric.aes192||e===Cn.symmetric.aes256}},$n=Bn.getNodeBuffer();let Nn,Ln;function Fn(e){let t=new Uint8Array;return mn(e,e=>{t=Bn.concatUint8Array([t,e]);const r=[],n=Math.floor(t.length/45),i=45*n,s=Nn(t.subarray(0,i));for(let e=0;e<n;e++)r.push(s.substr(60*e,60)),r.push("\n");return t=t.subarray(i),r.join("")},()=>t.length?Nn(t)+"\n":"")}function On(e){let t="";return mn(e,e=>{t+=e;let r=0;const n=[" ","\t","\r","\n"];for(let e=0;e<n.length;e++){const i=n[e];for(let e=t.indexOf(i);-1!==e;e=t.indexOf(i,e+1))r++}let i=t.length;for(;i>0&&(i-r)%4!=0;i--)n.includes(t[i])&&r--;const s=Ln(t.substr(0,i));return t=t.substr(i),s},()=>Ln(t))}function Rn(e){return On(e.replace(/-/g,"+").replace(/_/g,"/"))}function Mn(e,t){let r=Fn(e).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function jn(e){const t=e.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!t)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(t[1])?Cn.armor.multipartSection:/MESSAGE, PART \d+/.test(t[1])?Cn.armor.multipartLast:/SIGNED MESSAGE/.test(t[1])?Cn.armor.signed:/MESSAGE/.test(t[1])?Cn.armor.message:/PUBLIC KEY BLOCK/.test(t[1])?Cn.armor.publicKey:/PRIVATE KEY BLOCK/.test(t[1])?Cn.armor.privateKey:/SIGNATURE/.test(t[1])?Cn.armor.signature:void 0}function zn(e,t){let r="";return t.showVersion&&(r+="Version: "+t.versionString+"\n"),t.showComment&&(r+="Comment: "+t.commentString+"\n"),e&&(r+="Comment: "+e+"\n"),r+="\n",r}function Hn(e){const t=function(e){let t=13501623;return mn(e,e=>{const r=qn?Math.floor(e.length/4):0,n=new Uint32Array(e.buffer,e.byteOffset,r);for(let e=0;e<r;e++)t^=n[e],t=Gn[0][t>>24&255]^Gn[1][t>>16&255]^Gn[2][t>>8&255]^Gn[3][255&t];for(let n=4*r;n<e.length;n++)t=t>>8^Gn[0][255&t^e[n]]},()=>new Uint8Array([t,t>>8,t>>16]))}(e);return Fn(t)}$n?(Nn=e=>$n.from(e).toString("base64"),Ln=e=>{const t=$n.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}):(Nn=e=>btoa(Bn.uint8ArrayToString(e)),Ln=e=>Bn.stringToUint8Array(atob(e)));const Gn=[Array(255),Array(255),Array(255),Array(255)];for(let Ol=0;Ol<=255;Ol++){let Rl=Ol<<16;for(let Ml=0;Ml<8;Ml++)Rl=Rl<<1^(8388608&Rl?8801531:0);Gn[0][Ol]=(16711680&Rl)>>16|65280&Rl|(255&Rl)<<16}for(let jl=0;jl<=255;jl++)Gn[1][jl]=Gn[0][jl]>>8^Gn[0][255&Gn[0][jl]];for(let zl=0;zl<=255;zl++)Gn[2][zl]=Gn[1][zl]>>8^Gn[0][255&Gn[1][zl]];for(let Hl=0;Hl<=255;Hl++)Gn[3][Hl]=Gn[2][Hl]>>8^Gn[0][255&Gn[2][Hl]];const qn=function(){const e=new ArrayBuffer(2);return new DataView(e).setInt16(0,255,!0),255===new Int16Array(e)[0]}();function Wn(e){for(let t=0;t<e.length;t++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(e[t])||Bn.printDebugError(Error("Improperly formatted armor header: "+e[t])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(e[t])||Bn.printDebugError(Error("Unknown header: "+e[t]))}function Vn(e){let t=e;const r=e.lastIndexOf("=");return r>=0&&r!==e.length-1&&(t=e.slice(0,r)),t}function Xn(e){return new Promise(async(t,r)=>{try{const n=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,u=a,l=[];const h=On(bn(e,async(e,y)=>{const p=Un(e);try{for(;;){let e=await p.readLine();if(void 0===e)throw Error("Misformed armored text");if(e=Bn.removeTrailingSpaces(e.replace(/[\r\n]/g,"")),s)if(o)c||s!==Cn.armor.signed||(n.test(e)?(l=l.join("\r\n"),c=!0,Wn(u),u=[],o=!1):l.push(e.replace(/^- /,"")));else if(n.test(e)&&r(Error("Mandatory blank line missing between armor headers and armor data")),i.test(e)){if(Wn(u),o=!0,c||s!==Cn.armor.signed){t({text:l,data:h,headers:a,type:s});break}}else u.push(e);else n.test(e)&&(s=jn(e))}}catch(e){return void r(e)}const f=xn(y);try{for(;;){await f.ready;const{done:e,value:t}=await p.read();if(e)throw Error("Misformed armored text");const r=t+"";if(-1!==r.indexOf("=")||-1!==r.indexOf("-")){let e=await p.readToEnd();e.length||(e=""),e=r+e,e=Bn.removeTrailingSpaces(e.replace(/\r/g,""));const t=e.split(n);if(1===t.length)throw Error("Misformed armored text");const i=Vn(t[0].slice(0,-1));await f.write(i);break}await f.write(r)}await f.ready,await f.close()}catch(e){await f.abort(e)}}))}catch(e){r(e)}}).then(async e=>(nn(e.data)&&(e.data=await Kn(e.data)),e))}function Qn(e,t,r,n,i,s=!1,a=In){let o,c;e===Cn.armor.signed&&(o=t.text,c=t.hash,t=t.data);const u=s&&An(t),l=[];switch(e){case Cn.armor.multipartSection:l.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+n+"-----\n"),l.push(zn(i,a)),l.push(Fn(t)),u&&l.push("=",Hn(u)),l.push("-----END PGP MESSAGE, PART "+r+"/"+n+"-----\n");break;case Cn.armor.multipartLast:l.push("-----BEGIN PGP MESSAGE, PART "+r+"-----\n"),l.push(zn(i,a)),l.push(Fn(t)),u&&l.push("=",Hn(u)),l.push("-----END PGP MESSAGE, PART "+r+"-----\n");break;case Cn.armor.signed:l.push("-----BEGIN PGP SIGNED MESSAGE-----\n"),l.push(c?`Hash: ${c}\n\n`:"\n"),l.push(o.replace(/^-/gm,"- -")),l.push("\n-----BEGIN PGP SIGNATURE-----\n"),l.push(zn(i,a)),l.push(Fn(t)),u&&l.push("=",Hn(u)),l.push("-----END PGP SIGNATURE-----\n");break;case Cn.armor.message:l.push("-----BEGIN PGP MESSAGE-----\n"),l.push(zn(i,a)),l.push(Fn(t)),u&&l.push("=",Hn(u)),l.push("-----END PGP MESSAGE-----\n");break;case Cn.armor.publicKey:l.push("-----BEGIN PGP PUBLIC KEY BLOCK-----\n"),l.push(zn(i,a)),l.push(Fn(t)),u&&l.push("=",Hn(u)),l.push("-----END PGP PUBLIC KEY BLOCK-----\n");break;case Cn.armor.privateKey:l.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\n"),l.push(zn(i,a)),l.push(Fn(t)),u&&l.push("=",Hn(u)),l.push("-----END PGP PRIVATE KEY BLOCK-----\n");break;case Cn.armor.signature:l.push("-----BEGIN PGP SIGNATURE-----\n"),l.push(zn(i,a)),l.push(Fn(t)),u&&l.push("=",Hn(u)),l.push("-----END PGP SIGNATURE-----\n")}return Bn.concat(l)}const Yn=BigInt(0),Zn=BigInt(1);function Jn(e){const t="0123456789ABCDEF";let r="";return e.forEach(e=>{r+=t[e>>4]+t[15&e]}),BigInt("0x0"+r)}function ei(e,t){const r=e%t;return r<Yn?r+t:r}function ti(e,t,r){if(r===Yn)throw Error("Modulo cannot be zero");if(r===Zn)return BigInt(0);if(t<Yn)throw Error("Unsopported negative exponent");let n=t,i=e;i%=r;let s=BigInt(1);for(;n>Yn;){const e=n&Zn;n>>=Zn,s=e?s*i%r:s,i=i*i%r}return s}function ri(e){return e>=Yn?e:-e}function ni(e,t){const{gcd:r,x:n}=function(e,t){let r=BigInt(0),n=BigInt(1),i=BigInt(1),s=BigInt(0),a=ri(e),o=ri(t);const c=e<Yn,u=t<Yn;for(;o!==Yn;){const e=a/o;let t=r;r=i-e*r,i=t,t=n,n=s-e*n,s=t,t=o,o=a%o,a=t}return{x:c?-i:i,y:u?-s:s,gcd:a}}(e,t);if(r!==Zn)throw Error("Inverse does not exist");return ei(n+t,t)}function ii(e){const t=e<Yn?BigInt(-1):Yn,r=BigInt(8);let n=1,i=e;for(;(i>>=r)!==t;)n++;return n}function si(e,t="be",r){let n=e.toString(16);n.length%2==1&&(n="0"+n);const i=n.length/2,s=new Uint8Array(r||i),a=r?r-i:0;let o=0;for(;o<i;)s[o+a]=parseInt(n.slice(2*o,2*o+2),16),o++;return"be"!==t&&s.reverse(),s}const ai=Bn.getNodeCrypto();function oi(e){const t="undefined"!=typeof crypto?crypto:ai?.webcrypto;if(t?.getRandomValues){const r=new Uint8Array(e);return t.getRandomValues(r)}throw Error("No secure random number generator available.")}function ci(e,t){if(t<e)throw Error("Illegal parameter value: max <= min");const r=t-e;return ei(Jn(oi(ii(r)+8)),r)+e}BigInt(1),[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(e=>BigInt(e));const ui=Bn.getWebCrypto(),li=Bn.getNodeCrypto(),hi=li&&li.getHashes();function yi(e){if(li&&hi.includes(e))return async function(t){const r=li.createHash(e);return mn(t,e=>{r.update(e)},()=>new Uint8Array(r.digest()))}}function pi(e,t){const r=async()=>{const{nobleHashes:t}=await i.e(291).then(i.bind(i,291)),r=t.get(e);if(!r)throw Error("Unsupported hash");return r};return async function(e){if(nn(e)&&(e=await Kn(e)),Bn.isStream(e)){const t=(await r()).create();return mn(e,e=>{t.update(e)},()=>t.digest())}return ui&&t?new Uint8Array(await ui.digest(t,e)):(await r())(e)}}const fi=yi("md5")||pi("md5"),di=yi("sha1")||pi("sha1","SHA-1"),gi=yi("sha224")||pi("sha224"),wi=yi("sha256")||pi("sha256","SHA-256"),mi=yi("sha384")||pi("sha384","SHA-384"),bi=yi("sha512")||pi("sha512","SHA-512"),vi=yi("ripemd160")||pi("ripemd160"),ki=yi("sha3-256")||pi("sha3_256"),Ai=yi("sha3-512")||pi("sha3_512");function Si(e,t){switch(e){case Cn.hash.md5:return fi(t);case Cn.hash.sha1:return di(t);case Cn.hash.ripemd:return vi(t);case Cn.hash.sha256:return wi(t);case Cn.hash.sha384:return mi(t);case Cn.hash.sha512:return bi(t);case Cn.hash.sha224:return gi(t);case Cn.hash.sha3_256:return ki(t);case Cn.hash.sha3_512:return Ai(t);default:throw Error("Unsupported hash function")}}function Ei(e){switch(e){case Cn.hash.md5:return 16;case Cn.hash.sha1:case Cn.hash.ripemd:return 20;case Cn.hash.sha256:return 32;case Cn.hash.sha384:return 48;case Cn.hash.sha512:return 64;case Cn.hash.sha224:return 28;case Cn.hash.sha3_256:return 32;case Cn.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}const Ki=[];function _i(e,t){const r=e.length;if(r>t-11)throw Error("Message too long");const n=function(e){const t=new Uint8Array(e);let r=0;for(;r<e;){const n=oi(e-r);for(let e=0;e<n.length;e++)0!==n[e]&&(t[r++]=n[e])}return t}(t-r-3),i=new Uint8Array(t);return i[1]=2,i.set(n,2),i.set(e,t-r),i}function Pi(e,t){let r=2,n=1;for(let t=r;t<e.length;t++)n&=0!==e[t],r+=n;const i=r-2,s=e.subarray(r+1),a=0===e[0]&2===e[1]&i>=8&!n;if(t)return Bn.selectUint8Array(a,s,t);if(a)return s;throw Error("Decryption error")}function Ui(e,t,r){let n;if(t.length!==Ei(e))throw Error("Invalid hash length");const i=new Uint8Array(Ki[e].length);for(n=0;n<Ki[e].length;n++)i[n]=Ki[e][n];const s=i.length+t.length;if(r<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(i,r-s),o.set(t,r-t.length),o}Ki[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Ki[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Ki[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Ki[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Ki[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Ki[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Ki[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];const xi=Bn.getWebCrypto(),Di=Bn.getNodeCrypto(),Ci=BigInt(1);async function Ii(e,t,r,n,i,s,a,o,c){if(Ei(e)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(t&&!Bn.isStream(t))if(Bn.getWebCrypto())try{return await async function(e,t,r,n,i,s,a,o){const c=await Bi(r,n,i,s,a,o),u={name:"RSASSA-PKCS1-v1_5",hash:{name:e}},l=await xi.importKey("jwk",c,u,!1,["sign"]);return new Uint8Array(await xi.sign("RSASSA-PKCS1-v1_5",l,t))}(Cn.read(Cn.webHash,e),t,r,n,i,s,a,o)}catch(e){Bn.printDebugError(e)}else if(Bn.getNodeCrypto())return async function(e,t,r,n,i,s,a,o){const c=Di.createSign(Cn.read(Cn.hash,e));c.write(t),c.end();const u=await Bi(r,n,i,s,a,o);return new Uint8Array(c.sign({key:u,format:"jwk",type:"pkcs1"}))}(e,t,r,n,i,s,a,o);return async function(e,t,r,n){return t=Jn(t),si(ti(Jn(Ui(e,n,ii(t))),r=Jn(r),t),"be",ii(t))}(e,r,i,c)}async function Ti(e,t,r){return Bn.getNodeCrypto()?async function(e,t,r){const n={key:$i(t,r),format:"jwk",type:"pkcs1",padding:Di.constants.RSA_PKCS1_PADDING};return new Uint8Array(Di.publicEncrypt(n,e))}(e,t,r):async function(e,t,r){if(t=Jn(t),e=Jn(_i(e,ii(t))),r=Jn(r),e>=t)throw Error("Message size cannot exceed modulus size");return si(ti(e,r,t),"be",ii(t))}(e,t,r)}async function Bi(e,t,r,n,i,s){const a=Jn(n),o=Jn(i),c=Jn(r);let u=ei(c,o-Ci),l=ei(c,a-Ci);return l=si(l),u=si(u),{kty:"RSA",n:Mn(e),e:Mn(t),d:Mn(r),p:Mn(i),q:Mn(n),dp:Mn(u),dq:Mn(l),qi:Mn(s),ext:!0}}function $i(e,t){return{kty:"RSA",n:Mn(e),e:Mn(t),ext:!0}}const Ni=BigInt(1),Li={"2a8648ce3d030107":Cn.curve.nistP256,"2b81040022":Cn.curve.nistP384,"2b81040023":Cn.curve.nistP521,"2b8104000a":Cn.curve.secp256k1,"2b06010401da470f01":Cn.curve.ed25519Legacy,"2b060104019755010501":Cn.curve.curve25519Legacy,"2b2403030208010107":Cn.curve.brainpoolP256r1,"2b240303020801010b":Cn.curve.brainpoolP384r1,"2b240303020801010d":Cn.curve.brainpoolP512r1};class Fi{constructor(e){if(e instanceof Fi)this.oid=e.oid;else if(Bn.isArray(e)||Bn.isUint8Array(e)){if(6===(e=new Uint8Array(e))[0]){if(e[1]!==e.length-2)throw Error("Length mismatch in DER encoded oid");e=e.subarray(2)}this.oid=e}else this.oid=""}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.oid=e.subarray(1,1+t),1+this.oid.length}throw Error("Invalid oid")}write(){return Bn.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return Bn.uint8ArrayToHex(this.oid)}getName(){const e=Li[this.toHex()];if(!e)throw Error("Unknown curve object identifier.");return e}}function Oi(e){let t,r=0;const n=e[0];return n<192?([r]=e,t=1):n<255?(r=(e[0]-192<<8)+e[1]+192,t=2):255===n&&(r=Bn.readNumber(e.subarray(1,5)),t=5),{len:r,offset:t}}function Ri(e){return e<192?new Uint8Array([e]):e>191&&e<8384?new Uint8Array([192+(e-192>>8),e-192&255]):Bn.concatUint8Array([new Uint8Array([255]),Bn.writeNumber(e,4)])}function Mi(e){if(e<0||e>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+e])}function ji(e){return new Uint8Array([192|e])}function zi(e,t){return Bn.concatUint8Array([ji(e),Ri(t)])}function Hi(e){return[Cn.packet.literalData,Cn.packet.compressedData,Cn.packet.symmetricallyEncryptedData,Cn.packet.symEncryptedIntegrityProtectedData,Cn.packet.aeadEncryptedData].includes(e)}async function Gi(e,t,r){let n,i;try{const s=await e.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await e.readByte();let o,c,u=-1,l=-1;l=0,64&a&&(l=1),l?u=63&a:(u=(63&a)>>2,c=3&a);const h=Hi(u);let y,p=null;if(t&&h){if("array"===t){const e=new rn;n=xn(e),p=e}else{const e=new TransformStream;n=xn(e.writable),p=e.readable}i=r({tag:u,packet:p})}else p=[];do{if(l){const t=await e.readByte();if(y=!1,t<192)o=t;else if(t>=192&&t<224)o=(t-192<<8)+await e.readByte()+192;else if(t>223&&t<255){if(o=1<<(31&t),y=!0,!h)throw new TypeError("This packet type does not support partial lengths.")}else o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte()}else switch(c){case 0:o=await e.readByte();break;case 1:o=await e.readByte()<<8|await e.readByte();break;case 2:o=await e.readByte()<<24|await e.readByte()<<16|await e.readByte()<<8|await e.readByte();break;default:o=1/0}if(o>0){let t=0;for(;;){n&&await n.ready;const{done:r,value:i}=await e.read();if(r){if(o===1/0)break;throw Error("Unexpected end of packet")}const s=o===1/0?i:i.subarray(0,o-t);if(n?await n.write(s):p.push(s),t+=i.length,t>=o){e.unshift(i.subarray(o-t+i.length));break}}}}while(y);n?(await n.ready,await n.close()):(p=Bn.concatUint8Array(p),await r({tag:u,packet:p}))}catch(e){if(n)return await n.abort(e),!0;throw e}finally{n&&await i}}class qi extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,qi),this.name="UnsupportedError"}}class Wi extends qi{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,qi),this.name="UnknownPacketError"}}class Vi extends qi{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,qi),this.name="MalformedPacketError"}}class Xi{constructor(e,t){this.tag=e,this.rawContent=t}write(){return this.rawContent}}async function Qi(e,t,r,n,s,a){if(Ei(t)<Ei(Ji(e)))throw Error("Hash algorithm too weak for EdDSA.");switch(e){case Cn.publicKey.ed25519:try{const t=Bn.getWebCrypto(),r=ts(e,n,s),i=await t.importKey("jwk",r,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await t.sign("Ed25519",i,a))}}catch(e){if("NotSupportedError"!==e.name)throw e;const{default:t}=await i.e(837).then(i.bind(i,837)),r=Bn.concatUint8Array([s,n]);return{RS:t.sign.detached(a,r)}}case Cn.publicKey.ed448:return{RS:(await Bn.getNobleCurve(Cn.publicKey.ed448)).sign(a,s)};default:throw Error("Unsupported EdDSA algorithm")}}async function Yi(e,t,{RS:r},n,s,a){if(Ei(t)<Ei(Ji(e)))throw Error("Hash algorithm too weak for EdDSA.");switch(e){case Cn.publicKey.ed25519:try{const t=Bn.getWebCrypto(),n=es(e,s),i=await t.importKey("jwk",n,"Ed25519",!1,["verify"]);return await t.verify("Ed25519",i,r,a)}catch(e){if("NotSupportedError"!==e.name)throw e;const{default:t}=await i.e(837).then(i.bind(i,837));return t.sign.detached.verify(a,r,s)}case Cn.publicKey.ed448:return(await Bn.getNobleCurve(Cn.publicKey.ed448)).verify(r,a,s);default:throw Error("Unsupported EdDSA algorithm")}}function Zi(e){switch(e){case Cn.publicKey.ed25519:return 32;case Cn.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function Ji(e){switch(e){case Cn.publicKey.ed25519:return Cn.hash.sha256;case Cn.publicKey.ed448:return Cn.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const es=(e,t)=>{if(e===Cn.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:Mn(t),ext:!0};throw Error("Unsupported EdDSA algorithm")},ts=(e,t,r)=>{if(e===Cn.publicKey.ed25519){const n=es(e,t);return n.d=Mn(r),n}throw Error("Unsupported EdDSA algorithm")};function rs(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function ns(e,...t){if(!rs(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function is(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function ss(e,t){ns(e);const r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function as(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function os(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function cs(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function us(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const ls=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])();function hs(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array((new TextEncoder).encode(e))}(e);else{if(!rs(e))throw Error("Uint8Array expected, got "+typeof e);e=bs(e)}return e}function ys(e,t){return e.buffer===t.buffer&&e.byteOffset<t.byteOffset+t.byteLength&&t.byteOffset<e.byteOffset+e.byteLength}function ps(e,t){if(ys(e,t)&&e.byteOffset<t.byteOffset)throw Error("complex overlap of input and output is not supported")}function fs(e,t){if(e.length!==t.length)return!1;let r=0;for(let n=0;n<e.length;n++)r|=e[n]^t[n];return 0===r}const ds=(e,t)=>{function r(r,...n){if(ns(r),!ls)throw Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){const t=n[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?ns(t):ns(t,e.nonceLength)}const i=e.tagLength;i&&void 0!==n[1]&&ns(n[1]);const s=t(r,...n),a=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");ns(t)}};let o=!1;return{encrypt(e,t){if(o)throw Error("cannot encrypt() twice with same key + nonce");return o=!0,ns(e),a(s.encrypt.length,t),s.encrypt(e,t)},decrypt(e,t){if(ns(e),i&&e.length<i)throw Error("invalid ciphertext length: smaller than tagLength="+i);return a(s.decrypt.length,t),s.decrypt(e,t)}}}return Object.assign(r,e),r};function gs(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&!ms(t))throw Error("invalid output, must be aligned");return t}function ws(e,t,r,n){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,n);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s);e.setUint32(t+0,a,n),e.setUint32(t+4,o,n)}function ms(e){return e.byteOffset%4==0}function bs(e){return Uint8Array.from(e)}const vs=16,ks=new Uint8Array(16),As=os(ks),Ss=e=>(e>>>0&255)<<24|(e>>>8&255)<<16|(e>>>16&255)<<8|e>>>24&255;class Es{constructor(e,t){this.blockLen=vs,this.outputLen=vs,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,ns(e=hs(e),16);const r=us(e);let n=r.getUint32(0,!1),i=r.getUint32(4,!1),s=r.getUint32(8,!1),a=r.getUint32(12,!1);const o=[];for(let e=0;e<128;e++)o.push({s0:Ss(n),s1:Ss(i),s2:Ss(s),s3:Ss(a)}),({s0:n,s1:i,s2:s,s3:a}={s3:(l=s)<<31|(h=a)>>>1,s2:(u=i)<<31|l>>>1,s1:(c=n)<<31|u>>>1,s0:c>>>1^225<<24&-(1&h)});var c,u,l,h;const y=(p=t||1024)>65536?8:p>1024?4:2;var p;if(![1,2,4,8].includes(y))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=y;const f=128/y,d=this.windowSize=2**y,g=[];for(let e=0;e<f;e++)for(let t=0;t<d;t++){let r=0,n=0,i=0,s=0;for(let a=0;a<y;a++){if(!(t>>>y-a-1&1))continue;const{s0:c,s1:u,s2:l,s3:h}=o[y*e+a];r^=c,n^=u,i^=l,s^=h}g.push({s0:r,s1:n,s2:i,s3:s})}this.t=g}_updateBlock(e,t,r,n){e^=this.s0,t^=this.s1,r^=this.s2,n^=this.s3;const{W:i,t:s,windowSize:a}=this;let o=0,c=0,u=0,l=0;const h=(1<<i)-1;let y=0;for(const p of[e,t,r,n])for(let e=0;e<4;e++){const t=p>>>8*e&255;for(let e=8/i-1;e>=0;e--){const r=t>>>i*e&h,{s0:n,s1:p,s2:f,s3:d}=s[y*a+r];o^=n,c^=p,u^=f,l^=d,y+=1}}this.s0=o,this.s1=c,this.s2=u,this.s3=l}update(e){is(this),ns(e=hs(e));const t=os(e),r=Math.floor(e.length/vs),n=e.length%vs;for(let e=0;e<r;e++)this._updateBlock(t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]);return n&&(ks.set(e.subarray(r*vs)),this._updateBlock(As[0],As[1],As[2],As[3]),cs(As)),this}destroy(){const{t:e}=this;for(const t of e)t.s0=0,t.s1=0,t.s2=0,t.s3=0}digestInto(e){is(this),ss(e,this),this.finished=!0;const{s0:t,s1:r,s2:n,s3:i}=this,s=os(e);return s[0]=t,s[1]=r,s[2]=n,s[3]=i,e}digest(){const e=new Uint8Array(vs);return this.digestInto(e),this.destroy(),e}}class Ks extends Es{constructor(e,t){ns(e=hs(e));const r=function(e){e.reverse();const t=1&e[15];let r=0;for(let t=0;t<e.length;t++){const n=e[t];e[t]=n>>>1|r,r=(1&n)<<7}return e[0]^=225&-t,e}(bs(e));super(r,t),cs(r)}update(e){e=hs(e),is(this);const t=os(e),r=e.length%vs,n=Math.floor(e.length/vs);for(let e=0;e<n;e++)this._updateBlock(Ss(t[4*e+3]),Ss(t[4*e+2]),Ss(t[4*e+1]),Ss(t[4*e+0]));return r&&(ks.set(e.subarray(n*vs)),this._updateBlock(Ss(As[3]),Ss(As[2]),Ss(As[1]),Ss(As[0])),cs(As)),this}digestInto(e){is(this),ss(e,this),this.finished=!0;const{s0:t,s1:r,s2:n,s3:i}=this,s=os(e);return s[0]=t,s[1]=r,s[2]=n,s[3]=i,e.reverse()}}function _s(e){const t=(t,r)=>e(r,t.length).update(hs(t)).digest(),r=e(new Uint8Array(16),0);return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=(t,r)=>e(t,r),t}const Ps=_s((e,t)=>new Es(e,t));_s((e,t)=>new Ks(e,t));const Us=16,xs=new Uint8Array(Us);function Ds(e){return e<<1^283&-(e>>7)}function Cs(e,t){let r=0;for(;t>0;t>>=1)r^=e&-(1&t),e=Ds(e);return r}const Is=(()=>{const e=new Uint8Array(256);for(let t=0,r=1;t<256;t++,r^=Ds(r))e[t]=r;const t=new Uint8Array(256);t[0]=99;for(let r=0;r<255;r++){let n=e[255-r];n|=n<<8,t[e[r]]=255&(n^n>>4^n>>5^n>>6^n>>7^99)}return cs(e),t})(),Ts=Is.map((e,t)=>Is.indexOf(t)),Bs=e=>e<<8|e>>>24,$s=e=>e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;function Ns(e,t){if(256!==e.length)throw Error("Wrong sbox length");const r=new Uint32Array(256).map((r,n)=>t(e[n])),n=r.map(Bs),i=n.map(Bs),s=i.map(Bs),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let t=0;t<256;t++)for(let u=0;u<256;u++){const l=256*t+u;a[l]=r[t]^n[u],o[l]=i[t]^s[u],c[l]=e[t]<<8|e[u]}return{sbox:e,sbox2:c,T0:r,T1:n,T2:i,T3:s,T01:a,T23:o}}const Ls=Ns(Is,e=>Cs(e,3)<<24|e<<16|e<<8|Cs(e,2)),Fs=Ns(Ts,e=>Cs(e,11)<<24|Cs(e,13)<<16|Cs(e,9)<<8|Cs(e,14)),Os=(()=>{const e=new Uint8Array(16);for(let t=0,r=1;t<16;t++,r=Ds(r))e[t]=r;return e})();function Rs(e){ns(e);const t=e.length;if(![16,24,32].includes(t))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+t);const{sbox2:r}=Ls,n=[];ms(e)||n.push(e=bs(e));const i=os(e),s=i.length,a=e=>zs(r,e,e,e,e),o=new Uint32Array(t+28);o.set(i);for(let e=s;e<o.length;e++){let t=o[e-1];e%s==0?t=a((c=t)<<24|c>>>8)^Os[e/s-1]:s>6&&e%s==4&&(t=a(t)),o[e]=o[e-s]^t}var c;return cs(...n),o}function Ms(e){const t=Rs(e),r=t.slice(),n=t.length,{sbox2:i}=Ls,{T0:s,T1:a,T2:o,T3:c}=Fs;for(let e=0;e<n;e+=4)for(let i=0;i<4;i++)r[e+i]=t[n-e-4+i];cs(t);for(let e=4;e<n-4;e++){const t=r[e],n=zs(i,t,t,t,t);r[e]=s[255&n]^a[n>>>8&255]^o[n>>>16&255]^c[n>>>24]}return r}function js(e,t,r,n,i,s){return e[r<<8&65280|n>>>8&255]^t[i>>>8&65280|s>>>24&255]}function zs(e,t,r,n,i){return e[255&t|65280&r]|e[n>>>16&255|i>>>16&65280]<<16}function Hs(e,t,r,n,i){const{sbox2:s,T01:a,T23:o}=Ls;let c=0;t^=e[c++],r^=e[c++],n^=e[c++],i^=e[c++];const u=e.length/4-2;for(let s=0;s<u;s++){const s=e[c++]^js(a,o,t,r,n,i),u=e[c++]^js(a,o,r,n,i,t),l=e[c++]^js(a,o,n,i,t,r),h=e[c++]^js(a,o,i,t,r,n);t=s,r=u,n=l,i=h}return{s0:e[c++]^zs(s,t,r,n,i),s1:e[c++]^zs(s,r,n,i,t),s2:e[c++]^zs(s,n,i,t,r),s3:e[c++]^zs(s,i,t,r,n)}}function Gs(e,t,r,n,i){const{sbox2:s,T01:a,T23:o}=Fs;let c=0;t^=e[c++],r^=e[c++],n^=e[c++],i^=e[c++];const u=e.length/4-2;for(let s=0;s<u;s++){const s=e[c++]^js(a,o,t,i,n,r),u=e[c++]^js(a,o,r,t,i,n),l=e[c++]^js(a,o,n,r,t,i),h=e[c++]^js(a,o,i,n,r,t);t=s,r=u,n=l,i=h}return{s0:e[c++]^zs(s,t,i,n,r),s1:e[c++]^zs(s,r,t,i,n),s2:e[c++]^zs(s,n,r,t,i),s3:e[c++]^zs(s,i,n,r,t)}}function qs(e,t,r,n){ns(t,Us),ns(r);const i=r.length;ps(r,n=gs(i,n));const s=t,a=os(s);let{s0:o,s1:c,s2:u,s3:l}=Hs(e,a[0],a[1],a[2],a[3]);const h=os(r),y=os(n);for(let t=0;t+4<=h.length;t+=4){y[t+0]=h[t+0]^o,y[t+1]=h[t+1]^c,y[t+2]=h[t+2]^u,y[t+3]=h[t+3]^l;let r=1;for(let e=s.length-1;e>=0;e--)r=r+(255&s[e])|0,s[e]=255&r,r>>>=8;({s0:o,s1:c,s2:u,s3:l}=Hs(e,a[0],a[1],a[2],a[3]))}const p=Us*Math.floor(h.length/4);if(p<i){const e=new Uint32Array([o,c,u,l]),t=as(e);for(let e=p,s=0;e<i;e++,s++)n[e]=r[e]^t[s];cs(e)}return n}function Ws(e,t,r,n,i){ns(r,Us),ns(n),i=gs(n.length,i);const s=r,a=os(s),o=us(s),c=os(n),u=os(i),l=t?0:12,h=n.length;let y=o.getUint32(l,t),{s0:p,s1:f,s2:d,s3:g}=Hs(e,a[0],a[1],a[2],a[3]);for(let r=0;r+4<=c.length;r+=4)u[r+0]=c[r+0]^p,u[r+1]=c[r+1]^f,u[r+2]=c[r+2]^d,u[r+3]=c[r+3]^g,y=y+1>>>0,o.setUint32(l,y,t),({s0:p,s1:f,s2:d,s3:g}=Hs(e,a[0],a[1],a[2],a[3]));const w=Us*Math.floor(c.length/4);if(w<h){const e=new Uint32Array([p,f,d,g]),t=as(e);for(let e=w,r=0;e<h;e++,r++)i[e]=n[e]^t[r];cs(e)}return i}const Vs=ds({blockSize:16,nonceLength:16},function(e,t){function r(r,n){if(ns(r),void 0!==n&&(ns(n),!ms(n)))throw Error("unaligned destination");const i=Rs(e),s=bs(t),a=[i,s];ms(r)||a.push(r=bs(r));const o=qs(i,s,r,n);return cs(...a),o}return{encrypt:(e,t)=>r(e,t),decrypt:(e,t)=>r(e,t)}}),Xs=ds({blockSize:16,nonceLength:16},function(e,t,r={}){const n=!r.disablePadding;return{encrypt(r,i){const s=Rs(e),{b:a,o,out:c}=function(e,t,r){ns(e);let n=e.length;const i=n%Us;if(!t&&0!==i)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");ms(e)||(e=bs(e));const s=os(e);if(t){let e=Us-i;e||(e=Us),n+=e}return ps(e,r=gs(n,r)),{b:s,o:os(r),out:r}}(r,n,i);let u=t;const l=[s];ms(u)||l.push(u=bs(u));const h=os(u);let y=h[0],p=h[1],f=h[2],d=h[3],g=0;for(;g+4<=a.length;)y^=a[g+0],p^=a[g+1],f^=a[g+2],d^=a[g+3],({s0:y,s1:p,s2:f,s3:d}=Hs(s,y,p,f,d)),o[g++]=y,o[g++]=p,o[g++]=f,o[g++]=d;if(n){const e=function(e){const t=new Uint8Array(16),r=os(t);t.set(e);const n=Us-e.length;for(let e=Us-n;e<Us;e++)t[e]=n;return r}(r.subarray(4*g));y^=e[0],p^=e[1],f^=e[2],d^=e[3],({s0:y,s1:p,s2:f,s3:d}=Hs(s,y,p,f,d)),o[g++]=y,o[g++]=p,o[g++]=f,o[g++]=d}return cs(...l),c},decrypt(r,i){!function(e){if(ns(e),e.length%Us!=0)throw Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size 16")}(r);const s=Ms(e);let a=t;const o=[s];ms(a)||o.push(a=bs(a));const c=os(a);i=gs(r.length,i),ms(r)||o.push(r=bs(r)),ps(r,i);const u=os(r),l=os(i);let h=c[0],y=c[1],p=c[2],f=c[3];for(let e=0;e+4<=u.length;){const t=h,r=y,n=p,i=f;h=u[e+0],y=u[e+1],p=u[e+2],f=u[e+3];const{s0:a,s1:o,s2:c,s3:d}=Gs(s,h,y,p,f);l[e++]=a^t,l[e++]=o^r,l[e++]=c^n,l[e++]=d^i}return cs(...o),function(e,t){if(!t)return e;const r=e.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");const n=e[r-1];if(n<=0||n>16)throw Error("aes/pcks5: wrong padding");const i=e.subarray(0,-n);for(let t=0;t<n;t++)if(e[r-t-1]!==n)throw Error("aes/pcks5: wrong padding");return i}(i,n)}}}),Qs=ds({blockSize:16,nonceLength:16},function(e,t){function r(r,n,i){ns(r);const s=r.length;if(ys(r,i=gs(s,i)))throw Error("overlapping src and dst not supported.");const a=Rs(e);let o=t;const c=[a];ms(o)||c.push(o=bs(o)),ms(r)||c.push(r=bs(r));const u=os(r),l=os(i),h=n?l:u,y=os(o);let p=y[0],f=y[1],d=y[2],g=y[3];for(let e=0;e+4<=u.length;){const{s0:t,s1:r,s2:n,s3:i}=Hs(a,p,f,d,g);l[e+0]=u[e+0]^t,l[e+1]=u[e+1]^r,l[e+2]=u[e+2]^n,l[e+3]=u[e+3]^i,p=h[e++],f=h[e++],d=h[e++],g=h[e++]}const w=Us*Math.floor(u.length/4);if(w<s){({s0:p,s1:f,s2:d,s3:g}=Hs(a,p,f,d,g));const e=as(new Uint32Array([p,f,d,g]));for(let t=w,n=0;t<s;t++,n++)i[t]=r[t]^e[n];cs(e)}return cs(...c),i}return{encrypt:(e,t)=>r(e,!0,t),decrypt:(e,t)=>r(e,!1,t)}}),Ys=ds({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(e,t,r){if(t.length<8)throw Error("aes/gcm: invalid nonce length");function n(e,t,n){const i=function(e,t,r,n,i){const s=i?i.length:0,a=e.create(r,n.length+s);i&&a.update(i);const o=function(e,t,r){const n=new Uint8Array(16),i=us(n);return ws(i,0,BigInt(t),r),ws(i,8,BigInt(e),r),n}(8*n.length,8*s,!1);a.update(n),a.update(o);const c=a.digest();return cs(o),c}(Ps,0,e,n,r);for(let e=0;e<t.length;e++)i[e]^=t[e];return i}function i(){const r=Rs(e),n=xs.slice(),i=xs.slice();if(Ws(r,!1,i,i,n),12===t.length)i.set(t);else{const e=xs.slice();ws(us(e),8,BigInt(8*t.length),!1);const r=Ps.create(n).update(t).update(e);r.digestInto(i),r.destroy()}return{xk:r,authKey:n,counter:i,tagMask:Ws(r,!1,i,xs)}}return{encrypt(e){const{xk:t,authKey:r,counter:s,tagMask:a}=i(),o=new Uint8Array(e.length+16),c=[t,r,s,a];ms(e)||c.push(e=bs(e)),Ws(t,!1,s,e,o.subarray(0,e.length));const u=n(r,a,o.subarray(0,o.length-16));return c.push(u),o.set(u,e.length),cs(...c),o},decrypt(e){const{xk:t,authKey:r,counter:s,tagMask:a}=i(),o=[t,r,a,s];ms(e)||o.push(e=bs(e));const c=e.subarray(0,-16),u=e.subarray(-16),l=n(r,a,c);if(o.push(l),!fs(l,u))throw Error("aes/gcm: invalid ghash tag");const h=Ws(t,!1,s,c);return cs(...o),h}}});function Zs(e){return e instanceof Uint32Array||ArrayBuffer.isView(e)&&"Uint32Array"===e.constructor.name}function Js(e,t){if(ns(t,16),!Zs(e))throw Error("_encryptBlock accepts result of expandKeyLE");const r=os(t);let{s0:n,s1:i,s2:s,s3:a}=Hs(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=i,r[2]=s,r[3]=a,t}function ea(e,t){if(ns(t,16),!Zs(e))throw Error("_decryptBlock accepts result of expandKeyLE");const r=os(t);let{s0:n,s1:i,s2:s,s3:a}=Gs(e,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=i,r[2]=s,r[3]=a,t}const ta={encrypt(e,t){if(t.length>=2**32)throw Error("plaintext should be less than 4gb");const r=Rs(e);if(16===t.length)Js(r,t);else{const e=os(t);let n=e[0],i=e[1];for(let t=0,s=1;t<6;t++)for(let t=2;t<e.length;t+=2,s++){const{s0:a,s1:o,s2:c,s3:u}=Hs(r,n,i,e[t],e[t+1]);n=a,i=o^$s(s),e[t]=c,e[t+1]=u}e[0]=n,e[1]=i}r.fill(0)},decrypt(e,t){if(t.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const r=Ms(e),n=t.length/8-1;if(1===n)ea(r,t);else{const e=os(t);let i=e[0],s=e[1];for(let t=0,a=6*n;t<6;t++)for(let t=2*n;t>=1;t-=2,a--){s^=$s(a);const{s0:n,s1:o,s2:c,s3:u}=Gs(r,i,s,e[t],e[t+1]);i=n,s=o,e[t]=c,e[t+1]=u}e[0]=i,e[1]=s}r.fill(0)}},ra=new Uint8Array(8).fill(166),na=ds({blockSize:8},e=>({encrypt(t){if(!t.length||t.length%8!=0)throw Error("invalid plaintext length");if(8===t.length)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=function(...e){let t=0;for(let r=0;r<e.length;r++){const n=e[r];ns(n),t+=n.length}const r=new Uint8Array(t);for(let t=0,n=0;t<e.length;t++){const i=e[t];r.set(i,n),n+=i.length}return r}(ra,t);return ta.encrypt(e,r),r},decrypt(t){if(t.length%8!=0||t.length<24)throw Error("invalid ciphertext length");const r=bs(t);if(ta.decrypt(e,r),!fs(r.subarray(0,8),ra))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}})),ia={expandKeyLE:Rs,expandKeyDecLE:Ms,encrypt:Hs,decrypt:Gs,encryptBlock:Js,decryptBlock:ea,ctrCounter:qs,ctr32:Ws};async function sa(e){switch(e){case Cn.symmetric.aes128:case Cn.symmetric.aes192:case Cn.symmetric.aes256:throw Error("Not a legacy cipher");case Cn.symmetric.cast5:case Cn.symmetric.blowfish:case Cn.symmetric.twofish:case Cn.symmetric.tripledes:{const{legacyCiphers:t}=await i.e(464).then(i.bind(i,464)),r=Cn.read(Cn.symmetric,e),n=t.get(r);if(!n)throw Error("Unsupported cipher algorithm");return n}default:throw Error("Unsupported cipher algorithm")}}function aa(e){switch(e){case Cn.symmetric.aes128:case Cn.symmetric.aes192:case Cn.symmetric.aes256:case Cn.symmetric.twofish:return 16;case Cn.symmetric.blowfish:case Cn.symmetric.cast5:case Cn.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function oa(e){switch(e){case Cn.symmetric.aes128:case Cn.symmetric.blowfish:case Cn.symmetric.cast5:return 16;case Cn.symmetric.aes192:case Cn.symmetric.tripledes:return 24;case Cn.symmetric.aes256:case Cn.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function ca(e){return{keySize:oa(e),blockSize:aa(e)}}const ua=Bn.getWebCrypto();async function la(e,t,r){const{keySize:n}=ca(e);if(!Bn.isAES(e)||t.length!==n)throw Error("Unexpected algorithm or key size");try{const e=await ua.importKey("raw",t,{name:"AES-KW"},!1,["wrapKey"]),n=await ua.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),i=await ua.wrapKey("raw",n,e,{name:"AES-KW"});return new Uint8Array(i)}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;Bn.printDebugError("Browser did not support operation: "+e.message)}return na(t).encrypt(r)}async function ha(e,t,r){const{keySize:n}=ca(e);if(!Bn.isAES(e)||t.length!==n)throw Error("Unexpected algorithm or key size");let i;try{i=await ua.importKey("raw",t,{name:"AES-KW"},!1,["unwrapKey"])}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;return Bn.printDebugError("Browser did not support operation: "+e.message),na(t).decrypt(r)}try{const e=await ua.unwrapKey("raw",r,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await ua.exportKey("raw",e))}catch(e){if("OperationError"===e.name)throw Error("Key Data Integrity failed");throw e}}async function ya(e,t,r,n,i){const s=Bn.getWebCrypto(),a=Cn.read(Cn.webHash,e);if(!a)throw Error("Hash algo not supported with HKDF");const o=await s.importKey("raw",t,"HKDF",!1,["deriveBits"]),c=await s.deriveBits({name:"HKDF",hash:a,salt:r,info:n},o,8*i);return new Uint8Array(c)}const pa={x25519:Bn.encodeUTF8("OpenPGP X25519"),x448:Bn.encodeUTF8("OpenPGP X448")};function fa(e){switch(e){case Cn.publicKey.x25519:return 32;case Cn.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function da(e,t){switch(e){case Cn.publicKey.x25519:try{const r=Bn.getWebCrypto(),n=await r.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(e=>{if("OperationError"===e.name){const e=Error("Unexpected key generation issue");throw e.name="NotSupportedError",e}throw e}),i=await r.exportKey("jwk",n.publicKey);if((await r.exportKey("jwk",n.privateKey)).x!==i.x){const e=Error("Unexpected mismatching public point");throw e.name="NotSupportedError",e}const s=ma(e,t),a=await r.importKey("jwk",s,"X25519",!1,[]),o=await r.deriveBits({name:"X25519",public:a},n.privateKey,8*fa(e));return{sharedSecret:new Uint8Array(o),ephemeralPublicKey:new Uint8Array(Rn(i.x))}}catch(e){if("NotSupportedError"!==e.name)throw e;const{default:r}=await i.e(837).then(i.bind(i,837)),{secretKey:n,publicKey:s}=r.box.keyPair(),a=r.scalarMult(n,t);return wa(a),{ephemeralPublicKey:s,sharedSecret:a}}case Cn.publicKey.x448:{const e=await Bn.getNobleCurve(Cn.publicKey.x448),{secretKey:r,publicKey:n}=e.keygen(),i=e.getSharedSecret(r,t);return wa(i),{ephemeralPublicKey:n,sharedSecret:i}}default:throw Error("Unsupported ECDH algorithm")}}async function ga(e,t,r,n){switch(e){case Cn.publicKey.x25519:try{const i=Bn.getWebCrypto(),s=function(e,t,r){if(e===Cn.publicKey.x25519){const n=ma(e,t);return n.d=Mn(r),n}throw Error("Unsupported ECDH algorithm")}(e,r,n),a=ma(e,t),o=await i.importKey("jwk",s,"X25519",!1,["deriveKey","deriveBits"]),c=await i.importKey("jwk",a,"X25519",!1,[]),u=await i.deriveBits({name:"X25519",public:c},o,8*fa(e));return new Uint8Array(u)}catch(e){if("NotSupportedError"!==e.name)throw e;const{default:r}=await i.e(837).then(i.bind(i,837)),s=r.scalarMult(n,t);return wa(s),s}case Cn.publicKey.x448:{const e=(await Bn.getNobleCurve(Cn.publicKey.x448)).getSharedSecret(n,t);return wa(e),e}default:throw Error("Unsupported ECDH algorithm")}}function wa(e){let t=0;for(let r=0;r<e.length;r++)t|=e[r];if(0===t)throw Error("Unexpected low order point")}function ma(e,t){if(e===Cn.publicKey.x25519)return{kty:"OKP",crv:"X25519",x:Mn(t),ext:!0};throw Error("Unsupported ECDH algorithm")}const ba=Bn.getWebCrypto(),va=Bn.getNodeCrypto(),ka={[Cn.curve.nistP256]:"P-256",[Cn.curve.nistP384]:"P-384",[Cn.curve.nistP521]:"P-521"},Aa=va?va.getCurves():[],Sa=va?{[Cn.curve.secp256k1]:Aa.includes("secp256k1")?"secp256k1":void 0,[Cn.curve.nistP256]:Aa.includes("prime256v1")?"prime256v1":void 0,[Cn.curve.nistP384]:Aa.includes("secp384r1")?"secp384r1":void 0,[Cn.curve.nistP521]:Aa.includes("secp521r1")?"secp521r1":void 0,[Cn.curve.ed25519Legacy]:Aa.includes("ED25519")?"ED25519":void 0,[Cn.curve.curve25519Legacy]:Aa.includes("X25519")?"X25519":void 0,[Cn.curve.brainpoolP256r1]:Aa.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[Cn.curve.brainpoolP384r1]:Aa.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[Cn.curve.brainpoolP512r1]:Aa.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},Ea={[Cn.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:Cn.publicKey.ecdsa,hash:Cn.hash.sha256,cipher:Cn.symmetric.aes128,node:Sa[Cn.curve.nistP256],web:ka[Cn.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[Cn.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:Cn.publicKey.ecdsa,hash:Cn.hash.sha384,cipher:Cn.symmetric.aes192,node:Sa[Cn.curve.nistP384],web:ka[Cn.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[Cn.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:Cn.publicKey.ecdsa,hash:Cn.hash.sha512,cipher:Cn.symmetric.aes256,node:Sa[Cn.curve.nistP521],web:ka[Cn.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[Cn.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:Cn.publicKey.ecdsa,hash:Cn.hash.sha256,cipher:Cn.symmetric.aes128,node:Sa[Cn.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[Cn.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:Cn.publicKey.eddsaLegacy,hash:Cn.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[Cn.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:Cn.publicKey.ecdh,hash:Cn.hash.sha256,cipher:Cn.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[Cn.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:Cn.publicKey.ecdsa,hash:Cn.hash.sha256,cipher:Cn.symmetric.aes128,node:Sa[Cn.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[Cn.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:Cn.publicKey.ecdsa,hash:Cn.hash.sha384,cipher:Cn.symmetric.aes192,node:Sa[Cn.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[Cn.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:Cn.publicKey.ecdsa,hash:Cn.hash.sha512,cipher:Cn.symmetric.aes256,node:Sa[Cn.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class Ka{constructor(e){try{this.name=e instanceof Fi?e.getName():Cn.write(Cn.curve,e)}catch(e){throw new qi("Unknown curve")}const t=Ea[this.name];this.keyType=t.keyType,this.oid=t.oid,this.hash=t.hash,this.cipher=t.cipher,this.node=t.node,this.web=t.web,this.payloadSize=t.payloadSize,this.sharedSize=t.sharedSize,this.wireFormatLeadingByte=t.wireFormatLeadingByte,this.web&&Bn.getWebCrypto()?this.type="web":this.node&&Bn.getNodeCrypto()?this.type="node":this.name===Cn.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===Cn.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(e,t){const r=await ba.generateKey({name:"ECDSA",namedCurve:ka[e]},!0,["sign","verify"]),n=await ba.exportKey("jwk",r.privateKey);return{publicKey:Ua(await ba.exportKey("jwk",r.publicKey),t),privateKey:Rn(n.d)}}(this.name,this.wireFormatLeadingByte)}catch(e){return Bn.printDebugError("Browser did not support generating ec key "+e.message),Pa(this.name)}case"node":return async function(e){const t=va.createECDH(Sa[e]);return await t.generateKeys(),{publicKey:new Uint8Array(t.getPublicKey()),privateKey:new Uint8Array(t.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:e,A:t}=await async function(e){switch(e){case Cn.publicKey.x25519:try{const e=Bn.getWebCrypto(),t=await e.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(e=>{if("OperationError"===e.name){const e=Error("Unexpected key generation issue");throw e.name="NotSupportedError",e}throw e}),r=await e.exportKey("jwk",t.privateKey),n=await e.exportKey("jwk",t.publicKey);if(r.x!==n.x){const e=Error("Unexpected mismatching public point");throw e.name="NotSupportedError",e}return{A:new Uint8Array(Rn(n.x)),k:Rn(r.d)}}catch(e){if("NotSupportedError"!==e.name)throw e;const{default:t}=await i.e(837).then(i.bind(i,837)),{secretKey:r,publicKey:n}=t.box.keyPair();return{A:n,k:r}}case Cn.publicKey.x448:{const e=await Bn.getNobleCurve(Cn.publicKey.x448),{secretKey:t,publicKey:r}=e.keygen();return{A:r,k:t}}default:throw Error("Unsupported ECDH algorithm")}}(Cn.publicKey.x25519),r=e.slice().reverse();return r[0]=127&r[0]|64,r[31]&=248,{publicKey:Bn.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),t]),privateKey:r}}case"ed25519Legacy":{const{seed:e,A:t}=await async function(e){switch(e){case Cn.publicKey.ed25519:try{const e=Bn.getWebCrypto(),t=await e.generateKey("Ed25519",!0,["sign","verify"]).catch(e=>{if("OperationError"===e.name){const e=Error("Unexpected key generation issue");throw e.name="NotSupportedError",e}throw e}),r=await e.exportKey("jwk",t.privateKey),n=await e.exportKey("jwk",t.publicKey);return{A:new Uint8Array(Rn(n.x)),seed:Rn(r.d)}}catch(t){if("NotSupportedError"!==t.name)throw t;const{default:r}=await i.e(837).then(i.bind(i,837)),n=oi(Zi(e)),{publicKey:s}=r.sign.keyPair.fromSeed(n);return{A:s,seed:n}}case Cn.publicKey.ed448:{const e=await Bn.getNobleCurve(Cn.publicKey.ed448),{secretKey:t,publicKey:r}=e.keygen();return{A:r,seed:t}}default:throw Error("Unsupported EdDSA algorithm")}}(Cn.publicKey.ed25519);return{publicKey:Bn.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),t]),privateKey:e}}default:return Pa(this.name)}}}function _a(e,t){const{payloadSize:r,wireFormatLeadingByte:n,name:i}=e,s=i===Cn.curve.curve25519Legacy||i===Cn.curve.ed25519Legacy?r:2*r;if(t[0]!==n||t.length!==s+1)throw Error("Invalid point encoding")}async function Pa(e){const t=await Bn.getNobleCurve(Cn.publicKey.ecdsa,e),{secretKey:r}=t.keygen();return{publicKey:t.getPublicKey(r,!1),privateKey:r}}function Ua(e,t){const r=Rn(e.x),n=Rn(e.y),i=new Uint8Array(r.length+n.length+1);return i[0]=t,i.set(r,1),i.set(n,r.length+1),i}function xa(e,t,r){const n=e,i=r.slice(1,n+1),s=r.slice(n+1,2*n+1);return{kty:"EC",crv:t,x:Mn(i),y:Mn(s),ext:!0}}function Da(e,t,r,n){const i=xa(e,t,r);return i.d=Mn(n),i}const Ca=Bn.getWebCrypto(),Ia=Bn.getNodeCrypto();async function Ta(e,t,r,n){return(await Bn.getNobleCurve(Cn.publicKey.ecdsa,e.name)).verify(Bn.concatUint8Array([t.r,t.s]),r,n,{lowS:!1})}function Ba(e){const t=e.length;if(t>0){const r=e[t-1];if(r>=1){const n=e.subarray(t-r),i=new Uint8Array(r).fill(r);if(Bn.equalsUint8Array(n,i))return e.subarray(0,t-r)}}throw Error("Invalid padding")}function $a(e,t,r,n){return Bn.concatUint8Array([t.write(),new Uint8Array([e]),r.write(),Bn.stringToUint8Array("Anonymous Sender    "),n])}async function Na(e,t,r,n,i=!1,s=!1){let a;if(i){for(a=0;a<t.length&&0===t[a];a++);t=t.subarray(a)}if(s){for(a=t.length-1;a>=0&&0===t[a];a--);t=t.subarray(0,a+1)}return(await Si(e,Bn.concatUint8Array([new Uint8Array([0,0,0,1]),t,n]))).subarray(0,r)}async function La(e,t,r){return{secretKey:r,sharedKey:(await Bn.getNobleCurve(Cn.publicKey.ecdh,e.name)).getSharedSecret(r,t).subarray(1)}}async function Fa(e,t){const r=await Bn.getNobleCurve(Cn.publicKey.ecdh,e.name),{publicKey:n,privateKey:i}=await e.genKeyPair();return{publicKey:n,sharedKey:r.getSharedSecret(i,t).subarray(1)}}const Oa=BigInt(0),Ra=BigInt(1);class Ma{constructor(e){e&&(this.data=e)}read(e){if(e.length>=1){const t=e[0];if(e.length>=1+t)return this.data=e.subarray(1,1+t),1+this.data.length}throw Error("Invalid symmetric key")}write(){return Bn.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class ja{constructor(e){if(e){const{hash:t,cipher:r}=e;this.hash=t,this.cipher=r}else this.hash=null,this.cipher=null}read(e){if(e.length<4||3!==e[0]||1!==e[1])throw new qi("Cannot read KDFParams");return this.hash=e[2],this.cipher=e[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class za{static fromObject({wrappedKey:e,algorithm:t}){const r=new za;return r.wrappedKey=e,r.algorithm=t,r}read(e){let t=0,r=e[t++];this.algorithm=r%2?e[t++]:null,r-=r%2,this.wrappedKey=Bn.readExactSubarray(e,t,t+r),t+=r}write(){return Bn.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}async function Ha(e,t,r,n,i,s){switch(e){case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.rsaEncrypt:{const{c:e}=n,{n:i,e:a}=t,{d:o,p:c,q:u,u:l}=r;return async function(e,t,r,n,i,s,a,o){if(Bn.getNodeCrypto()&&!o)try{return await async function(e,t,r,n,i,s,a){const o={key:await Bi(t,r,n,i,s,a),format:"jwk",type:"pkcs1",padding:Di.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Di.privateDecrypt(o,e))}catch(e){throw Error("Decryption error")}}(e,t,r,n,i,s,a)}catch(e){Bn.printDebugError(e)}return async function(e,t,r,n,i,s,a,o){if(e=Jn(e),t=Jn(t),r=Jn(r),n=Jn(n),i=Jn(i),s=Jn(s),a=Jn(a),e>=t)throw Error("Data too large.");const c=ei(n,s-Ci),u=ei(n,i-Ci),l=ci(BigInt(2),t),h=ti(ni(l,t),r,t),y=ti(e=ei(e*h,t),u,i);let p=ei(a*(ti(e,c,s)-y),s)*i+y;return p=ei(p*l,t),Pi(si(p,"be",ii(t)),o)}(e,t,r,n,i,s,a,o)}(e,i,a,o,c,u,l,s)}case Cn.publicKey.elgamal:{const{c1:e,c2:i}=n;return async function(e,t,r,n,i){return e=Jn(e),t=Jn(t),r=Jn(r),Pi(si(ei(ni(ti(e,n=Jn(n),r),r)*t,r),"be",ii(r)),i)}(e,i,t.p,r.x,s)}case Cn.publicKey.ecdh:{const{oid:e,Q:s,kdfParams:a}=t,{d:o}=r,{V:c,C:u}=n;return async function(e,t,r,n,i,s,a){const o=new Ka(e);_a(o,i),_a(o,r);const{sharedKey:c}=await async function(e,t,r,n){if(n.length!==e.payloadSize){const t=new Uint8Array(e.payloadSize);t.set(n,e.payloadSize-n.length),n=t}switch(e.type){case"curve25519Legacy":{const e=n.slice().reverse();return{secretKey:e,sharedKey:await ga(Cn.publicKey.x25519,t.subarray(1),r.subarray(1),e)}}case"web":if(e.web&&Bn.getWebCrypto())try{return await async function(e,t,r,n){const i=Bn.getWebCrypto(),s=Da(e.payloadSize,e.web,r,n);let a=i.importKey("jwk",s,{name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]);const o=xa(e.payloadSize,e.web,t);let c=i.importKey("jwk",o,{name:"ECDH",namedCurve:e.web},!0,[]);[a,c]=await Promise.all([a,c]);let u=i.deriveBits({name:"ECDH",namedCurve:e.web,public:c},a,e.sharedSize),l=i.exportKey("jwk",a);[u,l]=await Promise.all([u,l]);const h=new Uint8Array(u);return{secretKey:Rn(l.d),sharedKey:h}}(e,t,r,n)}catch(r){return Bn.printDebugError(r),La(e,t,n)}break;case"node":return async function(e,t,r){const n=Bn.getNodeCrypto().createECDH(e.node);n.setPrivateKey(r);const i=new Uint8Array(n.computeSecret(t));return{secretKey:new Uint8Array(n.getPrivateKey()),sharedKey:i}}(e,t,n);default:return La(e,t,n)}}(o,r,i,s),u=$a(Cn.publicKey.ecdh,e,t,a),{keySize:l}=ca(t.cipher);let h;for(let r=0;r<3;r++)try{const e=await Na(t.hash,c,l,u,1===r,2===r);return Ba(await ha(t.cipher,e,n))}catch(e){h=e}throw h}(e,a,c,u.data,s,o,i)}case Cn.publicKey.x25519:case Cn.publicKey.x448:{const{A:i}=t,{k:s}=r,{ephemeralPublicKey:a,C:o}=n;if(null!==o.algorithm&&!Bn.isAES(o.algorithm))throw Error("AES session key expected");return async function(e,t,r,n,i){const s=await ga(e,t,n,i),a=Bn.concatUint8Array([t,n,s]);switch(e){case Cn.publicKey.x25519:{const e=Cn.symmetric.aes128,{keySize:t}=ca(e);return ha(e,await ya(Cn.hash.sha256,a,new Uint8Array,pa.x25519,t),r)}case Cn.publicKey.x448:{const e=Cn.symmetric.aes256,{keySize:t}=ca(Cn.symmetric.aes256);return ha(e,await ya(Cn.hash.sha512,a,new Uint8Array,pa.x448,t),r)}default:throw Error("Unsupported ECDH algorithm")}}(e,a,o.wrappedKey,i,s)}default:throw Error("Unknown public key encryption algorithm.")}}function Ga(e,t){const r=new Set([Cn.publicKey.ed25519,Cn.publicKey.x25519,Cn.publicKey.ed448,Cn.publicKey.x448]),n=Object.keys(t).map(n=>{const i=t[n];return Bn.isUint8Array(i)?r.has(e)?i:Bn.uint8ArrayToMPI(i):i.write()});return Bn.concatUint8Array(n)}function qa(e){const{keySize:t}=ca(e);return oi(t)}function Wa(e){try{e.getName()}catch(e){throw new qi("Unknown curve OID")}}function Va(e,t){switch(e){case Cn.publicKey.ecdsa:case Cn.publicKey.ecdh:case Cn.publicKey.eddsaLegacy:return new Ka(t).payloadSize;case Cn.publicKey.ed25519:case Cn.publicKey.ed448:return Zi(e);case Cn.publicKey.x25519:case Cn.publicKey.x448:return fa(e);default:throw Error("Unknown elliptic algo")}}const Xa=Bn.getWebCrypto(),Qa=Bn.getNodeCrypto(),Ya=Qa?Qa.getCiphers():[],Za={idea:Ya.includes("idea-cfb")?"idea-cfb":void 0,tripledes:Ya.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:Ya.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:Ya.includes("bf-cfb")?"bf-cfb":void 0,aes128:Ya.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:Ya.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:Ya.includes("aes-256-cfb")?"aes-256-cfb":void 0};async function Ja(e){const{blockSize:t}=ca(e),r=await oi(t),n=new Uint8Array([r[r.length-2],r[r.length-1]]);return Bn.concat([r,n])}async function eo(e,t,r,n,i){const s=Cn.read(Cn.symmetric,e);if(Bn.getNodeCrypto()&&Za[s])return function(e,t,r,n){const i=Cn.read(Cn.symmetric,e),s=new Qa.createCipheriv(Za[i],t,n);return mn(r,e=>new Uint8Array(s.update(e)))}(e,t,r,n);if(Bn.isAES(e))return async function(e,t,r,n){if(Xa&&await ro.isSupported(e)){const i=new ro(e,t,n);return Bn.isStream(r)?mn(r,e=>i.encryptChunk(e),()=>i.finish()):i.encrypt(r)}if(Bn.isStream(r)){const i=new no(!0,e,t,n);return mn(r,e=>i.processChunk(e),()=>i.finish())}return Qs(t,n).encrypt(r)}(e,t,r,n);const a=new(await sa(e))(t),o=a.blockSize,c=n.slice();let u=new Uint8Array;const l=e=>{e&&(u=Bn.concatUint8Array([u,e]));const t=new Uint8Array(u.length);let r,n=0;for(;e?u.length>=o:u.length;){const e=a.encrypt(c);for(r=0;r<o;r++)c[r]=u[r]^e[r],t[n++]=c[r];u=u.subarray(o)}return t.subarray(0,n)};return mn(r,l,l)}async function to(e,t,r,n){const i=Cn.read(Cn.symmetric,e);if(Qa&&Za[i])return function(e,t,r,n){const i=Cn.read(Cn.symmetric,e),s=new Qa.createDecipheriv(Za[i],t,n);return mn(r,e=>new Uint8Array(s.update(e)))}(e,t,r,n);if(Bn.isAES(e))return async function(e,t,r,n){if(Bn.isStream(r)){const i=new no(!1,e,t,n);return mn(r,e=>i.processChunk(e),()=>i.finish())}return Qs(t,n).decrypt(r)}(e,t,r,n);const s=new(await sa(e))(t),a=s.blockSize;let o=n,c=new Uint8Array;const u=e=>{e&&(c=Bn.concatUint8Array([c,e]));const t=new Uint8Array(c.length);let r,n=0;for(;e?c.length>=a:c.length;){const e=s.encrypt(o);for(o=c.subarray(0,a),r=0;r<a;r++)t[n++]=o[r]^e[r];c=c.subarray(a)}return t.subarray(0,n)};return mn(r,u,u)}class ro{constructor(e,t,r){const{blockSize:n}=ca(e);this.key=t,this.prevBlock=r,this.nextBlock=new Uint8Array(n),this.i=0,this.blockSize=n,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(e){const{keySize:t}=ca(e);return Xa.importKey("raw",new Uint8Array(t),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)}async _runCBC(e,t){const r="AES-CBC";this.keyRef=this.keyRef||await Xa.importKey("raw",this.key,r,!1,["encrypt"]);const n=await Xa.encrypt({name:r,iv:t||this.zeroBlock},this.keyRef,e);return new Uint8Array(n).subarray(0,e.length)}async encryptChunk(e){const t=this.nextBlock.length-this.i,r=e.subarray(0,t);if(this.nextBlock.set(r,this.i),this.i+e.length>=2*this.blockSize){const r=(e.length-t)%this.blockSize,n=Bn.concatUint8Array([this.nextBlock,e.subarray(t,e.length-r)]),i=Bn.concatUint8Array([this.prevBlock,n.subarray(0,n.length-this.blockSize)]),s=await this._runCBC(i);return io(s,n),this.prevBlock=s.slice(-this.blockSize),r>0&&this.nextBlock.set(e.subarray(-r)),this.i=r,s}let n;if(this.i+=r.length,this.i===this.nextBlock.length){const t=this.nextBlock;n=await this._runCBC(this.prevBlock),io(n,t),this.prevBlock=n.slice(),this.i=0;const i=e.subarray(r.length);this.nextBlock.set(i,this.i),this.i+=i.length}else n=new Uint8Array;return n}async finish(){let e;if(0===this.i)e=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const t=this.nextBlock,r=await this._runCBC(this.prevBlock);io(r,t),e=r.subarray(0,t.length)}return this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(e){const t=(await this._runCBC(Bn.concatUint8Array([new Uint8Array(this.blockSize),e]),this.iv)).subarray(0,e.length);return io(t,e),this.clearSensitiveData(),t}}class no{constructor(e,t,r,n){this.forEncryption=e;const{blockSize:i}=ca(t);this.key=ia.expandKeyLE(r),n.byteOffset%4!=0&&(n=n.slice()),this.prevBlock=so(n),this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i}_runCFB(e){const t=so(e),r=new Uint8Array(e.length),n=so(r);for(let e=0;e+4<=n.length;e+=4){const{s0:r,s1:i,s2:s,s3:a}=ia.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);n[e+0]=t[e+0]^r,n[e+1]=t[e+1]^i,n[e+2]=t[e+2]^s,n[e+3]=t[e+3]^a,this.prevBlock=(this.forEncryption?n:t).slice(e,e+4)}return r}async processChunk(e){const t=this.nextBlock.length-this.i,r=e.subarray(0,t);if(this.nextBlock.set(r,this.i),this.i+e.length>=2*this.blockSize){const r=(e.length-t)%this.blockSize,n=Bn.concatUint8Array([this.nextBlock,e.subarray(t,e.length-r)]),i=this._runCFB(n);return r>0&&this.nextBlock.set(e.subarray(-r)),this.i=r,i}let n;if(this.i+=r.length,this.i===this.nextBlock.length){n=this._runCFB(this.nextBlock),this.i=0;const t=e.subarray(r.length);this.nextBlock.set(t,this.i),this.i+=t.length}else n=new Uint8Array;return n}async finish(){let e;return e=0===this.i?new Uint8Array:this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),e}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function io(e,t){const r=Math.min(e.length,t.length);for(let n=0;n<r;n++)e[n]=e[n]^t[n]}const so=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),ao=Bn.getWebCrypto(),oo=Bn.getNodeCrypto(),co=16;function uo(e,t){const r=e.length-co;for(let n=0;n<co;n++)e[n+r]^=t[n];return e}const lo=new Uint8Array(co);const ho=Bn.getWebCrypto(),yo=Bn.getNodeCrypto(),po=Bn.getNodeBuffer(),fo=new Uint8Array(16),go=new Uint8Array(16);go[15]=1;const wo=new Uint8Array(16);async function mo(e){const t=await async function(e){const t=await async function(e){if(Bn.getNodeCrypto())return async function(t){const r=new oo.createCipheriv("aes-"+8*e.length+"-cbc",e,lo).update(t);return new Uint8Array(r)};if(Bn.getWebCrypto())try{return e=await ao.importKey("raw",e,{name:"AES-CBC",length:8*e.length},!1,["encrypt"]),async function(t){const r=await ao.encrypt({name:"AES-CBC",iv:lo,length:128},e,t);return new Uint8Array(r).subarray(0,r.byteLength-co)}}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;Bn.printDebugError("Browser did not support operation: "+t.message)}return async function(t){return Xs(e,lo,{disablePadding:!0}).encrypt(t)}}(e),r=Bn.double(await t(lo)),n=Bn.double(r);return async function(e){return(await t(function(e,t,r){if(e.length&&e.length%co==0)return uo(e,t);const n=new Uint8Array(e.length+(co-e.length%co));return n.set(e),n[e.length]=128,uo(n,r)}(e,r,n))).subarray(-16)}}(e);return function(e,r){return t(Bn.concatUint8Array([e,r]))}}async function bo(e){if(Bn.getNodeCrypto())return async function(t,r){const n=new yo.createCipheriv("aes-"+8*e.length+"-ctr",e,r),i=po.concat([n.update(t),n.final()]);return new Uint8Array(i)};if(Bn.getWebCrypto())try{const t=await ho.importKey("raw",e,{name:"AES-CTR",length:8*e.length},!1,["encrypt"]);return async function(e,r){const n=await ho.encrypt({name:"AES-CTR",counter:r,length:128},t,e);return new Uint8Array(n)}}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;Bn.printDebugError("Browser did not support operation: "+t.message)}return async function(t,r){return Vs(e,r).encrypt(t)}}async function vo(e,t){if(e!==Cn.symmetric.aes128&&e!==Cn.symmetric.aes192&&e!==Cn.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,n]=await Promise.all([mo(t),bo(t)]);return{encrypt:async function(e,t,i){const[s,a]=await Promise.all([r(fo,t),r(go,i)]),o=await n(e,s),c=await r(wo,o);for(let e=0;e<16;e++)c[e]^=a[e]^s[e];return Bn.concatUint8Array([o,c])},decrypt:async function(e,t,i){if(e.length<16)throw Error("Invalid EAX ciphertext");const s=e.subarray(0,-16),a=e.subarray(-16),[o,c,u]=await Promise.all([r(fo,t),r(go,i),r(wo,s)]),l=u;for(let e=0;e<16;e++)l[e]^=c[e]^o[e];if(!Bn.equalsUint8Array(a,l))throw Error("Authentication tag mismatch");return await n(s,o)}}}wo[15]=2,vo.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[8+e]^=t[e];return r},vo.blockLength=16,vo.ivLength=16,vo.tagLength=16;const ko=16;function Ao(e){let t=0;for(let r=1;!(e&r);r<<=1)t++;return t}function So(e,t){for(let r=0;r<e.length;r++)e[r]^=t[r];return e}function Eo(e,t){return So(e.slice(),t)}const Ko=new Uint8Array(ko),_o=new Uint8Array([1]);async function Po(e,t){const{keySize:r}=ca(e);if(!Bn.isAES(e)||t.length!==r)throw Error("Unexpected algorithm or key size");let n=0;const i=e=>Xs(t,Ko,{disablePadding:!0}).encrypt(e),s=e=>Xs(t,Ko,{disablePadding:!0}).decrypt(e);let a;function o(e,t,r,s){const o=t.length/ko|0;!function(e,t){const r=Bn.nbits(Math.max(e.length,t.length)/ko|0)-1;for(let e=n+1;e<=r;e++)a[e]=Bn.double(a[e-1]);n=r}(t,s);const c=Bn.concatUint8Array([Ko.subarray(0,15-r.length),_o,r]),u=63&c[15];c[15]&=192;const l=i(c),h=Bn.concatUint8Array([l,Eo(l.subarray(0,8),l.subarray(1,9))]),y=Bn.shiftRight(h.subarray(0+(u>>3),17+(u>>3)),8-(7&u)).subarray(1),p=new Uint8Array(ko),f=new Uint8Array(t.length+16);let d,g=0;for(d=0;d<o;d++)So(y,a[Ao(d+1)]),f.set(So(e(Eo(y,t)),y),g),So(p,e===i?t:f.subarray(g)),t=t.subarray(ko),g+=ko;if(t.length){So(y,a.x);const r=i(y);f.set(Eo(t,r),g);const n=new Uint8Array(ko);n.set(e===i?t:f.subarray(g,-16),0),n[t.length]=128,So(p,n),g+=t.length}const w=So(i(So(So(p,y),a.$)),function(e){if(!e.length)return Ko;const t=e.length/ko|0,r=new Uint8Array(ko),n=new Uint8Array(ko);for(let s=0;s<t;s++)So(r,a[Ao(s+1)]),So(n,i(Eo(r,e))),e=e.subarray(ko);if(e.length){So(r,a.x);const t=new Uint8Array(ko);t.set(e,0),t[e.length]=128,So(t,r),So(n,i(t))}return n}(s));return f.set(w,g),f}return function(){const e=i(Ko),t=Bn.double(e);a=[],a[0]=Bn.double(t),a.x=e,a.$=t}(),{encrypt:async function(e,t,r){return o(i,e,t,r)},decrypt:async function(e,t,r){if(e.length<16)throw Error("Invalid OCB ciphertext");const n=e.subarray(-16);e=e.subarray(0,-16);const i=o(s,e,t,r);if(Bn.equalsUint8Array(n,i.subarray(-16)))return i.subarray(0,-16);throw Error("Authentication tag mismatch")}}}Po.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[7+e]^=t[e];return r},Po.blockLength=ko,Po.ivLength=15,Po.tagLength=16;const Uo=Bn.getWebCrypto(),xo=Bn.getNodeCrypto(),Do=Bn.getNodeBuffer(),Co="AES-GCM";async function Io(e,t){if(e!==Cn.symmetric.aes128&&e!==Cn.symmetric.aes192&&e!==Cn.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(Bn.getNodeCrypto())return{encrypt:async function(e,r,n=new Uint8Array){const i=new xo.createCipheriv("aes-"+8*t.length+"-gcm",t,r);i.setAAD(n);const s=Do.concat([i.update(e),i.final(),i.getAuthTag()]);return new Uint8Array(s)},decrypt:async function(e,r,n=new Uint8Array){const i=new xo.createDecipheriv("aes-"+8*t.length+"-gcm",t,r);i.setAAD(n),i.setAuthTag(e.slice(e.length-16,e.length));const s=Do.concat([i.update(e.slice(0,e.length-16)),i.final()]);return new Uint8Array(s)}};if(Bn.getWebCrypto())try{const e=await Uo.importKey("raw",t,{name:Co},!1,["encrypt","decrypt"]),r=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(n,i,s=new Uint8Array){if(r&&!n.length)return Ys(t,i,s).encrypt(n);const a=await Uo.encrypt({name:Co,iv:i,additionalData:s,tagLength:128},e,n);return new Uint8Array(a)},decrypt:async function(n,i,s=new Uint8Array){if(r&&16===n.length)return Ys(t,i,s).decrypt(n);try{const t=await Uo.decrypt({name:Co,iv:i,additionalData:s,tagLength:128},e,n);return new Uint8Array(t)}catch(e){if("OperationError"===e.name)throw Error("Authentication tag mismatch")}}}}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;Bn.printDebugError("Browser did not support operation: "+e.message)}return{encrypt:async function(e,r,n){return Ys(t,r,n).encrypt(e)},decrypt:async function(e,r,n){return Ys(t,r,n).decrypt(e)}}}function To(e,t=!1){switch(e){case Cn.aead.eax:return vo;case Cn.aead.ocb:return Po;case Cn.aead.gcm:return Io;case Cn.aead.experimentalGCM:if(!t)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return Io;default:throw Error("Unsupported AEAD mode")}}async function Bo(e,t,r,n,i,s){switch(e){case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.rsaEncrypt:case Cn.publicKey.rsaSign:{const{n:e,e:a}=n;return async function(e,t,r,n,i,s){if(t&&!Bn.isStream(t))if(Bn.getWebCrypto())try{return await async function(e,t,r,n,i){const s=$i(n,i),a=await xi.importKey("jwk",s,{name:"RSASSA-PKCS1-v1_5",hash:{name:e}},!1,["verify"]);return xi.verify("RSASSA-PKCS1-v1_5",a,r,t)}(Cn.read(Cn.webHash,e),t,r,n,i)}catch(e){Bn.printDebugError(e)}else if(Bn.getNodeCrypto())return async function(e,t,r,n,i){const s={key:$i(n,i),format:"jwk",type:"pkcs1"},a=Di.createVerify(Cn.read(Cn.hash,e));a.write(t),a.end();try{return a.verify(s,r)}catch(e){return!1}}(e,t,r,n,i);return async function(e,t,r,n,i){if(r=Jn(r),t=Jn(t),n=Jn(n),t>=r)throw Error("Signature size cannot exceed modulus size");const s=si(ti(t,n,r),"be",ii(r)),a=Ui(e,i,ii(r));return Bn.equalsUint8Array(s,a)}(e,r,n,i,s)}(t,i,Bn.leftPad(r.s,e.length),e,a,s)}case Cn.publicKey.dsa:{const{g:e,p:t,q:i,y:a}=n,{r:o,s:c}=r;return async function(e,t,r,n,i,s,a,o){if(t=Jn(t),r=Jn(r),s=Jn(s),a=Jn(a),i=Jn(i),o=Jn(o),t<=Oa||t>=a||r<=Oa||r>=a)return Bn.printDebug("invalid DSA Signature"),!1;const c=ei(Jn(n.subarray(0,ii(a))),a),u=ni(r,a);if(u===Oa)return Bn.printDebug("invalid DSA Signature"),!1;i=ei(i,s),o=ei(o,s);const l=ei(c*u,a),h=ei(t*u,a);return ei(ei(ti(i,l,s)*ti(o,h,s),s),a)===t}(0,o,c,s,e,t,i,a)}case Cn.publicKey.ecdsa:{const{oid:e,Q:a}=n,o=new Ka(e).payloadSize;return async function(e,t,r,n,i,s){const a=new Ka(e);_a(a,i);const o=async()=>0===s[0]&&Ta(a,r,s.subarray(1),i);if(n&&!Bn.isStream(n))switch(a.type){case"web":try{const e=await async function(e,t,{r,s:n},i,s){const a=xa(e.payloadSize,ka[e.name],s),o=await Ca.importKey("jwk",a,{name:"ECDSA",namedCurve:ka[e.name],hash:{name:Cn.read(Cn.webHash,e.hash)}},!1,["verify"]),c=Bn.concatUint8Array([r,n]).buffer;return Ca.verify({name:"ECDSA",namedCurve:ka[e.name],hash:{name:Cn.read(Cn.webHash,t)}},o,c,i)}(a,t,r,n,i);return e||o()}catch(e){if("nistP521"!==a.name&&("DataError"===e.name||"OperationError"===e.name))throw e;Bn.printDebugError("Browser did not support verifying: "+e.message)}break;case"node":{const e=await async function(e,t,{r,s:n},i,s){const a=Bn.nodeRequire("eckey-utils"),o=Bn.getNodeBuffer(),{publicKey:c}=a.generateDer({curveName:Sa[e.name],publicKey:o.from(s)}),u=Ia.createVerify(Cn.read(Cn.hash,t));u.write(i),u.end();const l=Bn.concatUint8Array([r,n]);try{return u.verify({key:c,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},l)}catch(e){return!1}}(a,t,r,n,i);return e||o()}}return await Ta(a,r,s,i)||o()}(e,t,{r:Bn.leftPad(r.r,o),s:Bn.leftPad(r.s,o)},i,a,s)}case Cn.publicKey.eddsaLegacy:{const{oid:e,Q:i}=n,a=new Ka(e).payloadSize;return async function(e,t,{r,s:n},i,s,a){if(_a(new Ka(e),s),Ei(t)<Ei(Cn.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=Bn.concatUint8Array([r,n]);return Yi(Cn.publicKey.ed25519,t,{RS:o},0,s.subarray(1),a)}(e,t,{r:Bn.leftPad(r.r,a),s:Bn.leftPad(r.s,a)},0,i,s)}case Cn.publicKey.ed25519:case Cn.publicKey.ed448:{const{A:i}=n;return Yi(e,t,r,0,i,s)}default:throw Error("Unknown signature algorithm.")}}Io.getNonce=function(e,t){const r=e.slice();for(let e=0;e<t.length;e++)r[4+e]^=t[e];return r},Io.blockLength=16,Io.ivLength=12,Io.tagLength=16;class $o extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,$o),this.name="Argon2OutOfMemoryError"}}let No,Lo;class Fo{constructor(e=In){const{passes:t,parallelism:r,memoryExponent:n}=e.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=t,this.p=r,this.encodedM=n}generateSalt(){this.salt=oi(16)}read(e){let t=0;return this.salt=e.subarray(t,t+16),t+=16,this.t=e[t++],this.p=e[t++],this.encodedM=e[t++],t}write(){const e=[new Uint8Array([Cn.write(Cn.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return Bn.concatUint8Array(e)}async produceKey(e,t){const r=2<<this.encodedM-1;try{No=No||(await i.e(28).then(i.bind(i,28))).default,Lo=Lo||No();const n=(await Lo)({version:19,type:2,password:Bn.encodeUTF8(e),salt:this.salt,tagLength:t,memorySize:r,parallelism:this.p,passes:this.t});return r>1048576&&(Lo=No(),Lo.catch(()=>{})),n}catch(e){throw e.message&&(e.message.includes("Unable to grow instance memory")||e.message.includes("failed to grow memory")||e.message.includes("WebAssembly.Memory.grow")||e.message.includes("Out of memory"))?new $o("Could not allocate required memory for Argon2"):e}}}class Oo{constructor(e,t=In){this.algorithm=Cn.hash.sha256,this.type=Cn.read(Cn.s2k,e),this.c=t.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=oi(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(e){let t=0;switch(this.algorithm=e[t++],this.type){case"simple":break;case"salted":this.salt=e.subarray(t,t+8),t+=8;break;case"iterated":this.salt=e.subarray(t,t+8),t+=8,this.c=e[t++];break;case"gnu":if("GNU"!==Bn.uint8ArrayToString(e.subarray(t,t+3)))throw new qi("Unknown s2k type.");if(t+=3,1001!==1e3+e[t++])throw new qi("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new qi("Unknown s2k type.")}return t}write(){if("gnu-dummy"===this.type)return new Uint8Array([101,0,...Bn.stringToUint8Array("GNU"),1]);const e=[new Uint8Array([Cn.write(Cn.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":e.push(this.salt);break;case"iterated":e.push(this.salt),e.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return Bn.concatUint8Array(e)}async produceKey(e,t){e=Bn.encodeUTF8(e);const r=[];let n=0,i=0;for(;n<t;){let t;switch(this.type){case"simple":t=Bn.concatUint8Array([new Uint8Array(i),e]);break;case"salted":t=Bn.concatUint8Array([new Uint8Array(i),this.salt,e]);break;case"iterated":{const r=Bn.concatUint8Array([this.salt,e]);let n=r.length;const s=Math.max(this.getCount(),n);t=new Uint8Array(i+s),t.set(r,i);for(let e=i+n;e<s;e+=n,n*=2)t.copyWithin(e,i,e);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const s=await Si(this.algorithm,t);r.push(s),n+=s.length,i++}return Bn.concatUint8Array(r).subarray(0,t)}}const Ro=new Set([Cn.s2k.argon2,Cn.s2k.iterated]);function Mo(e,t=In){switch(e){case Cn.s2k.argon2:return new Fo(t);case Cn.s2k.iterated:case Cn.s2k.gnu:case Cn.s2k.salted:case Cn.s2k.simple:return new Oo(e,t);default:throw new qi("Unsupported S2K type")}}var jo=Uint8Array,zo=Uint16Array,Ho=Int32Array,Go=new jo([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),qo=new jo([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Wo=new jo([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Vo=function(e,t){for(var r=new zo(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];var i=new Ho(r[30]);for(n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},Xo=Vo(Go,2),Qo=Xo.b,Yo=Xo.r;Qo[28]=258,Yo[258]=28;for(var Zo=Vo(qo,0),Jo=Zo.b,ec=Zo.r,tc=new zo(32768),rc=0;rc<32768;++rc){var nc=(43690&rc)>>1|(21845&rc)<<1;nc=(61680&(nc=(52428&nc)>>2|(13107&nc)<<2))>>4|(3855&nc)<<4,tc[rc]=((65280&nc)>>8|(255&nc)<<8)>>1}var ic=function(e,t,r){for(var n=e.length,i=0,s=new zo(t);i<n;++i)e[i]&&++s[e[i]-1];var a,o=new zo(t);for(i=1;i<t;++i)o[i]=o[i-1]+s[i-1]<<1;if(r){a=new zo(1<<t);var c=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],l=t-e[i],h=o[e[i]-1]++<<l,y=h|(1<<l)-1;h<=y;++h)a[tc[h]>>c]=u}else for(a=new zo(n),i=0;i<n;++i)e[i]&&(a[i]=tc[o[e[i]-1]++]>>15-e[i]);return a},sc=new jo(288);for(rc=0;rc<144;++rc)sc[rc]=8;for(rc=144;rc<256;++rc)sc[rc]=9;for(rc=256;rc<280;++rc)sc[rc]=7;for(rc=280;rc<288;++rc)sc[rc]=8;var ac=new jo(32);for(rc=0;rc<32;++rc)ac[rc]=5;var oc=ic(sc,9,0),cc=ic(sc,9,1),uc=ic(ac,5,0),lc=ic(ac,5,1),hc=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},yc=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(7&t)&r},pc=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(7&t)},fc=function(e){return(e+7)/8|0},dc=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new jo(e.subarray(t,r))},gc=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],wc=function(e,t,r){var n=Error(t||gc[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,wc),!r)throw n;return n},mc=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},bc=function(e,t,r){r<<=7&t;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},vc=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,s=r.slice();if(!i)return{t:Pc,l:0};if(1==i){var a=new jo(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,l=1,h=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};l!=i-1;)o=r[r[u].f<r[h].f?u++:h++],c=r[u!=l&&r[u].f<r[h].f?u++:h++],r[l++]={s:-1,f:o.f+c.f,l:o,r:c};var y=s[0].s;for(n=1;n<i;++n)s[n].s>y&&(y=s[n].s);var p=new zo(y+1),f=kc(r[l-1],p,0);if(f>t){n=0;var d=0,g=f-t,w=1<<g;for(s.sort(function(e,t){return p[t.s]-p[e.s]||e.f-t.f});n<i;++n){var m=s[n].s;if(!(p[m]>t))break;d+=w-(1<<f-p[m]),p[m]=t}for(d>>=g;d>0;){var b=s[n].s;p[b]<t?d-=1<<t-p[b]++-1:++n}for(;n>=0&&d;--n){var v=s[n].s;p[v]==t&&(--p[v],++d)}f=t}return{t:new jo(p),l:f}},kc=function(e,t,r){return-1==e.s?Math.max(kc(e.l,t,r+1),kc(e.r,t,r+1)):t[e.s]=r},Ac=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new zo(++t),n=0,i=e[0],s=1,a=function(e){r[n++]=e},o=1;o<=t;++o)if(e[o]==i&&o!=t)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=e[o]}return{c:r.subarray(0,n),n:t}},Sc=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},Ec=function(e,t,r){var n=r.length,i=fc(t+2);e[i]=255&n,e[i+1]=n>>8,e[i+2]=255^e[i],e[i+3]=255^e[i+1];for(var s=0;s<n;++s)e[i+s+4]=r[s];return 8*(i+4+n)},Kc=function(e,t,r,n,i,s,a,o,c,u,l){mc(t,l++,r),++i[256];for(var h=vc(i,15),y=h.t,p=h.l,f=vc(s,15),d=f.t,g=f.l,w=Ac(y),m=w.c,b=w.n,v=Ac(d),k=v.c,A=v.n,S=new zo(19),E=0;E<m.length;++E)++S[31&m[E]];for(E=0;E<k.length;++E)++S[31&k[E]];for(var K=vc(S,7),_=K.t,P=K.l,U=19;U>4&&!_[Wo[U-1]];--U);var x,D,C,I,T=u+5<<3,B=Sc(i,sc)+Sc(s,ac)+a,$=Sc(i,y)+Sc(s,d)+a+14+3*U+Sc(S,_)+2*S[16]+3*S[17]+7*S[18];if(c>=0&&T<=B&&T<=$)return Ec(t,l,e.subarray(c,c+u));if(mc(t,l,1+($<B)),l+=2,$<B){x=ic(y,p,0),D=y,C=ic(d,g,0),I=d;var N=ic(_,P,0);for(mc(t,l,b-257),mc(t,l+5,A-1),mc(t,l+10,U-4),l+=14,E=0;E<U;++E)mc(t,l+3*E,_[Wo[E]]);l+=3*U;for(var L=[m,k],F=0;F<2;++F){var O=L[F];for(E=0;E<O.length;++E){var R=31&O[E];mc(t,l,N[R]),l+=_[R],R>15&&(mc(t,l,O[E]>>5&127),l+=O[E]>>12)}}}else x=oc,D=sc,C=uc,I=ac;for(E=0;E<o;++E){var M=n[E];if(M>255){bc(t,l,x[257+(R=M>>18&31)]),l+=D[R+257],R>7&&(mc(t,l,M>>23&31),l+=Go[R]);var j=31&M;bc(t,l,C[j]),l+=I[j],j>3&&(bc(t,l,M>>5&8191),l+=qo[j])}else bc(t,l,x[M]),l+=D[M]}return bc(t,l,x[256]),l+D[256]},_c=new Ho([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Pc=new jo(0),Uc=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,s=0|r.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=n+=r[a];n=(65535&n)+15*(n>>16),i=(65535&i)+15*(i>>16)}e=n,t=i},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},xc=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),a=new jo(s.length+e.length);a.set(s),a.set(e,s.length),e=a,i.w=s.length}return function(e,t,r,n,i,s){var a=s.z||e.length,o=new jo(n+a+5*(1+Math.ceil(a/7e3))+i),c=o.subarray(n,o.length-i),u=s.l,l=7&(s.r||0);if(t){l&&(c[0]=s.r>>3);for(var h=_c[t-1],y=h>>13,p=8191&h,f=(1<<r)-1,d=s.p||new zo(32768),g=s.h||new zo(f+1),w=Math.ceil(r/3),m=2*w,b=function(t){return(e[t]^e[t+1]<<w^e[t+2]<<m)&f},v=new Ho(25e3),k=new zo(288),A=new zo(32),S=0,E=0,K=s.i||0,_=0,P=s.w||0,U=0;K+2<a;++K){var x=b(K),D=32767&K,C=g[x];if(d[D]=C,g[x]=D,P<=K){var I=a-K;if((S>7e3||_>24576)&&(I>423||!u)){l=Kc(e,c,0,v,k,A,E,_,U,K-U,l),_=S=E=0,U=K;for(var T=0;T<286;++T)k[T]=0;for(T=0;T<30;++T)A[T]=0}var B=2,$=0,N=p,L=D-C&32767;if(I>2&&x==b(K-L))for(var F=Math.min(y,I)-1,O=Math.min(32767,K),R=Math.min(258,I);L<=O&&--N&&D!=C;){if(e[K+B]==e[K+B-L]){for(var M=0;M<R&&e[K+M]==e[K+M-L];++M);if(M>B){if(B=M,$=L,M>F)break;var j=Math.min(L,M-2),z=0;for(T=0;T<j;++T){var H=K-L+T&32767,G=H-d[H]&32767;G>z&&(z=G,C=H)}}}L+=(D=C)-(C=d[D])&32767}if($){v[_++]=268435456|Yo[B]<<18|ec[$];var q=31&Yo[B],W=31&ec[$];E+=Go[q]+qo[W],++k[257+q],++A[W],P=K+B,++S}else v[_++]=e[K],++k[e[K]]}}for(K=Math.max(K,P);K<a;++K)v[_++]=e[K],++k[e[K]];l=Kc(e,c,u,v,k,A,E,_,U,K-U,l),u||(s.r=7&l|c[l/8|0]<<3,l-=7,s.h=g,s.p=d,s.i=K,s.w=P)}else{for(K=s.w||0;K<a+u;K+=65535){var V=K+65535;V>=a&&(c[l/8|0]=u,V=a),l=Ec(c,l+1,e.subarray(K,V))}s.i=a}return dc(o,0,n+fc(l)+i)}(e,null==t.level?6:t.level,null==t.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,n,i)},Dc=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},Cc=function(){function e(e,t){if("function"==typeof e&&(t=e,e={}),this.ondata=t,this.o=e||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new jo(98304),this.o.dictionary){var r=this.o.dictionary.subarray(-32768);this.b.set(r,32768-r.length),this.s.i=32768-r.length}}return e.prototype.p=function(e,t){this.ondata(xc(e,this.o,0,0,this.s),t)},e.prototype.push=function(e,t){this.ondata||wc(5),this.s.l&&wc(4);var r=e.length+this.s.z;if(r>this.b.length){if(r>2*this.b.length-32768){var n=new jo(-32768&r);n.set(this.b.subarray(0,this.s.z)),this.b=n}var i=this.b.length-this.s.z;this.b.set(e.subarray(0,i),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(e.subarray(i),32768),this.s.z=e.length-i+32768,this.s.i=32766,this.s.w=32768}else this.b.set(e,this.s.z),this.s.z+=e.length;this.s.l=1&t,(this.s.z>this.s.w+8191||t)&&(this.p(this.b,t||!1),this.s.w=this.s.i,this.s.i-=2)},e.prototype.flush=function(){this.ondata||wc(5),this.s.l&&wc(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},e}(),Ic=function(){function e(e,t){"function"==typeof e&&(t=e,e={}),this.ondata=t;var r=e&&e.dictionary&&e.dictionary.subarray(-32768);this.s={i:0,b:r?r.length:0},this.o=new jo(32768),this.p=new jo(0),r&&this.o.set(r)}return e.prototype.e=function(e){if(this.ondata||wc(5),this.d&&wc(4),this.p.length){if(e.length){var t=new jo(this.p.length+e.length);t.set(this.p),t.set(e,this.p.length),this.p=t}}else this.p=e},e.prototype.c=function(e){this.s.i=+(this.d=e||!1);var t=this.s.b,r=function(e,t,r){var n=e.length;if(!n||t.f&&!t.l)return r||new jo(0);var i=!r,s=i||2!=t.i,a=t.i;i&&(r=new jo(3*n));var o=function(e){var t=r.length;if(e>t){var n=new jo(Math.max(2*t,e));n.set(r),r=n}},c=t.f||0,u=t.p||0,l=t.b||0,h=t.l,y=t.d,p=t.m,f=t.n,d=8*n;do{if(!h){c=yc(e,u,1);var g=yc(e,u+1,3);if(u+=3,!g){var w=e[(U=fc(u)+4)-4]|e[U-3]<<8,m=U+w;if(m>n){a&&wc(0);break}s&&o(l+w),r.set(e.subarray(U,m),l),t.b=l+=w,t.p=u=8*m,t.f=c;continue}if(1==g)h=cc,y=lc,p=9,f=5;else if(2==g){var b=yc(e,u,31)+257,v=yc(e,u+10,15)+4,k=b+yc(e,u+5,31)+1;u+=14;for(var A=new jo(k),S=new jo(19),E=0;E<v;++E)S[Wo[E]]=yc(e,u+3*E,7);u+=3*v;var K=hc(S),_=(1<<K)-1,P=ic(S,K,1);for(E=0;E<k;){var U,x=P[yc(e,u,_)];if(u+=15&x,(U=x>>4)<16)A[E++]=U;else{var D=0,C=0;for(16==U?(C=3+yc(e,u,3),u+=2,D=A[E-1]):17==U?(C=3+yc(e,u,7),u+=3):18==U&&(C=11+yc(e,u,127),u+=7);C--;)A[E++]=D}}var I=A.subarray(0,b),T=A.subarray(b);p=hc(I),f=hc(T),h=ic(I,p,1),y=ic(T,f,1)}else wc(1);if(u>d){a&&wc(0);break}}s&&o(l+131072);for(var B=(1<<p)-1,$=(1<<f)-1,N=u;;N=u){var L=(D=h[pc(e,u)&B])>>4;if((u+=15&D)>d){a&&wc(0);break}if(D||wc(2),L<256)r[l++]=L;else{if(256==L){N=u,h=null;break}var F=L-254;if(L>264){var O=Go[E=L-257];F=yc(e,u,(1<<O)-1)+Qo[E],u+=O}var R=y[pc(e,u)&$],M=R>>4;if(R||wc(3),u+=15&R,T=Jo[M],M>3&&(O=qo[M],T+=pc(e,u)&(1<<O)-1,u+=O),u>d){a&&wc(0);break}s&&o(l+131072);var j=l+F;if(l<T){var z=0-T,H=Math.min(T,j);for(z+l<0&&wc(3);l<H;++l)r[l]=(void 0)[z+l]}for(;l<j;++l)r[l]=r[l-T]}}t.l=h,t.p=N,t.b=l,t.f=c,h&&(c=1,t.m=p,t.d=y,t.n=f)}while(!c);return l!=r.length&&i?dc(r,0,l):r.subarray(0,l)}(this.p,this.s,this.o);this.ondata(dc(r,t,this.s.b),this.d),this.o=dc(r,this.s.b-32768),this.s.b=this.o.length,this.p=dc(this.p,this.s.p/8|0),this.s.p&=7},e.prototype.push=function(e,t){this.e(e),this.c(t)},e}(),Tc=function(){function e(e,t){this.c=Uc(),this.v=1,Cc.call(this,e,t)}return e.prototype.push=function(e,t){this.c.p(e),Cc.prototype.push.call(this,e,t)},e.prototype.p=function(e,t){var r=xc(e,this.o,this.v&&(this.o.dictionary?6:2),t&&4,this.s);this.v&&(function(e,t){var r=t.level,n=0==r?0:r<6?1:9==r?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=Uc();i.p(t.dictionary),Dc(e,2,i.d())}}(r,this.o),this.v=0),t&&Dc(r,r.length-4,this.c.d()),this.ondata(r,t)},e.prototype.flush=function(){Cc.prototype.flush.call(this)},e}(),Bc=function(){function e(e,t){Ic.call(this,e,t),this.v=e&&e.dictionary?2:1}return e.prototype.push=function(e,t){if(Ic.prototype.e.call(this,e),this.v){if(this.p.length<6&&!t)return;this.p=this.p.subarray((r=this.p,n=this.v-1,(8!=(15&r[0])||r[0]>>4>7||(r[0]<<8|r[1])%31)&&wc(6,"invalid zlib data"),(r[1]>>5&1)==+!n&&wc(6,"invalid zlib data: "+(32&r[1]?"need":"unexpected")+" dictionary"),2+(r[1]>>3&4))),this.v=0}var r,n;t&&(this.p.length<4&&wc(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),Ic.prototype.c.call(this,t)},e}(),$c="undefined"!=typeof TextDecoder&&new TextDecoder;try{$c.decode(Pc,{stream:!0})}catch(Xc){}class Nc{static get tag(){return Cn.packet.literalData}constructor(e=new Date){this.format=Cn.literal.utf8,this.date=Bn.normalizeDate(e),this.text=null,this.data=null,this.filename=""}setText(e,t=Cn.literal.utf8){this.format=t,this.text=e,this.data=null}getText(e=!1){return(null===this.text||Bn.isStream(this.text))&&(this.text=Bn.decodeUTF8(Bn.nativeEOL(this.getBytes(e)))),this.text}setBytes(e,t){this.format=t,this.data=e,this.text=null}getBytes(e=!1){return null===this.data&&(this.data=Bn.canonicalizeEOL(Bn.encodeUTF8(this.text))),e?An(this.data):this.data}setFilename(e){this.filename=e}getFilename(){return this.filename}async read(e){await vn(e,async e=>{const t=await e.readByte(),r=await e.readByte();this.filename=Bn.decodeUTF8(await e.readBytes(r)),this.date=Bn.readDate(await e.readBytes(4));let n=e.remainder();nn(n)&&(n=await Kn(n)),this.setBytes(n,t)})}writeHeader(){const e=Bn.encodeUTF8(this.filename),t=new Uint8Array([e.length]),r=new Uint8Array([this.format]),n=Bn.writeDate(this.date);return Bn.concatUint8Array([r,t,e,n])}write(){const e=this.writeHeader(),t=this.getBytes();return Bn.concat([e,t])}}class Lc{constructor(){this.bytes=""}read(e){return this.bytes=Bn.uint8ArrayToString(e.subarray(0,8)),this.bytes.length}write(){return Bn.stringToUint8Array(this.bytes)}toHex(){return Bn.uint8ArrayToHex(Bn.stringToUint8Array(this.bytes))}equals(e,t=!1){return t&&(e.isWildcard()||this.isWildcard())||this.bytes===e.bytes}isNull(){return""===this.bytes}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(e){return e.toHex()}static fromID(e){const t=new Lc;return t.read(Bn.hexToUint8Array(e)),t}static wildcard(){const e=new Lc;return e.read(new Uint8Array(8)),e}}const Fc=Symbol("verified"),Oc="salt@notations.openpgpjs.org",Rc=new Set([Cn.signatureSubpacket.issuerKeyID,Cn.signatureSubpacket.issuerFingerprint,Cn.signatureSubpacket.embeddedSignature]);class Mc{static get tag(){return Cn.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Lc,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[Fc]=null}read(e,t=In){let r=0;if(this.version=e[r++],5===this.version&&!t.enableParsingV5Entities)throw new qi("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4!==this.version&&5!==this.version&&6!==this.version)throw new qi(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=e[r++],this.publicKeyAlgorithm=e[r++],this.hashAlgorithm=e[r++],r+=this.readSubPackets(e.subarray(r,e.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=e.subarray(0,r),r+=this.readSubPackets(e.subarray(r,e.length),!1),this.signedHashValue=e.subarray(r,r+2),r+=2,6===this.version){const t=e[r++];this.salt=e.subarray(r,r+t),r+=t}const n=e.subarray(r,e.length),{read:i,signatureParams:s}=function(e,t){let r=0;switch(e){case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.rsaEncrypt:case Cn.publicKey.rsaSign:{const e=Bn.readMPI(t.subarray(r));return r+=e.length+2,{read:r,signatureParams:{s:e}}}case Cn.publicKey.dsa:case Cn.publicKey.ecdsa:{const e=Bn.readMPI(t.subarray(r));r+=e.length+2;const n=Bn.readMPI(t.subarray(r));return r+=n.length+2,{read:r,signatureParams:{r:e,s:n}}}case Cn.publicKey.eddsaLegacy:{const e=Bn.readMPI(t.subarray(r));r+=e.length+2;const n=Bn.readMPI(t.subarray(r));return r+=n.length+2,{read:r,signatureParams:{r:e,s:n}}}case Cn.publicKey.ed25519:case Cn.publicKey.ed448:{const n=2*Zi(e),i=Bn.readExactSubarray(t,r,r+n);return r+=i.length,{read:r,signatureParams:{RS:i}}}default:throw new qi("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,n);if(i<n.length)throw Error("Error reading MPIs");this.params=s}writeParams(){return this.params instanceof Promise?Pn(async()=>Ga(this.publicKeyAlgorithm,await this.params)):Ga(this.publicKeyAlgorithm,this.params)}write(){const e=[];return e.push(this.signatureData),e.push(this.writeUnhashedSubPackets()),e.push(this.signedHashValue),6===this.version&&(e.push(new Uint8Array([this.salt.length])),e.push(this.salt)),e.push(this.writeParams()),Bn.concat(e)}async sign(e,t,r=new Date,n=!1,i){this.version=e.version,this.created=Bn.normalizeDate(r),this.issuerKeyVersion=e.version,this.issuerFingerprint=e.getFingerprintBytes(),this.issuerKeyID=e.getKeyID();const s=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(6===this.version){const e=zc(this.hashAlgorithm);if(null===this.salt)this.salt=oi(e);else if(e!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(i.nonDeterministicSignaturesViaNotation){if(0!==this.rawNotations.filter(({name:e})=>e===Oc).length)throw Error("Unexpected existing salt notation");{const e=oi(zc(this.hashAlgorithm));this.rawNotations.push({name:Oc,value:e,humanReadable:!1,critical:!1})}}s.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=Bn.concat(s);const a=this.toHash(this.signatureType,t,n),o=await this.hash(this.signatureType,t,a,n);this.signedHashValue=En(kn(o),0,2);const c=async()=>async function(e,t,r,n,i,s){if(!r||!n)throw Error("Missing key parameters");switch(e){case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.rsaEncrypt:case Cn.publicKey.rsaSign:{const{n:e,e:a}=r,{d:o,p:c,q:u,u:l}=n;return{s:await Ii(t,i,e,a,o,c,u,l,s)}}case Cn.publicKey.dsa:{const{g:e,p:t,q:i}=r,{x:a}=n;return async function(e,t,r,n,i,s){const a=BigInt(0);let o,c,u,l;n=Jn(n),i=Jn(i),r=Jn(r),s=Jn(s),r=ei(r,n),s=ei(s,i);const h=ei(Jn(t.subarray(0,ii(i))),i);for(;;){if(o=ci(Ra,i),c=ei(ti(r,o,n),i),c===a)continue;const e=ei(s*c,i);if(l=ei(h+e,i),u=ei(ni(o,i)*l,i),u!==a)break}return{r:si(c,"be",ii(n)),s:si(u,"be",ii(n))}}(0,s,e,t,i,a)}case Cn.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case Cn.publicKey.ecdsa:{const{oid:e,Q:a}=r,{d:o}=n;return async function(e,t,r,n,i,s){const a=new Ka(e);if(_a(a,n),r&&!Bn.isStream(r)){const s={publicKey:n,privateKey:i};switch(a.type){case"web":try{return await async function(e,t,r,n){const i=e.payloadSize,s=Da(e.payloadSize,ka[e.name],n.publicKey,n.privateKey),a=await Ca.importKey("jwk",s,{name:"ECDSA",namedCurve:ka[e.name],hash:{name:Cn.read(Cn.webHash,e.hash)}},!1,["sign"]),o=new Uint8Array(await Ca.sign({name:"ECDSA",namedCurve:ka[e.name],hash:{name:Cn.read(Cn.webHash,t)}},a,r));return{r:o.slice(0,i),s:o.slice(i,i<<1)}}(a,t,r,s)}catch(e){if("nistP521"!==a.name&&("DataError"===e.name||"OperationError"===e.name))throw e;Bn.printDebugError("Browser did not support signing: "+e.message)}break;case"node":return async function(e,t,r,n){const i=Bn.nodeRequire("eckey-utils"),s=Bn.getNodeBuffer(),{privateKey:a}=i.generateDer({curveName:Sa[e.name],privateKey:s.from(n)}),o=Ia.createSign(Cn.read(Cn.hash,t));o.write(r),o.end();const c=new Uint8Array(o.sign({key:a,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),u=e.payloadSize;return{r:c.subarray(0,u),s:c.subarray(u,u<<1)}}(a,t,r,i)}}const o=(await Bn.getNobleCurve(Cn.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:si(o.r,"be",a.payloadSize),s:si(o.s,"be",a.payloadSize)}}(e,t,i,a,o,s)}case Cn.publicKey.eddsaLegacy:{const{oid:e,Q:i}=r,{seed:a}=n;return async function(e,t,r,n,i,s){if(_a(new Ka(e),n),Ei(t)<Ei(Cn.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await Qi(Cn.publicKey.ed25519,t,0,n.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}}(e,t,0,i,a,s)}case Cn.publicKey.ed25519:case Cn.publicKey.ed448:{const{A:i}=r,{seed:a}=n;return Qi(e,t,0,i,a,s)}default:throw Error("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,this.hashAlgorithm,e.publicParams,e.privateParams,a,await Kn(o));Bn.isStream(o)?this.params=c():(this.params=await c(),this[Fc]=!0)}writeHashedSubPackets(){const e=Cn.signatureSubpacket,t=[];let r;if(null===this.created)throw Error("Missing signature creation time");t.push(jc(e.signatureCreationTime,!0,Bn.writeDate(this.created))),null!==this.signatureExpirationTime&&t.push(jc(e.signatureExpirationTime,!0,Bn.writeNumber(this.signatureExpirationTime,4))),null!==this.exportable&&t.push(jc(e.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),null!==this.trustLevel&&(r=new Uint8Array([this.trustLevel,this.trustAmount]),t.push(jc(e.trustSignature,!0,r))),null!==this.regularExpression&&t.push(jc(e.regularExpression,!0,this.regularExpression)),null!==this.revocable&&t.push(jc(e.revocable,!0,new Uint8Array([this.revocable?1:0]))),null!==this.keyExpirationTime&&t.push(jc(e.keyExpirationTime,!0,Bn.writeNumber(this.keyExpirationTime,4))),null!==this.preferredSymmetricAlgorithms&&(r=Bn.stringToUint8Array(Bn.uint8ArrayToString(this.preferredSymmetricAlgorithms)),t.push(jc(e.preferredSymmetricAlgorithms,!1,r))),null!==this.revocationKeyClass&&(r=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),r=Bn.concat([r,this.revocationKeyFingerprint]),t.push(jc(e.revocationKey,!1,r))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&t.push(jc(e.issuerKeyID,!1,this.issuerKeyID.write())),this.rawNotations.forEach(({name:n,value:i,humanReadable:s,critical:a})=>{r=[new Uint8Array([s?128:0,0,0,0])];const o=Bn.encodeUTF8(n);r.push(Bn.writeNumber(o.length,2)),r.push(Bn.writeNumber(i.length,2)),r.push(o),r.push(i),r=Bn.concat(r),t.push(jc(e.notationData,a,r))}),null!==this.preferredHashAlgorithms&&(r=Bn.stringToUint8Array(Bn.uint8ArrayToString(this.preferredHashAlgorithms)),t.push(jc(e.preferredHashAlgorithms,!1,r))),null!==this.preferredCompressionAlgorithms&&(r=Bn.stringToUint8Array(Bn.uint8ArrayToString(this.preferredCompressionAlgorithms)),t.push(jc(e.preferredCompressionAlgorithms,!1,r))),null!==this.keyServerPreferences&&(r=Bn.stringToUint8Array(Bn.uint8ArrayToString(this.keyServerPreferences)),t.push(jc(e.keyServerPreferences,!1,r))),null!==this.preferredKeyServer&&t.push(jc(e.preferredKeyServer,!1,Bn.encodeUTF8(this.preferredKeyServer))),null!==this.isPrimaryUserID&&t.push(jc(e.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),null!==this.policyURI&&t.push(jc(e.policyURI,!1,Bn.encodeUTF8(this.policyURI))),null!==this.keyFlags&&(r=Bn.stringToUint8Array(Bn.uint8ArrayToString(this.keyFlags)),t.push(jc(e.keyFlags,!0,r))),null!==this.signersUserID&&t.push(jc(e.signersUserID,!1,Bn.encodeUTF8(this.signersUserID))),null!==this.reasonForRevocationFlag&&(r=Bn.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),t.push(jc(e.reasonForRevocation,!0,r))),null!==this.features&&(r=Bn.stringToUint8Array(Bn.uint8ArrayToString(this.features)),t.push(jc(e.features,!1,r))),null!==this.signatureTargetPublicKeyAlgorithm&&(r=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],r.push(Bn.stringToUint8Array(this.signatureTargetHash)),r=Bn.concat(r),t.push(jc(e.signatureTarget,!0,r))),null!==this.embeddedSignature&&t.push(jc(e.embeddedSignature,!0,this.embeddedSignature.write())),null!==this.issuerFingerprint&&(r=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],r=Bn.concat(r),t.push(jc(e.issuerFingerprint,this.version>=5,r))),null!==this.preferredAEADAlgorithms&&(r=Bn.stringToUint8Array(Bn.uint8ArrayToString(this.preferredAEADAlgorithms)),t.push(jc(e.preferredAEADAlgorithms,!1,r))),null!==this.preferredCipherSuites&&(r=new Uint8Array([].concat(...this.preferredCipherSuites)),t.push(jc(e.preferredCipherSuites,!1,r)));const n=Bn.concat(t),i=Bn.writeNumber(n.length,6===this.version?4:2);return Bn.concat([i,n])}writeUnhashedSubPackets(){const e=this.unhashedSubpackets.map(({type:e,critical:t,body:r})=>jc(e,t,r)),t=Bn.concat(e),r=Bn.writeNumber(t.length,6===this.version?4:2);return Bn.concat([r,t])}readSubPacket(e,t=!0){let r=0;const n=!!(128&e[r]),i=127&e[r];if(r++,t||(this.unhashedSubpackets.push({type:i,critical:n,body:e.subarray(r,e.length)}),Rc.has(i)))switch(i){case Cn.signatureSubpacket.signatureCreationTime:this.created=Bn.readDate(e.subarray(r,e.length));break;case Cn.signatureSubpacket.signatureExpirationTime:{const t=Bn.readNumber(e.subarray(r,e.length));this.signatureNeverExpires=0===t,this.signatureExpirationTime=t;break}case Cn.signatureSubpacket.exportableCertification:this.exportable=1===e[r++];break;case Cn.signatureSubpacket.trustSignature:this.trustLevel=e[r++],this.trustAmount=e[r++];break;case Cn.signatureSubpacket.regularExpression:this.regularExpression=e[r];break;case Cn.signatureSubpacket.revocable:this.revocable=1===e[r++];break;case Cn.signatureSubpacket.keyExpirationTime:{const t=Bn.readNumber(e.subarray(r,e.length));this.keyExpirationTime=t,this.keyNeverExpires=0===t;break}case Cn.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...e.subarray(r,e.length)];break;case Cn.signatureSubpacket.revocationKey:this.revocationKeyClass=e[r++],this.revocationKeyAlgorithm=e[r++],this.revocationKeyFingerprint=e.subarray(r,r+20);break;case Cn.signatureSubpacket.issuerKeyID:if(4===this.version)this.issuerKeyID.read(e.subarray(r,e.length));else if(t)throw Error("Unexpected Issuer Key ID subpacket");break;case Cn.signatureSubpacket.notationData:{const t=!!(128&e[r]);r+=4;const i=Bn.readNumber(e.subarray(r,r+2));r+=2;const s=Bn.readNumber(e.subarray(r,r+2));r+=2;const a=Bn.decodeUTF8(e.subarray(r,r+i)),o=e.subarray(r+i,r+i+s);this.rawNotations.push({name:a,humanReadable:t,value:o,critical:n}),t&&(this.notations[a]=Bn.decodeUTF8(o));break}case Cn.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...e.subarray(r,e.length)];break;case Cn.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...e.subarray(r,e.length)];break;case Cn.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...e.subarray(r,e.length)];break;case Cn.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=Bn.decodeUTF8(e.subarray(r,e.length));break;case Cn.signatureSubpacket.primaryUserID:this.isPrimaryUserID=0!==e[r++];break;case Cn.signatureSubpacket.policyURI:this.policyURI=Bn.decodeUTF8(e.subarray(r,e.length));break;case Cn.signatureSubpacket.keyFlags:this.keyFlags=[...e.subarray(r,e.length)];break;case Cn.signatureSubpacket.signersUserID:this.signersUserID=Bn.decodeUTF8(e.subarray(r,e.length));break;case Cn.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=e[r++],this.reasonForRevocationString=Bn.decodeUTF8(e.subarray(r,e.length));break;case Cn.signatureSubpacket.features:this.features=[...e.subarray(r,e.length)];break;case Cn.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=e[r++],this.signatureTargetHashAlgorithm=e[r++];const t=Ei(this.signatureTargetHashAlgorithm);this.signatureTargetHash=Bn.uint8ArrayToString(e.subarray(r,r+t));break}case Cn.signatureSubpacket.embeddedSignature:this.embeddedSignature=new Mc,this.embeddedSignature.read(e.subarray(r,e.length));break;case Cn.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=e[r++],this.issuerFingerprint=e.subarray(r,e.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case Cn.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...e.subarray(r,e.length)];break;case Cn.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let t=r;t<e.length;t+=2)this.preferredCipherSuites.push([e[t],e[t+1]]);break;default:this.unknownSubpackets.push({type:i,critical:n,body:e.subarray(r,e.length)})}}readSubPackets(e,t=!0,r){const n=6===this.version?4:2,i=Bn.readNumber(e.subarray(0,n));let s=n;for(;s<2+i;){const n=Oi(e.subarray(s,e.length));s+=n.offset,this.readSubPacket(e.subarray(s,s+n.len),t,r),s+=n.len}return s}toSign(e,t){const r=Cn.signature;switch(e){case r.binary:return null!==t.text?Bn.encodeUTF8(t.getText(!0)):t.getBytes(!0);case r.text:{const e=t.getBytes(!0);return Bn.canonicalizeEOL(e)}case r.standalone:return new Uint8Array(0);case r.certGeneric:case r.certPersona:case r.certCasual:case r.certPositive:case r.certRevocation:{let e,n;if(t.userID)n=180,e=t.userID;else{if(!t.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");n=209,e=t.userAttribute}const i=e.write();return Bn.concat([this.toSign(r.key,t),new Uint8Array([n]),Bn.writeNumber(i.length,4),i])}case r.subkeyBinding:case r.subkeyRevocation:case r.keyBinding:return Bn.concat([this.toSign(r.key,t),this.toSign(r.key,{key:t.bind})]);case r.key:if(void 0===t.key)throw Error("Key packet is required for this signature.");return t.key.writeForHash(this.version);case r.keyRevocation:return this.toSign(r.key,t);case r.timestamp:return new Uint8Array(0);case r.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(e,t){let r=0;return mn(kn(this.signatureData),e=>{r+=e.length},()=>{const n=[];return 5!==this.version||this.signatureType!==Cn.signature.binary&&this.signatureType!==Cn.signature.text||(t?n.push(new Uint8Array(6)):n.push(e.writeHeader())),n.push(new Uint8Array([this.version,255])),5===this.version&&n.push(new Uint8Array(4)),n.push(Bn.writeNumber(r,4)),Bn.concat(n)})}toHash(e,t,r=!1){const n=this.toSign(e,t);return Bn.concat([this.salt||new Uint8Array,n,this.signatureData,this.calculateTrailer(t,r)])}async hash(e,t,r,n=!1){if(6===this.version&&this.salt.length!==zc(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return r||(r=this.toHash(e,t,n)),Si(this.hashAlgorithm,r)}async verify(e,t,r,n=new Date,i=!1,s=In){if(!this.issuerKeyID.equals(e.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const a=t===Cn.signature.binary||t===Cn.signature.text;if(!this[Fc]||a){let n,s;if(this.hashed?s=await this.hashed:(n=this.toHash(t,r,i),s=await this.hash(t,r,n)),s=await Kn(s),this.signedHashValue[0]!==s[0]||this.signedHashValue[1]!==s[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[Fc]=await Bo(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,e.publicParams,n,s),!this[Fc])throw Error("Signature verification failed")}const o=Bn.normalizeDate(n);if(o&&this.created>o)throw Error("Signature creation time is in the future");if(o&&o>=this.getExpirationTime())throw Error("Signature is expired");if(s.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+Cn.read(Cn.hash,this.hashAlgorithm).toUpperCase());if(s.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[Cn.signature.binary,Cn.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+Cn.read(Cn.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:e,critical:t})=>{if(t)throw Error("Unknown critical signature subpacket type "+e)}),this.rawNotations.forEach(({name:e,critical:t})=>{if(t&&s.knownNotations.indexOf(e)<0)throw Error("Unknown critical notation: "+e)}),null!==this.revocationKeyClass)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(e=new Date){const t=Bn.normalizeDate(e);return null!==t&&!(this.created<=t&&t<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function jc(e,t,r){const n=[];return n.push(Ri(r.length+1)),n.push(new Uint8Array([(t?128:0)|e])),n.push(r),Bn.concat(n)}function zc(e){switch(e){case Cn.hash.sha256:return 16;case Cn.hash.sha384:return 24;case Cn.hash.sha512:return 32;case Cn.hash.sha224:case Cn.hash.sha3_256:return 16;case Cn.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class Hc{static get tag(){return Cn.packet.onePassSignature}static fromSignaturePacket(e,t){const r=new Hc;return r.version=6===e.version?6:3,r.signatureType=e.signatureType,r.hashAlgorithm=e.hashAlgorithm,r.publicKeyAlgorithm=e.publicKeyAlgorithm,r.issuerKeyID=e.issuerKeyID,r.salt=e.salt,r.issuerFingerprint=e.issuerFingerprint,r.flags=t?1:0,r}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(e){let t=0;if(this.version=e[t++],3!==this.version&&6!==this.version)throw new qi(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=e[t++],this.hashAlgorithm=e[t++],this.publicKeyAlgorithm=e[t++],6===this.version){const r=e[t++];this.salt=e.subarray(t,t+r),t+=r,this.issuerFingerprint=e.subarray(t,t+32),t+=32,this.issuerKeyID=new Lc,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Lc,this.issuerKeyID.read(e.subarray(t,t+8)),t+=8;return this.flags=e[t++],this}write(){const e=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return 6===this.version?e.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):e.push(this.issuerKeyID.write()),e.push(new Uint8Array([this.flags])),Bn.concatUint8Array(e)}calculateTrailer(...e){return Pn(async()=>Mc.prototype.calculateTrailer.apply(await this.correspondingSig,e))}async verify(){const e=await this.correspondingSig;if(!e||e.constructor.tag!==Cn.packet.signature)throw Error("Corresponding signature packet missing");if(e.signatureType!==this.signatureType||e.hashAlgorithm!==this.hashAlgorithm||e.publicKeyAlgorithm!==this.publicKeyAlgorithm||!e.issuerKeyID.equals(this.issuerKeyID)||3===this.version&&6===e.version||6===this.version&&6!==e.version||6===this.version&&!Bn.equalsUint8Array(e.issuerFingerprint,this.issuerFingerprint)||6===this.version&&!Bn.equalsUint8Array(e.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return e.hashed=this.hashed,e.verify.apply(e,arguments)}}function Gc(e,t){if(!t[e]){let r;try{r=Cn.read(Cn.packet,e)}catch(t){throw new Wi("Unknown packet type with tag: "+e)}throw Error("Packet not allowed in this context: "+r)}return new t[e]}Hc.prototype.hash=Mc.prototype.hash,Hc.prototype.toHash=Mc.prototype.toHash,Hc.prototype.toSign=Mc.prototype.toSign;class qc extends Array{static async fromBinary(e,t,r=In,n=null,i=!1){const s=new qc;return await s.read(e,t,r,n,i),s}async read(e,t,r=In,n=null,i=!1){let s;r.additionalAllowedPackets.length&&(s=Bn.constructAllowedPackets(r.additionalAllowedPackets),t={...t,...s}),this.stream=bn(e,async(e,a)=>{const o=Un(e),c=xn(a);try{let a=Bn.isStream(e);for(;;){let u,l;if(await c.ready,await Gi(o,a,async e=>{try{if(e.tag===Cn.packet.marker||e.tag===Cn.packet.trust||e.tag===Cn.packet.padding)return;const i=Gc(e.tag,t);try{n?.recordPacket(e.tag,s)}catch(e){if(r.enforceGrammar)throw e;Bn.printDebugError(e)}i.packets=new qc,i.fromStream=Bn.isStream(e.packet),l=i.fromStream;try{await i.read(e.packet,r)}catch(e){if(!(e instanceof qi))throw Bn.wrapError(new Vi(`Parsing ${i.constructor.name} failed`),e);throw e}await c.write(i)}catch(t){const n=t instanceof Wi&&e.tag<=39,s=t instanceof qi&&!(t instanceof Wi)&&!r.ignoreUnsupportedPackets,a=t instanceof Vi&&!r.ignoreMalformedPackets,o=Hi(e.tag);if(n||s||a||o||!(t instanceof Wi||t instanceof qi||t instanceof Vi))i?u=t:await c.abort(t);else{const t=new Xi(e.tag,e.packet);await c.write(t)}Bn.printDebugError(t)}}),l&&(a=null),u)throw await o.readToEnd(),u;const h=await o.peekBytes(2);if(!h||!h.length){try{n?.recordEnd()}catch(e){if(r.enforceGrammar)throw e;Bn.printDebugError(e)}return await c.ready,void await c.close()}}}catch(e){await c.abort(e)}});const a=Un(this.stream);for(;;){const{done:e,value:t}=await a.read();if(e?this.stream=null:this.push(t),e||Hi(t.constructor.tag))break}a.releaseLock()}write(){const e=[];for(let t=0;t<this.length;t++){const r=this[t]instanceof Xi?this[t].tag:this[t].constructor.tag,n=this[t].write();if(Bn.isStream(n)&&Hi(this[t].constructor.tag)){let t=[],i=0;const s=512;e.push(ji(r)),e.push(mn(n,e=>{if(t.push(e),i+=e.length,i>=s){const e=Math.min(Math.log(i)/Math.LN2|0,30),r=2**e,n=Bn.concat([Mi(e)].concat(t));return t=[n.subarray(1+r)],i=t[0].length,n.subarray(0,1+r)}},()=>Bn.concat([Ri(i)].concat(t))))}else{if(Bn.isStream(n)){let t=0;e.push(mn(kn(n),e=>{t+=e.length},()=>zi(r,t)))}else e.push(zi(r,n.length));e.push(n)}}return Bn.concat(e)}filterByTag(...e){const t=new qc,r=e=>t=>e===t;for(let n=0;n<this.length;n++)e.some(r(this[n].constructor.tag))&&t.push(this[n]);return t}findPacket(e){return this.find(t=>t.constructor.tag===e)}indexOfTag(...e){const t=[],r=this,n=e=>t=>e===t;for(let i=0;i<this.length;i++)e.some(n(r[i].constructor.tag))&&t.push(i);return t}}class Wc extends Error{constructor(...e){super(...e),Error.captureStackTrace&&Error.captureStackTrace(this,Wc),this.name="GrammarError"}}var Vc,Xc;(Xc=Vc||(Vc={}))[Xc.EmptyMessage=0]="EmptyMessage",Xc[Xc.PlaintextOrEncryptedData=1]="PlaintextOrEncryptedData",Xc[Xc.EncryptedSessionKeys=2]="EncryptedSessionKeys",Xc[Xc.StandaloneAdditionalAllowedData=3]="StandaloneAdditionalAllowedData";class Qc{constructor(){this.state=Vc.EmptyMessage,this.leadingOnePassSignatureCounter=0}recordPacket(e,t){switch(this.state){case Vc.EmptyMessage:case Vc.StandaloneAdditionalAllowedData:switch(e){case Cn.packet.literalData:case Cn.packet.compressedData:case Cn.packet.aeadEncryptedData:case Cn.packet.symEncryptedIntegrityProtectedData:case Cn.packet.symmetricallyEncryptedData:return void(this.state=Vc.PlaintextOrEncryptedData);case Cn.packet.signature:if(this.state===Vc.StandaloneAdditionalAllowedData&&--this.leadingOnePassSignatureCounter<0)throw new Wc("Trailing signature packet without OPS");return;case Cn.packet.onePassSignature:if(this.state===Vc.StandaloneAdditionalAllowedData)throw new Wc("OPS following StandaloneAdditionalAllowedData");return void this.leadingOnePassSignatureCounter++;case Cn.packet.publicKeyEncryptedSessionKey:case Cn.packet.symEncryptedSessionKey:return void(this.state=Vc.EncryptedSessionKeys);default:if(!t?.[e])throw new Wc(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Vc.StandaloneAdditionalAllowedData)}case Vc.PlaintextOrEncryptedData:if(e===Cn.packet.signature){if(--this.leadingOnePassSignatureCounter<0)throw new Wc("Trailing signature packet without OPS");return void(this.state=Vc.PlaintextOrEncryptedData)}if(!t?.[e])throw new Wc(`Unexpected packet ${e} in state ${this.state}`);return void(this.state=Vc.PlaintextOrEncryptedData);case Vc.EncryptedSessionKeys:switch(e){case Cn.packet.publicKeyEncryptedSessionKey:case Cn.packet.symEncryptedSessionKey:return void(this.state=Vc.EncryptedSessionKeys);case Cn.packet.symEncryptedIntegrityProtectedData:case Cn.packet.aeadEncryptedData:case Cn.packet.symmetricallyEncryptedData:return void(this.state=Vc.PlaintextOrEncryptedData);case Cn.packet.signature:if(--this.leadingOnePassSignatureCounter<0)throw new Wc("Trailing signature packet without OPS");return void(this.state=Vc.PlaintextOrEncryptedData);default:if(!t?.[e])throw new Wc(`Unexpected packet ${e} in state ${this.state}`);this.state=Vc.EncryptedSessionKeys}}}recordEnd(){switch(this.state){case Vc.EmptyMessage:case Vc.PlaintextOrEncryptedData:case Vc.EncryptedSessionKeys:case Vc.StandaloneAdditionalAllowedData:if(this.leadingOnePassSignatureCounter>0)throw new Wc("Missing trailing signature packets")}}}const Yc=Bn.constructAllowedPackets([Nc,Hc,Mc]);class Zc{static get tag(){return Cn.packet.compressedData}constructor(e=In){this.packets=null,this.algorithm=e.preferredCompressionAlgorithm,this.compressed=null}async read(e,t=In){await vn(e,async e=>{this.algorithm=await e.readByte(),this.compressed=e.remainder(),await this.decompress(t)})}write(){return null===this.compressed&&this.compress(),Bn.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(e=In){const t=Cn.read(Cn.compression,this.algorithm),r=nu[t];if(!r)throw Error(t+" decompression not supported");this.packets=await qc.fromBinary(await r(this.compressed),Yc,e,new Qc)}compress(){const e=Cn.read(Cn.compression,this.algorithm),t=ru[e];if(!t)throw Error(e+" compression not supported");this.compressed=t(this.packets.write())}}function Jc(e,t){return r=>{if(!Bn.isStream(r)||nn(r))return Pn(()=>Kn(r).then(e=>new Promise((r,n)=>{const i=new t,s=[];i.ondata=(e,t)=>{s.push(e),t&&r(Bn.concatUint8Array(s))};try{i.push(e,!0)}catch(e){n(e)}})));if(e)try{const t=e();return r.pipeThrough(t)}catch(e){if("TypeError"!==e.name)throw e}const n=r.getReader(),i=new t;return new ReadableStream({async start(e){for(i.ondata=async(t,r)=>{e.enqueue(t),r&&e.close()};;){const{done:e,value:t}=await n.read();if(e)return void i.push(new Uint8Array,!0);t.length&&i.push(t)}}})}}function eu(){return async function(e){const{decode:t}=await i.e(834).then(i.bind(i,834)).then(function(e){return e.i});return Pn(async()=>t(await Kn(e)))}}const tu=e=>({compressor:"undefined"!=typeof CompressionStream&&(()=>new CompressionStream(e)),decompressor:"undefined"!=typeof DecompressionStream&&(()=>new DecompressionStream(e))}),ru={zip:Jc(tu("deflate-raw").compressor,Cc),zlib:Jc(tu("deflate").compressor,Tc)},nu={uncompressed:e=>e,zip:Jc(tu("deflate-raw").decompressor,Ic),zlib:Jc(tu("deflate").decompressor,Bc),bzip2:eu()},iu=Bn.constructAllowedPackets([Nc,Zc,Hc,Mc]);class su{static get tag(){return Cn.packet.symEncryptedIntegrityProtectedData}static fromObject({version:e,aeadAlgorithm:t}){if(1!==e&&2!==e)throw Error("Unsupported SEIPD version");const r=new su;return r.version=e,2===e&&(r.aeadAlgorithm=t),r}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(e){await vn(e,async e=>{if(this.version=await e.readByte(),1!==this.version&&2!==this.version)throw new qi(`Version ${this.version} of the SEIP packet is unsupported.`);2===this.version&&(this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte(),this.salt=await e.readBytes(32)),this.encrypted=e.remainder()})}write(){return 2===this.version?Bn.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):Bn.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(e,t,r=In){const{blockSize:n,keySize:i}=ca(e);if(t.length!==i)throw Error("Unexpected session key size");let s=this.packets.write();if(nn(s)&&(s=await Kn(s)),2===this.version)this.cipherAlgorithm=e,this.salt=oi(32),this.chunkSizeByte=r.aeadChunkSizeByte,this.encrypted=await au(this,"encrypt",t,s);else{const r=await Ja(e),i=new Uint8Array([211,20]),a=Bn.concat([r,s,i]),o=await Si(Cn.hash.sha1,An(a)),c=Bn.concat([a,o]);this.encrypted=await eo(e,t,c,new Uint8Array(n))}return!0}async decrypt(e,t,r=In){if(t.length!==ca(e).keySize)throw Error("Unexpected session key size");let n,i=kn(this.encrypted);nn(i)&&(i=await Kn(i));let s=!1;if(2===this.version){if(this.cipherAlgorithm!==e)throw Error("Unexpected session key algorithm");n=await au(this,"decrypt",t,i)}else{const{blockSize:a}=ca(e),o=await to(e,t,i,new Uint8Array(a)),c=En(An(o),-20),u=En(o,0,-20),l=Promise.all([Kn(await Si(Cn.hash.sha1,An(u))),Kn(c)]).then(([e,t])=>{if(!Bn.equalsUint8Array(e,t))throw Error("Modification detected.");return new Uint8Array}),h=En(u,a+2);n=En(h,0,-2),n=fn([n,Pn(()=>l)]),Bn.isStream(i)&&r.allowUnauthenticatedStream?s=!0:n=await Kn(n)}return this.packets=await qc.fromBinary(n,iu,r,new Qc,s),!0}}async function au(e,t,r,n){const i=e instanceof su&&2===e.version,s=!i&&e.constructor.tag===Cn.packet.aeadEncryptedData;if(!i&&!s)throw Error("Unexpected packet type");const a=To(e.aeadAlgorithm,s),o="decrypt"===t?a.tagLength:0,c="encrypt"===t?a.tagLength:0,u=2**(e.chunkSizeByte+6)+o,l=s?8:0,h=new ArrayBuffer(13+l),y=new Uint8Array(h,0,5+l),p=new Uint8Array(h),f=new DataView(h),d=new Uint8Array(h,5,8);y.set([192|e.constructor.tag,e.version,e.cipherAlgorithm,e.aeadAlgorithm,e.chunkSizeByte],0);let g,w,m=0,b=Promise.resolve(),v=0,k=0;if(i){const{keySize:t}=ca(e.cipherAlgorithm),{ivLength:n}=a,i=new Uint8Array(h,0,5),s=await ya(Cn.hash.sha256,r,e.salt,i,t+n);r=s.subarray(0,t),g=s.subarray(t),g.fill(0,g.length-8),w=new DataView(g.buffer,g.byteOffset,g.byteLength)}else g=e.iv;const A=await a(e.cipherAlgorithm,r);return bn(n,async(r,n)=>{if("array"!==Bn.isStream(r)){const t=new TransformStream({},{highWaterMark:Bn.getHardwareConcurrency()*2**(e.chunkSizeByte+6),size:e=>e.length});dn(t.readable,n),n=t.writable}const s=Un(r),a=xn(n);try{for(;;){let e=await s.readBytes(u+o)||new Uint8Array;const r=e.subarray(e.length-o);let n,h,S;if(e=e.subarray(0,e.length-o),i)S=g;else{S=g.slice();for(let e=0;e<8;e++)S[g.length-8+e]^=d[e]}if(!m||e.length?(s.unshift(r),n=A[t](e,S,y),n.catch(()=>{}),k+=e.length-o+c):(f.setInt32(5+l+4,v),n=A[t](r,S,p),n.catch(()=>{}),k+=c,h=!0),v+=e.length-o,b=b.then(()=>n).then(async e=>{await a.ready,await a.write(e),k-=e.length}).catch(e=>a.abort(e)),(h||k>a.desiredSize)&&await b,h){await a.close();break}i?w.setInt32(g.length-4,++m):f.setInt32(9,++m)}}catch(e){await a.ready.catch(()=>{}),await a.abort(e)}})}const ou=Bn.constructAllowedPackets([Nc,Zc,Hc,Mc]);class cu{static get tag(){return Cn.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new Lc,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:e,encryptionKeyPacket:t,anonymousRecipient:r,sessionKey:n,sessionKeyAlgorithm:i}){const s=new cu;if(3!==e&&6!==e)throw Error("Unsupported PKESK version");return s.version=e,6===e&&(s.publicKeyVersion=r?null:t.version,s.publicKeyFingerprint=r?null:t.getFingerprintBytes()),s.publicKeyID=r?Lc.wildcard():t.getKeyID(),s.publicKeyAlgorithm=t.algorithm,s.sessionKey=n,s.sessionKeyAlgorithm=i,s}read(e){let t=0;if(this.version=e[t++],3!==this.version&&6!==this.version)throw new qi(`Version ${this.version} of the PKESK packet is unsupported.`);if(6===this.version){const r=e[t++];if(r){this.publicKeyVersion=e[t++];const n=r-1;this.publicKeyFingerprint=e.subarray(t,t+n),t+=n,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=Lc.wildcard()}else t+=this.publicKeyID.read(e.subarray(t,t+8));if(this.publicKeyAlgorithm=e[t++],this.encrypted=function(e,t){let r=0;switch(e){case Cn.publicKey.rsaEncrypt:case Cn.publicKey.rsaEncryptSign:return{c:Bn.readMPI(t.subarray(r))};case Cn.publicKey.elgamal:{const e=Bn.readMPI(t.subarray(r));return r+=e.length+2,{c1:e,c2:Bn.readMPI(t.subarray(r))}}case Cn.publicKey.ecdh:{const e=Bn.readMPI(t.subarray(r));r+=e.length+2;const n=new Ma;return n.read(t.subarray(r)),{V:e,C:n}}case Cn.publicKey.x25519:case Cn.publicKey.x448:{const n=Va(e),i=Bn.readExactSubarray(t,r,r+n);r+=i.length;const s=new za;return s.read(t.subarray(r)),{ephemeralPublicKey:i,C:s}}default:throw new qi("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,e.subarray(t)),this.publicKeyAlgorithm===Cn.publicKey.x25519||this.publicKeyAlgorithm===Cn.publicKey.x448)if(3===this.version)this.sessionKeyAlgorithm=Cn.write(Cn.symmetric,this.encrypted.C.algorithm);else if(null!==this.encrypted.C.algorithm)throw Error("Unexpected cleartext symmetric algorithm")}write(){const e=[new Uint8Array([this.version])];return 6===this.version?null!==this.publicKeyFingerprint?(e.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),e.push(this.publicKeyFingerprint)):e.push(new Uint8Array([0])):e.push(this.publicKeyID.write()),e.push(new Uint8Array([this.publicKeyAlgorithm]),Ga(this.publicKeyAlgorithm,this.encrypted)),Bn.concatUint8Array(e)}async encrypt(e){const t=Cn.write(Cn.publicKey,this.publicKeyAlgorithm),r=3===this.version?this.sessionKeyAlgorithm:null,n=5===e.version?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),i=uu(this.version,t,r,this.sessionKey);this.encrypted=await async function(e,t,r,n,i){switch(e){case Cn.publicKey.rsaEncrypt:case Cn.publicKey.rsaEncryptSign:{const{n:e,e:t}=r;return{c:await Ti(n,e,t)}}case Cn.publicKey.elgamal:{const{p:e,g:t,y:i}=r;return async function(e,t,r,n){t=Jn(t),r=Jn(r),n=Jn(n);const i=Jn(_i(e,ii(t))),s=ci(Ni,t-Ni);return{c1:si(ti(r,s,t)),c2:si(ei(ti(n,s,t)*i,t))}}(n,e,t,i)}case Cn.publicKey.ecdh:{const{oid:e,Q:t,kdfParams:s}=r,{publicKey:a,wrappedKey:o}=await async function(e,t,r,n,i){const s=function(e){const t=8-e.length%8,r=new Uint8Array(e.length+t).fill(t);return r.set(e),r}(r),a=new Ka(e);_a(a,n);const{publicKey:o,sharedKey:c}=await async function(e,t){switch(e.type){case"curve25519Legacy":{const{sharedSecret:r,ephemeralPublicKey:n}=await da(Cn.publicKey.x25519,t.subarray(1));return{publicKey:Bn.concatUint8Array([new Uint8Array([e.wireFormatLeadingByte]),n]),sharedKey:r}}case"web":if(e.web&&Bn.getWebCrypto())try{return await async function(e,t){const r=Bn.getWebCrypto(),n=xa(e.payloadSize,e.web,t);let i=r.generateKey({name:"ECDH",namedCurve:e.web},!0,["deriveKey","deriveBits"]),s=r.importKey("jwk",n,{name:"ECDH",namedCurve:e.web},!1,[]);[i,s]=await Promise.all([i,s]);let a=r.deriveBits({name:"ECDH",namedCurve:e.web,public:s},i.privateKey,e.sharedSize),o=r.exportKey("jwk",i.publicKey);[a,o]=await Promise.all([a,o]);const c=new Uint8Array(a);return{publicKey:new Uint8Array(Ua(o,e.wireFormatLeadingByte)),sharedKey:c}}(e,t)}catch(r){return Bn.printDebugError(r),Fa(e,t)}break;case"node":return async function(e,t){const r=Bn.getNodeCrypto().createECDH(e.node);r.generateKeys();const n=new Uint8Array(r.computeSecret(t));return{publicKey:new Uint8Array(r.getPublicKey()),sharedKey:n}}(e,t);default:return Fa(e,t)}}(a,n),u=$a(Cn.publicKey.ecdh,e,t,i),{keySize:l}=ca(t.cipher),h=await Na(t.hash,c,l,u);return{publicKey:o,wrappedKey:await la(t.cipher,h,s)}}(e,s,n,t,i);return{V:a,C:new Ma(o)}}case Cn.publicKey.x25519:case Cn.publicKey.x448:{if(t&&!Bn.isAES(t))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:i}=r,{ephemeralPublicKey:s,wrappedKey:a}=await async function(e,t,r){const{ephemeralPublicKey:n,sharedSecret:i}=await da(e,r),s=Bn.concatUint8Array([n,r,i]);switch(e){case Cn.publicKey.x25519:{const e=Cn.symmetric.aes128,{keySize:r}=ca(e),i=await ya(Cn.hash.sha256,s,new Uint8Array,pa.x25519,r);return{ephemeralPublicKey:n,wrappedKey:await la(e,i,t)}}case Cn.publicKey.x448:{const e=Cn.symmetric.aes256,{keySize:r}=ca(Cn.symmetric.aes256),i=await ya(Cn.hash.sha512,s,new Uint8Array,pa.x448,r);return{ephemeralPublicKey:n,wrappedKey:await la(e,i,t)}}default:throw Error("Unsupported ECDH algorithm")}}(e,n,i);return{ephemeralPublicKey:s,C:za.fromObject({algorithm:t,wrappedKey:a})}}default:return[]}}(t,r,e.publicParams,i,n)}async decrypt(e,t){if(this.publicKeyAlgorithm!==e.algorithm)throw Error("Decryption error");const r=t?uu(this.version,this.publicKeyAlgorithm,t.sessionKeyAlgorithm,t.sessionKey):null,n=5===e.version?e.getFingerprintBytes().subarray(0,20):e.getFingerprintBytes(),i=await Ha(this.publicKeyAlgorithm,e.publicParams,e.privateParams,this.encrypted,n,r),{sessionKey:s,sessionKeyAlgorithm:a}=function(e,t,r,n){switch(t){case Cn.publicKey.rsaEncrypt:case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.elgamal:case Cn.publicKey.ecdh:{const t=r.subarray(0,r.length-2),i=r.subarray(r.length-2),s=Bn.writeChecksum(t.subarray(t.length%8)),a=s[0]===i[0]&s[1]===i[1],o=6===e?{sessionKeyAlgorithm:null,sessionKey:t}:{sessionKeyAlgorithm:t[0],sessionKey:t.subarray(1)};if(n){const t=a&o.sessionKeyAlgorithm===n.sessionKeyAlgorithm&o.sessionKey.length===n.sessionKey.length;return{sessionKey:Bn.selectUint8Array(t,o.sessionKey,n.sessionKey),sessionKeyAlgorithm:6===e?null:Bn.selectUint8(t,o.sessionKeyAlgorithm,n.sessionKeyAlgorithm)}}if(a&&(6===e||Cn.read(Cn.symmetric,o.sessionKeyAlgorithm)))return o;throw Error("Decryption error")}case Cn.publicKey.x25519:case Cn.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:r};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,i,t);if(3===this.version){const e=this.publicKeyAlgorithm!==Cn.publicKey.x25519&&this.publicKeyAlgorithm!==Cn.publicKey.x448;if(this.sessionKeyAlgorithm=e?a:this.sessionKeyAlgorithm,s.length!==ca(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=s}}function uu(e,t,r,n){switch(t){case Cn.publicKey.rsaEncrypt:case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.elgamal:case Cn.publicKey.ecdh:return Bn.concatUint8Array([new Uint8Array(6===e?[]:[r]),n,Bn.writeChecksum(n.subarray(n.length%8))]);case Cn.publicKey.x25519:case Cn.publicKey.x448:return n;default:throw Error("Unsupported public key algorithm")}}class lu{static get tag(){return Cn.packet.symEncryptedSessionKey}constructor(e=In){this.version=e.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=Cn.write(Cn.aead,e.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(e){let t=0;if(this.version=e[t++],4!==this.version&&5!==this.version&&6!==this.version)throw new qi(`Version ${this.version} of the SKESK packet is unsupported.`);6===this.version&&t++;const r=e[t++];this.version>=5&&(this.aeadAlgorithm=e[t++],6===this.version&&t++);const n=e[t++];if(this.s2k=Mo(n),t+=this.s2k.read(e.subarray(t,e.length)),this.version>=5){const r=To(this.aeadAlgorithm,!0);this.iv=e.subarray(t,t+=r.ivLength)}this.version>=5||t<e.length?(this.encrypted=e.subarray(t,e.length),this.sessionKeyEncryptionAlgorithm=r):this.sessionKeyAlgorithm=r}write(){const e=null===this.encrypted?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let t;const r=this.s2k.write();if(6===this.version){const n=r.length,i=3+n+this.iv.length;t=Bn.concatUint8Array([new Uint8Array([this.version,i,e,this.aeadAlgorithm,n]),r,this.iv,this.encrypted])}else 5===this.version?t=Bn.concatUint8Array([new Uint8Array([this.version,e,this.aeadAlgorithm]),r,this.iv,this.encrypted]):(t=Bn.concatUint8Array([new Uint8Array([this.version,e]),r]),null!==this.encrypted&&(t=Bn.concatUint8Array([t,this.encrypted])));return t}async decrypt(e){const t=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:r,keySize:n}=ca(t),i=await this.s2k.produceKey(e,n);if(this.version>=5){const e=To(this.aeadAlgorithm,!0),r=new Uint8Array([192|lu.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),s=6===this.version?await ya(Cn.hash.sha256,i,new Uint8Array,r,n):i,a=await e(t,s);this.sessionKey=await a.decrypt(this.encrypted,this.iv,r)}else if(null!==this.encrypted){const e=await to(t,i,this.encrypted,new Uint8Array(r));if(this.sessionKeyAlgorithm=Cn.write(Cn.symmetric,e[0]),this.sessionKey=e.subarray(1,e.length),this.sessionKey.length!==ca(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=i}async encrypt(e,t=In){const r=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=r,this.s2k=function(e){const{s2kType:t}=e;if(!Ro.has(t))throw Error("The provided `config.s2kType` value is not allowed");return Mo(t,e)}(t),this.s2k.generateSalt();const{blockSize:n,keySize:i}=ca(r),s=await this.s2k.produceKey(e,i);if(null===this.sessionKey&&(this.sessionKey=qa(this.sessionKeyAlgorithm)),this.version>=5){const e=To(this.aeadAlgorithm);this.iv=oi(e.ivLength);const t=new Uint8Array([192|lu.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),n=6===this.version?await ya(Cn.hash.sha256,s,new Uint8Array,t,i):s,a=await e(r,n);this.encrypted=await a.encrypt(this.sessionKey,this.iv,t)}else{const e=Bn.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await eo(r,s,e,new Uint8Array(n))}}}class hu{static get tag(){return Cn.packet.publicKey}constructor(e=new Date,t=In){this.version=t.v6Keys?6:4,this.created=Bn.normalizeDate(e),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(e){const t=new hu,{version:r,created:n,algorithm:i,publicParams:s,keyID:a,fingerprint:o}=e;return t.version=r,t.created=n,t.algorithm=i,t.publicParams=s,t.keyID=a,t.fingerprint=o,t}async read(e,t=In){let r=0;if(this.version=e[r++],5===this.version&&!t.enableParsingV5Entities)throw new qi("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4===this.version||5===this.version||6===this.version){this.created=Bn.readDate(e.subarray(r,r+4)),r+=4,this.algorithm=e[r++],this.version>=5&&(r+=4);const{read:t,publicParams:n}=function(e,t){let r=0;switch(e){case Cn.publicKey.rsaEncrypt:case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.rsaSign:{const e=Bn.readMPI(t.subarray(r));r+=e.length+2;const n=Bn.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{n:e,e:n}}}case Cn.publicKey.dsa:{const e=Bn.readMPI(t.subarray(r));r+=e.length+2;const n=Bn.readMPI(t.subarray(r));r+=n.length+2;const i=Bn.readMPI(t.subarray(r));r+=i.length+2;const s=Bn.readMPI(t.subarray(r));return r+=s.length+2,{read:r,publicParams:{p:e,q:n,g:i,y:s}}}case Cn.publicKey.elgamal:{const e=Bn.readMPI(t.subarray(r));r+=e.length+2;const n=Bn.readMPI(t.subarray(r));r+=n.length+2;const i=Bn.readMPI(t.subarray(r));return r+=i.length+2,{read:r,publicParams:{p:e,g:n,y:i}}}case Cn.publicKey.ecdsa:{const e=new Fi;r+=e.read(t),Wa(e);const n=Bn.readMPI(t.subarray(r));return r+=n.length+2,{read:r,publicParams:{oid:e,Q:n}}}case Cn.publicKey.eddsaLegacy:{const e=new Fi;if(r+=e.read(t),Wa(e),e.getName()!==Cn.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let n=Bn.readMPI(t.subarray(r));return r+=n.length+2,n=Bn.leftPad(n,33),{read:r,publicParams:{oid:e,Q:n}}}case Cn.publicKey.ecdh:{const e=new Fi;r+=e.read(t),Wa(e);const n=Bn.readMPI(t.subarray(r));r+=n.length+2;const i=new ja;return r+=i.read(t.subarray(r)),{read:r,publicParams:{oid:e,Q:n,kdfParams:i}}}case Cn.publicKey.ed25519:case Cn.publicKey.ed448:case Cn.publicKey.x25519:case Cn.publicKey.x448:{const n=Bn.readExactSubarray(t,r,r+Va(e));return r+=n.length,{read:r,publicParams:{A:n}}}default:throw new qi("Unknown public key encryption algorithm.")}}(this.algorithm,e.subarray(r));if(6===this.version&&n.oid&&(n.oid.getName()===Cn.curve.curve25519Legacy||n.oid.getName()===Cn.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=n,r+=t,await this.computeFingerprintAndKeyID(),r}throw new qi(`Version ${this.version} of the key packet is unsupported.`)}write(){const e=[];e.push(new Uint8Array([this.version])),e.push(Bn.writeDate(this.created)),e.push(new Uint8Array([this.algorithm]));const t=Ga(this.algorithm,this.publicParams);return this.version>=5&&e.push(Bn.writeNumber(t.length,4)),e.push(t),Bn.concatUint8Array(e)}writeForHash(e){const t=this.writePublicKey(),r=149+e,n=e>=5?4:2;return Bn.concatUint8Array([new Uint8Array([r]),Bn.writeNumber(t.length,n),t])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Lc,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(4!==this.version)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const e=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await Si(Cn.hash.sha256,e);else{if(4!==this.version)throw Error("Unsupported key version");this.fingerprint=await Si(Cn.hash.sha1,e)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return Bn.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(e){return this.version===e.version&&Bn.equalsUint8Array(this.writePublicKey(),e.writePublicKey())}getAlgorithmInfo(){const e={};e.algorithm=Cn.read(Cn.publicKey,this.algorithm);const t=this.publicParams.n||this.publicParams.p;return t?e.bits=Bn.uint8ArrayBitLength(t):this.publicParams.oid&&(e.curve=this.publicParams.oid.getName()),e}}hu.prototype.readPublicKey=hu.prototype.read,hu.prototype.writePublicKey=hu.prototype.write;const yu=Bn.constructAllowedPackets([Nc,Zc,Hc,Mc]);class pu{constructor(e){this.packets=e||new qc}write(){return this.packets.write()}armor(e=In){const t=this.packets.some(e=>e.constructor.tag===Mc.tag&&6!==e.version);return Qn(Cn.armor.signature,this.write(),void 0,void 0,void 0,t,e)}getSigningKeyIDs(){return this.packets.map(e=>e.issuerKeyID)}}async function fu(e,t,r,n,i=new Date,s){let a,o;for(let c=e.length-1;c>=0;c--)try{(!a||e[c].created>=a.created)&&(await e[c].verify(t,r,n,i,void 0,s),a=e[c])}catch(e){o=e}if(!a)throw Bn.wrapError(`Could not find valid ${Cn.read(Cn.signature,r)} signature in key ${t.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(e,t,r)=>t+" "+r.toLowerCase()),o);return a}function du(e,t,r=new Date){const n=Bn.normalizeDate(r);if(null!==n){const r=bu(e,t);return!(e.created<=n&&n<r)}return!1}async function gu(e,t,r,n,i,s,a=[],o=!1,c){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const u=new Mc;return Object.assign(u,n),u.publicKeyAlgorithm=r.algorithm,u.hashAlgorithm=await async function(e,t,r=new Date,n=[],i){const s=Cn.hash.sha256,a=i.preferredHashAlgorithm,o=await Promise.all(e.map(async(e,t)=>(await e.getPrimarySelfSignature(r,n[t],i)).preferredHashAlgorithms||[])),c=new Map;for(const e of o)for(const t of e)try{const e=Cn.write(Cn.hash,t);c.set(e,c.has(e)?c.get(e)+1:1)}catch{}const u=t=>0===e.length||c.get(t)===e.length||t===s,l=()=>{if(0===c.size)return s;const e=Array.from(c.keys()).filter(e=>u(e)).sort((e,t)=>Ei(e)-Ei(t))[0];return Ei(e)>=Ei(s)?e:s};if(new Set([Cn.publicKey.ecdsa,Cn.publicKey.eddsaLegacy,Cn.publicKey.ed25519,Cn.publicKey.ed448]).has(t.algorithm)){const e=function(e,t){switch(e){case Cn.publicKey.ecdsa:case Cn.publicKey.eddsaLegacy:return function(e){return Ea[e.getName()].hash}(t);case Cn.publicKey.ed25519:case Cn.publicKey.ed448:return Ji(e);default:throw Error("Unknown elliptic signing algo")}}(t.algorithm,t.publicParams.oid),r=u(a),n=Ei(a)>=Ei(e);if(r&&n)return a;{const t=l();return Ei(t)>=Ei(e)?t:e}}return u(a)?a:l()}(t,r,i,s,c),u.rawNotations=[...a],await u.sign(r,e,i,o,c),u}async function wu(e,t,r,n=new Date,i){(e=e[r])&&(t[r].length?await Promise.all(e.map(async function(e){e.isExpired(n)||i&&!await i(e)||t[r].some(function(t){return Bn.equalsUint8Array(t.writeParams(),e.writeParams())})||t[r].push(e)})):t[r]=e)}async function mu(e,t,r,n,i,s,a=new Date,o){s=s||e;const c=[];return await Promise.all(n.map(async function(e){try{if(!i||e.issuerKeyID.equals(i.issuerKeyID)){const n=![Cn.reasonForRevocation.keyRetired,Cn.reasonForRevocation.keySuperseded,Cn.reasonForRevocation.userIDInvalid].includes(e.reasonForRevocationFlag);await e.verify(s,t,r,n?null:a,!1,o),c.push(e.issuerKeyID)}}catch(e){}})),i?(i.revoked=!!c.some(e=>e.equals(i.issuerKeyID))||i.revoked||!1,i.revoked):c.length>0}function bu(e,t){let r;return!1===t.keyNeverExpires&&(r=e.created.getTime()+1e3*t.keyExpirationTime),r?new Date(r):1/0}function vu(e,t,r){switch(e.algorithm){case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.rsaSign:case Cn.publicKey.dsa:case Cn.publicKey.ecdsa:case Cn.publicKey.eddsaLegacy:case Cn.publicKey.ed25519:case Cn.publicKey.ed448:if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&Cn.keyFlags.signData);default:return!1}}function ku(e,t,r){switch(e.algorithm){case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.rsaEncrypt:case Cn.publicKey.elgamal:case Cn.publicKey.ecdh:case Cn.publicKey.x25519:case Cn.publicKey.x448:if(!t.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!t.keyFlags||!!(t.keyFlags[0]&Cn.keyFlags.encryptCommunication)||!!(t.keyFlags[0]&Cn.keyFlags.encryptStorage);default:return!1}}function Au(e,t){const r=Cn.write(Cn.publicKey,e.algorithm),n=e.getAlgorithmInfo();if(t.rejectPublicKeyAlgorithms.has(r))throw Error(n.algorithm+" keys are considered too weak.");switch(r){case Cn.publicKey.rsaEncryptSign:case Cn.publicKey.rsaSign:case Cn.publicKey.rsaEncrypt:if(n.bits<t.minRSABits)throw Error(`RSA keys shorter than ${t.minRSABits} bits are considered too weak.`);break;case Cn.publicKey.ecdsa:case Cn.publicKey.eddsaLegacy:case Cn.publicKey.ecdh:if(t.rejectCurves.has(n.curve))throw Error(`Support for ${n.algorithm} keys using curve ${n.curve} is disabled.`)}}class Su{constructor(e,t){this.userID=e.constructor.tag===Cn.packet.userID?e:null,this.userAttribute=e.constructor.tag===Cn.packet.userAttribute?e:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new qc;return e.push(this.userID||this.userAttribute),e.push(...this.revocationSignatures),e.push(...this.selfCertifications),e.push(...this.otherCertifications),e}clone(){const e=new Su(this.userID||this.userAttribute,this.mainKey);return e.selfCertifications=[...this.selfCertifications],e.otherCertifications=[...this.otherCertifications],e.revocationSignatures=[...this.revocationSignatures],e}async certify(e,t,r){const n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n},s=new Su(i.userID||i.userAttribute,this.mainKey);return s.otherCertifications=await Promise.all(e.map(async function(e){if(!e.isPrivate())throw Error("Need private key for signing");if(e.hasSameFingerprintAs(n))throw Error("The user's own key can only be used for self-certifications");const s=await e.getSigningKey(void 0,t,void 0,r);return gu(i,[e],s.keyPacket,{signatureType:Cn.signature.certGeneric,keyFlags:[Cn.keyFlags.certifyKeys|Cn.keyFlags.signData]},t,void 0,void 0,void 0,r)})),await s.update(this,t,r),s}async isRevoked(e,t,r=new Date,n=In){const i=this.mainKey.keyPacket;return mu(i,Cn.signature.certRevocation,{key:i,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,e,t,r,n)}async verifyCertificate(e,t,r=new Date,n){const i=this,s=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:s},{issuerKeyID:o}=e,c=t.filter(e=>e.getKeys(o).length>0);return 0===c.length?null:(await Promise.all(c.map(async t=>{const s=await t.getSigningKey(o,e.created,void 0,n);if(e.revoked||await i.isRevoked(e,s.keyPacket,r,n))throw Error("User certificate is revoked");try{await e.verify(s.keyPacket,Cn.signature.certGeneric,a,r,void 0,n)}catch(e){throw Bn.wrapError("User certificate is invalid",e)}})),!0)}async verifyAllCertifications(e,t=new Date,r){const n=this,i=this.selfCertifications.concat(this.otherCertifications);return Promise.all(i.map(async i=>({keyID:i.issuerKeyID,valid:await n.verifyCertificate(i,e,t,r).catch(()=>!1)})))}async verify(e=new Date,t){if(!this.selfCertifications.length)throw Error("No self-certifications found");const r=this,n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n};let s;for(let a=this.selfCertifications.length-1;a>=0;a--)try{const s=this.selfCertifications[a];if(s.revoked||await r.isRevoked(s,void 0,e,t))throw Error("Self-certification is revoked");try{await s.verify(n,Cn.signature.certGeneric,i,e,void 0,t)}catch(e){throw Bn.wrapError("Self-certification is invalid",e)}return!0}catch(e){s=e}throw s}async update(e,t,r){const n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n};await wu(e,this,"selfCertifications",t,async function(e){try{return await e.verify(n,Cn.signature.certGeneric,i,t,!1,r),!0}catch(e){return!1}}),await wu(e,this,"otherCertifications",t),await wu(e,this,"revocationSignatures",t,function(e){return mu(n,Cn.signature.certRevocation,i,[e],void 0,void 0,t,r)})}async revoke(e,{flag:t=Cn.reasonForRevocation.noReason,string:r=""}={},n=new Date,i=In){const s={userID:this.userID,userAttribute:this.userAttribute,key:e},a=new Su(s.userID||s.userAttribute,this.mainKey);return a.revocationSignatures.push(await gu(s,[],e,{signatureType:Cn.signature.certRevocation,reasonForRevocationFlag:Cn.write(Cn.reasonForRevocation,t),reasonForRevocationString:r},n,void 0,void 0,!1,i)),await a.update(this),a}}class Eu{constructor(e,t){this.keyPacket=e,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=t}toPacketList(){const e=new qc;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.bindingSignatures),e}clone(){const e=new Eu(this.keyPacket,this.mainKey);return e.bindingSignatures=[...this.bindingSignatures],e.revocationSignatures=[...this.revocationSignatures],e}async isRevoked(e,t,r=new Date,n=In){const i=this.mainKey.keyPacket;return mu(i,Cn.signature.subkeyRevocation,{key:i,bind:this.keyPacket},this.revocationSignatures,e,t,r,n)}async verify(e=new Date,t=In){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket},i=await fu(this.bindingSignatures,r,Cn.signature.subkeyBinding,n,e,t);if(i.revoked||await this.isRevoked(i,null,e,t))throw Error("Subkey is revoked");if(du(this.keyPacket,i,e))throw Error("Subkey is expired");return i}async getExpirationTime(e=new Date,t=In){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket};let i;try{i=await fu(this.bindingSignatures,r,Cn.signature.subkeyBinding,n,e,t)}catch(e){return null}const s=bu(this.keyPacket,i),a=i.getExpirationTime();return s<a?s:a}async update(e,t=new Date,r=In){const n=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(e))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===Cn.packet.publicSubkey&&e.keyPacket.constructor.tag===Cn.packet.secretSubkey&&(this.keyPacket=e.keyPacket);const i=this,s={key:n,bind:i.keyPacket};await wu(e,this,"bindingSignatures",t,async function(e){for(let t=0;t<i.bindingSignatures.length;t++)if(i.bindingSignatures[t].issuerKeyID.equals(e.issuerKeyID))return e.created>i.bindingSignatures[t].created&&(i.bindingSignatures[t]=e),!1;try{return await e.verify(n,Cn.signature.subkeyBinding,s,t,void 0,r),!0}catch(e){return!1}}),await wu(e,this,"revocationSignatures",t,function(e){return mu(n,Cn.signature.subkeyRevocation,s,[e],void 0,void 0,t,r)})}async revoke(e,{flag:t=Cn.reasonForRevocation.noReason,string:r=""}={},n=new Date,i=In){const s={key:e,bind:this.keyPacket},a=new Eu(this.keyPacket,this.mainKey);return a.revocationSignatures.push(await gu(s,[],e,{signatureType:Cn.signature.subkeyRevocation,reasonForRevocationFlag:Cn.write(Cn.reasonForRevocation,t),reasonForRevocationString:r},n,void 0,void 0,!1,i)),await a.update(this),a}hasSameFingerprintAs(e){return this.keyPacket.hasSameFingerprintAs(e.keyPacket||e)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(e=>{Eu.prototype[e]=function(){return this.keyPacket[e]()}});const Ku=Bn.constructAllowedPackets([Mc]),_u=new Set([Cn.packet.publicKey,Cn.packet.privateKey]),Pu=new Set([Cn.packet.publicKey,Cn.packet.privateKey,Cn.packet.publicSubkey,Cn.packet.privateSubkey]);class Uu{packetListToStructure(e,t=new Set){let r,n,i,s;for(const a of e){if(a instanceof Xi){Pu.has(a.tag)&&!s&&(s=_u.has(a.tag)?_u:Pu);continue}const e=a.constructor.tag;if(s){if(!s.has(e))continue;s=null}if(t.has(e))throw Error("Unexpected packet type: "+e);switch(e){case Cn.packet.publicKey:case Cn.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=a,n=this.getKeyID(),!n)throw Error("Missing Key ID");break;case Cn.packet.userID:case Cn.packet.userAttribute:r=new Su(a,this),this.users.push(r);break;case Cn.packet.publicSubkey:case Cn.packet.secretSubkey:r=null,i=new Eu(a,this),this.subkeys.push(i);break;case Cn.packet.signature:switch(a.signatureType){case Cn.signature.certGeneric:case Cn.signature.certPersona:case Cn.signature.certCasual:case Cn.signature.certPositive:if(!r){Bn.printDebug("Dropping certification signatures without preceding user packet");continue}a.issuerKeyID.equals(n)?r.selfCertifications.push(a):r.otherCertifications.push(a);break;case Cn.signature.certRevocation:r?r.revocationSignatures.push(a):this.directSignatures.push(a);break;case Cn.signature.key:this.directSignatures.push(a);break;case Cn.signature.subkeyBinding:if(!i){Bn.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}i.bindingSignatures.push(a);break;case Cn.signature.keyRevocation:this.revocationSignatures.push(a);break;case Cn.signature.subkeyRevocation:if(!i){Bn.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}i.revocationSignatures.push(a)}}}}toPacketList(){const e=new qc;return e.push(this.keyPacket),e.push(...this.revocationSignatures),e.push(...this.directSignatures),this.users.map(t=>e.push(...t.toPacketList())),this.subkeys.map(t=>e.push(...t.toPacketList())),e}clone(e=!1){const t=new this.constructor(this.toPacketList());return e&&t.getKeys().forEach(e=>{if(e.keyPacket=Object.create(Object.getPrototypeOf(e.keyPacket),Object.getOwnPropertyDescriptors(e.keyPacket)),!e.keyPacket.isDecrypted())return;const t={};Object.keys(e.keyPacket.privateParams).forEach(r=>{t[r]=new Uint8Array(e.keyPacket.privateParams[r])}),e.keyPacket.privateParams=t}),t}getSubkeys(e=null){return this.subkeys.filter(t=>!e||t.getKeyID().equals(e,!0))}getKeys(e=null){const t=[];return e&&!this.getKeyID().equals(e,!0)||t.push(this),t.concat(this.getSubkeys(e))}getKeyIDs(){return this.getKeys().map(e=>e.getKeyID())}getUserIDs(){return this.users.map(e=>e.userID?e.userID.userID:null).filter(e=>null!==e)}write(){return this.toPacketList().write()}async getSigningKey(e=null,t=new Date,r={},n=In){await this.verifyPrimaryKey(t,r,n);const i=this.keyPacket;try{Au(i,n)}catch(e){throw Bn.wrapError("Could not verify primary key",e)}const s=this.subkeys.slice().sort((e,t)=>t.keyPacket.created-e.keyPacket.created||t.keyPacket.algorithm-e.keyPacket.algorithm);let a;for(const r of s)if(!e||r.getKeyID().equals(e))try{await r.verify(t,n);const e={key:i,bind:r.keyPacket},s=await fu(r.bindingSignatures,i,Cn.signature.subkeyBinding,e,t,n);if(!vu(r.keyPacket,s,n))continue;if(!s.embeddedSignature)throw Error("Missing embedded signature");return await fu([s.embeddedSignature],r.keyPacket,Cn.signature.keyBinding,e,t,n),Au(r.keyPacket,n),r}catch(e){a=e}try{const s=await this.getPrimarySelfSignature(t,r,n);if((!e||i.getKeyID().equals(e))&&vu(i,s,n))return Au(i,n),this}catch(e){a=e}throw Bn.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),a)}async getEncryptionKey(e,t=new Date,r={},n=In){await this.verifyPrimaryKey(t,r,n);const i=this.keyPacket;try{Au(i,n)}catch(e){throw Bn.wrapError("Could not verify primary key",e)}const s=this.subkeys.slice().sort((e,t)=>t.keyPacket.created-e.keyPacket.created||t.keyPacket.algorithm-e.keyPacket.algorithm);let a;for(const r of s)if(!e||r.getKeyID().equals(e))try{await r.verify(t,n);const e={key:i,bind:r.keyPacket},s=await fu(r.bindingSignatures,i,Cn.signature.subkeyBinding,e,t,n);if(ku(r.keyPacket,s,n))return Au(r.keyPacket,n),r}catch(e){a=e}try{const s=await this.getPrimarySelfSignature(t,r,n);if((!e||i.getKeyID().equals(e))&&ku(i,s,n))return Au(i,n),this}catch(e){a=e}throw Bn.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),a)}async isRevoked(e,t,r=new Date,n=In){return mu(this.keyPacket,Cn.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,e,t,r,n)}async verifyPrimaryKey(e=new Date,t={},r=In){const n=this.keyPacket;if(await this.isRevoked(null,null,e,r))throw Error("Primary key is revoked");if(du(n,await this.getPrimarySelfSignature(e,t,r),e))throw Error("Primary key is expired");if(6!==n.version){const t=await fu(this.directSignatures,n,Cn.signature.key,{key:n},e,r).catch(()=>{});if(t&&du(n,t,e))throw Error("Primary key is expired")}}async getExpirationTime(e,t=In){let r;try{const n=await this.getPrimarySelfSignature(null,e,t),i=bu(this.keyPacket,n),s=n.getExpirationTime(),a=6!==this.keyPacket.version&&await fu(this.directSignatures,this.keyPacket,Cn.signature.key,{key:this.keyPacket},null,t).catch(()=>{});if(a){const e=bu(this.keyPacket,a);r=Math.min(i,s,e)}else r=i<s?i:s}catch(e){r=null}return Bn.normalizeDate(r)}async getPrimarySelfSignature(e=new Date,t={},r=In){const n=this.keyPacket;if(6===n.version)return fu(this.directSignatures,n,Cn.signature.key,{key:n},e,r);const{selfCertification:i}=await this.getPrimaryUser(e,t,r);return i}async getPrimaryUser(e=new Date,t={},r=In){const n=this.keyPacket,i=[];let s;for(let a=0;a<this.users.length;a++)try{const s=this.users[a];if(!s.userID)continue;if(void 0!==t.name&&s.userID.name!==t.name||void 0!==t.email&&s.userID.email!==t.email||void 0!==t.comment&&s.userID.comment!==t.comment)throw Error("Could not find user that matches that user ID");const o={userID:s.userID,key:n},c=await fu(s.selfCertifications,n,Cn.signature.certGeneric,o,e,r);i.push({index:a,user:s,selfCertification:c})}catch(e){s=e}if(!i.length)throw s||Error("Could not find primary user");await Promise.all(i.map(async function(t){return t.selfCertification.revoked||t.user.isRevoked(t.selfCertification,null,e,r)}));const a=i.sort(function(e,t){const r=e.selfCertification,n=t.selfCertification;return n.revoked-r.revoked||r.isPrimaryUserID-n.isPrimaryUserID||r.created-n.created}).pop(),{user:o,selfCertification:c}=a;if(c.revoked||await o.isRevoked(c,null,e,r))throw Error("Primary user is revoked");return a}async update(e,t=new Date,r=In){if(!this.hasSameFingerprintAs(e))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&e.isPrivate()){if(this.subkeys.length!==e.subkeys.length||!this.subkeys.every(t=>e.subkeys.some(e=>t.hasSameFingerprintAs(e))))throw Error("Cannot update public key with private key if subkeys mismatch");return e.update(this,r)}const n=this.clone();return await wu(e,n,"revocationSignatures",t,i=>mu(n.keyPacket,Cn.signature.keyRevocation,n,[i],null,e.keyPacket,t,r)),await wu(e,n,"directSignatures",t),await Promise.all(e.users.map(async e=>{const i=n.users.filter(t=>e.userID&&e.userID.equals(t.userID)||e.userAttribute&&e.userAttribute.equals(t.userAttribute));if(i.length>0)await Promise.all(i.map(n=>n.update(e,t,r)));else{const t=e.clone();t.mainKey=n,n.users.push(t)}})),await Promise.all(e.subkeys.map(async e=>{const i=n.subkeys.filter(t=>t.hasSameFingerprintAs(e));if(i.length>0)await Promise.all(i.map(n=>n.update(e,t,r)));else{const t=e.clone();t.mainKey=n,n.subkeys.push(t)}})),n}async getRevocationCertificate(e=new Date,t=In){const r={key:this.keyPacket},n=await fu(this.revocationSignatures,this.keyPacket,Cn.signature.keyRevocation,r,e,t),i=new qc;i.push(n);const s=6!==this.keyPacket.version;return Qn(Cn.armor.publicKey,i.write(),null,null,"This is a revocation certificate",s,t)}async applyRevocationCertificate(e,t=new Date,r=In){const n=await Xn(e),i=(await qc.fromBinary(n.data,Ku,r)).findPacket(Cn.packet.signature);if(!i||i.signatureType!==Cn.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!i.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await i.verify(this.keyPacket,Cn.signature.keyRevocation,{key:this.keyPacket},t,void 0,r)}catch(e){throw Bn.wrapError("Could not verify revocation signature",e)}const s=this.clone();return s.revocationSignatures.push(i),s}async signPrimaryUser(e,t,r,n=In){const{index:i,user:s}=await this.getPrimaryUser(t,r,n),a=await s.certify(e,t,n),o=this.clone();return o.users[i]=a,o}async signAllUsers(e,t=new Date,r=In){const n=this.clone();return n.users=await Promise.all(this.users.map(function(n){return n.certify(e,t,r)})),n}async verifyPrimaryUser(e,t=new Date,r,n=In){const i=this.keyPacket,{user:s}=await this.getPrimaryUser(t,r,n);return e?await s.verifyAllCertifications(e,t,n):[{keyID:i.getKeyID(),valid:await s.verify(t,n).catch(()=>!1)}]}async verifyAllUsers(e,t=new Date,r=In){const n=this.keyPacket,i=[];return await Promise.all(this.users.map(async s=>{const a=e?await s.verifyAllCertifications(e,t,r):[{keyID:n.getKeyID(),valid:await s.verify(t,r).catch(()=>!1)}];i.push(...a.map(e=>({userID:s.userID?s.userID.userID:null,userAttribute:s.userAttribute,keyID:e.keyID,valid:e.valid})))})),i}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(e=>{Uu.prototype[e]=Eu.prototype[e]});const xu=Bn.constructAllowedPackets([Nc,Zc,class{static get tag(){return Cn.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=Cn.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(e){await vn(e,async e=>{const t=await e.readByte();if(1!==t)throw new qi(`Version ${t} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await e.readByte(),this.aeadAlgorithm=await e.readByte(),this.chunkSizeByte=await e.readByte();const r=To(this.aeadAlgorithm,!0);this.iv=await e.readBytes(r.ivLength),this.encrypted=e.remainder()})}write(){return Bn.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(e,t,r=In){this.packets=await qc.fromBinary(await au(this,"decrypt",t,kn(this.encrypted)),ou,r,new Qc)}async encrypt(e,t,r=In){this.cipherAlgorithm=e;const{ivLength:n}=To(this.aeadAlgorithm,!0);this.iv=oi(n),this.chunkSizeByte=r.aeadChunkSizeByte;const i=this.packets.write();this.encrypted=await au(this,"encrypt",t,i)}},su,class{static get tag(){return Cn.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(e){this.encrypted=e}write(){return this.encrypted}async decrypt(e,t,r=In){if(!r.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:n}=ca(e),i=await Kn(kn(this.encrypted)),s=await to(e,t,i.subarray(n+2),i.subarray(2,n+2));this.packets=await qc.fromBinary(s,yu,r)}async encrypt(e,t,r=In){const n=this.packets.write(),{blockSize:i}=ca(e),s=await Ja(e),a=await eo(e,t,s,new Uint8Array(i)),o=await eo(e,t,n,a.subarray(2));this.encrypted=Bn.concat([a,o])}},cu,lu,Hc,Mc]),Du=Bn.constructAllowedPackets([lu]),Cu=Bn.constructAllowedPackets([Mc]);class Iu{constructor(e){this.packets=e||new qc}getEncryptionKeyIDs(){const e=[];return this.packets.filterByTag(Cn.packet.publicKeyEncryptedSessionKey).forEach(function(t){e.push(t.publicKeyID)}),e}getSigningKeyIDs(){const e=this.unwrapCompressed(),t=e.packets.filterByTag(Cn.packet.onePassSignature);return t.length>0?t.map(e=>e.issuerKeyID):e.packets.filterByTag(Cn.packet.signature).map(e=>e.issuerKeyID)}async decrypt(e,t,r,n=new Date,i=In){const s=this.packets.filterByTag(Cn.packet.symmetricallyEncryptedData,Cn.packet.symEncryptedIntegrityProtectedData,Cn.packet.aeadEncryptedData);if(0===s.length)throw Error("No encrypted data found");const a=s[0],o=a.cipherAlgorithm,c=r||await this.decryptSessionKeys(e,t,o,n,i);let u=null;const l=Promise.all(c.map(async({algorithm:e,data:t})=>{if(!Bn.isUint8Array(t)||!a.cipherAlgorithm&&!Bn.isString(e))throw Error("Invalid session key for decryption.");try{const r=a.cipherAlgorithm||Cn.write(Cn.symmetric,e);await a.decrypt(r,t,i)}catch(e){Bn.printDebugError(e),u=e}}));if(_n(a.encrypted),a.encrypted=null,await l,!a.packets||!a.packets.length)throw u||Error("Decryption failed.");const h=new Iu(a.packets);return a.packets=new qc,h}async decryptSessionKeys(e,t,r,n=new Date,i=In){let s,a=[];if(t){const e=this.packets.filterByTag(Cn.packet.symEncryptedSessionKey);if(0===e.length)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(t.map(async function(t,r){let n;n=r?await qc.fromBinary(e.write(),Du,i):e,await Promise.all(n.map(async function(e){try{await e.decrypt(t),a.push(e)}catch(e){Bn.printDebugError(e),e instanceof $o&&(s=e)}}))}))}else{if(!e)throw Error("No key or password specified.");{const t=this.packets.filterByTag(Cn.packet.publicKeyEncryptedSessionKey);if(0===t.length)throw Error("No public key encrypted session key packet found.");await Promise.all(t.map(async function(t){await Promise.all(e.map(async function(e){let o;try{o=(await e.getDecryptionKeys(t.publicKeyID,null,void 0,i)).map(e=>e.keyPacket)}catch(e){return void(s=e)}let c=[Cn.symmetric.aes256,Cn.symmetric.aes128,Cn.symmetric.tripledes,Cn.symmetric.cast5];try{const t=await e.getPrimarySelfSignature(n,void 0,i);t.preferredSymmetricAlgorithms&&(c=c.concat(t.preferredSymmetricAlgorithms))}catch(e){}await Promise.all(o.map(async function(e){if(!e.isDecrypted())throw Error("Decryption key is not decrypted.");if(!i.constantTimePKCS1Decryption||t.publicKeyAlgorithm!==Cn.publicKey.rsaEncrypt&&t.publicKeyAlgorithm!==Cn.publicKey.rsaEncryptSign&&t.publicKeyAlgorithm!==Cn.publicKey.rsaSign&&t.publicKeyAlgorithm!==Cn.publicKey.elgamal)try{await t.decrypt(e);const n=r||t.sessionKeyAlgorithm;if(n&&!c.includes(Cn.write(Cn.symmetric,n)))throw Error("A non-preferred symmetric algorithm was used.");a.push(t)}catch(e){Bn.printDebugError(e),s=e}else{const n=t.write();await Promise.all((r?[r]:Array.from(i.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map(async t=>{const r=new cu;r.read(n);const i={sessionKeyAlgorithm:t,sessionKey:qa(t)};try{await r.decrypt(e,i),a.push(r)}catch(e){Bn.printDebugError(e),s=e}}))}}))})),_n(t.encrypted),t.encrypted=null}))}}if(a.length>0){if(a.length>1){const e=new Set;a=a.filter(t=>{const r=t.sessionKeyAlgorithm+Bn.uint8ArrayToString(t.sessionKey);return!e.has(r)&&(e.add(r),!0)})}return a.map(e=>({data:e.sessionKey,algorithm:e.sessionKeyAlgorithm&&Cn.read(Cn.symmetric,e.sessionKeyAlgorithm)}))}throw s||Error("Session key decryption failed.")}getLiteralData(){const e=this.unwrapCompressed().packets.findPacket(Cn.packet.literalData);return e&&e.getBytes()||null}getFilename(){const e=this.unwrapCompressed().packets.findPacket(Cn.packet.literalData);return e&&e.getFilename()||null}getText(){const e=this.unwrapCompressed().packets.findPacket(Cn.packet.literalData);return e?e.getText():null}static async generateSessionKey(e=[],t=new Date,r=[],n=In){const{symmetricAlgo:i,aeadAlgo:s}=await async function(e=[],t=new Date,r=[],n=In){const i=await Promise.all(e.map((e,i)=>e.getPrimarySelfSignature(t,r[i],n)));if(e.length?i.every(e=>e.features&&e.features[0]&Cn.features.seipdv2):n.aeadProtect){const e={symmetricAlgo:Cn.symmetric.aes128,aeadAlgo:Cn.aead.ocb},t=[{symmetricAlgo:n.preferredSymmetricAlgorithm,aeadAlgo:n.preferredAEADAlgorithm},{symmetricAlgo:n.preferredSymmetricAlgorithm,aeadAlgo:Cn.aead.ocb},{symmetricAlgo:Cn.symmetric.aes128,aeadAlgo:n.preferredAEADAlgorithm}];for(const e of t)if(i.every(t=>t.preferredCipherSuites&&t.preferredCipherSuites.some(t=>t[0]===e.symmetricAlgo&&t[1]===e.aeadAlgo)))return e;return e}const s=Cn.symmetric.aes128,a=n.preferredSymmetricAlgorithm;return{symmetricAlgo:i.every(e=>e.preferredSymmetricAlgorithms&&e.preferredSymmetricAlgorithms.includes(a))?a:s,aeadAlgo:void 0}}(e,t,r,n),a=Cn.read(Cn.symmetric,i),o=s?Cn.read(Cn.aead,s):void 0;return await Promise.all(e.map(e=>e.getEncryptionKey().catch(()=>null).then(e=>{if(e&&(e.keyPacket.algorithm===Cn.publicKey.x25519||e.keyPacket.algorithm===Cn.publicKey.x448)&&!o&&!Bn.isAES(i))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:qa(i),algorithm:a,aeadAlgorithm:o}}async encrypt(e,t,r,n=!1,i=[],s=new Date,a=[],o=In){if(r){if(!Bn.isUint8Array(r.data)||!Bn.isString(r.algorithm))throw Error("Invalid session key for encryption.")}else if(e&&e.length)r=await Iu.generateSessionKey(e,s,a,o);else{if(!t||!t.length)throw Error("No keys, passwords, or session key provided.");r=await Iu.generateSessionKey(void 0,void 0,void 0,o)}const{data:c,algorithm:u,aeadAlgorithm:l}=r,h=await Iu.encryptSessionKey(c,u,l,e,t,n,i,s,a,o),y=su.fromObject({version:l?2:1,aeadAlgorithm:l?Cn.write(Cn.aead,l):null});y.packets=this.packets;const p=Cn.write(Cn.symmetric,u);return await y.encrypt(p,c,o),h.packets.push(y),y.packets=new qc,h}static async encryptSessionKey(e,t,r,n,i,s=!1,a=[],o=new Date,c=[],u=In){const l=new qc,h=Cn.write(Cn.symmetric,t),y=r&&Cn.write(Cn.aead,r);if(n){const t=await Promise.all(n.map(async function(t,r){const n=await t.getEncryptionKey(a[r],o,c,u),i=cu.fromObject({version:y?6:3,encryptionKeyPacket:n.keyPacket,anonymousRecipient:s,sessionKey:e,sessionKeyAlgorithm:h});return await i.encrypt(n.keyPacket),delete i.sessionKey,i}));l.push(...t)}if(i){const t=async function(e,t){try{return await e.decrypt(t),1}catch(e){return 0}},r=(e,t)=>e+t,n=async function(e,s,a,o){const c=new lu(u);return c.sessionKey=e,c.sessionKeyAlgorithm=s,a&&(c.aeadAlgorithm=a),await c.encrypt(o,u),u.passwordCollisionCheck&&1!==(await Promise.all(i.map(e=>t(c,e)))).reduce(r)?n(e,s,o):(delete c.sessionKey,c)},s=await Promise.all(i.map(t=>n(e,h,y,t)));l.push(...s)}return new Iu(l)}async sign(e=[],t=[],r=null,n=[],i=new Date,s=[],a=[],o=[],c=In){const u=new qc,l=this.packets.findPacket(Cn.packet.literalData);if(!l)throw Error("No literal data packet to sign.");const h=await Tu(l,e,t,r,n,i,s,a,o,!1,c),y=h.map((e,t)=>Hc.fromSignaturePacket(e,0===t)).reverse();return u.push(...y),u.push(l),u.push(...h),new Iu(u)}compress(e,t=In){if(e===Cn.compression.uncompressed)return this;const r=new Zc(t);r.algorithm=e,r.packets=this.packets;const n=new qc;return n.push(r),new Iu(n)}async signDetached(e=[],t=[],r=null,n=[],i=[],s=new Date,a=[],o=[],c=In){const u=this.packets.findPacket(Cn.packet.literalData);if(!u)throw Error("No literal data packet to sign.");return new pu(await Tu(u,e,t,r,n,i,s,a,o,!0,c))}async verify(e,t=new Date,r=In){const n=this.unwrapCompressed(),i=n.packets.filterByTag(Cn.packet.literalData);if(1!==i.length)throw Error("Can only verify message with one literal data packet.");let s=n.packets;nn(s.stream)&&(s=s.concat(await Kn(s.stream,e=>e||[])));const a=s.filterByTag(Cn.packet.onePassSignature).reverse(),o=s.filterByTag(Cn.packet.signature);return a.length&&!o.length&&Bn.isStream(s.stream)&&!nn(s.stream)?(await Promise.all(a.map(async e=>{e.correspondingSig=new Promise((t,r)=>{e.correspondingSigResolve=t,e.correspondingSigReject=r}),e.signatureData=Pn(async()=>(await e.correspondingSig).signatureData),e.hashed=Kn(await e.hash(e.signatureType,i[0],void 0,!1)),e.hashed.catch(()=>{})})),s.stream=bn(s.stream,async(e,t)=>{const r=Un(e),n=xn(t);try{for(let e=0;e<a.length;e++){const{value:t}=await r.read();a[e].correspondingSigResolve(t)}await r.readToEnd(),await n.ready,await n.close()}catch(e){a.forEach(t=>{t.correspondingSigReject(e)}),await n.abort(e)}}),Bu(a,i,e,t,!1,r)):Bu(o,i,e,t,!1,r)}verifyDetached(e,t,r=new Date,n=In){const i=this.unwrapCompressed().packets.filterByTag(Cn.packet.literalData);if(1!==i.length)throw Error("Can only verify message with one literal data packet.");return Bu(e.packets.filterByTag(Cn.packet.signature),i,t,r,!0,n)}unwrapCompressed(){const e=this.packets.filterByTag(Cn.packet.compressedData);return e.length?new Iu(e[0].packets):this}async appendSignature(e,t=In){await this.packets.read(Bn.isUint8Array(e)?e:(await Xn(e)).data,Cu,t)}write(){return this.packets.write()}armor(e=In){const t=this.packets[this.packets.length-1],r=t.constructor.tag===su.tag?2!==t.version:this.packets.some(e=>e.constructor.tag===Mc.tag&&6!==e.version);return Qn(Cn.armor.message,this.write(),null,null,null,r,e)}}async function Tu(e,t,r=[],n=null,i=[],s=new Date,a=[],o=[],c=[],u=!1,l=In){const h=new qc,y=null===e.text?Cn.signature.binary:Cn.signature.text;if(await Promise.all(t.map(async(t,n)=>{const h=a[n];if(!t.isPrivate())throw Error("Need private key for signing");const p=await t.getSigningKey(i[n],s,h,l);return gu(e,r.length?r:[t],p.keyPacket,{signatureType:y},s,o,c,u,l)})).then(e=>{h.push(...e)}),n){const e=n.packets.filterByTag(Cn.packet.signature);h.push(...e)}return h}async function Bu(e,t,r,n=new Date,i=!1,s=In){return Promise.all(e.filter(function(e){return["text","binary"].includes(Cn.read(Cn.signature,e.signatureType))}).map(async function(e){return async function(e,t,r,n=new Date,i=!1,s=In){let a,o;for(const t of r){const r=t.getKeys(e.issuerKeyID);if(r.length>0){a=t,o=r[0];break}}const c=e instanceof Hc?e.correspondingSig:e,u={keyID:e.issuerKeyID,verified:(async()=>{if(!o)throw Error("Could not find signing key with key ID "+e.issuerKeyID.toHex());await e.verify(o.keyPacket,e.signatureType,t[0],n,i,s);const r=await c;if(o.getCreationTime()>r.created)throw Error("Key is newer than the signature");try{await a.getSigningKey(o.getKeyID(),r.created,void 0,s)}catch(e){if(!s.allowInsecureVerificationWithReformattedKeys||!e.message.match(/Signature creation time is in the future/))throw e;await a.getSigningKey(o.getKeyID(),n,void 0,s)}return!0})(),signature:(async()=>{const e=await c,t=new qc;return e&&t.push(e),new pu(t)})()};return u.signature.catch(()=>{}),u.verified.catch(()=>{}),u}(e,t,r,n,i,s)}))}async function $u({text:e,binary:t,filename:r,date:n=new Date,format:i=(void 0!==e?"utf8":"binary"),...s}){const a=void 0!==e?e:t;if(void 0===a)throw Error("createMessage: must pass options object containing `text` or `binary`");if(e&&!Bn.isString(e)&&!Bn.isStream(e))throw Error("createMessage: options.text must be a string or stream");if(t&&!Bn.isUint8Array(t)&&!Bn.isStream(t))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=Bn.isStream(a),u=new Nc(n);void 0!==e?u.setText(a,Cn.write(Cn.literal,i)):u.setBytes(a,Cn.write(Cn.literal,i)),void 0!==r&&u.setFilename(r);const l=new qc;l.push(u);const h=new Iu(l);return h.fromStream=c,h}async function Nu({message:e,encryptionKeys:t,signingKeys:r,passwords:n,sessionKey:i,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:u=[],date:l=new Date,signingUserIDs:h=[],encryptionUserIDs:y=[],signatureNotations:p=[],config:f,...d}){if(Ou(f={...In,...f}),Lu(e),function(e){if("armored"!==e&&"binary"!==e&&"object"!==e)throw Error("Unsupported format "+e)}(s),t=Ru(t),r=Ru(r),n=Ru(n),c=Ru(c),u=Ru(u),h=Ru(h),y=Ru(y),p=Ru(p),d.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(d.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(d.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(void 0!==d.armor)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const g=Object.keys(d);if(g.length>0)throw Error("Unknown option: "+g.join(", "));r||(r=[]);try{if((r.length||a)&&(e=await e.sign(r,t,a,c,l,h,u,p,f)),e=e.compress(await async function(e=[],t=new Date,r=[],n=In){const i=Cn.compression.uncompressed,s=n.preferredCompressionAlgorithm,a=await Promise.all(e.map(async function(e,i){const a=(await e.getPrimarySelfSignature(t,r[i],n)).preferredCompressionAlgorithms;return!!a&&a.indexOf(s)>=0}));return a.every(Boolean)?s:i}(t,l,y,f),f),e=await e.encrypt(t,n,i,o,u,l,y,f),"object"===s)return e;const d="armored"===s?e.armor(f):e.write();return await Mu(d)}catch(e){throw Bn.wrapError("Error encrypting message",e)}}function Lu(e){if(!(e instanceof Iu))throw Error("Parameter [message] needs to be of type Message")}const Fu=Object.keys(In).length;function Ou(e){const t=Object.keys(e);if(t.length!==Fu)for(const e of t)if(void 0===In[e])throw Error("Unknown config property: "+e)}function Ru(e){return e&&!Bn.isArray(e)&&(e=[e]),e}async function Mu(e){return"array"===Bn.isStream(e)?Kn(e):e}const ju="%[a-f0-9]{2}",zu=new RegExp("("+ju+")|([^%]+?)","gi"),Hu=new RegExp("("+ju+")+","gi");function Gu(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(1===e.length)return e;t=t||1;const r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],Gu(r),Gu(n))}function qu(e){try{return decodeURIComponent(e)}catch{let t=e.match(zu)||[];for(let r=1;r<t.length;r++)t=(e=Gu(t,r).join("")).match(zu)||[];return e}}function Wu(e,t){const r={};if(Array.isArray(t))for(const n of t){const t=Object.getOwnPropertyDescriptor(e,n);t?.enumerable&&Object.defineProperty(r,n,t)}else for(const n of Reflect.ownKeys(e)){const i=Object.getOwnPropertyDescriptor(e,n);i.enumerable&&t(n,e[n],e)&&Object.defineProperty(r,n,i)}return r}function Vu(e,t){if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===e||""===t)return[];const r=e.indexOf(t);return-1===r?[]:[e.slice(0,r),e.slice(r+t.length)]}const Xu=e=>null==e,Qu=e=>encodeURIComponent(e).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Yu=Symbol("encodeFragmentIdentifier");function Zu(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function Ju(e,t){return t.encode?t.strict?Qu(e):encodeURIComponent(e):e}function el(e,t){return t.decode?function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return function(e){const t={"%FE%FF":"��","%FF%FE":"��"};let r=Hu.exec(e);for(;r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{const e=qu(r[0]);e!==r[0]&&(t[r[0]]=e)}r=Hu.exec(e)}t["%C2"]="�";const n=Object.keys(t);for(const r of n)e=e.replace(new RegExp(r,"g"),t[r]);return e}(e)}}(e):e}function tl(e){return Array.isArray(e)?e.sort():"object"==typeof e?tl(Object.keys(e)).sort((e,t)=>Number(e)-Number(t)).map(t=>e[t]):e}function rl(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function nl(e,t,r){return"string"===r&&"string"==typeof e?e:"function"==typeof r&&"string"==typeof e?r(e):"boolean"===r&&null===e||("boolean"!==r||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?"boolean"!==r||null===e||"1"!==e.toLowerCase()&&"0"!==e.toLowerCase()?"string[]"===r&&"none"!==t.arrayFormat&&"string"==typeof e?[e]:"number[]"!==r||"none"===t.arrayFormat||Number.isNaN(Number(e))||"string"!=typeof e||""===e.trim()?"number"!==r||Number.isNaN(Number(e))||"string"!=typeof e||""===e.trim()?!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()?t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?Number(e):e:"true"===e.toLowerCase():Number(e):[Number(e)]:"1"===e.toLowerCase():"true"===e.toLowerCase())}function il(e){const t=(e=rl(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function sl(e,t){Zu((t={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...t}).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)]$/.exec(e),e=e.replace(/\[\d*]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[])$/.exec(e),e=e.replace(/\[]$/,""),t?void 0!==n[e]?n[e]=[...n[e],r]:n[e]=[r]:n[e]=r};case"colon-list-separator":return(e,r,n)=>{t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),t?void 0!==n[e]?n[e]=[...n[e],r]:n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const i="string"==typeof r&&r.includes(e.arrayFormatSeparator)?r.split(e.arrayFormatSeparator).map(t=>el(t,e)):null===r?r:el(r,e);n[t]=i};case"bracket-separator":return(t,r,n)=>{const i=/(\[])$/.test(t);if(t=t.replace(/\[]$/,""),!i)return void(n[t]=r?el(r,e):r);const s=null===r?[]:el(r,e).split(e.arrayFormatSeparator);void 0!==n[t]?n[t]=[...n[t],...s]:n[t]=s};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[...[r[e]].flat(),t]:r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const i of e.split("&")){if(""===i)continue;const e=t.decode?i.replaceAll("+"," "):i;let[s,a]=Vu(e,"=");void 0===s&&(s=e),a=void 0===a?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?a:el(a,t),r(el(s,t),a,n)}for(const[e,r]of Object.entries(n))if("object"==typeof r&&null!==r&&"string"!==t.types[e])for(const[n,i]of Object.entries(r)){const s=t.types[e],a="function"==typeof s?s:s?s.replace("[]",""):void 0;r[n]=nl(i,t,a)}else"object"==typeof r&&null!==r&&"string"===t.types[e]?n[e]=Object.values(r).join(t.arrayFormatSeparator):n[e]=nl(r,t,t.types[e]);return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce((e,t)=>{const r=n[t];return e[t]=Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?tl(r):r,e},Object.create(null))}function al(e,t){if(!e)return"";Zu((t={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...t}).arrayFormatSeparator);const r=r=>t.skipNull&&Xu(e[r])||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const i=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[Ju(t,e),"[",i,"]"].join("")]:[...r,[Ju(t,e),"[",Ju(i,e),"]=",Ju(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[Ju(t,e),"[]"].join("")]:[...r,[Ju(t,e),"[]=",Ju(n,e)].join("")];case"colon-list-separator":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[Ju(t,e),":list="].join("")]:[...r,[Ju(t,e),":list=",Ju(n,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(n,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?n:(i=null===i?"":i,0===n.length?[[Ju(r,e),t,Ju(i,e)].join("")]:[[n,Ju(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,Ju(t,e)]:[...r,[Ju(t,e),"=",Ju(n,e)].join("")]}}(t),i={};for(const[t,n]of Object.entries(e))r(t)||(i[t]=n);const s=Object.keys(i);return!1!==t.sort&&s.sort(t.sort),s.map(r=>{let i=e[r];if(t.replacer&&(i=t.replacer(r,i),void 0===i))return"";if(void 0===i)return"";if(null===i)return Ju(r,t);if(Array.isArray(i)){if(0===i.length&&"bracket-separator"===t.arrayFormat)return Ju(r,t)+"[]";let e=i;return t.replacer&&(e=i.map((e,n)=>t.replacer(`${r}[${n}]`,e)).filter(e=>void 0!==e)),e.reduce(n(r),[]).join("&")}return Ju(r,t)+"="+Ju(i,t)}).filter(e=>e.length>0).join("&")}function ol(e,t){t={decode:!0,...t};let[r,n]=Vu(e,"#");return void 0===r&&(r=e),{url:r?.split("?")?.[0]??"",query:sl(il(e),t),...t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:el(n,t)}:{}}}function cl(e,t){t={encode:!0,strict:!0,[Yu]:!0,...t};const r=rl(e.url).split("?")[0]||"";let n=al({...sl(il(e.url),{sort:!1,...t}),...e.query},t);n&&=`?${n}`;let i=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);if("string"==typeof e.fragmentIdentifier){const n=new URL(r);n.hash=e.fragmentIdentifier,i=t[Yu]?n.hash:`#${e.fragmentIdentifier}`}return`${r}${n}${i}`}function ul(e,t,r){r={parseFragmentIdentifier:!0,[Yu]:!1,...r};const{url:n,query:i,fragmentIdentifier:s}=ol(e,r);return cl({url:n,query:Wu(i,t),fragmentIdentifier:s},r)}function ll(e,t,r){return ul(e,Array.isArray(t)?e=>!t.includes(e):(e,r)=>!t(e,r),r)}const hl=e;var yl=(e,t)=>{try{navigator.clipboard.readText().then(e=>Xe(t,e,!0))}catch(e){Xe(t,"클립보드 읽기 실패: "+e)}},pl=(e,t,r)=>Xe(t,(0,Qr.AG)(cr(r)),!0),fl=(e,t,r)=>{try{Xe(t,(0,Qr.Ph)(cr(r)),!0)}catch(e){Xe(t,"디코딩 실패: 올바른 Base64 문자열이 아닙니다.")}},dl=br('<button type="button">인코딩</button> <button type="button">디코딩</button>',1),gl=(e,t,r,n)=>Xe(t,cr(r)?(0,Qr.L4)((0,Qr.AG)(cr(n))):(0,Qr.L4)(cr(n)),!0),wl=(e,t,r,n)=>Xe(t,cr(r)?(0,Qr.Ph)((0,Qr.vu)((0,Qr.lb)(cr(n)))):(0,Qr.vu)(cr(n)),!0),ml=br('<button type="button">인코딩</button> <button type="button">디코딩</button> <fieldset><label><input type="checkbox" role="switch"/> <span data-tooltip="문자를 Base64로 먼저 인코딩하여 ASCII 범위 외에서도 투명 상태를 유지합니다.">Base64 래핑</span></label></fieldset>',1),bl=(e,t,r)=>Xe(t,(0,Qr.u3)(cr(r)),!0),vl=(e,t,r)=>Xe(t,(0,Qr.L3)(cr(r)),!0),kl=br('<button type="button">인코딩</button> <button type="button">디코딩</button>',1),Al=(e,t)=>{try{navigator.clipboard.readText().then(e=>Xe(t,e,!0))}catch(e){Xe(t,"클립보드 읽기 실패: "+e)}},Sl=(e,t,r,n)=>Xe(t,(0,Qr.M8)(cr(r),cr(n)),!0),El=(e,t,r,n)=>{try{Xe(t,(0,Qr.wO)(cr(r),cr(n)),!0)}catch(e){Xe(t,"복호화 실패: "+e)}},Kl=br('<form role="group"><textarea class="key" placeholder="암호"></textarea> <button type="button">붙여넣기</button></form> <button type="button">암호화</button> <button type="button">복호화</button>',1),_l=(e,t)=>{try{navigator.clipboard.readText().then(e=>Xe(t,e,!0))}catch(e){Xe(t,"클립보드 읽기 실패: "+e)}},Pl=async(e,t,r,n)=>{const i=await $u({text:cr(t)});console.log(i),Xe(n,await Nu({message:i,passwords:[cr(r)]}),!0)},Ul=async(e,t,r,n)=>{const i=await $u({text:cr(t)});console.log(i);const s=await Nu({message:i,passwords:[cr(r)]});Xe(n,(0,Qr.L4)(s),!0)},xl=async(e,t,r,n)=>{try{const e=await async function({armoredMessage:e,binaryMessage:t,config:r,...n}){r={...In,...r};let i=e||t;if(!i)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(e&&!Bn.isString(e)&&!Bn.isStream(e))throw Error("readMessage: options.armoredMessage must be a string or stream");if(t&&!Bn.isUint8Array(t)&&!Bn.isStream(t))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=Bn.isStream(i);if(e){const{type:e,data:t}=await Xn(i);if(e!==Cn.armor.message)throw Error("Armored text not of type message");i=t}const o=await qc.fromBinary(i,xu,r,new Qc),c=new Iu(o);return c.fromStream=a,c}({armoredMessage:cr(t)}),{data:i}=await async function({message:e,decryptionKeys:t,passwords:r,sessionKeys:n,verificationKeys:i,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:u,...l}){if(Ou(u={...In,...u}),Lu(e),i=Ru(i),t=Ru(t),r=Ru(r),n=Ru(n),l.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(l.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const h=Object.keys(l);if(h.length>0)throw Error("Unknown option: "+h.join(", "));try{const l=await e.decrypt(t,r,n,c,u);i||(i=[]);const h={};if(h.signatures=o?await l.verifyDetached(o,i,c,u):await l.verify(i,c,u),h.data="binary"===a?l.getLiteralData():l.getText(),h.filename=l.getFilename(),function(e,t,...r){e.data=bn(t.packets.stream,async(t,n)=>{await dn(e.data,n,{preventClose:!0});const i=xn(n);try{await Kn(t,e=>e),await Promise.all(r.map(e=>Kn(e.packets.stream,e=>e))),await i.close()}catch(e){await i.abort(e)}})}(h,e,...new Set([l,l.unwrapCompressed()])),s){if(0===i.length)throw Error("Verification keys are required to verify message signatures");if(0===h.signatures.length)throw Error("Message is not signed");h.data=fn([h.data,Pn(async()=>(await Bn.anyPromise(h.signatures.map(e=>e.verified)),"binary"===a?new Uint8Array:""))])}return h.data=await Mu(h.data),h}catch(e){throw Bn.wrapError("Error decrypting message",e)}}({message:e,passwords:[cr(r)]});Xe(n,i,!0)}catch(e){Xe(n,"오류:"+e)}},Dl=br('<form role="group"><textarea class="key" placeholder="암호"></textarea> <button type="button">붙여넣기</button></form> <button type="button">암호화</button> <button type="button">투명 암호화</button> <button type="button">복호화</button>',1),Cl=br("<p> </p>"),Il=(e,t)=>navigator.clipboard.writeText(cr(t)),Tl=(e,t,r)=>Xe(t,cr(r),!0),Bl=(e,t,r)=>Xe(t,cr(t)+cr(r)),$l=(e,t)=>navigator.clipboard.writeText(cr(t)),Nl=(e,t,r)=>Xe(t,cr(r),!0),Ll=br('<main class="container"><nav><ul><li><h1><strong>WebCrypt</strong></h1></li></ul> <ul><li><a href="https://freecommunity.kro.kr">자유 커뮤니티 위키</a></li> <li><a href="https://goroawase.kro.kr">고로아와세 변환기</a></li></ul></nav> <form role="group"><textarea class="source" placeholder="처리할 텍스트를 입력해주세요."></textarea> <button type="button">붙여넣기</button></form> <select aria-label="처리 알고리즘"><option>Base64</option><option>투명 인코딩</option><option>유니코드 이스케이프</option><option>AES 암호</option><option>PGP-대칭(삭제 예정)</option></select> <!> <form role="group"><textarea class="result" name="read-only" readonly=""></textarea> <button type="button">복사</button></form> <button type="button">↑ 처리 필드로 이동</button> <button type="button">메모리에 추가 ↓</button> <form role="group"><textarea class="memory" placeholder="메모리"></textarea> <button type="button">메모리 복사</button></form> <button type="button">↑ 처리 필드로 이동</button><br/> <fieldset><label><input type="checkbox" role="switch"/> <span data-tooltip="입력 필드에 투명 인코딩이 감지되면 필드가 초록색으로 강조됩니다">투명 인코딩 자동 감지</span></label></fieldset></main>');!function(e){for(var t=0;t<e.length;t++)pr.add(e[t]);for(var r of fr)r(e)}(["click"]),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)})}),Kr(function(e,t){ae(t,!0),(0,Qr.Ay)();let r=hl.parse(location.search,{parseBooleans:!0,types:{keyText:"string",autoDetect:"boolean",B64Invisible:"boolean",encrypt:"string"}}),n=Ve(""),i=Ve(""),s=Ve(""),a=Ve(tt(r.keyText?r.keyText:"")),o=Ve(tt(!!r.autoDetect&&r.autoDetect)),c=Ve(tt(!!r.B64Invisible&&r.B64Invisible)),u=Ve(tt(r.enctype?r.enctype:"base64"));var l=Ll(),h=gt(ft(l),2),y=ft(h);mt(y),gt(y,2).__click=[yl,n],W(h);var p=gt(h,2),f=ft(p);f.value=f.__value="base64";var d=gt(f);d.value=d.__value="inv";var g=gt(d);g.value=g.__value="unicode";var w=gt(g);w.value=w.__value="aes";var m=gt(w);m.value=m.__value="pgp",W(p);var b=gt(p,2),v=e=>{var t=dl(),r=dt(t);r.__click=[pl,i,n],gt(r,2).__click=[fl,i,n],kr(e,t)},k=e=>{var t=vr(),r=dt(t),s=e=>{var t=ml(),r=dt(t);r.__click=[gl,i,c,n];var s=gt(r,2);s.__click=[wl,i,c,n];var a=gt(s,2),o=ft(a),u=ft(o);Lr(u),V(2),W(o),W(a),Hr(u,()=>cr(c),e=>Xe(c,e)),kr(e,t)},o=e=>{var t=vr(),r=dt(t),s=e=>{var t=kl(),r=dt(t);r.__click=[bl,i,n],gt(r,2).__click=[vl,i,n],kr(e,t)},o=e=>{var t=vr(),r=dt(t),s=e=>{var t=Kl(),r=dt(t),s=ft(r);mt(s),gt(s,2).__click=[Al,a],W(r);var o=gt(r,2);o.__click=[Sl,i,n,a],gt(o,2).__click=[El,i,n,a],zr(s,()=>cr(a),e=>Xe(a,e)),kr(e,t)},o=e=>{var t=vr(),r=dt(t),s=e=>{var t=Dl(),r=dt(t),s=ft(r);mt(s),gt(s,2).__click=[_l,a],W(r);var o=gt(r,2);o.__click=[Pl,n,a,i];var c=gt(o,2);c.__click=[Ul,n,a,i],gt(c,2).__click=[xl,n,a,i],zr(s,()=>cr(a),e=>Xe(a,e)),kr(e,t)},o=e=>{var t=Cl(),r=ft(t);W(t),_t(()=>{return e=r,void((n=null==(t=`방식 "$${cr(u)??""}"은 존재하지 않습니다.`)?"":"object"==typeof t?t+"":t)!==(e.__t??=e.nodeValue)&&(e.__t=n,e.nodeValue=n+""));var e,t,n}),kr(e,t)};Dr(r,e=>{"pgp"===cr(u)?e(s):e(o,!1)},!0),kr(e,t)};Dr(r,e=>{"aes"===cr(u)?e(s):e(o,!1)},!0),kr(e,t)};Dr(r,e=>{"unicode"===cr(u)?e(s):e(o,!1)},!0),kr(e,t)};Dr(r,e=>{"inv"===cr(u)?e(s):e(o,!1)},!0),kr(e,t)};Dr(b,e=>{"base64"===cr(u)?e(v):e(k,!1)});var A=gt(b,2),S=ft(A);mt(S),gt(S,2).__click=[Il,i],W(A);var E=gt(A,2);E.__click=[Tl,n,i];var K=gt(E,2);K.__click=[Bl,s,i];var _=gt(K,2),P=ft(_);mt(P),gt(P,2).__click=[$l,s],W(_);var U=gt(_,2);U.__click=[Nl,n,s];var x=gt(U,3),D=ft(x),C=ft(D);Lr(C),V(2),W(D),W(x),W(l),_t(e=>{var t,r,n;Fr(y,"aria-invalid",e),t=S,r=cr(i),(n=Or(t)).value!==(n.value=r??void 0)&&(t.value!==r||0===r&&"PROGRESS"===t.nodeName)&&(t.value=r??"")},[()=>cr(o)&&(0,Qr.aj)(cr(n))?"false":null]),zr(y,()=>cr(n),e=>Xe(n,e)),Tr(p,()=>cr(u),e=>Xe(u,e)),zr(P,()=>cr(s),e=>Xe(s,e)),Hr(C,()=>cr(o),e=>Xe(o,e)),kr(e,l),oe()},{target:document.body})})()})();
/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var t={84:(t,e,r)=>{"use strict";t.exports=r.p+"build/encodedecode_bg.wasm"},508:t=>{function e(t){var r,n,i="";if("string"==typeof t||"number"==typeof t)i+=t;else if("object"==typeof t)if(Array.isArray(t)){var s=t.length;for(r=0;r<s;r++)t[r]&&(n=e(t[r]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function r(){for(var t,r,n=0,i="",s=arguments.length;n<s;n++)(t=arguments[n])&&(r=e(t))&&(i&&(i+=" "),i+=r);return i}t.exports=r,t.exports.clsx=r}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var s=e[n]={exports:{}};return t[n](s,s.exports,r),s.exports}r.m=t,r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t;r.g.importScripts&&(t=r.g.location+"");var e=r.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var n=e.getElementsByTagName("script");if(n.length)for(var i=n.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=n[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=t+"../"})(),r.b=document.baseURI||self.location.href,(()=>{"use strict";"undefined"!=typeof window&&((window.__svelte??={}).v??=new Set).add("5");const t={},e=Symbol(),n=Symbol("filename"),i=(Symbol("hmr"),globalThis.process?.env?.NODE_ENV),s=i&&!i.toLowerCase().startsWith("prod");var a=Array.isArray,o=Array.prototype.indexOf,c=Array.from,u=Object.keys,l=Object.defineProperty,f=Object.getOwnPropertyDescriptor,h=Object.getOwnPropertyDescriptors,y=Object.prototype,d=Array.prototype,p=Object.getPrototypeOf,g=Object.isExtensible;function A(t){for(var e=0;e<t.length;e++)t[e]()}const w=256,b=1024,m=2048,v=4096,E=8192,k=16384,B=32768,I=65536,S=1<<17,C=1<<19,K=1<<21,D=1<<22,U=1<<23,x=Symbol("$state"),P=Symbol("legacy props"),Q=Symbol(""),_=Symbol("proxy path"),R=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function T(){if(s){const t=new Error("bind_invalid_checkbox_value\nUsing `bind:value` together with a checkbox input is not allowed. Use `bind:checked` instead\nhttps://svelte.dev/e/bind_invalid_checkbox_value");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/bind_invalid_checkbox_value")}var M="font-weight: bold",N="font-weight: normal";function O(t){s?console.warn(`%c[svelte] hydration_mismatch\n%c${t?`Hydration failed because the initial UI does not match what was rendered on the server. The error occurred near ${t}`:"Hydration failed because the initial UI does not match what was rendered on the server"}\nhttps://svelte.dev/e/hydration_mismatch`,M,N):console.warn("https://svelte.dev/e/hydration_mismatch")}function F(t){s?console.warn(`%c[svelte] state_proxy_equality_mismatch\n%cReactive \`$state(...)\` proxies and the values they proxy have different identities. Because of this, comparisons with \`${t}\` will produce unexpected results\nhttps://svelte.dev/e/state_proxy_equality_mismatch`,M,N):console.warn("https://svelte.dev/e/state_proxy_equality_mismatch")}let L,H=!1;function z(t){H=t}function G(e){if(null===e)throw O(),t;return L=e}function $(){return G(he(L))}function j(e){if(H){if(null!==he(L))throw O(),t;L=e}}function V(t=1){if(H){for(var e=t,r=L;e--;)r=he(r);L=r}}function q(t){return t===this.v}function Y(t){return!function(t,e){return t!=t?e==e:t!==e||null!==t&&"object"==typeof t||"function"==typeof t}(t,this.v)}function Z(t){let e=Error();const r=e.stack;if(!r)return null;const n=r.split("\n"),i=["\n"];for(let t=0;t<n.length;t++){const e=n[t];if("Error"!==e){if(e.includes("validate_each_keys"))return null;e.includes("svelte/src/internal")||i.push(e)}}return 1===i.length?null:(l(e,"stack",{value:i.join("\n")}),l(e,"name",{value:`${t}Error`}),e)}function J(t,e){return t.label=e,W(t.v,e),t}function W(t,e){return t?.[_]?.(e),t}let X=null;function tt(t){X=t}let et=null;function rt(t){et=t}let nt=null;function it(t){nt=t}function st(t,e=!1,r){X={p:X,c:null,e:null,s:t,x:null,l:null},s&&(X.function=r,nt=r)}function at(t){var e=X,r=e.e;if(null!==r)for(var n of(e.e=null,r))ke(n);return void 0!==t&&(e.x=t),X=e.p,s&&(nt=X?.function??null),t??{}}const ot=new WeakMap;function ct(t,e){for(;null!==e;){if(128&e.f)try{return void e.b.error(t)}catch(e){t=e}e=e.parent}throw t instanceof Error&&ut(t),t}function ut(t){const e=ot.get(t);e&&(l(t,"message",{value:e.message}),l(t,"stack",{value:e.stack}))}const lt="undefined"==typeof requestIdleCallback?t=>setTimeout(t,1):requestIdleCallback;let ft=[],ht=[];function yt(){var t=ft;ft=[],A(t)}function dt(){var t=ht;ht=[],A(t)}function pt(){return ft.length>0||ht.length>0}function gt(){ft.length>0&&yt(),ht.length>0&&dt()}let At=null;function wt(t){At=t}const bt=new Set;function mt(t){var r=2050,n=null!==Fe&&2&Fe.f?Fe:null;null===ze||null!==n&&0!==(n.f&w)?r|=w:ze.f|=C;const i={ctx:X,deps:null,effects:null,equals:q,f:r,fn:t,reactions:null,rv:0,v:e,wv:0,parent:n??ze,ac:null};return i}function vt(t){var e=t.effects;if(null!==e){t.effects=null;for(var r=0;r<e.length;r+=1)De(e[r])}}let Et=[];function kt(t){var e,r=ze;if(Ge(function(t){for(var e=t.parent;null!==e;){if(!(2&e.f))return e;e=e.parent}return null}(t)),s){let n=Ht;Gt(new Set);try{Et.includes(t)&&function(){if(s){const t=new Error("derived_references_self\nA derived value cannot reference itself recursively\nhttps://svelte.dev/e/derived_references_self");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/derived_references_self")}(),Et.push(t),vt(t),e=nr(t)}finally{Ge(r),Gt(n),Et.pop()}}else try{vt(t),e=nr(t)}finally{Ge(r)}return e}function Bt(t){var e=kt(t);t.equals(e)||(t.v=e,t.wv=tr()),Ne||(null!==Dt?Dt.set(t,t.v):fr(t,!Xe&&0===(t.f&w)||null===t.deps?b:v))}function It(){Ge(null),He(null),tt(null),s&&wt(null)}const St=new Set;let Ct=null,Kt=null,Dt=null,Ut=new Set,xt=[],Pt=null,Qt=!1,_t=!1;class Rt{current=new Map;#t=new Map;#e=new Set;#r=0;#n=null;#i=!1;#s=[];#a=[];#o=[];#c=[];#u=[];#l=[];#f=[];skipped_effects=new Set;process(t){xt=[],Kt=null;var e=null;for(const e of t)this.#h(e);if(0===this.#s.length&&0===this.#r){this.#y();var r=this.#o,n=this.#c;this.#o=[],this.#c=[],this.#u=[],Kt=Ct,Ct=null,Ft(r),Ft(n),null===Ct?Ct=this:St.delete(this),this.#n?.resolve()}else this.#d(this.#o),this.#d(this.#c),this.#d(this.#u);if(e){for(const[t,{v:r,wv:n}]of e)t.wv<=n&&(t.v=r);Dt=null}for(const t of this.#s)ar(t);for(const t of this.#a)ar(t);this.#s=[],this.#a=[]}#h(t){t.f^=b;for(var e=t.first;null!==e;){var r=e.f,n=!!(96&r);if(!(n&&0!==(r&b)||0!==(r&E)||this.skipped_effects.has(e))&&null!==e.fn){n?e.f^=b:4&r?this.#c.push(e):0===(r&b)&&(0!==(r&D)?(e.b?.is_pending()?this.#a:this.#s).push(e):er(e)&&(!!(16&e.f)&&this.#u.push(e),ar(e)));var i=e.first;if(null!==i){e=i;continue}}var s=e.parent;for(e=e.next;null===e&&null!==s;)e=s.next,s=s.parent}}#d(t){for(const e of t)(0!==(e.f&m)?this.#l:this.#f).push(e),fr(e,b);t.length=0}capture(t,e){this.#t.has(t)||this.#t.set(t,e),this.current.set(t,t.v)}activate(){Ct=this}deactivate(){Ct=null,Kt=null;for(const t of Ut)if(Ut.delete(t),t(),null!==Ct)break}neuter(){this.#i=!0}flush(){xt.length>0?Mt():this.#y(),Ct===this&&(0===this.#r&&St.delete(this),this.deactivate())}#y(){if(!this.#i)for(const t of this.#e)t();this.#e.clear()}increment(){this.#r+=1}decrement(){if(this.#r-=1,0===this.#r){for(const t of this.#l)fr(t,m),Lt(t);for(const t of this.#f)fr(t,v),Lt(t);this.#o=[],this.#c=[],this.flush()}else this.deactivate()}add_callback(t){this.#e.add(t)}settled(){return(this.#n??={promise:new Promise((r,n)=>{t=r,e=n}),resolve:t,reject:e}).promise;var t,e}static ensure(){if(null===Ct){const t=Ct=new Rt;St.add(Ct),_t||Rt.enqueue(()=>{Ct===t&&t.flush()})}return Ct}static enqueue(t){!function(t){if(0===ft.length&&!_t){var e=ft;queueMicrotask(()=>{e===ft&&yt()})}ft.push(t)}(t)}}function Tt(t){var e=_t;_t=!0;try{var r;for(t&&(Mt(),r=t());;){if(gt(),0===xt.length&&!pt()&&(Ct?.flush(),0===xt.length))return Pt=null,r;Mt()}}finally{_t=e}}function Mt(){var t=Te;Qt=!0;try{var e=0;for(Me(!0);xt.length>0;){var r=Rt.ensure();if(e++>1e3){if(s){var n=new Map;for(const t of r.current.keys())for(const[e,r]of t.updated??[]){var i=n.get(e);i||(i={error:r.error,count:0},n.set(e,i)),i.count+=r.count}for(const t of n.values())console.error(t.error)}Nt()}r.process(xt),zt.clear()}}finally{Qt=!1,Me(t),Pt=null}}function Nt(){try{!function(){if(s){const t=new Error("effect_update_depth_exceeded\nMaximum update depth exceeded. This typically indicates that an effect reads and writes the same piece of state\nhttps://svelte.dev/e/effect_update_depth_exceeded");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}()}catch(t){s&&l(t,"stack",{value:""}),ct(t,Pt)}}let Ot=null;function Ft(t){var e=t.length;if(0!==e){for(var r=0;r<e;){var n=t[r++];if(!(24576&n.f)&&er(n)&&(Ot=[],ar(n),null===n.deps&&null===n.first&&null===n.nodes_start&&(null===n.teardown&&null===n.ac?Ue(n):n.fn=null),Ot?.length>0)){zt.clear();for(const t of Ot)ar(t);Ot=[]}}Ot=null}}function Lt(t){for(var e=Pt=t;null!==e.parent;){var r=(e=e.parent).f;if(Qt&&e===ze&&16&r)return;if(96&r){if(0===(r&b))return;e.f^=b}}xt.push(e)}let Ht=new Set;const zt=new Map;function Gt(t){Ht=t}let $t=!1;function jt(t,e){var r={f:0,v:t,reactions:null,equals:q,rv:0,wv:0};return r}function Vt(t,e){const r=jt(t);var n;return n=r,null!==Fe&&(null===$e?$e=[n]:$e.push(n)),r}function qt(t,e,r=!1){null!==Fe&&(!Le||0!==(Fe.f&S))&&4325394&Fe.f&&!$e?.includes(t)&&function(){if(s){const t=new Error("state_unsafe_mutation\nUpdating state inside `$derived(...)`, `$inspect(...)` or a template expression is forbidden. If the value should not be reactive, declare it without `$state`\nhttps://svelte.dev/e/state_unsafe_mutation");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/state_unsafe_mutation")}();let n=r?te(e):e;return s&&W(n,t.label),Yt(t,n)}function Yt(t,e){if(!t.equals(e)){var r=t.v;if(Ne?zt.set(t,e):zt.set(t,r),t.v=e,Rt.ensure().capture(t,r),s){if(null!==ze){const e=Z("UpdatedAt");if(null!==e){t.updated??=new Map;let r=t.updated.get(e.stack);r||(r={error:e,count:0},t.updated.set(e.stack,r)),r.count++}}null!==ze&&(t.set_during_effect=!0)}2&t.f&&(0!==(t.f&m)&&kt(t),fr(t,0===(t.f&w)?b:v)),t.wv=tr(),Wt(t,m),null===ze||0===(ze.f&b)||96&ze.f||(null===qe?function(t){qe=t}([t]):qe.push(t)),s&&Ht.size>0&&!$t&&Zt()}return e}function Zt(){$t=!1;const t=Array.from(Ht);for(const e of t)0!==(e.f&b)&&fr(e,v),er(e)&&ar(e);Ht.clear()}function Jt(t){qt(t,t.v+1)}function Wt(t,e){var r=t.reactions;if(null!==r)for(var n=r.length,i=0;i<n;i++){var a=r[i],o=a.f;if(s&&0!==(o&S))Ht.add(a);else{var c=0===(o&m);c&&fr(a,e),2&o?Wt(a,v):c&&(!!(16&o)&&null!==Ot&&Ot.push(a),Lt(a))}}}const Xt=/^[a-zA-Z_$][a-zA-Z_$0-9]*$/;function te(t){if("object"!=typeof t||null===t||x in t)return t;const r=p(t);if(r!==y&&r!==d)return t;var n=new Map,i=a(t),o=Vt(0),c=Je,u=t=>{if(Je===c)return t();var e=Fe,r=Je;He(null),We(c);var n=t();return He(e),We(r),n};i&&(n.set("length",Vt(t.length)),s&&(t=new Proxy(t,{get(t,e,r){var n=Reflect.get(t,e,r);return ie.has(e)?function(...t){$t=!0;var e=n.apply(this,t);return Zt(),e}:n}})));var l="";let h=!1;function g(t){if(!h){h=!0,J(o,`${l=t} version`);for(const[t,e]of n)J(e,ee(l,t));h=!1}}return new Proxy(t,{defineProperty(t,e,r){"value"in r&&!1!==r.configurable&&!1!==r.enumerable&&!1!==r.writable||function(){if(s){const t=new Error("state_descriptors_fixed\nProperty descriptors defined on `$state` objects must contain `value` and always be `enumerable`, `configurable` and `writable`.\nhttps://svelte.dev/e/state_descriptors_fixed");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/state_descriptors_fixed")}();var i=n.get(e);return void 0===i?i=u(()=>{var t=Vt(r.value);return n.set(e,t),s&&"string"==typeof e&&J(t,ee(l,e)),t}):qt(i,r.value,!0),!0},deleteProperty(t,r){var i=n.get(r);if(void 0===i){if(r in t){const t=u(()=>Vt(e));n.set(r,t),Jt(o),s&&J(t,ee(l,r))}}else qt(i,e),Jt(o);return!0},get(r,i,a){if(i===x)return t;if(s&&i===_)return g;var o=n.get(i),c=i in r;if(void 0!==o||c&&!f(r,i)?.writable||(o=u(()=>{var t=Vt(te(c?r[i]:e));return s&&J(t,ee(l,i)),t}),n.set(i,o)),void 0!==o){var h=or(o);return h===e?void 0:h}return Reflect.get(r,i,a)},getOwnPropertyDescriptor(t,r){var i=Reflect.getOwnPropertyDescriptor(t,r);if(i&&"value"in i){var s=n.get(r);s&&(i.value=or(s))}else if(void 0===i){var a=n.get(r),o=a?.v;if(void 0!==a&&o!==e)return{enumerable:!0,configurable:!0,value:o,writable:!0}}return i},has(t,r){if(r===x)return!0;var i=n.get(r),a=void 0!==i&&i.v!==e||Reflect.has(t,r);return!((void 0!==i||null!==ze&&(!a||f(t,r)?.writable))&&(void 0===i&&(i=u(()=>{var n=Vt(a?te(t[r]):e);return s&&J(n,ee(l,r)),n}),n.set(r,i)),or(i)===e))&&a},set(t,r,a,c){var h=n.get(r),y=r in t;if(i&&"length"===r)for(var d=a;d<h.v;d+=1){var p=n.get(d+"");void 0!==p?qt(p,e):d in t&&(p=u(()=>Vt(e)),n.set(d+"",p),s&&J(p,ee(l,d)))}void 0===h?y&&!f(t,r)?.writable||(h=u(()=>Vt(void 0)),s&&J(h,ee(l,r)),qt(h,te(a)),n.set(r,h)):(y=h.v!==e,qt(h,u(()=>te(a))));var g=Reflect.getOwnPropertyDescriptor(t,r);if(g?.set&&g.set.call(c,a),!y){if(i&&"string"==typeof r){var A=n.get("length"),w=Number(r);Number.isInteger(w)&&w>=A.v&&qt(A,w+1)}Jt(o)}return!0},ownKeys(t){or(o);var r=Reflect.ownKeys(t).filter(t=>{var r=n.get(t);return void 0===r||r.v!==e});for(var[i,s]of n)s.v===e||i in t||r.push(i);return r},setPrototypeOf(){!function(){if(s){const t=new Error("state_prototype_fixed\nCannot set prototype of `$state` object\nhttps://svelte.dev/e/state_prototype_fixed");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/state_prototype_fixed")}()}})}function ee(t,e){return"symbol"==typeof e?`${t}[Symbol(${e.description??""})]`:Xt.test(e)?`${t}.${e}`:/^\d+$/.test(e)?`${t}[${e}]`:`${t}['${e}']`}function re(t){try{if(null!==t&&"object"==typeof t&&x in t)return t[x]}catch{}return t}function ne(t,e){return Object.is(re(t),re(e))}const ie=new Set(["copyWithin","fill","pop","push","reverse","shift","sort","splice","unshift"]);var se,ae,oe,ce;function ue(){if(void 0===se){se=window,document,ae=/Firefox/.test(navigator.userAgent);var t=Element.prototype,e=Node.prototype,r=Text.prototype;oe=f(e,"firstChild").get,ce=f(e,"nextSibling").get,g(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),g(r)&&(r.__t=void 0),s&&(t.__svelte_meta=null,function(){const t=Array.prototype,e=Array.__svelte_cleanup;e&&e();const{indexOf:r,lastIndexOf:n,includes:i}=t;t.indexOf=function(t,e){const n=r.call(this,t,e);if(-1===n)for(let r=e??0;r<this.length;r+=1)if(re(this[r])===t){F("array.indexOf(...)");break}return n},t.lastIndexOf=function(t,e){const r=n.call(this,t,e??this.length-1);if(-1===r)for(let r=0;r<=(e??this.length-1);r+=1)if(re(this[r])===t){F("array.lastIndexOf(...)");break}return r},t.includes=function(t,e){const r=i.call(this,t,e);if(!r)for(let e=0;e<this.length;e+=1)if(re(this[e])===t){F("array.includes(...)");break}return r},Array.__svelte_cleanup=()=>{t.indexOf=r,t.lastIndexOf=n,t.includes=i}}())}}function le(t=""){return document.createTextNode(t)}function fe(t){return oe.call(t)}function he(t){return ce.call(t)}function ye(t,e){if(!H)return fe(t);var r=fe(L);if(null===r)r=L.appendChild(le());else if(e&&3!==r.nodeType){var n=le();return r?.before(n),G(n),n}return G(r),r}function de(t,e){if(!H){var r=fe(t);return r instanceof Comment&&""===r.data?he(r):r}if(e&&3!==L?.nodeType){var n=le();return L?.before(n),G(n),n}return L}function pe(t,e=1,r=!1){let n=H?L:t;for(var i;e--;)i=n,n=he(n);if(!H)return n;if(r&&3!==n?.nodeType){var s=le();return null===n?i?.after(s):n.before(s),G(s),s}return G(n),n}function ge(t){t.textContent=""}function Ae(t){H&&null!==fe(t)&&ge(t)}let we=!1;function be(){we||(we=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const e of t.target.elements)e.__on_r?.()})},{capture:!0}))}function me(t){var e=Fe,r=ze;He(null),Ge(null);try{return t()}finally{He(e),Ge(r)}}function ve(t,e,r,n=r){t.addEventListener(e,()=>me(r));const i=t.__on_r;t.__on_r=i?()=>{i(),n(!0)}:()=>n(!0),be()}function Ee(t,e,r,n=!0){var i=ze;if(s)for(;null!==i&&0!==(i.f&S);)i=i.parent;null!==i&&0!==(i.f&E)&&(t|=E);var a={ctx:X,deps:null,nodes_start:null,nodes_end:null,f:t|m,first:null,fn:e,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,transitions:null,wv:0,ac:null};if(s&&(a.component_function=nt),r)try{ar(a),a.f|=B}catch(o){throw De(a),o}else null!==e&&Lt(a);if(n){var o=a;if(r&&null===o.deps&&null===o.teardown&&null===o.nodes_start&&o.first===o.last&&0===(o.f&C)&&(o=o.first),null!==o&&(o.parent=i,null!==i&&function(t,e){var r=e.last;null===r?e.last=e.first=t:(r.next=t,t.prev=r,e.last=t)}(o,i),null!==Fe&&2&Fe.f&&!(64&t))){var c=Fe;(c.effects??=[]).push(o)}}return a}function ke(t){return Ee(1048580,t,!1)}function Be(t,e=0){return Ee(8|e,t,!0)}function Ie(t,r=[],n=[]){!function(t,r,n){const i=mt;if(0!==r.length){var a=Ct,o=ze,c=function(){var t=ze,e=Fe,r=X,n=Ct;return function(){Ge(t),He(e),tt(r),n?.activate(),s&&wt(null)}}(),u=function(){const t=ze.b;return null===t&&function(){if(s){const t=new Error("await_outside_boundary\nCannot await outside a `<svelte:boundary>` with a `pending` snippet\nhttps://svelte.dev/e/await_outside_boundary");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/await_outside_boundary")}(),t}();Promise.all(r.map(t=>function(t,r){let n=ze;null===n&&function(){if(s){const t=new Error("async_derived_orphan\nCannot create a `$derived(...)` with an `await` expression outside of an effect tree\nhttps://svelte.dev/e/async_derived_orphan");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/async_derived_orphan")}();var i=n.b,a=void 0,o=jt(e),c=null,u=!Fe;return function(t){Ee(4718592,t,!0)}(()=>{s&&(At=ze);try{var e=t();c&&Promise.resolve(e).catch(()=>{})}catch(t){e=Promise.reject(t)}s&&(At=null);var n=()=>e;a=c?.then(n,n)??Promise.resolve(e),c=a;var l=Ct,f=i.is_pending();u&&(i.update_pending_count(1),f||l.increment());const h=(t,e=void 0)=>{c=null,At=null,f||l.activate(),e?e!==R&&(o.f|=U,Yt(o,e)):(0!==(o.f&U)&&(o.f^=U),Yt(o,t),s&&void 0!==r&&(bt.add(o),setTimeout(()=>{bt.has(o)&&(function(t,e){s?console.warn(`%c[svelte] await_waterfall\n%cAn async derived, \`${t}\` (${e}) was not read immediately after it resolved. This often indicates an unnecessary waterfall, which can slow down your app\nhttps://svelte.dev/e/await_waterfall`,M,N):console.warn("https://svelte.dev/e/await_waterfall")}(o.label,r),bt.delete(o))}))),u&&(i.update_pending_count(-1),f||l.decrement()),It()};if(a.then(h,t=>h(null,t||"unknown")),l)return()=>{queueMicrotask(()=>l.neuter())}}),s&&(o.f|=D),new Promise(t=>{!function e(r){function n(){r===a?t(o):e(a)}r.then(n,n)}(a)})}(t))).then(e=>{a?.activate(),c();try{n([...t.map(i),...e])}catch(t){0===(o.f&k)&&ct(t,o)}a?.deactivate(),It()}).catch(t=>{u.error(t)})}else n(t.map(i))}(r,n,e=>{Ee(8,()=>t(...e.map(or)),!0)})}function Se(t,e=!0){return Ee(524320,t,!0,e)}function Ce(t){var e=t.teardown;if(null!==e){const t=Ne,r=Fe;Oe(!0),He(null);try{e.call(null)}finally{Oe(t),He(r)}}}function Ke(t,e=!1){var r=t.first;for(t.first=t.last=null;null!==r;){const t=r.ac;null!==t&&me(()=>{t.abort(R)});var n=r.next;64&r.f?r.parent=null:De(r,e),r=n}}function De(t,e=!0){var r=!1;(e||262144&t.f)&&null!==t.nodes_start&&null!==t.nodes_end&&(function(t,e){for(;null!==t;){var r=t===e?null:he(t);t.remove(),t=r}}(t.nodes_start,t.nodes_end),r=!0),Ke(t,e&&!r),sr(t,0),fr(t,k);var n=t.transitions;if(null!==n)for(const t of n)t.stop();Ce(t);var i=t.parent;null!==i&&null!==i.first&&Ue(t),s&&(t.component_function=null),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes_start=t.nodes_end=t.ac=null}function Ue(t){var e=t.parent,r=t.prev,n=t.next;null!==r&&(r.next=n),null!==n&&(n.prev=r),null!==e&&(e.first===t&&(e.first=n),e.last===t&&(e.last=r))}function xe(t,e){var r=[];Pe(t,r,!0),function(t,e){var r=t.length;if(r>0){var n=()=>--r||e();for(var i of t)i.out(n)}else e()}(r,()=>{De(t),e&&e()})}function Pe(t,e,r){if(0===(t.f&E)){if(t.f^=E,null!==t.transitions)for(const n of t.transitions)(n.is_global||r)&&e.push(n);for(var n=t.first;null!==n;){var i=n.next;Pe(n,e,!!(0!==(n.f&I)||32&n.f)&&r),n=i}}}function Qe(t){_e(t,!0)}function _e(t,e){if(0!==(t.f&E)){t.f^=E,0===(t.f&b)&&(fr(t,m),Lt(t));for(var r=t.first;null!==r;){var n=r.next;_e(r,!!(0!==(r.f&I)||32&r.f)&&e),r=n}if(null!==t.transitions)for(const r of t.transitions)(r.is_global||e)&&r.in()}}let Re=null,Te=!1;function Me(t){Te=t}let Ne=!1;function Oe(t){Ne=t}let Fe=null,Le=!1;function He(t){Fe=t}let ze=null;function Ge(t){ze=t}let $e=null,je=null,Ve=0,qe=null,Ye=1,Ze=0,Je=Ze;function We(t){Je=t}let Xe=!1;function tr(){return++Ye}function er(t){var e=t.f;if(0!==(e&m))return!0;if(0!==(e&v)){var r=t.deps,n=0!==(e&w);if(null!==r){var i,s,a=!!(512&e),o=n&&null!==ze&&!Xe,c=r.length;if((a||o)&&(null===ze||0===(ze.f&k))){var u=t,l=u.parent;for(i=0;i<c;i++)s=r[i],!a&&s?.reactions?.includes(u)||(s.reactions??=[]).push(u);a&&(u.f^=512),o&&null!==l&&0===(l.f&w)&&(u.f^=w)}for(i=0;i<c;i++)if(er(s=r[i])&&Bt(s),s.wv>t.wv)return!0}n&&(null===ze||Xe)||fr(t,b)}return!1}function rr(t,e,r=!0){var n=t.reactions;if(null!==n&&!$e?.includes(t))for(var i=0;i<n.length;i++){var s=n[i];2&s.f?rr(s,e,!1):e===s&&(r?fr(s,m):0!==(s.f&b)&&fr(s,v),Lt(s))}}function nr(t){var e=je,r=Ve,i=qe,a=Fe,o=Xe,c=$e,u=X,l=Le,h=Je,y=t.f;je=null,Ve=0,qe=null,Xe=0!==(y&w)&&(Le||!Te||null===Fe),Fe=96&y?null:t,$e=null,tt(t.ctx),Le=!1,Je=++Ze,null!==t.ac&&(me(()=>{t.ac.abort(R)}),t.ac=null);try{t.f|=K;var d=(0,t.fn)(),p=t.deps;if(null!==je){var g;if(sr(t,Ve),null!==p&&Ve>0)for(p.length=Ve+je.length,g=0;g<je.length;g++)p[Ve+g]=je[g];else t.deps=p=je;if(!Xe||2&y&&null!==t.reactions)for(g=Ve;g<p.length;g++)(p[g].reactions??=[]).push(t)}else null!==p&&Ve<p.length&&(sr(t,Ve),p.length=Ve);if(!(null===qe||Le||null===p||6146&t.f))for(g=0;g<qe.length;g++)rr(qe[g],t);return null!==a&&a!==t&&(Ze++,null!==qe&&(null===i?i=qe:i.push(...qe))),0!==(t.f&U)&&(t.f^=U),d}catch(t){return function(t){var e=ze;if(null===e)return Fe.f|=U,t;if(s&&t instanceof Error&&!ot.has(t)&&ot.set(t,function(t,e){const r=f(t,"message");if(!r||r.configurable){for(var i=ae?"  ":"\t",s=`\n${i}in ${e.fn?.name||"<unknown>"}`,a=e.ctx;null!==a;)s+=`\n${i}in ${a.function?.[n].split("/").pop()}`,a=a.p;return{message:t.message+`\n${s}\n`,stack:t.stack?.split("\n").filter(t=>!t.includes("svelte/src/internal")).join("\n")}}}(t,e)),0===(e.f&B)){if(!(128&e.f))throw!e.parent&&t instanceof Error&&ut(t),t;e.b.error(t)}else ct(t,e)}(t)}finally{t.f^=K,je=e,Ve=r,qe=i,Fe=a,Xe=o,$e=c,tt(u),Le=l,Je=h}}function ir(t,e){let r=e.reactions;if(null!==r){var n=o.call(r,t);if(-1!==n){var i=r.length-1;0===i?r=e.reactions=null:(r[n]=r[i],r.pop())}}null===r&&2&e.f&&(null===je||!je.includes(e))&&(fr(e,v),768&e.f||(e.f^=512),vt(e),sr(e,0))}function sr(t,e){var r=t.deps;if(null!==r)for(var n=e;n<r.length;n++)ir(t,r[n])}function ar(t){var e=t.f;if(0===(e&k)){fr(t,b);var r=ze,n=Te;if(ze=t,Te=!0,s){var i=nt;it(t.component_function);var a=et;rt(t.dev_stack??et)}try{16&e?function(t){for(var e=t.first;null!==e;){var r=e.next;!(32&e.f)&&De(e),e=r}}(t):Ke(t),Ce(t);var o=nr(t);t.teardown="function"==typeof o?o:null,t.wv=Ye}finally{Te=n,ze=r,s&&(it(i),rt(a))}}}function or(t){var e,r=!!(2&t.f);if(Re?.add(t),null===Fe||Le){if(r&&null===t.deps&&null===t.effects){var n=t,i=n.parent;null!==i&&0===(i.f&w)&&(n.f^=w)}}else if((null===ze||0===(ze.f&k))&&!$e?.includes(t)){var a=Fe.deps;if(0!==(Fe.f&K))t.rv<Ze&&(t.rv=Ze,null===je&&null!==a&&a[Ve]===t?Ve++:null===je?je=[t]:Xe&&je.includes(t)||je.push(t));else{(Fe.deps??=[]).push(t);var o=t.reactions;null===o?t.reactions=[Fe]:o.includes(Fe)||o.push(Fe)}}if(s){if(At){var c=0!==(At.f&K),u=At.deps?.includes(t);if(!c&&!Le&&!u){e=t.label,s?console.warn(`%c[svelte] await_reactivity_loss\n%cDetected reactivity loss when reading \`${e}\`. This happens when state is read in an async function after an earlier \`await\`\nhttps://svelte.dev/e/await_reactivity_loss`,M,N):console.warn("https://svelte.dev/e/await_reactivity_loss");var l=Z("TracedAt");l&&console.warn(l)}}bt.delete(t)}if(Ne){if(zt.has(t))return zt.get(t);if(r){var f=(n=t).v;return(0===(n.f&b)&&null!==n.reactions||cr(n))&&(f=kt(n)),zt.set(n,f),f}}else if(r){if(n=t,Dt?.has(n))return Dt.get(n);er(n)&&Bt(n)}if(0!==(t.f&U))throw t.v;return t.v}function cr(t){if(t.v===e)return!0;if(null===t.deps)return!1;for(const e of t.deps){if(zt.has(e))return!0;if(2&e.f&&cr(e))return!0}return!1}function ur(t){var e=Le;try{return Le=!0,t()}finally{Le=e}}const lr=-7169;function fr(t,e){t.f=t.f&lr|e}const hr=new Set,yr=new Set;let dr,pr=null;function gr(t){var e=this,r=e.ownerDocument,n=t.type,i=t.composedPath?.()||[],s=i[0]||t.target;pr=t;var o=0,c=pr===t&&t.__root;if(c){var u=i.indexOf(c);if(-1!==u&&(e===document||e===window))return void(t.__root=e);var f=i.indexOf(e);if(-1===f)return;u<=f&&(o=u)}if((s=i[o]||t.target)!==e){l(t,"currentTarget",{configurable:!0,get:()=>s||r});var h=Fe,y=ze;He(null),Ge(null);try{for(var d,p=[];null!==s;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var A=s["__"+n];if(null!=A&&(!s.disabled||t.target===s))if(a(A)){var[w,...b]=A;w.apply(s,[t,...b])}else A.call(s,t)}catch(t){d?p.push(t):d=t}if(t.cancelBubble||g===e||null===g)break;s=g}if(d){for(let t of p)queueMicrotask(()=>{throw t});throw d}}finally{t.__root=e,delete t.currentTarget,He(h),Ge(y)}}}function Ar(t,e){var r=ze;null===r.nodes_start&&(r.nodes_start=t,r.nodes_end=e)}function wr(t,e){var r,n=!!(1&e),i=!!(2&e),s=!t.startsWith("<!>");return()=>{if(H)return Ar(L,null),L;var e,a;void 0===r&&(e=s?t:"<!>"+t,(a=document.createElement("template")).innerHTML=e.replaceAll("<!>","\x3c!----\x3e"),r=a.content,n||(r=fe(r)));var o=i||ae?document.importNode(r,!0):r.cloneNode(!0);return n?Ar(fe(o),o.lastChild):Ar(o,o),o}}function br(){if(H)return Ar(L,null),L;var t=document.createDocumentFragment(),e=document.createComment(""),r=le();return t.append(e,r),Ar(e,r),t}function mr(t,e){if(H)return ze.nodes_end=L,void $();null!==t&&t.before(e)}const vr=["touchstart","touchmove"];function Er(t){return vr.includes(t)}let kr=!0;function Br(t,e){return Cr(t,e)}function Ir(e,r){ue(),r.intro=r.intro??!1;const n=r.target,i=H,a=L;try{for(var o=fe(n);o&&(8!==o.nodeType||"["!==o.data);)o=he(o);if(!o)throw t;z(!0),G(o),$();const i=Cr(e,{...r,anchor:o});if(null===L||8!==L.nodeType||"]"!==L.data)throw O(),t;return z(!1),i}catch(i){if(i instanceof Error&&i.message.split("\n").some(t=>t.startsWith("https://svelte.dev/e/")))throw i;return i!==t&&console.warn("Failed to hydrate: ",i),!1===r.recover&&function(){if(s){const t=new Error("hydration_failed\nFailed to hydrate the application\nhttps://svelte.dev/e/hydration_failed");throw t.name="Svelte error",t}throw new Error("https://svelte.dev/e/hydration_failed")}(),ue(),ge(n),z(!1),Br(e,r)}finally{z(i),G(a),dr=void 0}}const Sr=new Map;function Cr(t,{target:e,anchor:r,props:n={},events:i,context:s,intro:a=!0}){ue();var o=new Set,u=t=>{for(var r=0;r<t.length;r++){var n=t[r];if(!o.has(n)){o.add(n);var i=Er(n);e.addEventListener(n,gr,{passive:i});var s=Sr.get(n);void 0===s?(document.addEventListener(n,gr,{passive:i}),Sr.set(n,1)):Sr.set(n,s+1)}}};u(c(hr)),yr.add(u);var l=void 0,f=function(){Rt.ensure();const c=Ee(524352,()=>{var c=r??e.appendChild(le());return Se(()=>{s&&(st({}),X.c=s),i&&(n.$$events=i),H&&Ar(c,null),kr=a,l=t(c,n)||{},kr=!0,H&&(ze.nodes_end=L),s&&at()}),()=>{for(var t of o){e.removeEventListener(t,gr);var n=Sr.get(t);0===--n?(document.removeEventListener(t,gr),Sr.delete(t)):Sr.set(t,n)}yr.delete(u),c!==r&&c.parentNode?.removeChild(c)}},!0);return(t={})=>new Promise(e=>{t.outro?xe(c,()=>{De(c),e(void 0)}):(De(c),e(void 0))})}();return Kr.set(l,f),l}let Kr=new WeakMap;if(s){function Eg(t){if(!(t in globalThis)){let e;Object.defineProperty(globalThis,t,{configurable:!0,get:()=>{if(void 0!==e)return e;!function(t){if(s){const e=new Error(`rune_outside_svelte\nThe \`${t}\` rune is only available inside \`.svelte\` and \`.svelte.js/ts\` files\nhttps://svelte.dev/e/rune_outside_svelte`);throw e.name="Svelte error",e}throw new Error("https://svelte.dev/e/rune_outside_svelte")}(t)},set:t=>{e=t}})}}Eg("$state"),Eg("$effect"),Eg("$derived"),Eg("$inspect"),Eg("$props"),Eg("$bindable")}function Dr(r,n,i=!1){H&&$();var a=r,o=null,c=null,u=e,l=!1;const f=(t,e=!0)=>{l=!0,d(e,t)};var h=null;function y(){null!==h&&(h.lastChild.remove(),a.before(h),h=null);var t=u?o:c,e=u?c:o;t&&Qe(t),e&&xe(e,()=>{u?c=null:o=null})}const d=(e,r)=>{if(u===(u=e))return;let n=!1;if(H){const e="[!"===function(e){if(!e||8!==e.nodeType)throw O(),t;return e.data}(a);!!u===e&&(a=function(){for(var t=0,e=L;;){if(8===e.nodeType){var r=e.data;if("]"===r){if(0===t)return e;t-=1}else"["!==r&&"[!"!==r||(t+=1)}var n=he(e);e.remove(),e=n}}(),G(a),z(!1),n=!0)}var i=a;u?o??=r&&Se(()=>r(i)):c??=r&&Se(()=>r(i)),y(),n&&z(!0)};!function(t,e=0){var r=Ee(16|e,t,!0);s&&(r.dev_stack=et)}(()=>{l=!1,n(f),l||d(null,null)},i?I:0),H&&(a=L)}function Ur(t,e,r=!1){if(t.multiple){if(null==e)return;if(!a(e))return void(s?console.warn("%c[svelte] select_multiple_invalid_value\n%cThe `value` property of a `<select multiple>` element should be an array, but it received a non-array value. The selection will be kept as is.\nhttps://svelte.dev/e/select_multiple_invalid_value",M,N):console.warn("https://svelte.dev/e/select_multiple_invalid_value"));for(var n of t.options)n.selected=e.includes(Qr(n))}else{for(n of t.options)if(ne(Qr(n),e))return void(n.selected=!0);r&&void 0===e||(t.selectedIndex=-1)}}function xr(t){var e=new MutationObserver(()=>{Ur(t,t.__value)});e.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),function(){const t=Ee(8,null,!1);fr(t,b),t.teardown=()=>{e.disconnect()}}()}function Pr(t,e,r=e){var n=!0;ve(t,"change",e=>{var n,i=e?"[selected]":":checked";if(t.multiple)n=[].map.call(t.querySelectorAll(i),Qr);else{var s=t.querySelector(i)??t.querySelector("option:not([disabled])");n=s&&Qr(s)}r(n)}),Ee(4,()=>{var i=e();if(Ur(t,i,n),n&&void 0===i){var s=t.querySelector(":checked");null!==s&&(i=Qr(s),r(i))}t.__value=i,n=!1},!1),xr(t)}function Qr(t){return"__value"in t?t.__value:t.value}new Map,r(508),new Map([[!0,"yes"],[!1,"no"]]),Symbol("class"),Symbol("style");const _r=Symbol("is custom element"),Rr=Symbol("is html");function Tr(t,e,r,n){var i=Mr(t);H&&(i[e]=t.getAttribute(e),"src"===e||"srcset"===e||"href"===e&&"LINK"===t.nodeName)?n||function(t,e,r){s&&("srcset"===e&&function(t,e){var r=Fr(t.srcset),n=Fr(e);return n.length===r.length&&n.every(([t,e],n)=>e===r[n][1]&&(Or(r[n][0],t)||Or(t,r[n][0])))}(t,r)||Or(t.getAttribute(e)??"",r)||function(t,e,r){s?console.warn(`%c[svelte] hydration_attribute_changed\n%cThe \`${t}\` attribute on \`${e}\` changed its value between server and client renders. The client value, \`${r}\`, will be ignored in favour of the server value\nhttps://svelte.dev/e/hydration_attribute_changed`,M,N):console.warn("https://svelte.dev/e/hydration_attribute_changed")}(e,t.outerHTML.replace(t.innerHTML,t.innerHTML&&"..."),String(r)))}(t,e,r??""):i[e]!==(i[e]=r)&&("loading"===e&&(t[Q]=r),null==r?t.removeAttribute(e):"string"!=typeof r&&function(t){var e,r=t.getAttribute("is")||t.nodeName,n=Nr.get(r);if(n)return n;Nr.set(r,n=[]);for(var i=t,s=Element.prototype;s!==i;){for(var a in e=h(i))e[a].set&&n.push(a);i=p(i)}return n}(t).includes(e)?t[e]=r:t.setAttribute(e,r))}function Mr(t){return t.__attributes??={[_r]:t.nodeName.includes("-"),[Rr]:"http://www.w3.org/1999/xhtml"===t.namespaceURI}}var Nr=new Map;function Or(t,e){return t===e||new URL(t,document.baseURI).href===new URL(e,document.baseURI).href}function Fr(t){return t.split(",").map(t=>t.trim().split(" ").filter(Boolean))}function Lr(t,e,r=e){var n=new WeakSet;ve(t,"input",async i=>{s&&"checkbox"===t.type&&T();var a=i?t.defaultValue:t.value;if(a=Hr(t)?zr(a):a,r(a),null!==Ct&&n.add(Ct),await async function(){await Promise.resolve(),Tt()}(),a!==(a=e())){var o=t.selectionStart,c=t.selectionEnd;t.value=a??"",null!==c&&(t.selectionStart=o,t.selectionEnd=Math.min(c,t.value.length))}}),(H&&t.defaultValue!==t.value||null==ur(e)&&t.value)&&(r(Hr(t)?zr(t.value):t.value),null!==Ct&&n.add(Ct)),Be(()=>{s&&"checkbox"===t.type&&T();var r=e();if(t===document.activeElement){var i=Kt??Ct;if(n.has(i))return}Hr(t)&&r===zr(t.value)||("date"!==t.type||r||t.value)&&r!==t.value&&(t.value=r??"")})}function Hr(t){var e=t.type;return"number"===e||"range"===e}function zr(t){return""===t?null:+t}new Set,new Set,new WeakMap,Symbol();class Gr{#p;#g;constructor(t){var e=new Map,r=(t,r)=>{var n=function(t,e=!1){const r=jt(t);return e||(r.equals=Y),r}(r,!1,!1);return e.set(t,n),n};const n=new Proxy({...t.props||{},$$events:{}},{get:(t,n)=>or(e.get(n)??r(n,Reflect.get(t,n))),has:(t,n)=>n===P||(or(e.get(n)??r(n,Reflect.get(t,n))),Reflect.has(t,n)),set:(t,n,i)=>(qt(e.get(n)??r(n,i),i),Reflect.set(t,n,i))});this.#g=(t.hydrate?Ir:Br)(t.component,{target:t.target,anchor:t.anchor,props:n,context:t.context,intro:t.intro??!1,recover:t.recover}),t?.props?.$$host&&!1!==t.sync||Tt(),this.#p=n.$$events;for(const t of Object.keys(this.#g))"$set"!==t&&"$destroy"!==t&&"$on"!==t&&l(this,t,{get(){return this.#g[t]},set(e){this.#g[t]=e},enumerable:!0});this.#g.$set=t=>{Object.assign(n,t)},this.#g.$destroy=()=>{!function(t,e){const r=Kr.get(t);r?(Kr.delete(t),r(e)):(s&&(s?console.warn("%c[svelte] lifecycle_double_unmount\n%cTried to unmount a component that was not mounted\nhttps://svelte.dev/e/lifecycle_double_unmount",M,N):console.warn("https://svelte.dev/e/lifecycle_double_unmount")),Promise.resolve())}(this.#g)}}$set(t){this.#g.$set(t)}$on(t,e){this.#p[t]=this.#p[t]||[];const r=(...t)=>e.call(this,...t);return this.#p[t].push(r),()=>{this.#p[t]=this.#p[t].filter(t=>t!==r)}}$destroy(){this.#g.$destroy()}}let $r,jr;function Vr(t,e,r,n){const i=r[t]?.type;if(e="Boolean"===i&&"boolean"!=typeof e?null!=e:e,!n||!r[t])return e;if("toAttribute"===n)switch(i){case"Object":case"Array":return null==e?null:JSON.stringify(e);case"Boolean":return e?"":null;case"Number":return null==e?null:e;default:return e}else switch(i){case"Object":case"Array":return e&&JSON.parse(e);case"Boolean":default:return e;case"Number":return null!=e?+e:e}}"function"==typeof HTMLElement&&($r=class extends HTMLElement{$$ctor;$$s;$$c;$$cn=!1;$$d={};$$r=!1;$$p_d={};$$l={};$$l_u=new Map;$$me;constructor(t,e,r){super(),this.$$ctor=t,this.$$s=e,r&&this.attachShadow({mode:"open"})}addEventListener(t,e,r){if(this.$$l[t]=this.$$l[t]||[],this.$$l[t].push(e),this.$$c){const r=this.$$c.$on(t,e);this.$$l_u.set(e,r)}super.addEventListener(t,e,r)}removeEventListener(t,e,r){if(super.removeEventListener(t,e,r),this.$$c){const t=this.$$l_u.get(e);t&&(t(),this.$$l_u.delete(e))}}async connectedCallback(){if(this.$$cn=!0,!this.$$c){if(await Promise.resolve(),!this.$$cn||this.$$c)return;function e(t){return e=>{const r=document.createElement("slot");"default"!==t&&(r.name=t),mr(e,r)}}const r={},n=function(t){const e={};return t.childNodes.forEach(t=>{e[t.slot||"default"]=!0}),e}(this);for(const i of this.$$s)i in n&&("default"!==i||this.$$d.children?r[i]=e(i):(this.$$d.children=e(i),r.default=!0));for(const s of this.attributes){const a=this.$$g_p(s.name);a in this.$$d||(this.$$d[a]=Vr(a,s.value,this.$$p_d,"toProp"))}for(const o in this.$$p_d)o in this.$$d||void 0===this[o]||(this.$$d[o]=this[o],delete this[o]);this.$$c=(t={component:this.$$ctor,target:this.shadowRoot||this,props:{...this.$$d,$$slots:r,$$host:this}},new Gr(t)),this.$$me=function(t){Rt.ensure();const e=Ee(524352,t,!0);return()=>{De(e)}}(()=>{Be(()=>{this.$$r=!0;for(const t of u(this.$$c)){if(!this.$$p_d[t]?.reflect)continue;this.$$d[t]=this.$$c[t];const e=Vr(t,this.$$d[t],this.$$p_d,"toAttribute");null==e?this.removeAttribute(this.$$p_d[t].attribute||t):this.setAttribute(this.$$p_d[t].attribute||t,e)}this.$$r=!1})});for(const c in this.$$l)for(const l of this.$$l[c]){const f=this.$$c.$on(c,l);this.$$l_u.set(l,f)}this.$$l={}}var t}attributeChangedCallback(t,e,r){this.$$r||(t=this.$$g_p(t),this.$$d[t]=Vr(t,r,this.$$p_d,"toProp"),this.$$c?.$set({[t]:this.$$d[t]}))}disconnectedCallback(){this.$$cn=!1,Promise.resolve().then(()=>{!this.$$cn&&this.$$c&&(this.$$c.$destroy(),this.$$me(),this.$$c=void 0)})}$$g_p(t){return u(this.$$p_d).find(e=>this.$$p_d[e].attribute===t||!this.$$p_d[e].attribute&&e.toLowerCase()===t)||t}});let qr=null;function Yr(){return null!==qr&&0!==qr.byteLength||(qr=new Uint8Array(jr.memory.buffer)),qr}let Zr="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};"undefined"!=typeof TextDecoder&&Zr.decode();let Jr=0;function Wr(t,e){return function(t,e){return Jr+=e,Jr>=2146435072&&(Zr="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}},Zr.decode(),Jr=e),Zr.decode(Yr().subarray(t,t+e))}(t>>>=0,e)}let Xr=0;const tn="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},en="function"==typeof tn.encodeInto?function(t,e){return tn.encodeInto(t,e)}:function(t,e){const r=tn.encode(t);return e.set(r),{read:t.length,written:r.length}};function rn(t,e,r){if(void 0===r){const r=tn.encode(t),n=e(r.length,1)>>>0;return Yr().subarray(n,n+r.length).set(r),Xr=r.length,n}let n=t.length,i=e(n,1)>>>0;const s=Yr();let a=0;for(;a<n;a++){const e=t.charCodeAt(a);if(e>127)break;s[i+a]=e}if(a!==n){0!==a&&(t=t.slice(a)),i=r(i,n,n=a+3*t.length,1)>>>0;const e=Yr().subarray(i+a,i+n);a+=en(t,e).written,i=r(i,n,a,1)>>>0}return Xr=a,i}function nn(t){let e,r;try{const n=rn(t,jr.__wbindgen_malloc,jr.__wbindgen_realloc),i=Xr,s=jr.inv_encode(n,i);return e=s[0],r=s[1],Wr(s[0],s[1])}finally{jr.__wbindgen_free(e,r,1)}}function sn(t){let e,r;try{const n=rn(t,jr.__wbindgen_malloc,jr.__wbindgen_realloc),i=Xr,s=jr.inv_decode(n,i);return e=s[0],r=s[1],Wr(s[0],s[1])}finally{jr.__wbindgen_free(e,r,1)}}function an(t){let e,r;try{const n=rn(t,jr.__wbindgen_malloc,jr.__wbindgen_realloc),i=Xr,s=jr.to_base64(n,i);return e=s[0],r=s[1],Wr(s[0],s[1])}finally{jr.__wbindgen_free(e,r,1)}}function on(t){let e,r;try{const s=rn(t,jr.__wbindgen_malloc,jr.__wbindgen_realloc),a=Xr,o=jr.from_base64(s,a);var n=o[0],i=o[1];if(o[3])throw n=0,i=0,function(t){const e=jr.__wbindgen_export_0.get(t);return jr.__externref_table_dealloc(t),e}(o[2]);return e=n,r=i,Wr(n,i)}finally{jr.__wbindgen_free(e,r,1)}}const cn=new Set(["basic","cors","default"]);async function un(t){if(void 0!==jr)return jr;void 0!==t&&(Object.getPrototypeOf(t)===Object.prototype?({module_or_path:t}=t):console.warn("using deprecated parameters for the initialization function; pass a single object instead")),void 0===t&&(t=new URL(r(84),r.b));const e=function(){const t={wbg:{}};return t.wbg.__wbindgen_init_externref_table=function(){const t=jr.__wbindgen_export_0,e=t.grow(4);t.set(0,void 0),t.set(e+0,void 0),t.set(e+1,null),t.set(e+2,!0),t.set(e+3,!1)},t.wbg.__wbindgen_string_new=function(t,e){return Wr(t,e)},t}();("string"==typeof t||"function"==typeof Request&&t instanceof Request||"function"==typeof URL&&t instanceof URL)&&(t=fetch(t));const{instance:n,module:i}=await async function(t,e){if("function"==typeof Response&&t instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(t,e)}catch(e){if(!t.ok||!cn.has(t.type)||"application/wasm"===t.headers.get("Content-Type"))throw e;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",e)}const r=await t.arrayBuffer();return await WebAssembly.instantiate(r,e)}{const r=await WebAssembly.instantiate(t,e);return r instanceof WebAssembly.Instance?{instance:r,module:t}:r}}(await t,e);return function(t,e){return jr=t.exports,un.__wbindgen_wasm_module=e,qr=null,jr.__wbindgen_start(),jr}(n,i)}const ln=un,fn="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function hn(t,e){return e.forEach(function(e){e&&"string"!=typeof e&&!Array.isArray(e)&&Object.keys(e).forEach(function(r){if("default"!==r&&!(r in t)){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})}),Object.freeze(t)}const yn=Symbol("doneWritingPromise"),dn=Symbol("doneWritingResolve"),pn=Symbol("doneWritingReject"),gn=Symbol("readingIndex");class An extends Array{constructor(){super(),Object.setPrototypeOf(this,An.prototype),this[yn]=new Promise((t,e)=>{this[dn]=t,this[pn]=e}),this[yn].catch(()=>{})}}function wn(t){return t&&t.getReader&&Array.isArray(t)}function bn(t){if(!wn(t)){const e=t.getWriter(),r=e.releaseLock;return e.releaseLock=()=>{e.closed.catch(function(){}),r.call(e)},e}this.stream=t}function mn(t){if(wn(t))return"array";if(fn.ReadableStream&&fn.ReadableStream.prototype.isPrototypeOf(t))return"web";if(t&&!(fn.ReadableStream&&t instanceof fn.ReadableStream)&&"function"==typeof t._read&&"object"==typeof t._readableState)throw Error("Native Node streams are no longer supported: please manually convert the stream to a WebStream, using e.g. `stream.Readable.toWeb`");return!(!t||!t.getReader)&&"web-like"}function vn(t){return Uint8Array.prototype.isPrototypeOf(t)}function En(t){if(1===t.length)return t[0];let e=0;for(let r=0;r<t.length;r++){if(!vn(t[r]))throw Error("concatUint8Array: Data must be in the form of a Uint8Array");e+=t[r].length}const r=new Uint8Array(e);let n=0;return t.forEach(function(t){r.set(t,n),n+=t.length}),r}An.prototype.getReader=function(){return void 0===this[gn]&&(this[gn]=0),{read:async()=>(await this[yn],this[gn]===this.length?{value:void 0,done:!0}:{value:this[this[gn]++],done:!1})}},An.prototype.readToEnd=async function(t){await this[yn];const e=t(this.slice(this[gn]));return this.length=0,e},An.prototype.clone=function(){const t=new An;return t[yn]=this[yn].then(()=>{t.push(...this)}),t},bn.prototype.write=async function(t){this.stream.push(t)},bn.prototype.close=async function(){this.stream[dn]()},bn.prototype.abort=async function(t){return this.stream[pn](t),t},bn.prototype.releaseLock=function(){},"object"==typeof fn.process&&fn.process.versions;const kn=new WeakSet,Bn=Symbol("externalBuffer");function In(t){if(this.stream=t,t[Bn]&&(this[Bn]=t[Bn].slice()),wn(t)){const e=t.getReader();return this._read=e.read.bind(e),this._releaseLock=()=>{},void(this._cancel=()=>{})}if(mn(t)){const e=t.getReader();return this._read=e.read.bind(e),this._releaseLock=()=>{e.closed.catch(function(){}),e.releaseLock()},void(this._cancel=e.cancel.bind(e))}let e=!1;this._read=async()=>e||kn.has(t)?{value:void 0,done:!0}:(e=!0,{value:t,done:!1}),this._releaseLock=()=>{if(e)try{kn.add(t)}catch(t){}}}function Sn(t){return mn(t)?t:new ReadableStream({start(e){e.enqueue(t),e.close()}})}function Cn(t){if(mn(t))return t;const e=new An;return(async()=>{const r=zn(e);await r.write(t),await r.close()})(),e}function Kn(t){return t.some(t=>mn(t)&&!wn(t))?function(t){t=t.map(Sn);const e=xn(async function(t){await Promise.all(n.map(e=>Fn(e,t)))});let r=Promise.resolve();const n=t.map((n,i)=>Qn(n,(n,s)=>(r=r.then(()=>Dn(n,e.writable,{preventClose:i!==t.length-1})),r)));return e.readable}(t):t.some(t=>wn(t))?function(t){const e=new An;let r=Promise.resolve();return t.forEach((n,i)=>(r=r.then(()=>Dn(n,e,{preventClose:i!==t.length-1})),r)),e}(t):"string"==typeof t[0]?t.join(""):En(t)}async function Dn(t,e,{preventClose:r=!1,preventAbort:n=!1,preventCancel:i=!1}={}){if(mn(t)&&!wn(t)){t=Sn(t);try{if(t[Bn]){const r=zn(e);for(let e=0;e<t[Bn].length;e++)await r.ready,await r.write(t[Bn][e]);r.releaseLock()}await t.pipeTo(e,{preventClose:r,preventAbort:n,preventCancel:i})}catch(t){}return}const s=Hn(t=Cn(t)),a=zn(e);try{for(;;){await a.ready;const{done:t,value:e}=await s.read();if(t){r||await a.close();break}await a.write(e)}}catch(t){n||await a.abort(t)}finally{s.releaseLock(),a.releaseLock()}}function Un(t,e){const r=new TransformStream(e);return Dn(t,r.writable),r.readable}function xn(t){let e,r,n,i=!1,s=!1;return{readable:new ReadableStream({start(t){n=t},pull(){e?e():i=!0},async cancel(e){s=!0,t&&await t(e),r&&r(e)}},{highWaterMark:0}),writable:new WritableStream({write:async function(t){if(s)throw Error("Stream is cancelled");n.enqueue(t),i?i=!1:(await new Promise((t,n)=>{e=t,r=n}),e=null,r=null)},close:n.close.bind(n),abort:n.error.bind(n)})}}function Pn(t,e=()=>{},r=()=>{}){if(wn(t)){const n=new An;return(async()=>{const i=zn(n);try{const n=await On(t),s=e(n),a=r();let o;o=void 0!==s&&void 0!==a?Kn([s,a]):void 0!==s?s:a,await i.write(o),await i.close()}catch(t){await i.abort(t)}})(),n}if(mn(t))return Un(t,{async transform(t,r){try{const n=await e(t);void 0!==n&&r.enqueue(n)}catch(t){r.error(t)}},async flush(t){try{const e=await r();void 0!==e&&t.enqueue(e)}catch(e){t.error(e)}}});const n=e(t),i=r();return void 0!==n&&void 0!==i?Kn([n,i]):void 0!==n?n:i}function Qn(t,e){if(mn(t)&&!wn(t)){let r;const n=new TransformStream({start(t){r=t}}),i=Dn(t,n.writable),s=xn(async function(t){r.error(t),await i,await new Promise(setTimeout)});return e(n.readable,s.writable),s.readable}t=Cn(t);const r=new An;return e(t,r),r}function _n(t,e){let r;const n=Qn(t,(t,i)=>{const s=Hn(t);s.remainder=()=>(s.releaseLock(),Dn(t,i),n),r=e(s)});return r}function Rn(t){if(wn(t))return t.clone();if(mn(t)){const e=function(t){if(wn(t))throw Error("ArrayStream cannot be tee()d, use clone() instead");if(mn(t)){const e=Sn(t).tee();return e[0][Bn]=e[1][Bn]=t[Bn],e}return[Nn(t),Nn(t)]}(t);return Mn(t,e[0]),e[1]}return Nn(t)}function Tn(t){return wn(t)?Rn(t):mn(t)?new ReadableStream({start(e){const r=Qn(t,async(t,r)=>{const n=Hn(t),i=zn(r);try{for(;;){await i.ready;const{done:r,value:s}=await n.read();if(r){try{e.close()}catch(t){}return void await i.close()}try{e.enqueue(s)}catch(t){}await i.write(s)}}catch(t){e.error(t),await i.abort(t)}});Mn(t,r)}}):Nn(t)}function Mn(t,e){Object.entries(Object.getOwnPropertyDescriptors(t.constructor.prototype)).forEach(([r,n])=>{"constructor"!==r&&(n.value?n.value=n.value.bind(e):n.get=n.get.bind(e),Object.defineProperty(t,r,n))})}function Nn(t,e=0,r=1/0){if(wn(t))throw Error("Not implemented");if(mn(t)){if(e>=0&&r>=0){let n=0;return Un(t,{transform(t,i){n<r?(n+t.length>=e&&i.enqueue(Nn(t,Math.max(e-n,0),r-n)),n+=t.length):i.terminate()}})}if(e<0&&(r<0||r===1/0)){let n=[];return Pn(t,t=>{t.length>=-e?n=[t]:n.push(t)},()=>Nn(Kn(n),e,r))}if(0===e&&r<0){let n;return Pn(t,t=>{const i=n?Kn([n,t]):t;if(i.length>=-r)return n=Nn(i,r),Nn(i,e,r);n=i})}return console.warn(`stream.slice(input, ${e}, ${r}) not implemented efficiently.`),Ln(async()=>Nn(await On(t),e,r))}return t[Bn]&&(t=Kn(t[Bn].concat([t]))),vn(t)?t.subarray(e,r===1/0?t.length:r):t.slice(e,r)}async function On(t,e=Kn){return wn(t)?t.readToEnd(e):mn(t)?Hn(t).readToEnd(e):t}async function Fn(t,e){if(mn(t)){if(t.cancel){const r=await t.cancel(e);return await new Promise(setTimeout),r}if(t.destroy)return t.destroy(e),await new Promise(setTimeout),e}}function Ln(t){const e=new An;return(async()=>{const r=zn(e);try{await r.write(await t()),await r.close()}catch(t){await r.abort(t)}})(),e}function Hn(t){return new In(t)}function zn(t){return new bn(t)}In.prototype.read=async function(){return this[Bn]&&this[Bn].length?{done:!1,value:this[Bn].shift()}:this._read()},In.prototype.releaseLock=function(){this[Bn]&&(this.stream[Bn]=this[Bn]),this._releaseLock()},In.prototype.cancel=function(t){return this._cancel(t)},In.prototype.readLine=async function(){let t,e=[];for(;!t;){let{done:r,value:n}=await this.read();if(n+="",r)return e.length?Kn(e):void 0;const i=n.indexOf("\n")+1;i&&(t=Kn(e.concat(n.substr(0,i))),e=[]),i!==n.length&&e.push(n.substr(i))}return this.unshift(...e),t},In.prototype.readByte=async function(){const{done:t,value:e}=await this.read();if(t)return;const r=e[0];return this.unshift(Nn(e,1)),r},In.prototype.readBytes=async function(t){const e=[];let r=0;for(;;){const{done:n,value:i}=await this.read();if(n)return e.length?Kn(e):void 0;if(e.push(i),r+=i.length,r>=t){const r=Kn(e);return this.unshift(Nn(r,t)),Nn(r,0,t)}}},In.prototype.peekBytes=async function(t){const e=await this.readBytes(t);return this.unshift(e),e},In.prototype.unshift=function(...t){this[Bn]||(this[Bn]=[]),1===t.length&&vn(t[0])&&this[Bn].length&&t[0].length&&this[Bn][0].byteOffset>=t[0].length?this[Bn][0]=new Uint8Array(this[Bn][0].buffer,this[Bn][0].byteOffset-t[0].length,this[Bn][0].byteLength+t[0].length):this[Bn].unshift(...t.filter(t=>t&&t.length))},In.prototype.readToEnd=async function(t=Kn){const e=[];for(;;){const{done:t,value:r}=await this.read();if(t)break;e.push(r)}return t(e)};const Gn=Symbol("byValue");var $n={curve:{nistP256:"nistP256",p256:"nistP256",nistP384:"nistP384",p384:"nistP384",nistP521:"nistP521",p521:"nistP521",secp256k1:"secp256k1",ed25519Legacy:"ed25519Legacy",ed25519:"ed25519Legacy",curve25519Legacy:"curve25519Legacy",curve25519:"curve25519Legacy",brainpoolP256r1:"brainpoolP256r1",brainpoolP384r1:"brainpoolP384r1",brainpoolP512r1:"brainpoolP512r1"},s2k:{simple:0,salted:1,iterated:3,argon2:4,gnu:101},publicKey:{rsaEncryptSign:1,rsaEncrypt:2,rsaSign:3,elgamal:16,dsa:17,ecdh:18,ecdsa:19,eddsaLegacy:22,aedh:23,aedsa:24,x25519:25,x448:26,ed25519:27,ed448:28},symmetric:{idea:1,tripledes:2,cast5:3,blowfish:4,aes128:7,aes192:8,aes256:9,twofish:10},compression:{uncompressed:0,zip:1,zlib:2,bzip2:3},hash:{md5:1,sha1:2,ripemd:3,sha256:8,sha384:9,sha512:10,sha224:11,sha3_256:12,sha3_512:14},webHash:{"SHA-1":2,"SHA-256":8,"SHA-384":9,"SHA-512":10},aead:{eax:1,ocb:2,gcm:3,experimentalGCM:100},packet:{publicKeyEncryptedSessionKey:1,signature:2,symEncryptedSessionKey:3,onePassSignature:4,secretKey:5,publicKey:6,secretSubkey:7,compressedData:8,symmetricallyEncryptedData:9,marker:10,literalData:11,trust:12,userID:13,publicSubkey:14,userAttribute:17,symEncryptedIntegrityProtectedData:18,modificationDetectionCode:19,aeadEncryptedData:20,padding:21},literal:{binary:98,text:116,utf8:117,mime:109},signature:{binary:0,text:1,standalone:2,certGeneric:16,certPersona:17,certCasual:18,certPositive:19,certRevocation:48,subkeyBinding:24,keyBinding:25,key:31,keyRevocation:32,subkeyRevocation:40,timestamp:64,thirdParty:80},signatureSubpacket:{signatureCreationTime:2,signatureExpirationTime:3,exportableCertification:4,trustSignature:5,regularExpression:6,revocable:7,keyExpirationTime:9,placeholderBackwardsCompatibility:10,preferredSymmetricAlgorithms:11,revocationKey:12,issuerKeyID:16,notationData:20,preferredHashAlgorithms:21,preferredCompressionAlgorithms:22,keyServerPreferences:23,preferredKeyServer:24,primaryUserID:25,policyURI:26,keyFlags:27,signersUserID:28,reasonForRevocation:29,features:30,signatureTarget:31,embeddedSignature:32,issuerFingerprint:33,preferredAEADAlgorithms:34,preferredCipherSuites:39},keyFlags:{certifyKeys:1,signData:2,encryptCommunication:4,encryptStorage:8,splitPrivateKey:16,authentication:32,sharedPrivateKey:128},armor:{multipartSection:0,multipartLast:1,signed:2,message:3,publicKey:4,privateKey:5,signature:6},reasonForRevocation:{noReason:0,keySuperseded:1,keyCompromised:2,keyRetired:3,userIDInvalid:32},features:{modificationDetection:1,aead:2,v5Keys:4,seipdv2:8},write:function(t,e){if("number"==typeof e&&(e=this.read(t,e)),void 0!==t[e])return t[e];throw Error("Invalid enum value.")},read:function(t,e){if(t[Gn]||(t[Gn]=[],Object.entries(t).forEach(([e,r])=>{t[Gn][r]=e})),void 0!==t[Gn][e])return t[Gn][e];throw Error("Invalid enum value.")}},jn={preferredHashAlgorithm:$n.hash.sha512,preferredSymmetricAlgorithm:$n.symmetric.aes256,preferredCompressionAlgorithm:$n.compression.uncompressed,aeadProtect:!1,parseAEADEncryptedV4KeysAsLegacy:!1,preferredAEADAlgorithm:$n.aead.gcm,aeadChunkSizeByte:12,v6Keys:!1,enableParsingV5Entities:!1,s2kType:$n.s2k.iterated,s2kIterationCountByte:224,s2kArgon2Params:{passes:3,parallelism:4,memoryExponent:16},allowUnauthenticatedMessages:!1,allowUnauthenticatedStream:!1,minRSABits:2047,passwordCollisionCheck:!1,allowInsecureDecryptionWithSigningKeys:!1,allowInsecureVerificationWithReformattedKeys:!1,allowMissingKeyFlags:!1,constantTimePKCS1Decryption:!1,constantTimePKCS1DecryptionSupportedSymmetricAlgorithms:new Set([$n.symmetric.aes128,$n.symmetric.aes192,$n.symmetric.aes256]),ignoreUnsupportedPackets:!0,ignoreMalformedPackets:!1,enforceGrammar:!0,additionalAllowedPackets:[],showVersion:!1,showComment:!1,versionString:"OpenPGP.js 6.2.2",commentString:"https://openpgpjs.org",maxUserIDLength:5120,knownNotations:[],nonDeterministicSignaturesViaNotation:!0,useEllipticFallback:!0,rejectHashAlgorithms:new Set([$n.hash.md5,$n.hash.ripemd]),rejectMessageHashAlgorithms:new Set([$n.hash.md5,$n.hash.ripemd,$n.hash.sha1]),rejectPublicKeyAlgorithms:new Set([$n.publicKey.elgamal,$n.publicKey.dsa]),rejectCurves:new Set([$n.curve.secp256k1])};const Vn=(()=>{try{return!1}catch(t){}return!1})(),qn={isString:function(t){return"string"==typeof t||t instanceof String},nodeRequire:()=>{},isArray:function(t){return t instanceof Array},isUint8Array:vn,isStream:mn,getNobleCurve:async(t,e)=>{if(!jn.useEllipticFallback)throw Error("This curve is only supported in the full build of OpenPGP.js");const{nobleCurves:r}=await Promise.resolve().then(function(){return Gy});switch(t){case $n.publicKey.ecdh:case $n.publicKey.ecdsa:{const t=r.get(e);if(!t)throw Error("Unsupported curve");return t}case $n.publicKey.x448:return r.get("x448");case $n.publicKey.ed448:return r.get("ed448");default:throw Error("Unsupported curve")}},readNumber:function(t){let e=0;for(let r=0;r<t.length;r++)e+=256**r*t[t.length-1-r];return e},writeNumber:function(t,e){const r=new Uint8Array(e);for(let n=0;n<e;n++)r[n]=t>>8*(e-n-1)&255;return r},readDate:function(t){const e=qn.readNumber(t);return new Date(1e3*e)},writeDate:function(t){const e=Math.floor(t.getTime()/1e3);return qn.writeNumber(e,4)},normalizeDate:function(t=Date.now()){return null===t||t===1/0?t:new Date(1e3*Math.floor(+t/1e3))},readMPI:function(t){const e=7+(t[0]<<8|t[1])>>>3;return qn.readExactSubarray(t,2,2+e)},readExactSubarray:function(t,e,r){if(t.length<r-e)throw Error("Input array too short");return t.subarray(e,r)},leftPad(t,e){if(t.length>e)throw Error("Input array too long");const r=new Uint8Array(e),n=e-t.length;return r.set(t,n),r},uint8ArrayToMPI:function(t){const e=qn.uint8ArrayBitLength(t);if(0===e)throw Error("Zero MPI");const r=t.subarray(t.length-Math.ceil(e/8)),n=new Uint8Array([(65280&e)>>8,255&e]);return qn.concatUint8Array([n,r])},uint8ArrayBitLength:function(t){let e;for(e=0;e<t.length&&0===t[e];e++);if(e===t.length)return 0;const r=t.subarray(e);return 8*(r.length-1)+qn.nbits(r[0])},hexToUint8Array:function(t){const e=new Uint8Array(t.length>>1);for(let r=0;r<t.length>>1;r++)e[r]=parseInt(t.substr(r<<1,2),16);return e},uint8ArrayToHex:function(t){const e="0123456789abcdef";let r="";return t.forEach(t=>{r+=e[t>>4]+e[15&t]}),r},stringToUint8Array:function(t){return Pn(t,t=>{if(!qn.isString(t))throw Error("stringToUint8Array: Data must be in the form of a string");const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e})},uint8ArrayToString:function(t){const e=[],r=16384,n=(t=new Uint8Array(t)).length;for(let i=0;i<n;i+=r)e.push(String.fromCharCode.apply(String,t.subarray(i,i+r<n?i+r:n)));return e.join("")},encodeUTF8:function(t){const e=new TextEncoder("utf-8");function r(t,r=!1){return e.encode(t,{stream:!r})}return Pn(t,r,()=>r("",!0))},decodeUTF8:function(t){const e=new TextDecoder("utf-8");function r(t,r=!1){return e.decode(t,{stream:!r})}return Pn(t,r,()=>r(new Uint8Array,!0))},concat:Kn,concatUint8Array:En,equalsUint8Array:function(t,e){if(!qn.isUint8Array(t)||!qn.isUint8Array(e))throw Error("Data must be in the form of a Uint8Array");if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0},findLastIndex:function(t,e){for(let r=t.length;r>=0;r--)if(e(t[r],r,t))return r;return-1},writeChecksum:function(t){let e=0;for(let r=0;r<t.length;r++)e=e+t[r]&65535;return qn.writeNumber(e,2)},printDebug:function(t){Vn&&console.log("[OpenPGP.js debug]",t)},printDebugError:function(t){Vn&&console.error("[OpenPGP.js debug]",t)},nbits:function(t){let e=1,r=t>>>16;return 0!==r&&(t=r,e+=16),r=t>>8,0!==r&&(t=r,e+=8),r=t>>4,0!==r&&(t=r,e+=4),r=t>>2,0!==r&&(t=r,e+=2),r=t>>1,0!==r&&(t=r,e+=1),e},double:function(t){const e=new Uint8Array(t.length),r=t.length-1;for(let n=0;n<r;n++)e[n]=t[n]<<1^t[n+1]>>7;return e[r]=t[r]<<1^135*(t[0]>>7),e},shiftRight:function(t,e){if(e)for(let r=t.length-1;r>=0;r--)t[r]>>=e,r>0&&(t[r]|=t[r-1]<<8-e);return t},getWebCrypto:function(){const t=void 0!==fn&&fn.crypto&&fn.crypto.subtle||this.getNodeCrypto()?.webcrypto.subtle;if(!t)throw Error("The WebCrypto API is not available");return t},getNodeCrypto:function(){return this.nodeRequire("crypto")},getNodeZlib:function(){return this.nodeRequire("zlib")},getNodeBuffer:function(){return(this.nodeRequire("buffer")||{}).Buffer},getHardwareConcurrency:function(){return"undefined"!=typeof navigator?navigator.hardwareConcurrency||1:this.nodeRequire("os").cpus().length},isEmailAddress:function(t){return!!qn.isString(t)&&/^[^\p{C}\p{Z}@<>\\]+@[^\p{C}\p{Z}@<>\\]+[^\p{C}\p{Z}\p{P}]$/u.test(t)},canonicalizeEOL:function(t){let e=!1;return Pn(t,t=>{let r;e&&(t=qn.concatUint8Array([new Uint8Array([13]),t])),13===t[t.length-1]?(e=!0,t=t.subarray(0,-1)):e=!1;const n=[];for(let e=0;r=t.indexOf(10,e)+1,r;e=r)13!==t[r-2]&&n.push(r);if(!n.length)return t;const i=new Uint8Array(t.length+n.length);let s=0;for(let e=0;e<n.length;e++){const r=t.subarray(n[e-1]||0,n[e]);i.set(r,s),s+=r.length,i[s-1]=13,i[s]=10,s++}return i.set(t.subarray(n[n.length-1]||0),s),i},()=>e?new Uint8Array([13]):void 0)},nativeEOL:function(t){let e=!1;return Pn(t,t=>{let r;13===(t=e&&10!==t[0]?qn.concatUint8Array([new Uint8Array([13]),t]):new Uint8Array(t))[t.length-1]?(e=!0,t=t.subarray(0,-1)):e=!1;let n=0;for(let e=0;e!==t.length;e=r){r=t.indexOf(13,e)+1,r||(r=t.length);const i=r-(10===t[r]?1:0);e&&t.copyWithin(n,e,i),n+=i-e}return t.subarray(0,n)},()=>e?new Uint8Array([13]):void 0)},removeTrailingSpaces:function(t){return t.split("\n").map(t=>{let e=t.length-1;for(;e>=0&&(" "===t[e]||"\t"===t[e]||"\r"===t[e]);e--);return t.substr(0,e+1)}).join("\n")},wrapError:function(t,e){if(!e)return t instanceof Error?t:Error(t);if(t instanceof Error){try{t.message+=": "+e.message,t.cause=e}catch(t){}return t}return Error(t+": "+e.message,{cause:e})},constructAllowedPackets:function(t){const e={};return t.forEach(t=>{if(!t.tag)throw Error("Invalid input: expected a packet class");e[t.tag]=t}),e},anyPromise:function(t){return new Promise(async(e,r)=>{let n;await Promise.all(t.map(async t=>{try{e(await t)}catch(t){n=t}})),r(n)})},selectUint8Array:function(t,e,r){const n=Math.max(e.length,r.length),i=new Uint8Array(n);let s=0;for(let n=0;n<i.length;n++)i[n]=e[n]&256-t|r[n]&255+t,s+=t&n<e.length|1-t&n<r.length;return i.subarray(0,s)},selectUint8:function(t,e,r){return e&256-t|r&255+t},isAES:function(t){return t===$n.symmetric.aes128||t===$n.symmetric.aes192||t===$n.symmetric.aes256}},Yn=qn.getNodeBuffer();let Zn,Jn;function Wn(t){let e=new Uint8Array;return Pn(t,t=>{e=qn.concatUint8Array([e,t]);const r=[],n=Math.floor(e.length/45),i=45*n,s=Zn(e.subarray(0,i));for(let t=0;t<n;t++)r.push(s.substr(60*t,60)),r.push("\n");return e=e.subarray(i),r.join("")},()=>e.length?Zn(e)+"\n":"")}function Xn(t){let e="";return Pn(t,t=>{e+=t;let r=0;const n=[" ","\t","\r","\n"];for(let t=0;t<n.length;t++){const i=n[t];for(let t=e.indexOf(i);-1!==t;t=e.indexOf(i,t+1))r++}let i=e.length;for(;i>0&&(i-r)%4!=0;i--)n.includes(e[i])&&r--;const s=Jn(e.substr(0,i));return e=e.substr(i),s},()=>Jn(e))}function ti(t){return Xn(t.replace(/-/g,"+").replace(/_/g,"/"))}function ei(t,e){let r=Wn(t).replace(/[\r\n]/g,"");return r=r.replace(/[+]/g,"-").replace(/[/]/g,"_").replace(/[=]/g,""),r}function ri(t){const e=t.match(/^-----BEGIN PGP (MESSAGE, PART \d+\/\d+|MESSAGE, PART \d+|SIGNED MESSAGE|MESSAGE|PUBLIC KEY BLOCK|PRIVATE KEY BLOCK|SIGNATURE)-----$/m);if(!e)throw Error("Unknown ASCII armor type");return/MESSAGE, PART \d+\/\d+/.test(e[1])?$n.armor.multipartSection:/MESSAGE, PART \d+/.test(e[1])?$n.armor.multipartLast:/SIGNED MESSAGE/.test(e[1])?$n.armor.signed:/MESSAGE/.test(e[1])?$n.armor.message:/PUBLIC KEY BLOCK/.test(e[1])?$n.armor.publicKey:/PRIVATE KEY BLOCK/.test(e[1])?$n.armor.privateKey:/SIGNATURE/.test(e[1])?$n.armor.signature:void 0}function ni(t,e){let r="";return e.showVersion&&(r+="Version: "+e.versionString+"\n"),e.showComment&&(r+="Comment: "+e.commentString+"\n"),t&&(r+="Comment: "+t+"\n"),r+="\n",r}function ii(t){const e=function(t){let e=13501623;return Pn(t,t=>{const r=ai?Math.floor(t.length/4):0,n=new Uint32Array(t.buffer,t.byteOffset,r);for(let t=0;t<r;t++)e^=n[t],e=si[0][e>>24&255]^si[1][e>>16&255]^si[2][e>>8&255]^si[3][255&e];for(let n=4*r;n<t.length;n++)e=e>>8^si[0][255&e^t[n]]},()=>new Uint8Array([e,e>>8,e>>16]))}(t);return Wn(e)}Yn?(Zn=t=>Yn.from(t).toString("base64"),Jn=t=>{const e=Yn.from(t,"base64");return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}):(Zn=t=>btoa(qn.uint8ArrayToString(t)),Jn=t=>qn.stringToUint8Array(atob(t)));const si=[Array(255),Array(255),Array(255),Array(255)];for(let kg=0;kg<=255;kg++){let Bg=kg<<16;for(let Ig=0;Ig<8;Ig++)Bg=Bg<<1^(8388608&Bg?8801531:0);si[0][kg]=(16711680&Bg)>>16|65280&Bg|(255&Bg)<<16}for(let Sg=0;Sg<=255;Sg++)si[1][Sg]=si[0][Sg]>>8^si[0][255&si[0][Sg]];for(let Cg=0;Cg<=255;Cg++)si[2][Cg]=si[1][Cg]>>8^si[0][255&si[1][Cg]];for(let Kg=0;Kg<=255;Kg++)si[3][Kg]=si[2][Kg]>>8^si[0][255&si[2][Kg]];const ai=function(){const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,255,!0),255===new Int16Array(t)[0]}();function oi(t){for(let e=0;e<t.length;e++)/^([^\s:]|[^\s:][^:]*[^\s:]): .+$/.test(t[e])||qn.printDebugError(Error("Improperly formatted armor header: "+t[e])),/^(Version|Comment|MessageID|Hash|Charset): .+$/.test(t[e])||qn.printDebugError(Error("Unknown header: "+t[e]))}function ci(t){let e=t;const r=t.lastIndexOf("=");return r>=0&&r!==t.length-1&&(e=t.slice(0,r)),e}function ui(t){return new Promise(async(e,r)=>{try{const n=/^-----[^-]+-----$/m,i=/^[ \f\r\t\u00a0\u2000-\u200a\u202f\u205f\u3000]*$/;let s;const a=[];let o,c,u=a,l=[];const f=Xn(Qn(t,async(t,h)=>{const y=Hn(t);try{for(;;){let t=await y.readLine();if(void 0===t)throw Error("Misformed armored text");if(t=qn.removeTrailingSpaces(t.replace(/[\r\n]/g,"")),s)if(o)c||s!==$n.armor.signed||(n.test(t)?(l=l.join("\r\n"),c=!0,oi(u),u=[],o=!1):l.push(t.replace(/^- /,"")));else if(n.test(t)&&r(Error("Mandatory blank line missing between armor headers and armor data")),i.test(t)){if(oi(u),o=!0,c||s!==$n.armor.signed){e({text:l,data:f,headers:a,type:s});break}}else u.push(t);else n.test(t)&&(s=ri(t))}}catch(t){return void r(t)}const d=zn(h);try{for(;;){await d.ready;const{done:t,value:e}=await y.read();if(t)throw Error("Misformed armored text");const r=e+"";if(-1!==r.indexOf("=")||-1!==r.indexOf("-")){let t=await y.readToEnd();t.length||(t=""),t=r+t,t=qn.removeTrailingSpaces(t.replace(/\r/g,""));const e=t.split(n);if(1===e.length)throw Error("Misformed armored text");const i=ci(e[0].slice(0,-1));await d.write(i);break}await d.write(r)}await d.ready,await d.close()}catch(t){await d.abort(t)}}))}catch(t){r(t)}}).then(async t=>(wn(t.data)&&(t.data=await On(t.data)),t))}function li(t,e,r,n,i,s=!1,a=jn){let o,c;t===$n.armor.signed&&(o=e.text,c=e.hash,e=e.data);const u=s&&Tn(e),l=[];switch(t){case $n.armor.multipartSection:l.push("-----BEGIN PGP MESSAGE, PART "+r+"/"+n+"-----\n"),l.push(ni(i,a)),l.push(Wn(e)),u&&l.push("=",ii(u)),l.push("-----END PGP MESSAGE, PART "+r+"/"+n+"-----\n");break;case $n.armor.multipartLast:l.push("-----BEGIN PGP MESSAGE, PART "+r+"-----\n"),l.push(ni(i,a)),l.push(Wn(e)),u&&l.push("=",ii(u)),l.push("-----END PGP MESSAGE, PART "+r+"-----\n");break;case $n.armor.signed:l.push("-----BEGIN PGP SIGNED MESSAGE-----\n"),l.push(c?`Hash: ${c}\n\n`:"\n"),l.push(o.replace(/^-/gm,"- -")),l.push("\n-----BEGIN PGP SIGNATURE-----\n"),l.push(ni(i,a)),l.push(Wn(e)),u&&l.push("=",ii(u)),l.push("-----END PGP SIGNATURE-----\n");break;case $n.armor.message:l.push("-----BEGIN PGP MESSAGE-----\n"),l.push(ni(i,a)),l.push(Wn(e)),u&&l.push("=",ii(u)),l.push("-----END PGP MESSAGE-----\n");break;case $n.armor.publicKey:l.push("-----BEGIN PGP PUBLIC KEY BLOCK-----\n"),l.push(ni(i,a)),l.push(Wn(e)),u&&l.push("=",ii(u)),l.push("-----END PGP PUBLIC KEY BLOCK-----\n");break;case $n.armor.privateKey:l.push("-----BEGIN PGP PRIVATE KEY BLOCK-----\n"),l.push(ni(i,a)),l.push(Wn(e)),u&&l.push("=",ii(u)),l.push("-----END PGP PRIVATE KEY BLOCK-----\n");break;case $n.armor.signature:l.push("-----BEGIN PGP SIGNATURE-----\n"),l.push(ni(i,a)),l.push(Wn(e)),u&&l.push("=",ii(u)),l.push("-----END PGP SIGNATURE-----\n")}return qn.concat(l)}const fi=BigInt(0),hi=BigInt(1);function yi(t){const e="0123456789ABCDEF";let r="";return t.forEach(t=>{r+=e[t>>4]+e[15&t]}),BigInt("0x0"+r)}function di(t,e){const r=t%e;return r<fi?r+e:r}function pi(t,e,r){if(r===fi)throw Error("Modulo cannot be zero");if(r===hi)return BigInt(0);if(e<fi)throw Error("Unsopported negative exponent");let n=e,i=t;i%=r;let s=BigInt(1);for(;n>fi;){const t=n&hi;n>>=hi,s=t?s*i%r:s,i=i*i%r}return s}function gi(t){return t>=fi?t:-t}function Ai(t,e){const{gcd:r,x:n}=function(t,e){let r=BigInt(0),n=BigInt(1),i=BigInt(1),s=BigInt(0),a=gi(t),o=gi(e);const c=t<fi,u=e<fi;for(;o!==fi;){const t=a/o;let e=r;r=i-t*r,i=e,e=n,n=s-t*n,s=e,e=o,o=a%o,a=e}return{x:c?-i:i,y:u?-s:s,gcd:a}}(t,e);if(r!==hi)throw Error("Inverse does not exist");return di(n+e,e)}function wi(t){const e=t<fi?BigInt(-1):fi,r=BigInt(8);let n=1,i=t;for(;(i>>=r)!==e;)n++;return n}function bi(t,e="be",r){let n=t.toString(16);n.length%2==1&&(n="0"+n);const i=n.length/2,s=new Uint8Array(r||i),a=r?r-i:0;let o=0;for(;o<i;)s[o+a]=parseInt(n.slice(2*o,2*o+2),16),o++;return"be"!==e&&s.reverse(),s}const mi=qn.getNodeCrypto();function vi(t){const e="undefined"!=typeof crypto?crypto:mi?.webcrypto;if(e?.getRandomValues){const r=new Uint8Array(t);return e.getRandomValues(r)}throw Error("No secure random number generator available.")}function Ei(t,e){if(e<t)throw Error("Illegal parameter value: max <= min");const r=e-t;return di(yi(vi(wi(r)+8)),r)+t}BigInt(1),[7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999,3001,3011,3019,3023,3037,3041,3049,3061,3067,3079,3083,3089,3109,3119,3121,3137,3163,3167,3169,3181,3187,3191,3203,3209,3217,3221,3229,3251,3253,3257,3259,3271,3299,3301,3307,3313,3319,3323,3329,3331,3343,3347,3359,3361,3371,3373,3389,3391,3407,3413,3433,3449,3457,3461,3463,3467,3469,3491,3499,3511,3517,3527,3529,3533,3539,3541,3547,3557,3559,3571,3581,3583,3593,3607,3613,3617,3623,3631,3637,3643,3659,3671,3673,3677,3691,3697,3701,3709,3719,3727,3733,3739,3761,3767,3769,3779,3793,3797,3803,3821,3823,3833,3847,3851,3853,3863,3877,3881,3889,3907,3911,3917,3919,3923,3929,3931,3943,3947,3967,3989,4001,4003,4007,4013,4019,4021,4027,4049,4051,4057,4073,4079,4091,4093,4099,4111,4127,4129,4133,4139,4153,4157,4159,4177,4201,4211,4217,4219,4229,4231,4241,4243,4253,4259,4261,4271,4273,4283,4289,4297,4327,4337,4339,4349,4357,4363,4373,4391,4397,4409,4421,4423,4441,4447,4451,4457,4463,4481,4483,4493,4507,4513,4517,4519,4523,4547,4549,4561,4567,4583,4591,4597,4603,4621,4637,4639,4643,4649,4651,4657,4663,4673,4679,4691,4703,4721,4723,4729,4733,4751,4759,4783,4787,4789,4793,4799,4801,4813,4817,4831,4861,4871,4877,4889,4903,4909,4919,4931,4933,4937,4943,4951,4957,4967,4969,4973,4987,4993,4999].map(t=>BigInt(t));const ki=qn.getWebCrypto(),Bi=qn.getNodeCrypto(),Ii=Bi&&Bi.getHashes();function Si(t){if(Bi&&Ii.includes(t))return async function(e){const r=Bi.createHash(t);return Pn(e,t=>{r.update(t)},()=>new Uint8Array(r.digest()))}}function Ci(t,e){const r=async()=>{const{nobleHashes:e}=await Promise.resolve().then(function(){return Ad}),r=e.get(t);if(!r)throw Error("Unsupported hash");return r};return async function(t){if(wn(t)&&(t=await On(t)),qn.isStream(t)){const e=(await r()).create();return Pn(t,t=>{e.update(t)},()=>e.digest())}return ki&&e?new Uint8Array(await ki.digest(e,t)):(await r())(t)}}const Ki=Si("md5")||Ci("md5"),Di=Si("sha1")||Ci("sha1","SHA-1"),Ui=Si("sha224")||Ci("sha224"),xi=Si("sha256")||Ci("sha256","SHA-256"),Pi=Si("sha384")||Ci("sha384","SHA-384"),Qi=Si("sha512")||Ci("sha512","SHA-512"),_i=Si("ripemd160")||Ci("ripemd160"),Ri=Si("sha3-256")||Ci("sha3_256"),Ti=Si("sha3-512")||Ci("sha3_512");function Mi(t,e){switch(t){case $n.hash.md5:return Ki(e);case $n.hash.sha1:return Di(e);case $n.hash.ripemd:return _i(e);case $n.hash.sha256:return xi(e);case $n.hash.sha384:return Pi(e);case $n.hash.sha512:return Qi(e);case $n.hash.sha224:return Ui(e);case $n.hash.sha3_256:return Ri(e);case $n.hash.sha3_512:return Ti(e);default:throw Error("Unsupported hash function")}}function Ni(t){switch(t){case $n.hash.md5:return 16;case $n.hash.sha1:case $n.hash.ripemd:return 20;case $n.hash.sha256:return 32;case $n.hash.sha384:return 48;case $n.hash.sha512:return 64;case $n.hash.sha224:return 28;case $n.hash.sha3_256:return 32;case $n.hash.sha3_512:return 64;default:throw Error("Invalid hash algorithm.")}}const Oi=[];function Fi(t,e){const r=t.length;if(r>e-11)throw Error("Message too long");const n=function(t){const e=new Uint8Array(t);let r=0;for(;r<t;){const n=vi(t-r);for(let t=0;t<n.length;t++)0!==n[t]&&(e[r++]=n[t])}return e}(e-r-3),i=new Uint8Array(e);return i[1]=2,i.set(n,2),i.set(t,e-r),i}function Li(t,e){let r=2,n=1;for(let e=r;e<t.length;e++)n&=0!==t[e],r+=n;const i=r-2,s=t.subarray(r+1),a=0===t[0]&2===t[1]&i>=8&!n;if(e)return qn.selectUint8Array(a,s,e);if(a)return s;throw Error("Decryption error")}function Hi(t,e,r){let n;if(e.length!==Ni(t))throw Error("Invalid hash length");const i=new Uint8Array(Oi[t].length);for(n=0;n<Oi[t].length;n++)i[n]=Oi[t][n];const s=i.length+e.length;if(r<s+11)throw Error("Intended encoded message length too short");const a=new Uint8Array(r-s-3).fill(255),o=new Uint8Array(r);return o[1]=1,o.set(a,2),o.set(i,r-s),o.set(e,r-e.length),o}Oi[1]=[48,32,48,12,6,8,42,134,72,134,247,13,2,5,5,0,4,16],Oi[2]=[48,33,48,9,6,5,43,14,3,2,26,5,0,4,20],Oi[3]=[48,33,48,9,6,5,43,36,3,2,1,5,0,4,20],Oi[8]=[48,49,48,13,6,9,96,134,72,1,101,3,4,2,1,5,0,4,32],Oi[9]=[48,65,48,13,6,9,96,134,72,1,101,3,4,2,2,5,0,4,48],Oi[10]=[48,81,48,13,6,9,96,134,72,1,101,3,4,2,3,5,0,4,64],Oi[11]=[48,45,48,13,6,9,96,134,72,1,101,3,4,2,4,5,0,4,28];const zi=qn.getWebCrypto(),Gi=qn.getNodeCrypto(),$i=BigInt(1);async function ji(t,e,r,n,i,s,a,o,c){if(Ni(t)>=r.length)throw Error("Digest size cannot exceed key modulus size");if(e&&!qn.isStream(e))if(qn.getWebCrypto())try{return await async function(t,e,r,n,i,s,a,o){const c=await qi(r,n,i,s,a,o),u={name:"RSASSA-PKCS1-v1_5",hash:{name:t}},l=await zi.importKey("jwk",c,u,!1,["sign"]);return new Uint8Array(await zi.sign("RSASSA-PKCS1-v1_5",l,e))}($n.read($n.webHash,t),e,r,n,i,s,a,o)}catch(t){qn.printDebugError(t)}else if(qn.getNodeCrypto())return async function(t,e,r,n,i,s,a,o){const c=Gi.createSign($n.read($n.hash,t));c.write(e),c.end();const u=await qi(r,n,i,s,a,o);return new Uint8Array(c.sign({key:u,format:"jwk",type:"pkcs1"}))}(t,e,r,n,i,s,a,o);return async function(t,e,r,n){return e=yi(e),bi(pi(yi(Hi(t,n,wi(e))),r=yi(r),e),"be",wi(e))}(t,r,i,c)}async function Vi(t,e,r){return qn.getNodeCrypto()?async function(t,e,r){const n={key:Yi(e,r),format:"jwk",type:"pkcs1",padding:Gi.constants.RSA_PKCS1_PADDING};return new Uint8Array(Gi.publicEncrypt(n,t))}(t,e,r):async function(t,e,r){if(e=yi(e),t=yi(Fi(t,wi(e))),r=yi(r),t>=e)throw Error("Message size cannot exceed modulus size");return bi(pi(t,r,e),"be",wi(e))}(t,e,r)}async function qi(t,e,r,n,i,s){const a=yi(n),o=yi(i),c=yi(r);let u=di(c,o-$i),l=di(c,a-$i);return l=bi(l),u=bi(u),{kty:"RSA",n:ei(t),e:ei(e),d:ei(r),p:ei(i),q:ei(n),dp:ei(u),dq:ei(l),qi:ei(s),ext:!0}}function Yi(t,e){return{kty:"RSA",n:ei(t),e:ei(e),ext:!0}}const Zi=BigInt(1),Ji={"2a8648ce3d030107":$n.curve.nistP256,"2b81040022":$n.curve.nistP384,"2b81040023":$n.curve.nistP521,"2b8104000a":$n.curve.secp256k1,"2b06010401da470f01":$n.curve.ed25519Legacy,"2b060104019755010501":$n.curve.curve25519Legacy,"2b2403030208010107":$n.curve.brainpoolP256r1,"2b240303020801010b":$n.curve.brainpoolP384r1,"2b240303020801010d":$n.curve.brainpoolP512r1};class Wi{constructor(t){if(t instanceof Wi)this.oid=t.oid;else if(qn.isArray(t)||qn.isUint8Array(t)){if(6===(t=new Uint8Array(t))[0]){if(t[1]!==t.length-2)throw Error("Length mismatch in DER encoded oid");t=t.subarray(2)}this.oid=t}else this.oid=""}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.oid=t.subarray(1,1+e),1+this.oid.length}throw Error("Invalid oid")}write(){return qn.concatUint8Array([new Uint8Array([this.oid.length]),this.oid])}toHex(){return qn.uint8ArrayToHex(this.oid)}getName(){const t=Ji[this.toHex()];if(!t)throw Error("Unknown curve object identifier.");return t}}function Xi(t){let e,r=0;const n=t[0];return n<192?([r]=t,e=1):n<255?(r=(t[0]-192<<8)+t[1]+192,e=2):255===n&&(r=qn.readNumber(t.subarray(1,5)),e=5),{len:r,offset:e}}function ts(t){return t<192?new Uint8Array([t]):t>191&&t<8384?new Uint8Array([192+(t-192>>8),t-192&255]):qn.concatUint8Array([new Uint8Array([255]),qn.writeNumber(t,4)])}function es(t){if(t<0||t>30)throw Error("Partial Length power must be between 1 and 30");return new Uint8Array([224+t])}function rs(t){return new Uint8Array([192|t])}function ns(t,e){return qn.concatUint8Array([rs(t),ts(e)])}function is(t){return[$n.packet.literalData,$n.packet.compressedData,$n.packet.symmetricallyEncryptedData,$n.packet.symEncryptedIntegrityProtectedData,$n.packet.aeadEncryptedData].includes(t)}async function ss(t,e,r){let n,i;try{const s=await t.peekBytes(2);if(!s||s.length<2||!(128&s[0]))throw Error("Error during parsing. This message / key probably does not conform to a valid OpenPGP format.");const a=await t.readByte();let o,c,u=-1,l=-1;l=0,64&a&&(l=1),l?u=63&a:(u=(63&a)>>2,c=3&a);const f=is(u);let h,y=null;if(e&&f){if("array"===e){const t=new An;n=zn(t),y=t}else{const t=new TransformStream;n=zn(t.writable),y=t.readable}i=r({tag:u,packet:y})}else y=[];do{if(l){const e=await t.readByte();if(h=!1,e<192)o=e;else if(e>=192&&e<224)o=(e-192<<8)+await t.readByte()+192;else if(e>223&&e<255){if(o=1<<(31&e),h=!0,!f)throw new TypeError("This packet type does not support partial lengths.")}else o=await t.readByte()<<24|await t.readByte()<<16|await t.readByte()<<8|await t.readByte()}else switch(c){case 0:o=await t.readByte();break;case 1:o=await t.readByte()<<8|await t.readByte();break;case 2:o=await t.readByte()<<24|await t.readByte()<<16|await t.readByte()<<8|await t.readByte();break;default:o=1/0}if(o>0){let e=0;for(;;){n&&await n.ready;const{done:r,value:i}=await t.read();if(r){if(o===1/0)break;throw Error("Unexpected end of packet")}const s=o===1/0?i:i.subarray(0,o-e);if(n?await n.write(s):y.push(s),e+=i.length,e>=o){t.unshift(i.subarray(o-e+i.length));break}}}}while(h);n?(await n.ready,await n.close()):(y=qn.concatUint8Array(y),await r({tag:u,packet:y}))}catch(t){if(n)return await n.abort(t),!0;throw t}finally{n&&await i}}class as extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,as),this.name="UnsupportedError"}}class os extends as{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,as),this.name="UnknownPacketError"}}class cs extends as{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,as),this.name="MalformedPacketError"}}class us{constructor(t,e){this.tag=t,this.rawContent=e}write(){return this.rawContent}}async function ls(t,e,r,n,i,s){if(Ni(e)<Ni(ys(t)))throw Error("Hash algorithm too weak for EdDSA.");switch(t){case $n.publicKey.ed25519:try{const e=qn.getWebCrypto(),r=ps(t,n,i),a=await e.importKey("jwk",r,"Ed25519",!1,["sign"]);return{RS:new Uint8Array(await e.sign("Ed25519",a,s))}}catch(t){if("NotSupportedError"!==t.name)throw t;const{default:e}=await Promise.resolve().then(function(){return op}),r=qn.concatUint8Array([i,n]);return{RS:e.sign.detached(s,r)}}case $n.publicKey.ed448:return{RS:(await qn.getNobleCurve($n.publicKey.ed448)).sign(s,i)};default:throw Error("Unsupported EdDSA algorithm")}}async function fs(t,e,{RS:r},n,i,s){if(Ni(e)<Ni(ys(t)))throw Error("Hash algorithm too weak for EdDSA.");switch(t){case $n.publicKey.ed25519:try{const e=qn.getWebCrypto(),n=ds(t,i),a=await e.importKey("jwk",n,"Ed25519",!1,["verify"]);return await e.verify("Ed25519",a,r,s)}catch(t){if("NotSupportedError"!==t.name)throw t;const{default:e}=await Promise.resolve().then(function(){return op});return e.sign.detached.verify(s,r,i)}case $n.publicKey.ed448:return(await qn.getNobleCurve($n.publicKey.ed448)).verify(r,s,i);default:throw Error("Unsupported EdDSA algorithm")}}function hs(t){switch(t){case $n.publicKey.ed25519:return 32;case $n.publicKey.ed448:return 57;default:throw Error("Unsupported EdDSA algorithm")}}function ys(t){switch(t){case $n.publicKey.ed25519:return $n.hash.sha256;case $n.publicKey.ed448:return $n.hash.sha512;default:throw Error("Unknown EdDSA algo")}}const ds=(t,e)=>{if(t===$n.publicKey.ed25519)return{kty:"OKP",crv:"Ed25519",x:ei(e),ext:!0};throw Error("Unsupported EdDSA algorithm")},ps=(t,e,r)=>{if(t===$n.publicKey.ed25519){const n=ds(t,e);return n.d=ei(r),n}throw Error("Unsupported EdDSA algorithm")};function gs(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function As(t,...e){if(!gs(t))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error("Uint8Array expected of length "+e+", got length="+t.length)}function ws(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function bs(t,e){As(t);const r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function ms(t){return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function vs(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Es(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function ks(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}const Bs=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])();function Is(t){if("string"==typeof t)t=function(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}(t);else{if(!gs(t))throw Error("Uint8Array expected, got "+typeof t);t=Qs(t)}return t}function Ss(t,e){return t.buffer===e.buffer&&t.byteOffset<e.byteOffset+e.byteLength&&e.byteOffset<t.byteOffset+t.byteLength}function Cs(t,e){if(Ss(t,e)&&t.byteOffset<e.byteOffset)throw Error("complex overlap of input and output is not supported")}function Ks(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return 0===r}const Ds=(t,e)=>{function r(r,...n){if(As(r),!Bs)throw Error("Non little-endian hardware is not yet supported");if(void 0!==t.nonceLength){const e=n[0];if(!e)throw Error("nonce / iv required");t.varSizeNonce?As(e):As(e,t.nonceLength)}const i=t.tagLength;i&&void 0!==n[1]&&As(n[1]);const s=e(r,...n),a=(t,e)=>{if(void 0!==e){if(2!==t)throw Error("cipher output not supported");As(e)}};let o=!1;return{encrypt(t,e){if(o)throw Error("cannot encrypt() twice with same key + nonce");return o=!0,As(t),a(s.encrypt.length,e),s.encrypt(t,e)},decrypt(t,e){if(As(t),i&&t.length<i)throw Error("invalid ciphertext length: smaller than tagLength="+i);return a(s.decrypt.length,e),s.decrypt(t,e)}}}return Object.assign(r,t),r};function Us(t,e,r=!0){if(void 0===e)return new Uint8Array(t);if(e.length!==t)throw Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!Ps(e))throw Error("invalid output, must be aligned");return e}function xs(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s);t.setUint32(e+0,a,n),t.setUint32(e+4,o,n)}function Ps(t){return t.byteOffset%4==0}function Qs(t){return Uint8Array.from(t)}const _s=16,Rs=new Uint8Array(16),Ts=vs(Rs),Ms=t=>(t>>>0&255)<<24|(t>>>8&255)<<16|(t>>>16&255)<<8|t>>>24&255;class Ns{constructor(t,e){this.blockLen=_s,this.outputLen=_s,this.s0=0,this.s1=0,this.s2=0,this.s3=0,this.finished=!1,As(t=Is(t),16);const r=ks(t);let n=r.getUint32(0,!1),i=r.getUint32(4,!1),s=r.getUint32(8,!1),a=r.getUint32(12,!1);const o=[];for(let t=0;t<128;t++)o.push({s0:Ms(n),s1:Ms(i),s2:Ms(s),s3:Ms(a)}),({s0:n,s1:i,s2:s,s3:a}={s3:(l=s)<<31|(f=a)>>>1,s2:(u=i)<<31|l>>>1,s1:(c=n)<<31|u>>>1,s0:c>>>1^225<<24&-(1&f)});var c,u,l,f;const h=(y=e||1024)>65536?8:y>1024?4:2;var y;if(![1,2,4,8].includes(h))throw Error("ghash: invalid window size, expected 2, 4 or 8");this.W=h;const d=128/h,p=this.windowSize=2**h,g=[];for(let t=0;t<d;t++)for(let e=0;e<p;e++){let r=0,n=0,i=0,s=0;for(let a=0;a<h;a++){if(!(e>>>h-a-1&1))continue;const{s0:c,s1:u,s2:l,s3:f}=o[h*t+a];r^=c,n^=u,i^=l,s^=f}g.push({s0:r,s1:n,s2:i,s3:s})}this.t=g}_updateBlock(t,e,r,n){t^=this.s0,e^=this.s1,r^=this.s2,n^=this.s3;const{W:i,t:s,windowSize:a}=this;let o=0,c=0,u=0,l=0;const f=(1<<i)-1;let h=0;for(const y of[t,e,r,n])for(let t=0;t<4;t++){const e=y>>>8*t&255;for(let t=8/i-1;t>=0;t--){const r=e>>>i*t&f,{s0:n,s1:y,s2:d,s3:p}=s[h*a+r];o^=n,c^=y,u^=d,l^=p,h+=1}}this.s0=o,this.s1=c,this.s2=u,this.s3=l}update(t){ws(this),As(t=Is(t));const e=vs(t),r=Math.floor(t.length/_s),n=t.length%_s;for(let t=0;t<r;t++)this._updateBlock(e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]);return n&&(Rs.set(t.subarray(r*_s)),this._updateBlock(Ts[0],Ts[1],Ts[2],Ts[3]),Es(Ts)),this}destroy(){const{t}=this;for(const e of t)e.s0=0,e.s1=0,e.s2=0,e.s3=0}digestInto(t){ws(this),bs(t,this),this.finished=!0;const{s0:e,s1:r,s2:n,s3:i}=this,s=vs(t);return s[0]=e,s[1]=r,s[2]=n,s[3]=i,t}digest(){const t=new Uint8Array(_s);return this.digestInto(t),this.destroy(),t}}class Os extends Ns{constructor(t,e){As(t=Is(t));const r=function(t){t.reverse();const e=1&t[15];let r=0;for(let e=0;e<t.length;e++){const n=t[e];t[e]=n>>>1|r,r=(1&n)<<7}return t[0]^=225&-e,t}(Qs(t));super(r,e),Es(r)}update(t){t=Is(t),ws(this);const e=vs(t),r=t.length%_s,n=Math.floor(t.length/_s);for(let t=0;t<n;t++)this._updateBlock(Ms(e[4*t+3]),Ms(e[4*t+2]),Ms(e[4*t+1]),Ms(e[4*t+0]));return r&&(Rs.set(t.subarray(n*_s)),this._updateBlock(Ms(Ts[3]),Ms(Ts[2]),Ms(Ts[1]),Ms(Ts[0])),Es(Ts)),this}digestInto(t){ws(this),bs(t,this),this.finished=!0;const{s0:e,s1:r,s2:n,s3:i}=this,s=vs(t);return s[0]=e,s[1]=r,s[2]=n,s[3]=i,t.reverse()}}function Fs(t){const e=(e,r)=>t(r,e.length).update(Is(e)).digest(),r=t(new Uint8Array(16),0);return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=(e,r)=>t(e,r),e}const Ls=Fs((t,e)=>new Ns(t,e));Fs((t,e)=>new Os(t,e));const Hs=16,zs=new Uint8Array(Hs);function Gs(t){return t<<1^283&-(t>>7)}function $s(t,e){let r=0;for(;e>0;e>>=1)r^=t&-(1&e),t=Gs(t);return r}const js=(()=>{const t=new Uint8Array(256);for(let e=0,r=1;e<256;e++,r^=Gs(r))t[e]=r;const e=new Uint8Array(256);e[0]=99;for(let r=0;r<255;r++){let n=t[255-r];n|=n<<8,e[t[r]]=255&(n^n>>4^n>>5^n>>6^n>>7^99)}return Es(t),e})(),Vs=js.map((t,e)=>js.indexOf(e)),qs=t=>t<<8|t>>>24,Ys=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;function Zs(t,e){if(256!==t.length)throw Error("Wrong sbox length");const r=new Uint32Array(256).map((r,n)=>e(t[n])),n=r.map(qs),i=n.map(qs),s=i.map(qs),a=new Uint32Array(65536),o=new Uint32Array(65536),c=new Uint16Array(65536);for(let e=0;e<256;e++)for(let u=0;u<256;u++){const l=256*e+u;a[l]=r[e]^n[u],o[l]=i[e]^s[u],c[l]=t[e]<<8|t[u]}return{sbox:t,sbox2:c,T0:r,T1:n,T2:i,T3:s,T01:a,T23:o}}const Js=Zs(js,t=>$s(t,3)<<24|t<<16|t<<8|$s(t,2)),Ws=Zs(Vs,t=>$s(t,11)<<24|$s(t,13)<<16|$s(t,9)<<8|$s(t,14)),Xs=(()=>{const t=new Uint8Array(16);for(let e=0,r=1;e<16;e++,r=Gs(r))t[e]=r;return t})();function ta(t){As(t);const e=t.length;if(![16,24,32].includes(e))throw Error("aes: invalid key size, should be 16, 24 or 32, got "+e);const{sbox2:r}=Js,n=[];Ps(t)||n.push(t=Qs(t));const i=vs(t),s=i.length,a=t=>na(r,t,t,t,t),o=new Uint32Array(e+28);o.set(i);for(let t=s;t<o.length;t++){let e=o[t-1];t%s==0?e=a((c=e)<<24|c>>>8)^Xs[t/s-1]:s>6&&t%s==4&&(e=a(e)),o[t]=o[t-s]^e}var c;return Es(...n),o}function ea(t){const e=ta(t),r=e.slice(),n=e.length,{sbox2:i}=Js,{T0:s,T1:a,T2:o,T3:c}=Ws;for(let t=0;t<n;t+=4)for(let i=0;i<4;i++)r[t+i]=e[n-t-4+i];Es(e);for(let t=4;t<n-4;t++){const e=r[t],n=na(i,e,e,e,e);r[t]=s[255&n]^a[n>>>8&255]^o[n>>>16&255]^c[n>>>24]}return r}function ra(t,e,r,n,i,s){return t[r<<8&65280|n>>>8&255]^e[i>>>8&65280|s>>>24&255]}function na(t,e,r,n,i){return t[255&e|65280&r]|t[n>>>16&255|i>>>16&65280]<<16}function ia(t,e,r,n,i){const{sbox2:s,T01:a,T23:o}=Js;let c=0;e^=t[c++],r^=t[c++],n^=t[c++],i^=t[c++];const u=t.length/4-2;for(let s=0;s<u;s++){const s=t[c++]^ra(a,o,e,r,n,i),u=t[c++]^ra(a,o,r,n,i,e),l=t[c++]^ra(a,o,n,i,e,r),f=t[c++]^ra(a,o,i,e,r,n);e=s,r=u,n=l,i=f}return{s0:t[c++]^na(s,e,r,n,i),s1:t[c++]^na(s,r,n,i,e),s2:t[c++]^na(s,n,i,e,r),s3:t[c++]^na(s,i,e,r,n)}}function sa(t,e,r,n,i){const{sbox2:s,T01:a,T23:o}=Ws;let c=0;e^=t[c++],r^=t[c++],n^=t[c++],i^=t[c++];const u=t.length/4-2;for(let s=0;s<u;s++){const s=t[c++]^ra(a,o,e,i,n,r),u=t[c++]^ra(a,o,r,e,i,n),l=t[c++]^ra(a,o,n,r,e,i),f=t[c++]^ra(a,o,i,n,r,e);e=s,r=u,n=l,i=f}return{s0:t[c++]^na(s,e,i,n,r),s1:t[c++]^na(s,r,e,i,n),s2:t[c++]^na(s,n,r,e,i),s3:t[c++]^na(s,i,n,r,e)}}function aa(t,e,r,n){As(e,Hs),As(r);const i=r.length;Cs(r,n=Us(i,n));const s=e,a=vs(s);let{s0:o,s1:c,s2:u,s3:l}=ia(t,a[0],a[1],a[2],a[3]);const f=vs(r),h=vs(n);for(let e=0;e+4<=f.length;e+=4){h[e+0]=f[e+0]^o,h[e+1]=f[e+1]^c,h[e+2]=f[e+2]^u,h[e+3]=f[e+3]^l;let r=1;for(let t=s.length-1;t>=0;t--)r=r+(255&s[t])|0,s[t]=255&r,r>>>=8;({s0:o,s1:c,s2:u,s3:l}=ia(t,a[0],a[1],a[2],a[3]))}const y=Hs*Math.floor(f.length/4);if(y<i){const t=new Uint32Array([o,c,u,l]),e=ms(t);for(let t=y,s=0;t<i;t++,s++)n[t]=r[t]^e[s];Es(t)}return n}function oa(t,e,r,n,i){As(r,Hs),As(n),i=Us(n.length,i);const s=r,a=vs(s),o=ks(s),c=vs(n),u=vs(i),l=e?0:12,f=n.length;let h=o.getUint32(l,e),{s0:y,s1:d,s2:p,s3:g}=ia(t,a[0],a[1],a[2],a[3]);for(let r=0;r+4<=c.length;r+=4)u[r+0]=c[r+0]^y,u[r+1]=c[r+1]^d,u[r+2]=c[r+2]^p,u[r+3]=c[r+3]^g,h=h+1>>>0,o.setUint32(l,h,e),({s0:y,s1:d,s2:p,s3:g}=ia(t,a[0],a[1],a[2],a[3]));const A=Hs*Math.floor(c.length/4);if(A<f){const t=new Uint32Array([y,d,p,g]),e=ms(t);for(let t=A,r=0;t<f;t++,r++)i[t]=n[t]^e[r];Es(t)}return i}const ca=Ds({blockSize:16,nonceLength:16},function(t,e){function r(r,n){if(As(r),void 0!==n&&(As(n),!Ps(n)))throw Error("unaligned destination");const i=ta(t),s=Qs(e),a=[i,s];Ps(r)||a.push(r=Qs(r));const o=aa(i,s,r,n);return Es(...a),o}return{encrypt:(t,e)=>r(t,e),decrypt:(t,e)=>r(t,e)}}),ua=Ds({blockSize:16,nonceLength:16},function(t,e,r={}){const n=!r.disablePadding;return{encrypt(r,i){const s=ta(t),{b:a,o,out:c}=function(t,e,r){As(t);let n=t.length;const i=n%Hs;if(!e&&0!==i)throw Error("aec/(cbc-ecb): unpadded plaintext with disabled padding");Ps(t)||(t=Qs(t));const s=vs(t);if(e){let t=Hs-i;t||(t=Hs),n+=t}return Cs(t,r=Us(n,r)),{b:s,o:vs(r),out:r}}(r,n,i);let u=e;const l=[s];Ps(u)||l.push(u=Qs(u));const f=vs(u);let h=f[0],y=f[1],d=f[2],p=f[3],g=0;for(;g+4<=a.length;)h^=a[g+0],y^=a[g+1],d^=a[g+2],p^=a[g+3],({s0:h,s1:y,s2:d,s3:p}=ia(s,h,y,d,p)),o[g++]=h,o[g++]=y,o[g++]=d,o[g++]=p;if(n){const t=function(t){const e=new Uint8Array(16),r=vs(e);e.set(t);const n=Hs-t.length;for(let t=Hs-n;t<Hs;t++)e[t]=n;return r}(r.subarray(4*g));h^=t[0],y^=t[1],d^=t[2],p^=t[3],({s0:h,s1:y,s2:d,s3:p}=ia(s,h,y,d,p)),o[g++]=h,o[g++]=y,o[g++]=d,o[g++]=p}return Es(...l),c},decrypt(r,i){!function(t){if(As(t),t.length%Hs!=0)throw Error("aes-(cbc/ecb).decrypt ciphertext should consist of blocks with size 16")}(r);const s=ea(t);let a=e;const o=[s];Ps(a)||o.push(a=Qs(a));const c=vs(a);i=Us(r.length,i),Ps(r)||o.push(r=Qs(r)),Cs(r,i);const u=vs(r),l=vs(i);let f=c[0],h=c[1],y=c[2],d=c[3];for(let t=0;t+4<=u.length;){const e=f,r=h,n=y,i=d;f=u[t+0],h=u[t+1],y=u[t+2],d=u[t+3];const{s0:a,s1:o,s2:c,s3:p}=sa(s,f,h,y,d);l[t++]=a^e,l[t++]=o^r,l[t++]=c^n,l[t++]=p^i}return Es(...o),function(t,e){if(!e)return t;const r=t.length;if(!r)throw Error("aes/pcks5: empty ciphertext not allowed");const n=t[r-1];if(n<=0||n>16)throw Error("aes/pcks5: wrong padding");const i=t.subarray(0,-n);for(let e=0;e<n;e++)if(t[r-e-1]!==n)throw Error("aes/pcks5: wrong padding");return i}(i,n)}}}),la=Ds({blockSize:16,nonceLength:16},function(t,e){function r(r,n,i){As(r);const s=r.length;if(Ss(r,i=Us(s,i)))throw Error("overlapping src and dst not supported.");const a=ta(t);let o=e;const c=[a];Ps(o)||c.push(o=Qs(o)),Ps(r)||c.push(r=Qs(r));const u=vs(r),l=vs(i),f=n?l:u,h=vs(o);let y=h[0],d=h[1],p=h[2],g=h[3];for(let t=0;t+4<=u.length;){const{s0:e,s1:r,s2:n,s3:i}=ia(a,y,d,p,g);l[t+0]=u[t+0]^e,l[t+1]=u[t+1]^r,l[t+2]=u[t+2]^n,l[t+3]=u[t+3]^i,y=f[t++],d=f[t++],p=f[t++],g=f[t++]}const A=Hs*Math.floor(u.length/4);if(A<s){({s0:y,s1:d,s2:p,s3:g}=ia(a,y,d,p,g));const t=ms(new Uint32Array([y,d,p,g]));for(let e=A,n=0;e<s;e++,n++)i[e]=r[e]^t[n];Es(t)}return Es(...c),i}return{encrypt:(t,e)=>r(t,!0,e),decrypt:(t,e)=>r(t,!1,e)}}),fa=Ds({blockSize:16,nonceLength:12,tagLength:16,varSizeNonce:!0},function(t,e,r){if(e.length<8)throw Error("aes/gcm: invalid nonce length");function n(t,e,n){const i=function(t,e,r,n,i){const s=i?i.length:0,a=t.create(r,n.length+s);i&&a.update(i);const o=function(t,e,r){const n=new Uint8Array(16),i=ks(n);return xs(i,0,BigInt(e),r),xs(i,8,BigInt(t),r),n}(8*n.length,8*s,!1);a.update(n),a.update(o);const c=a.digest();return Es(o),c}(Ls,0,t,n,r);for(let t=0;t<e.length;t++)i[t]^=e[t];return i}function i(){const r=ta(t),n=zs.slice(),i=zs.slice();if(oa(r,!1,i,i,n),12===e.length)i.set(e);else{const t=zs.slice();xs(ks(t),8,BigInt(8*e.length),!1);const r=Ls.create(n).update(e).update(t);r.digestInto(i),r.destroy()}return{xk:r,authKey:n,counter:i,tagMask:oa(r,!1,i,zs)}}return{encrypt(t){const{xk:e,authKey:r,counter:s,tagMask:a}=i(),o=new Uint8Array(t.length+16),c=[e,r,s,a];Ps(t)||c.push(t=Qs(t)),oa(e,!1,s,t,o.subarray(0,t.length));const u=n(r,a,o.subarray(0,o.length-16));return c.push(u),o.set(u,t.length),Es(...c),o},decrypt(t){const{xk:e,authKey:r,counter:s,tagMask:a}=i(),o=[e,r,a,s];Ps(t)||o.push(t=Qs(t));const c=t.subarray(0,-16),u=t.subarray(-16),l=n(r,a,c);if(o.push(l),!Ks(l,u))throw Error("aes/gcm: invalid ghash tag");const f=oa(e,!1,s,c);return Es(...o),f}}});function ha(t){return t instanceof Uint32Array||ArrayBuffer.isView(t)&&"Uint32Array"===t.constructor.name}function ya(t,e){if(As(e,16),!ha(t))throw Error("_encryptBlock accepts result of expandKeyLE");const r=vs(e);let{s0:n,s1:i,s2:s,s3:a}=ia(t,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=i,r[2]=s,r[3]=a,e}function da(t,e){if(As(e,16),!ha(t))throw Error("_decryptBlock accepts result of expandKeyLE");const r=vs(e);let{s0:n,s1:i,s2:s,s3:a}=sa(t,r[0],r[1],r[2],r[3]);return r[0]=n,r[1]=i,r[2]=s,r[3]=a,e}const pa={encrypt(t,e){if(e.length>=2**32)throw Error("plaintext should be less than 4gb");const r=ta(t);if(16===e.length)ya(r,e);else{const t=vs(e);let n=t[0],i=t[1];for(let e=0,s=1;e<6;e++)for(let e=2;e<t.length;e+=2,s++){const{s0:a,s1:o,s2:c,s3:u}=ia(r,n,i,t[e],t[e+1]);n=a,i=o^Ys(s),t[e]=c,t[e+1]=u}t[0]=n,t[1]=i}r.fill(0)},decrypt(t,e){if(e.length-8>=2**32)throw Error("ciphertext should be less than 4gb");const r=ea(t),n=e.length/8-1;if(1===n)da(r,e);else{const t=vs(e);let i=t[0],s=t[1];for(let e=0,a=6*n;e<6;e++)for(let e=2*n;e>=1;e-=2,a--){s^=Ys(a);const{s0:n,s1:o,s2:c,s3:u}=sa(r,i,s,t[e],t[e+1]);i=n,s=o,t[e]=c,t[e+1]=u}t[0]=i,t[1]=s}r.fill(0)}},ga=new Uint8Array(8).fill(166),Aa=Ds({blockSize:8},t=>({encrypt(e){if(!e.length||e.length%8!=0)throw Error("invalid plaintext length");if(8===e.length)throw Error("8-byte keys not allowed in AESKW, use AESKWP instead");const r=function(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];As(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}(ga,e);return pa.encrypt(t,r),r},decrypt(e){if(e.length%8!=0||e.length<24)throw Error("invalid ciphertext length");const r=Qs(e);if(pa.decrypt(t,r),!Ks(r.subarray(0,8),ga))throw Error("integrity check failed");return r.subarray(0,8).fill(0),r.subarray(8)}})),wa={expandKeyLE:ta,expandKeyDecLE:ea,encrypt:ia,decrypt:sa,encryptBlock:ya,decryptBlock:da,ctrCounter:aa,ctr32:oa};async function ba(t){switch(t){case $n.symmetric.aes128:case $n.symmetric.aes192:case $n.symmetric.aes256:throw Error("Not a legacy cipher");case $n.symmetric.cast5:case $n.symmetric.blowfish:case $n.symmetric.twofish:case $n.symmetric.tripledes:{const{legacyCiphers:e}=await Promise.resolve().then(function(){return Ep}),r=$n.read($n.symmetric,t),n=e.get(r);if(!n)throw Error("Unsupported cipher algorithm");return n}default:throw Error("Unsupported cipher algorithm")}}function ma(t){switch(t){case $n.symmetric.aes128:case $n.symmetric.aes192:case $n.symmetric.aes256:case $n.symmetric.twofish:return 16;case $n.symmetric.blowfish:case $n.symmetric.cast5:case $n.symmetric.tripledes:return 8;default:throw Error("Unsupported cipher")}}function va(t){switch(t){case $n.symmetric.aes128:case $n.symmetric.blowfish:case $n.symmetric.cast5:return 16;case $n.symmetric.aes192:case $n.symmetric.tripledes:return 24;case $n.symmetric.aes256:case $n.symmetric.twofish:return 32;default:throw Error("Unsupported cipher")}}function Ea(t){return{keySize:va(t),blockSize:ma(t)}}const ka=qn.getWebCrypto();async function Ba(t,e,r){const{keySize:n}=Ea(t);if(!qn.isAES(t)||e.length!==n)throw Error("Unexpected algorithm or key size");try{const t=await ka.importKey("raw",e,{name:"AES-KW"},!1,["wrapKey"]),n=await ka.importKey("raw",r,{name:"HMAC",hash:"SHA-256"},!0,["sign"]),i=await ka.wrapKey("raw",n,t,{name:"AES-KW"});return new Uint8Array(i)}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;qn.printDebugError("Browser did not support operation: "+t.message)}return Aa(e).encrypt(r)}async function Ia(t,e,r){const{keySize:n}=Ea(t);if(!qn.isAES(t)||e.length!==n)throw Error("Unexpected algorithm or key size");let i;try{i=await ka.importKey("raw",e,{name:"AES-KW"},!1,["unwrapKey"])}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;return qn.printDebugError("Browser did not support operation: "+t.message),Aa(e).decrypt(r)}try{const t=await ka.unwrapKey("raw",r,i,{name:"AES-KW"},{name:"HMAC",hash:"SHA-256"},!0,["sign"]);return new Uint8Array(await ka.exportKey("raw",t))}catch(t){if("OperationError"===t.name)throw Error("Key Data Integrity failed");throw t}}async function Sa(t,e,r,n,i){const s=qn.getWebCrypto(),a=$n.read($n.webHash,t);if(!a)throw Error("Hash algo not supported with HKDF");const o=await s.importKey("raw",e,"HKDF",!1,["deriveBits"]),c=await s.deriveBits({name:"HKDF",hash:a,salt:r,info:n},o,8*i);return new Uint8Array(c)}const Ca={x25519:qn.encodeUTF8("OpenPGP X25519"),x448:qn.encodeUTF8("OpenPGP X448")};function Ka(t){switch(t){case $n.publicKey.x25519:return 32;case $n.publicKey.x448:return 56;default:throw Error("Unsupported ECDH algorithm")}}async function Da(t,e){switch(t){case $n.publicKey.x25519:try{const r=qn.getWebCrypto(),n=await r.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(t=>{if("OperationError"===t.name){const t=Error("Unexpected key generation issue");throw t.name="NotSupportedError",t}throw t}),i=await r.exportKey("jwk",n.publicKey);if((await r.exportKey("jwk",n.privateKey)).x!==i.x){const t=Error("Unexpected mismatching public point");throw t.name="NotSupportedError",t}const s=Pa(t,e),a=await r.importKey("jwk",s,"X25519",!1,[]),o=await r.deriveBits({name:"X25519",public:a},n.privateKey,8*Ka(t));return{sharedSecret:new Uint8Array(o),ephemeralPublicKey:new Uint8Array(ti(i.x))}}catch(t){if("NotSupportedError"!==t.name)throw t;const{default:r}=await Promise.resolve().then(function(){return op}),{secretKey:n,publicKey:i}=r.box.keyPair(),s=r.scalarMult(n,e);return xa(s),{ephemeralPublicKey:i,sharedSecret:s}}case $n.publicKey.x448:{const t=await qn.getNobleCurve($n.publicKey.x448),{secretKey:r,publicKey:n}=t.keygen(),i=t.getSharedSecret(r,e);return xa(i),{ephemeralPublicKey:n,sharedSecret:i}}default:throw Error("Unsupported ECDH algorithm")}}async function Ua(t,e,r,n){switch(t){case $n.publicKey.x25519:try{const i=qn.getWebCrypto(),s=function(t,e,r){if(t===$n.publicKey.x25519){const n=Pa(t,e);return n.d=ei(r),n}throw Error("Unsupported ECDH algorithm")}(t,r,n),a=Pa(t,e),o=await i.importKey("jwk",s,"X25519",!1,["deriveKey","deriveBits"]),c=await i.importKey("jwk",a,"X25519",!1,[]),u=await i.deriveBits({name:"X25519",public:c},o,8*Ka(t));return new Uint8Array(u)}catch(t){if("NotSupportedError"!==t.name)throw t;const{default:r}=await Promise.resolve().then(function(){return op}),i=r.scalarMult(n,e);return xa(i),i}case $n.publicKey.x448:{const t=(await qn.getNobleCurve($n.publicKey.x448)).getSharedSecret(n,e);return xa(t),t}default:throw Error("Unsupported ECDH algorithm")}}function xa(t){let e=0;for(let r=0;r<t.length;r++)e|=t[r];if(0===e)throw Error("Unexpected low order point")}function Pa(t,e){if(t===$n.publicKey.x25519)return{kty:"OKP",crv:"X25519",x:ei(e),ext:!0};throw Error("Unsupported ECDH algorithm")}const Qa=qn.getWebCrypto(),_a=qn.getNodeCrypto(),Ra={[$n.curve.nistP256]:"P-256",[$n.curve.nistP384]:"P-384",[$n.curve.nistP521]:"P-521"},Ta=_a?_a.getCurves():[],Ma=_a?{[$n.curve.secp256k1]:Ta.includes("secp256k1")?"secp256k1":void 0,[$n.curve.nistP256]:Ta.includes("prime256v1")?"prime256v1":void 0,[$n.curve.nistP384]:Ta.includes("secp384r1")?"secp384r1":void 0,[$n.curve.nistP521]:Ta.includes("secp521r1")?"secp521r1":void 0,[$n.curve.ed25519Legacy]:Ta.includes("ED25519")?"ED25519":void 0,[$n.curve.curve25519Legacy]:Ta.includes("X25519")?"X25519":void 0,[$n.curve.brainpoolP256r1]:Ta.includes("brainpoolP256r1")?"brainpoolP256r1":void 0,[$n.curve.brainpoolP384r1]:Ta.includes("brainpoolP384r1")?"brainpoolP384r1":void 0,[$n.curve.brainpoolP512r1]:Ta.includes("brainpoolP512r1")?"brainpoolP512r1":void 0}:{},Na={[$n.curve.nistP256]:{oid:[6,8,42,134,72,206,61,3,1,7],keyType:$n.publicKey.ecdsa,hash:$n.hash.sha256,cipher:$n.symmetric.aes128,node:Ma[$n.curve.nistP256],web:Ra[$n.curve.nistP256],payloadSize:32,sharedSize:256,wireFormatLeadingByte:4},[$n.curve.nistP384]:{oid:[6,5,43,129,4,0,34],keyType:$n.publicKey.ecdsa,hash:$n.hash.sha384,cipher:$n.symmetric.aes192,node:Ma[$n.curve.nistP384],web:Ra[$n.curve.nistP384],payloadSize:48,sharedSize:384,wireFormatLeadingByte:4},[$n.curve.nistP521]:{oid:[6,5,43,129,4,0,35],keyType:$n.publicKey.ecdsa,hash:$n.hash.sha512,cipher:$n.symmetric.aes256,node:Ma[$n.curve.nistP521],web:Ra[$n.curve.nistP521],payloadSize:66,sharedSize:528,wireFormatLeadingByte:4},[$n.curve.secp256k1]:{oid:[6,5,43,129,4,0,10],keyType:$n.publicKey.ecdsa,hash:$n.hash.sha256,cipher:$n.symmetric.aes128,node:Ma[$n.curve.secp256k1],payloadSize:32,wireFormatLeadingByte:4},[$n.curve.ed25519Legacy]:{oid:[6,9,43,6,1,4,1,218,71,15,1],keyType:$n.publicKey.eddsaLegacy,hash:$n.hash.sha512,node:!1,payloadSize:32,wireFormatLeadingByte:64},[$n.curve.curve25519Legacy]:{oid:[6,10,43,6,1,4,1,151,85,1,5,1],keyType:$n.publicKey.ecdh,hash:$n.hash.sha256,cipher:$n.symmetric.aes128,node:!1,payloadSize:32,wireFormatLeadingByte:64},[$n.curve.brainpoolP256r1]:{oid:[6,9,43,36,3,3,2,8,1,1,7],keyType:$n.publicKey.ecdsa,hash:$n.hash.sha256,cipher:$n.symmetric.aes128,node:Ma[$n.curve.brainpoolP256r1],payloadSize:32,wireFormatLeadingByte:4},[$n.curve.brainpoolP384r1]:{oid:[6,9,43,36,3,3,2,8,1,1,11],keyType:$n.publicKey.ecdsa,hash:$n.hash.sha384,cipher:$n.symmetric.aes192,node:Ma[$n.curve.brainpoolP384r1],payloadSize:48,wireFormatLeadingByte:4},[$n.curve.brainpoolP512r1]:{oid:[6,9,43,36,3,3,2,8,1,1,13],keyType:$n.publicKey.ecdsa,hash:$n.hash.sha512,cipher:$n.symmetric.aes256,node:Ma[$n.curve.brainpoolP512r1],payloadSize:64,wireFormatLeadingByte:4}};class Oa{constructor(t){try{this.name=t instanceof Wi?t.getName():$n.write($n.curve,t)}catch(t){throw new as("Unknown curve")}const e=Na[this.name];this.keyType=e.keyType,this.oid=e.oid,this.hash=e.hash,this.cipher=e.cipher,this.node=e.node,this.web=e.web,this.payloadSize=e.payloadSize,this.sharedSize=e.sharedSize,this.wireFormatLeadingByte=e.wireFormatLeadingByte,this.web&&qn.getWebCrypto()?this.type="web":this.node&&qn.getNodeCrypto()?this.type="node":this.name===$n.curve.curve25519Legacy?this.type="curve25519Legacy":this.name===$n.curve.ed25519Legacy&&(this.type="ed25519Legacy")}async genKeyPair(){switch(this.type){case"web":try{return await async function(t,e){const r=await Qa.generateKey({name:"ECDSA",namedCurve:Ra[t]},!0,["sign","verify"]),n=await Qa.exportKey("jwk",r.privateKey);return{publicKey:Ha(await Qa.exportKey("jwk",r.publicKey),e),privateKey:ti(n.d)}}(this.name,this.wireFormatLeadingByte)}catch(t){return qn.printDebugError("Browser did not support generating ec key "+t.message),La(this.name)}case"node":return async function(t){const e=_a.createECDH(Ma[t]);return await e.generateKeys(),{publicKey:new Uint8Array(e.getPublicKey()),privateKey:new Uint8Array(e.getPrivateKey())}}(this.name);case"curve25519Legacy":{const{k:t,A:e}=await async function(t){switch(t){case $n.publicKey.x25519:try{const t=qn.getWebCrypto(),e=await t.generateKey("X25519",!0,["deriveKey","deriveBits"]).catch(t=>{if("OperationError"===t.name){const t=Error("Unexpected key generation issue");throw t.name="NotSupportedError",t}throw t}),r=await t.exportKey("jwk",e.privateKey),n=await t.exportKey("jwk",e.publicKey);if(r.x!==n.x){const t=Error("Unexpected mismatching public point");throw t.name="NotSupportedError",t}return{A:new Uint8Array(ti(n.x)),k:ti(r.d)}}catch(t){if("NotSupportedError"!==t.name)throw t;const{default:e}=await Promise.resolve().then(function(){return op}),{secretKey:r,publicKey:n}=e.box.keyPair();return{A:n,k:r}}case $n.publicKey.x448:{const t=await qn.getNobleCurve($n.publicKey.x448),{secretKey:e,publicKey:r}=t.keygen();return{A:r,k:e}}default:throw Error("Unsupported ECDH algorithm")}}($n.publicKey.x25519),r=t.slice().reverse();return r[0]=127&r[0]|64,r[31]&=248,{publicKey:qn.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),e]),privateKey:r}}case"ed25519Legacy":{const{seed:t,A:e}=await async function(t){switch(t){case $n.publicKey.ed25519:try{const t=qn.getWebCrypto(),e=await t.generateKey("Ed25519",!0,["sign","verify"]).catch(t=>{if("OperationError"===t.name){const t=Error("Unexpected key generation issue");throw t.name="NotSupportedError",t}throw t}),r=await t.exportKey("jwk",e.privateKey),n=await t.exportKey("jwk",e.publicKey);return{A:new Uint8Array(ti(n.x)),seed:ti(r.d)}}catch(e){if("NotSupportedError"!==e.name)throw e;const{default:r}=await Promise.resolve().then(function(){return op}),n=vi(hs(t)),{publicKey:i}=r.sign.keyPair.fromSeed(n);return{A:i,seed:n}}case $n.publicKey.ed448:{const t=await qn.getNobleCurve($n.publicKey.ed448),{secretKey:e,publicKey:r}=t.keygen();return{A:r,seed:e}}default:throw Error("Unsupported EdDSA algorithm")}}($n.publicKey.ed25519);return{publicKey:qn.concatUint8Array([new Uint8Array([this.wireFormatLeadingByte]),e]),privateKey:t}}default:return La(this.name)}}}function Fa(t,e){const{payloadSize:r,wireFormatLeadingByte:n,name:i}=t,s=i===$n.curve.curve25519Legacy||i===$n.curve.ed25519Legacy?r:2*r;if(e[0]!==n||e.length!==s+1)throw Error("Invalid point encoding")}async function La(t){const e=await qn.getNobleCurve($n.publicKey.ecdsa,t),{secretKey:r}=e.keygen();return{publicKey:e.getPublicKey(r,!1),privateKey:r}}function Ha(t,e){const r=ti(t.x),n=ti(t.y),i=new Uint8Array(r.length+n.length+1);return i[0]=e,i.set(r,1),i.set(n,r.length+1),i}function za(t,e,r){const n=t,i=r.slice(1,n+1),s=r.slice(n+1,2*n+1);return{kty:"EC",crv:e,x:ei(i),y:ei(s),ext:!0}}function Ga(t,e,r,n){const i=za(t,e,r);return i.d=ei(n),i}const $a=qn.getWebCrypto(),ja=qn.getNodeCrypto();async function Va(t,e,r,n){return(await qn.getNobleCurve($n.publicKey.ecdsa,t.name)).verify(qn.concatUint8Array([e.r,e.s]),r,n,{lowS:!1})}function qa(t){const e=t.length;if(e>0){const r=t[e-1];if(r>=1){const n=t.subarray(e-r),i=new Uint8Array(r).fill(r);if(qn.equalsUint8Array(n,i))return t.subarray(0,e-r)}}throw Error("Invalid padding")}function Ya(t,e,r,n){return qn.concatUint8Array([e.write(),new Uint8Array([t]),r.write(),qn.stringToUint8Array("Anonymous Sender    "),n])}async function Za(t,e,r,n,i=!1,s=!1){let a;if(i){for(a=0;a<e.length&&0===e[a];a++);e=e.subarray(a)}if(s){for(a=e.length-1;a>=0&&0===e[a];a--);e=e.subarray(0,a+1)}return(await Mi(t,qn.concatUint8Array([new Uint8Array([0,0,0,1]),e,n]))).subarray(0,r)}async function Ja(t,e,r){return{secretKey:r,sharedKey:(await qn.getNobleCurve($n.publicKey.ecdh,t.name)).getSharedSecret(r,e).subarray(1)}}async function Wa(t,e){const r=await qn.getNobleCurve($n.publicKey.ecdh,t.name),{publicKey:n,privateKey:i}=await t.genKeyPair();return{publicKey:n,sharedKey:r.getSharedSecret(i,e).subarray(1)}}const Xa=BigInt(0),to=BigInt(1);class eo{constructor(t){t&&(this.data=t)}read(t){if(t.length>=1){const e=t[0];if(t.length>=1+e)return this.data=t.subarray(1,1+e),1+this.data.length}throw Error("Invalid symmetric key")}write(){return qn.concatUint8Array([new Uint8Array([this.data.length]),this.data])}}class ro{constructor(t){if(t){const{hash:e,cipher:r}=t;this.hash=e,this.cipher=r}else this.hash=null,this.cipher=null}read(t){if(t.length<4||3!==t[0]||1!==t[1])throw new as("Cannot read KDFParams");return this.hash=t[2],this.cipher=t[3],4}write(){return new Uint8Array([3,1,this.hash,this.cipher])}}class no{static fromObject({wrappedKey:t,algorithm:e}){const r=new no;return r.wrappedKey=t,r.algorithm=e,r}read(t){let e=0,r=t[e++];this.algorithm=r%2?t[e++]:null,r-=r%2,this.wrappedKey=qn.readExactSubarray(t,e,e+r),e+=r}write(){return qn.concatUint8Array([this.algorithm?new Uint8Array([this.wrappedKey.length+1,this.algorithm]):new Uint8Array([this.wrappedKey.length]),this.wrappedKey])}}async function io(t,e,r,n,i,s){switch(t){case $n.publicKey.rsaEncryptSign:case $n.publicKey.rsaEncrypt:{const{c:t}=n,{n:i,e:a}=e,{d:o,p:c,q:u,u:l}=r;return async function(t,e,r,n,i,s,a,o){if(qn.getNodeCrypto()&&!o)try{return await async function(t,e,r,n,i,s,a){const o={key:await qi(e,r,n,i,s,a),format:"jwk",type:"pkcs1",padding:Gi.constants.RSA_PKCS1_PADDING};try{return new Uint8Array(Gi.privateDecrypt(o,t))}catch(t){throw Error("Decryption error")}}(t,e,r,n,i,s,a)}catch(t){qn.printDebugError(t)}return async function(t,e,r,n,i,s,a,o){if(t=yi(t),e=yi(e),r=yi(r),n=yi(n),i=yi(i),s=yi(s),a=yi(a),t>=e)throw Error("Data too large.");const c=di(n,s-$i),u=di(n,i-$i),l=Ei(BigInt(2),e),f=pi(Ai(l,e),r,e),h=pi(t=di(t*f,e),u,i);let y=di(a*(pi(t,c,s)-h),s)*i+h;return y=di(y*l,e),Li(bi(y,"be",wi(e)),o)}(t,e,r,n,i,s,a,o)}(t,i,a,o,c,u,l,s)}case $n.publicKey.elgamal:{const{c1:t,c2:i}=n;return async function(t,e,r,n,i){return t=yi(t),e=yi(e),r=yi(r),Li(bi(di(Ai(pi(t,n=yi(n),r),r)*e,r),"be",wi(r)),i)}(t,i,e.p,r.x,s)}case $n.publicKey.ecdh:{const{oid:t,Q:s,kdfParams:a}=e,{d:o}=r,{V:c,C:u}=n;return async function(t,e,r,n,i,s,a){const o=new Oa(t);Fa(o,i),Fa(o,r);const{sharedKey:c}=await async function(t,e,r,n){if(n.length!==t.payloadSize){const e=new Uint8Array(t.payloadSize);e.set(n,t.payloadSize-n.length),n=e}switch(t.type){case"curve25519Legacy":{const t=n.slice().reverse();return{secretKey:t,sharedKey:await Ua($n.publicKey.x25519,e.subarray(1),r.subarray(1),t)}}case"web":if(t.web&&qn.getWebCrypto())try{return await async function(t,e,r,n){const i=qn.getWebCrypto(),s=Ga(t.payloadSize,t.web,r,n);let a=i.importKey("jwk",s,{name:"ECDH",namedCurve:t.web},!0,["deriveKey","deriveBits"]);const o=za(t.payloadSize,t.web,e);let c=i.importKey("jwk",o,{name:"ECDH",namedCurve:t.web},!0,[]);[a,c]=await Promise.all([a,c]);let u=i.deriveBits({name:"ECDH",namedCurve:t.web,public:c},a,t.sharedSize),l=i.exportKey("jwk",a);[u,l]=await Promise.all([u,l]);const f=new Uint8Array(u);return{secretKey:ti(l.d),sharedKey:f}}(t,e,r,n)}catch(r){return qn.printDebugError(r),Ja(t,e,n)}break;case"node":return async function(t,e,r){const n=qn.getNodeCrypto().createECDH(t.node);n.setPrivateKey(r);const i=new Uint8Array(n.computeSecret(e));return{secretKey:new Uint8Array(n.getPrivateKey()),sharedKey:i}}(t,e,n);default:return Ja(t,e,n)}}(o,r,i,s),u=Ya($n.publicKey.ecdh,t,e,a),{keySize:l}=Ea(e.cipher);let f;for(let r=0;r<3;r++)try{const t=await Za(e.hash,c,l,u,1===r,2===r);return qa(await Ia(e.cipher,t,n))}catch(t){f=t}throw f}(t,a,c,u.data,s,o,i)}case $n.publicKey.x25519:case $n.publicKey.x448:{const{A:i}=e,{k:s}=r,{ephemeralPublicKey:a,C:o}=n;if(null!==o.algorithm&&!qn.isAES(o.algorithm))throw Error("AES session key expected");return async function(t,e,r,n,i){const s=await Ua(t,e,n,i),a=qn.concatUint8Array([e,n,s]);switch(t){case $n.publicKey.x25519:{const t=$n.symmetric.aes128,{keySize:e}=Ea(t);return Ia(t,await Sa($n.hash.sha256,a,new Uint8Array,Ca.x25519,e),r)}case $n.publicKey.x448:{const t=$n.symmetric.aes256,{keySize:e}=Ea($n.symmetric.aes256);return Ia(t,await Sa($n.hash.sha512,a,new Uint8Array,Ca.x448,e),r)}default:throw Error("Unsupported ECDH algorithm")}}(t,a,o.wrappedKey,i,s)}default:throw Error("Unknown public key encryption algorithm.")}}function so(t,e){const r=new Set([$n.publicKey.ed25519,$n.publicKey.x25519,$n.publicKey.ed448,$n.publicKey.x448]),n=Object.keys(e).map(n=>{const i=e[n];return qn.isUint8Array(i)?r.has(t)?i:qn.uint8ArrayToMPI(i):i.write()});return qn.concatUint8Array(n)}function ao(t){const{keySize:e}=Ea(t);return vi(e)}function oo(t){try{t.getName()}catch(t){throw new as("Unknown curve OID")}}function co(t,e){switch(t){case $n.publicKey.ecdsa:case $n.publicKey.ecdh:case $n.publicKey.eddsaLegacy:return new Oa(e).payloadSize;case $n.publicKey.ed25519:case $n.publicKey.ed448:return hs(t);case $n.publicKey.x25519:case $n.publicKey.x448:return Ka(t);default:throw Error("Unknown elliptic algo")}}const uo=qn.getWebCrypto(),lo=qn.getNodeCrypto(),fo=lo?lo.getCiphers():[],ho={idea:fo.includes("idea-cfb")?"idea-cfb":void 0,tripledes:fo.includes("des-ede3-cfb")?"des-ede3-cfb":void 0,cast5:fo.includes("cast5-cfb")?"cast5-cfb":void 0,blowfish:fo.includes("bf-cfb")?"bf-cfb":void 0,aes128:fo.includes("aes-128-cfb")?"aes-128-cfb":void 0,aes192:fo.includes("aes-192-cfb")?"aes-192-cfb":void 0,aes256:fo.includes("aes-256-cfb")?"aes-256-cfb":void 0};async function yo(t){const{blockSize:e}=Ea(t),r=await vi(e),n=new Uint8Array([r[r.length-2],r[r.length-1]]);return qn.concat([r,n])}async function po(t,e,r,n,i){const s=$n.read($n.symmetric,t);if(qn.getNodeCrypto()&&ho[s])return function(t,e,r,n){const i=$n.read($n.symmetric,t),s=new lo.createCipheriv(ho[i],e,n);return Pn(r,t=>new Uint8Array(s.update(t)))}(t,e,r,n);if(qn.isAES(t))return async function(t,e,r,n){if(uo&&await Ao.isSupported(t)){const i=new Ao(t,e,n);return qn.isStream(r)?Pn(r,t=>i.encryptChunk(t),()=>i.finish()):i.encrypt(r)}if(qn.isStream(r)){const i=new wo(!0,t,e,n);return Pn(r,t=>i.processChunk(t),()=>i.finish())}return la(e,n).encrypt(r)}(t,e,r,n);const a=new(await ba(t))(e),o=a.blockSize,c=n.slice();let u=new Uint8Array;const l=t=>{t&&(u=qn.concatUint8Array([u,t]));const e=new Uint8Array(u.length);let r,n=0;for(;t?u.length>=o:u.length;){const t=a.encrypt(c);for(r=0;r<o;r++)c[r]=u[r]^t[r],e[n++]=c[r];u=u.subarray(o)}return e.subarray(0,n)};return Pn(r,l,l)}async function go(t,e,r,n){const i=$n.read($n.symmetric,t);if(lo&&ho[i])return function(t,e,r,n){const i=$n.read($n.symmetric,t),s=new lo.createDecipheriv(ho[i],e,n);return Pn(r,t=>new Uint8Array(s.update(t)))}(t,e,r,n);if(qn.isAES(t))return async function(t,e,r,n){if(qn.isStream(r)){const i=new wo(!1,t,e,n);return Pn(r,t=>i.processChunk(t),()=>i.finish())}return la(e,n).decrypt(r)}(t,e,r,n);const s=new(await ba(t))(e),a=s.blockSize;let o=n,c=new Uint8Array;const u=t=>{t&&(c=qn.concatUint8Array([c,t]));const e=new Uint8Array(c.length);let r,n=0;for(;t?c.length>=a:c.length;){const t=s.encrypt(o);for(o=c.subarray(0,a),r=0;r<a;r++)e[n++]=o[r]^t[r];c=c.subarray(a)}return e.subarray(0,n)};return Pn(r,u,u)}class Ao{constructor(t,e,r){const{blockSize:n}=Ea(t);this.key=e,this.prevBlock=r,this.nextBlock=new Uint8Array(n),this.i=0,this.blockSize=n,this.zeroBlock=new Uint8Array(this.blockSize)}static async isSupported(t){const{keySize:e}=Ea(t);return uo.importKey("raw",new Uint8Array(e),"aes-cbc",!1,["encrypt"]).then(()=>!0,()=>!1)}async _runCBC(t,e){const r="AES-CBC";this.keyRef=this.keyRef||await uo.importKey("raw",this.key,r,!1,["encrypt"]);const n=await uo.encrypt({name:r,iv:e||this.zeroBlock},this.keyRef,t);return new Uint8Array(n).subarray(0,t.length)}async encryptChunk(t){const e=this.nextBlock.length-this.i,r=t.subarray(0,e);if(this.nextBlock.set(r,this.i),this.i+t.length>=2*this.blockSize){const r=(t.length-e)%this.blockSize,n=qn.concatUint8Array([this.nextBlock,t.subarray(e,t.length-r)]),i=qn.concatUint8Array([this.prevBlock,n.subarray(0,n.length-this.blockSize)]),s=await this._runCBC(i);return bo(s,n),this.prevBlock=s.slice(-this.blockSize),r>0&&this.nextBlock.set(t.subarray(-r)),this.i=r,s}let n;if(this.i+=r.length,this.i===this.nextBlock.length){const e=this.nextBlock;n=await this._runCBC(this.prevBlock),bo(n,e),this.prevBlock=n.slice(),this.i=0;const i=t.subarray(r.length);this.nextBlock.set(i,this.i),this.i+=i.length}else n=new Uint8Array;return n}async finish(){let t;if(0===this.i)t=new Uint8Array;else{this.nextBlock=this.nextBlock.subarray(0,this.i);const e=this.nextBlock,r=await this._runCBC(this.prevBlock);bo(r,e),t=r.subarray(0,e.length)}return this.clearSensitiveData(),t}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.keyRef=null,this.key=null}async encrypt(t){const e=(await this._runCBC(qn.concatUint8Array([new Uint8Array(this.blockSize),t]),this.iv)).subarray(0,t.length);return bo(e,t),this.clearSensitiveData(),e}}class wo{constructor(t,e,r,n){this.forEncryption=t;const{blockSize:i}=Ea(e);this.key=wa.expandKeyLE(r),n.byteOffset%4!=0&&(n=n.slice()),this.prevBlock=mo(n),this.nextBlock=new Uint8Array(i),this.i=0,this.blockSize=i}_runCFB(t){const e=mo(t),r=new Uint8Array(t.length),n=mo(r);for(let t=0;t+4<=n.length;t+=4){const{s0:r,s1:i,s2:s,s3:a}=wa.encrypt(this.key,this.prevBlock[0],this.prevBlock[1],this.prevBlock[2],this.prevBlock[3]);n[t+0]=e[t+0]^r,n[t+1]=e[t+1]^i,n[t+2]=e[t+2]^s,n[t+3]=e[t+3]^a,this.prevBlock=(this.forEncryption?n:e).slice(t,t+4)}return r}async processChunk(t){const e=this.nextBlock.length-this.i,r=t.subarray(0,e);if(this.nextBlock.set(r,this.i),this.i+t.length>=2*this.blockSize){const r=(t.length-e)%this.blockSize,n=qn.concatUint8Array([this.nextBlock,t.subarray(e,t.length-r)]),i=this._runCFB(n);return r>0&&this.nextBlock.set(t.subarray(-r)),this.i=r,i}let n;if(this.i+=r.length,this.i===this.nextBlock.length){n=this._runCFB(this.nextBlock),this.i=0;const e=t.subarray(r.length);this.nextBlock.set(e,this.i),this.i+=e.length}else n=new Uint8Array;return n}async finish(){let t;return t=0===this.i?new Uint8Array:this._runCFB(this.nextBlock).subarray(0,this.i),this.clearSensitiveData(),t}clearSensitiveData(){this.nextBlock.fill(0),this.prevBlock.fill(0),this.key.fill(0)}}function bo(t,e){const r=Math.min(t.length,e.length);for(let n=0;n<r;n++)t[n]=t[n]^e[n]}const mo=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),vo=qn.getWebCrypto(),Eo=qn.getNodeCrypto(),ko=16;function Bo(t,e){const r=t.length-ko;for(let n=0;n<ko;n++)t[n+r]^=e[n];return t}const Io=new Uint8Array(ko);const So=qn.getWebCrypto(),Co=qn.getNodeCrypto(),Ko=qn.getNodeBuffer(),Do=new Uint8Array(16),Uo=new Uint8Array(16);Uo[15]=1;const xo=new Uint8Array(16);async function Po(t){const e=await async function(t){const e=await async function(t){if(qn.getNodeCrypto())return async function(e){const r=new Eo.createCipheriv("aes-"+8*t.length+"-cbc",t,Io).update(e);return new Uint8Array(r)};if(qn.getWebCrypto())try{return t=await vo.importKey("raw",t,{name:"AES-CBC",length:8*t.length},!1,["encrypt"]),async function(e){const r=await vo.encrypt({name:"AES-CBC",iv:Io,length:128},t,e);return new Uint8Array(r).subarray(0,r.byteLength-ko)}}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;qn.printDebugError("Browser did not support operation: "+e.message)}return async function(e){return ua(t,Io,{disablePadding:!0}).encrypt(e)}}(t),r=qn.double(await e(Io)),n=qn.double(r);return async function(t){return(await e(function(t,e,r){if(t.length&&t.length%ko==0)return Bo(t,e);const n=new Uint8Array(t.length+(ko-t.length%ko));return n.set(t),n[t.length]=128,Bo(n,r)}(t,r,n))).subarray(-16)}}(t);return function(t,r){return e(qn.concatUint8Array([t,r]))}}async function Qo(t){if(qn.getNodeCrypto())return async function(e,r){const n=new Co.createCipheriv("aes-"+8*t.length+"-ctr",t,r),i=Ko.concat([n.update(e),n.final()]);return new Uint8Array(i)};if(qn.getWebCrypto())try{const e=await So.importKey("raw",t,{name:"AES-CTR",length:8*t.length},!1,["encrypt"]);return async function(t,r){const n=await So.encrypt({name:"AES-CTR",counter:r,length:128},e,t);return new Uint8Array(n)}}catch(e){if("NotSupportedError"!==e.name&&(24!==t.length||"OperationError"!==e.name))throw e;qn.printDebugError("Browser did not support operation: "+e.message)}return async function(e,r){return ca(t,r).encrypt(e)}}async function _o(t,e){if(t!==$n.symmetric.aes128&&t!==$n.symmetric.aes192&&t!==$n.symmetric.aes256)throw Error("EAX mode supports only AES cipher");const[r,n]=await Promise.all([Po(e),Qo(e)]);return{encrypt:async function(t,e,i){const[s,a]=await Promise.all([r(Do,e),r(Uo,i)]),o=await n(t,s),c=await r(xo,o);for(let t=0;t<16;t++)c[t]^=a[t]^s[t];return qn.concatUint8Array([o,c])},decrypt:async function(t,e,i){if(t.length<16)throw Error("Invalid EAX ciphertext");const s=t.subarray(0,-16),a=t.subarray(-16),[o,c,u]=await Promise.all([r(Do,e),r(Uo,i),r(xo,s)]),l=u;for(let t=0;t<16;t++)l[t]^=c[t]^o[t];if(!qn.equalsUint8Array(a,l))throw Error("Authentication tag mismatch");return await n(s,o)}}}xo[15]=2,_o.getNonce=function(t,e){const r=t.slice();for(let t=0;t<e.length;t++)r[8+t]^=e[t];return r},_o.blockLength=16,_o.ivLength=16,_o.tagLength=16;const Ro=16;function To(t){let e=0;for(let r=1;!(t&r);r<<=1)e++;return e}function Mo(t,e){for(let r=0;r<t.length;r++)t[r]^=e[r];return t}function No(t,e){return Mo(t.slice(),e)}const Oo=new Uint8Array(Ro),Fo=new Uint8Array([1]);async function Lo(t,e){const{keySize:r}=Ea(t);if(!qn.isAES(t)||e.length!==r)throw Error("Unexpected algorithm or key size");let n=0;const i=t=>ua(e,Oo,{disablePadding:!0}).encrypt(t),s=t=>ua(e,Oo,{disablePadding:!0}).decrypt(t);let a;function o(t,e,r,s){const o=e.length/Ro|0;!function(t,e){const r=qn.nbits(Math.max(t.length,e.length)/Ro|0)-1;for(let t=n+1;t<=r;t++)a[t]=qn.double(a[t-1]);n=r}(e,s);const c=qn.concatUint8Array([Oo.subarray(0,15-r.length),Fo,r]),u=63&c[15];c[15]&=192;const l=i(c),f=qn.concatUint8Array([l,No(l.subarray(0,8),l.subarray(1,9))]),h=qn.shiftRight(f.subarray(0+(u>>3),17+(u>>3)),8-(7&u)).subarray(1),y=new Uint8Array(Ro),d=new Uint8Array(e.length+16);let p,g=0;for(p=0;p<o;p++)Mo(h,a[To(p+1)]),d.set(Mo(t(No(h,e)),h),g),Mo(y,t===i?e:d.subarray(g)),e=e.subarray(Ro),g+=Ro;if(e.length){Mo(h,a.x);const r=i(h);d.set(No(e,r),g);const n=new Uint8Array(Ro);n.set(t===i?e:d.subarray(g,-16),0),n[e.length]=128,Mo(y,n),g+=e.length}const A=Mo(i(Mo(Mo(y,h),a.$)),function(t){if(!t.length)return Oo;const e=t.length/Ro|0,r=new Uint8Array(Ro),n=new Uint8Array(Ro);for(let s=0;s<e;s++)Mo(r,a[To(s+1)]),Mo(n,i(No(r,t))),t=t.subarray(Ro);if(t.length){Mo(r,a.x);const e=new Uint8Array(Ro);e.set(t,0),e[t.length]=128,Mo(e,r),Mo(n,i(e))}return n}(s));return d.set(A,g),d}return function(){const t=i(Oo),e=qn.double(t);a=[],a[0]=qn.double(e),a.x=t,a.$=e}(),{encrypt:async function(t,e,r){return o(i,t,e,r)},decrypt:async function(t,e,r){if(t.length<16)throw Error("Invalid OCB ciphertext");const n=t.subarray(-16);t=t.subarray(0,-16);const i=o(s,t,e,r);if(qn.equalsUint8Array(n,i.subarray(-16)))return i.subarray(0,-16);throw Error("Authentication tag mismatch")}}}Lo.getNonce=function(t,e){const r=t.slice();for(let t=0;t<e.length;t++)r[7+t]^=e[t];return r},Lo.blockLength=Ro,Lo.ivLength=15,Lo.tagLength=16;const Ho=qn.getWebCrypto(),zo=qn.getNodeCrypto(),Go=qn.getNodeBuffer(),$o="AES-GCM";async function jo(t,e){if(t!==$n.symmetric.aes128&&t!==$n.symmetric.aes192&&t!==$n.symmetric.aes256)throw Error("GCM mode supports only AES cipher");if(qn.getNodeCrypto())return{encrypt:async function(t,r,n=new Uint8Array){const i=new zo.createCipheriv("aes-"+8*e.length+"-gcm",e,r);i.setAAD(n);const s=Go.concat([i.update(t),i.final(),i.getAuthTag()]);return new Uint8Array(s)},decrypt:async function(t,r,n=new Uint8Array){const i=new zo.createDecipheriv("aes-"+8*e.length+"-gcm",e,r);i.setAAD(n),i.setAuthTag(t.slice(t.length-16,t.length));const s=Go.concat([i.update(t.slice(0,t.length-16)),i.final()]);return new Uint8Array(s)}};if(qn.getWebCrypto())try{const t=await Ho.importKey("raw",e,{name:$o},!1,["encrypt","decrypt"]),r=navigator.userAgent.match(/Version\/13\.\d(\.\d)* Safari/)||navigator.userAgent.match(/Version\/(13|14)\.\d(\.\d)* Mobile\/\S* Safari/);return{encrypt:async function(n,i,s=new Uint8Array){if(r&&!n.length)return fa(e,i,s).encrypt(n);const a=await Ho.encrypt({name:$o,iv:i,additionalData:s,tagLength:128},t,n);return new Uint8Array(a)},decrypt:async function(n,i,s=new Uint8Array){if(r&&16===n.length)return fa(e,i,s).decrypt(n);try{const e=await Ho.decrypt({name:$o,iv:i,additionalData:s,tagLength:128},t,n);return new Uint8Array(e)}catch(t){if("OperationError"===t.name)throw Error("Authentication tag mismatch")}}}}catch(t){if("NotSupportedError"!==t.name&&(24!==e.length||"OperationError"!==t.name))throw t;qn.printDebugError("Browser did not support operation: "+t.message)}return{encrypt:async function(t,r,n){return fa(e,r,n).encrypt(t)},decrypt:async function(t,r,n){return fa(e,r,n).decrypt(t)}}}function Vo(t,e=!1){switch(t){case $n.aead.eax:return _o;case $n.aead.ocb:return Lo;case $n.aead.gcm:return jo;case $n.aead.experimentalGCM:if(!e)throw Error("Unexpected non-standard `experimentalGCM` AEAD algorithm provided in `config.preferredAEADAlgorithm`: use `gcm` instead");return jo;default:throw Error("Unsupported AEAD mode")}}async function qo(t,e,r,n,i,s){switch(t){case $n.publicKey.rsaEncryptSign:case $n.publicKey.rsaEncrypt:case $n.publicKey.rsaSign:{const{n:t,e:a}=n;return async function(t,e,r,n,i,s){if(e&&!qn.isStream(e))if(qn.getWebCrypto())try{return await async function(t,e,r,n,i){const s=Yi(n,i),a=await zi.importKey("jwk",s,{name:"RSASSA-PKCS1-v1_5",hash:{name:t}},!1,["verify"]);return zi.verify("RSASSA-PKCS1-v1_5",a,r,e)}($n.read($n.webHash,t),e,r,n,i)}catch(t){qn.printDebugError(t)}else if(qn.getNodeCrypto())return async function(t,e,r,n,i){const s={key:Yi(n,i),format:"jwk",type:"pkcs1"},a=Gi.createVerify($n.read($n.hash,t));a.write(e),a.end();try{return a.verify(s,r)}catch(t){return!1}}(t,e,r,n,i);return async function(t,e,r,n,i){if(r=yi(r),e=yi(e),n=yi(n),e>=r)throw Error("Signature size cannot exceed modulus size");const s=bi(pi(e,n,r),"be",wi(r)),a=Hi(t,i,wi(r));return qn.equalsUint8Array(s,a)}(t,r,n,i,s)}(e,i,qn.leftPad(r.s,t.length),t,a,s)}case $n.publicKey.dsa:{const{g:t,p:e,q:i,y:a}=n,{r:o,s:c}=r;return async function(t,e,r,n,i,s,a,o){if(e=yi(e),r=yi(r),s=yi(s),a=yi(a),i=yi(i),o=yi(o),e<=Xa||e>=a||r<=Xa||r>=a)return qn.printDebug("invalid DSA Signature"),!1;const c=di(yi(n.subarray(0,wi(a))),a),u=Ai(r,a);if(u===Xa)return qn.printDebug("invalid DSA Signature"),!1;i=di(i,s),o=di(o,s);const l=di(c*u,a),f=di(e*u,a);return di(di(pi(i,l,s)*pi(o,f,s),s),a)===e}(0,o,c,s,t,e,i,a)}case $n.publicKey.ecdsa:{const{oid:t,Q:a}=n,o=new Oa(t).payloadSize;return async function(t,e,r,n,i,s){const a=new Oa(t);Fa(a,i);const o=async()=>0===s[0]&&Va(a,r,s.subarray(1),i);if(n&&!qn.isStream(n))switch(a.type){case"web":try{const t=await async function(t,e,{r,s:n},i,s){const a=za(t.payloadSize,Ra[t.name],s),o=await $a.importKey("jwk",a,{name:"ECDSA",namedCurve:Ra[t.name],hash:{name:$n.read($n.webHash,t.hash)}},!1,["verify"]),c=qn.concatUint8Array([r,n]).buffer;return $a.verify({name:"ECDSA",namedCurve:Ra[t.name],hash:{name:$n.read($n.webHash,e)}},o,c,i)}(a,e,r,n,i);return t||o()}catch(t){if("nistP521"!==a.name&&("DataError"===t.name||"OperationError"===t.name))throw t;qn.printDebugError("Browser did not support verifying: "+t.message)}break;case"node":{const t=await async function(t,e,{r,s:n},i,s){const a=qn.nodeRequire("eckey-utils"),o=qn.getNodeBuffer(),{publicKey:c}=a.generateDer({curveName:Ma[t.name],publicKey:o.from(s)}),u=ja.createVerify($n.read($n.hash,e));u.write(i),u.end();const l=qn.concatUint8Array([r,n]);try{return u.verify({key:c,format:"der",type:"spki",dsaEncoding:"ieee-p1363"},l)}catch(t){return!1}}(a,e,r,n,i);return t||o()}}return await Va(a,r,s,i)||o()}(t,e,{r:qn.leftPad(r.r,o),s:qn.leftPad(r.s,o)},i,a,s)}case $n.publicKey.eddsaLegacy:{const{oid:t,Q:i}=n,a=new Oa(t).payloadSize;return async function(t,e,{r,s:n},i,s,a){if(Fa(new Oa(t),s),Ni(e)<Ni($n.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const o=qn.concatUint8Array([r,n]);return fs($n.publicKey.ed25519,e,{RS:o},0,s.subarray(1),a)}(t,e,{r:qn.leftPad(r.r,a),s:qn.leftPad(r.s,a)},0,i,s)}case $n.publicKey.ed25519:case $n.publicKey.ed448:{const{A:i}=n;return fs(t,e,r,0,i,s)}default:throw Error("Unknown signature algorithm.")}}jo.getNonce=function(t,e){const r=t.slice();for(let t=0;t<e.length;t++)r[4+t]^=e[t];return r},jo.blockLength=16,jo.ivLength=12,jo.tagLength=16;class Yo extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,Yo),this.name="Argon2OutOfMemoryError"}}let Zo,Jo;class Wo{constructor(t=jn){const{passes:e,parallelism:r,memoryExponent:n}=t.s2kArgon2Params;this.type="argon2",this.salt=null,this.t=e,this.p=r,this.encodedM=n}generateSalt(){this.salt=vi(16)}read(t){let e=0;return this.salt=t.subarray(e,e+16),e+=16,this.t=t[e++],this.p=t[e++],this.encodedM=t[e++],e}write(){const t=[new Uint8Array([$n.write($n.s2k,this.type)]),this.salt,new Uint8Array([this.t,this.p,this.encodedM])];return qn.concatUint8Array(t)}async produceKey(t,e){const r=2<<this.encodedM-1;try{Zo=Zo||(await Promise.resolve().then(function(){return Wp})).default,Jo=Jo||Zo();const n=(await Jo)({version:19,type:2,password:qn.encodeUTF8(t),salt:this.salt,tagLength:e,memorySize:r,parallelism:this.p,passes:this.t});return r>1048576&&(Jo=Zo(),Jo.catch(()=>{})),n}catch(t){throw t.message&&(t.message.includes("Unable to grow instance memory")||t.message.includes("failed to grow memory")||t.message.includes("WebAssembly.Memory.grow")||t.message.includes("Out of memory"))?new Yo("Could not allocate required memory for Argon2"):t}}}class Xo{constructor(t,e=jn){this.algorithm=$n.hash.sha256,this.type=$n.read($n.s2k,t),this.c=e.s2kIterationCountByte,this.salt=null}generateSalt(){switch(this.type){case"salted":case"iterated":this.salt=vi(8)}}getCount(){return 16+(15&this.c)<<6+(this.c>>4)}read(t){let e=0;switch(this.algorithm=t[e++],this.type){case"simple":break;case"salted":this.salt=t.subarray(e,e+8),e+=8;break;case"iterated":this.salt=t.subarray(e,e+8),e+=8,this.c=t[e++];break;case"gnu":if("GNU"!==qn.uint8ArrayToString(t.subarray(e,e+3)))throw new as("Unknown s2k type.");if(e+=3,1001!==1e3+t[e++])throw new as("Unknown s2k gnu protection mode.");this.type="gnu-dummy";break;default:throw new as("Unknown s2k type.")}return e}write(){if("gnu-dummy"===this.type)return new Uint8Array([101,0,...qn.stringToUint8Array("GNU"),1]);const t=[new Uint8Array([$n.write($n.s2k,this.type),this.algorithm])];switch(this.type){case"simple":break;case"salted":t.push(this.salt);break;case"iterated":t.push(this.salt),t.push(new Uint8Array([this.c]));break;case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}return qn.concatUint8Array(t)}async produceKey(t,e){t=qn.encodeUTF8(t);const r=[];let n=0,i=0;for(;n<e;){let e;switch(this.type){case"simple":e=qn.concatUint8Array([new Uint8Array(i),t]);break;case"salted":e=qn.concatUint8Array([new Uint8Array(i),this.salt,t]);break;case"iterated":{const r=qn.concatUint8Array([this.salt,t]);let n=r.length;const s=Math.max(this.getCount(),n);e=new Uint8Array(i+s),e.set(r,i);for(let t=i+n;t<s;t+=n,n*=2)e.copyWithin(t,i,t);break}case"gnu":throw Error("GNU s2k type not supported.");default:throw Error("Unknown s2k type.")}const s=await Mi(this.algorithm,e);r.push(s),n+=s.length,i++}return qn.concatUint8Array(r).subarray(0,e)}}const tc=new Set([$n.s2k.argon2,$n.s2k.iterated]);function ec(t,e=jn){switch(t){case $n.s2k.argon2:return new Wo(e);case $n.s2k.iterated:case $n.s2k.gnu:case $n.s2k.salted:case $n.s2k.simple:return new Xo(t,e);default:throw new as("Unsupported S2K type")}}var rc=Uint8Array,nc=Uint16Array,ic=Int32Array,sc=new rc([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ac=new rc([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),oc=new rc([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),cc=function(t,e){for(var r=new nc(31),n=0;n<31;++n)r[n]=e+=1<<t[n-1];var i=new ic(r[30]);for(n=1;n<30;++n)for(var s=r[n];s<r[n+1];++s)i[s]=s-r[n]<<5|n;return{b:r,r:i}},uc=cc(sc,2),lc=uc.b,fc=uc.r;lc[28]=258,fc[258]=28;for(var hc=cc(ac,0),yc=hc.b,dc=hc.r,pc=new nc(32768),gc=0;gc<32768;++gc){var Ac=(43690&gc)>>1|(21845&gc)<<1;Ac=(61680&(Ac=(52428&Ac)>>2|(13107&Ac)<<2))>>4|(3855&Ac)<<4,pc[gc]=((65280&Ac)>>8|(255&Ac)<<8)>>1}var wc=function(t,e,r){for(var n=t.length,i=0,s=new nc(e);i<n;++i)t[i]&&++s[t[i]-1];var a,o=new nc(e);for(i=1;i<e;++i)o[i]=o[i-1]+s[i-1]<<1;if(r){a=new nc(1<<e);var c=15-e;for(i=0;i<n;++i)if(t[i])for(var u=i<<4|t[i],l=e-t[i],f=o[t[i]-1]++<<l,h=f|(1<<l)-1;f<=h;++f)a[pc[f]>>c]=u}else for(a=new nc(n),i=0;i<n;++i)t[i]&&(a[i]=pc[o[t[i]-1]++]>>15-t[i]);return a},bc=new rc(288);for(gc=0;gc<144;++gc)bc[gc]=8;for(gc=144;gc<256;++gc)bc[gc]=9;for(gc=256;gc<280;++gc)bc[gc]=7;for(gc=280;gc<288;++gc)bc[gc]=8;var mc=new rc(32);for(gc=0;gc<32;++gc)mc[gc]=5;var vc=wc(bc,9,0),Ec=wc(bc,9,1),kc=wc(mc,5,0),Bc=wc(mc,5,1),Ic=function(t){for(var e=t[0],r=1;r<t.length;++r)t[r]>e&&(e=t[r]);return e},Sc=function(t,e,r){var n=e/8|0;return(t[n]|t[n+1]<<8)>>(7&e)&r},Cc=function(t,e){var r=e/8|0;return(t[r]|t[r+1]<<8|t[r+2]<<16)>>(7&e)},Kc=function(t){return(t+7)/8|0},Dc=function(t,e,r){return(null==e||e<0)&&(e=0),(null==r||r>t.length)&&(r=t.length),new rc(t.subarray(e,r))},Uc=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],xc=function(t,e,r){var n=Error(e||Uc[t]);if(n.code=t,Error.captureStackTrace&&Error.captureStackTrace(n,xc),!r)throw n;return n},Pc=function(t,e,r){r<<=7&e;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8},Qc=function(t,e,r){r<<=7&e;var n=e/8|0;t[n]|=r,t[n+1]|=r>>8,t[n+2]|=r>>16},_c=function(t,e){for(var r=[],n=0;n<t.length;++n)t[n]&&r.push({s:n,f:t[n]});var i=r.length,s=r.slice();if(!i)return{t:Lc,l:0};if(1==i){var a=new rc(r[0].s+1);return a[r[0].s]=1,{t:a,l:1}}r.sort(function(t,e){return t.f-e.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,l=1,f=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};l!=i-1;)o=r[r[u].f<r[f].f?u++:f++],c=r[u!=l&&r[u].f<r[f].f?u++:f++],r[l++]={s:-1,f:o.f+c.f,l:o,r:c};var h=s[0].s;for(n=1;n<i;++n)s[n].s>h&&(h=s[n].s);var y=new nc(h+1),d=Rc(r[l-1],y,0);if(d>e){n=0;var p=0,g=d-e,A=1<<g;for(s.sort(function(t,e){return y[e.s]-y[t.s]||t.f-e.f});n<i;++n){var w=s[n].s;if(!(y[w]>e))break;p+=A-(1<<d-y[w]),y[w]=e}for(p>>=g;p>0;){var b=s[n].s;y[b]<e?p-=1<<e-y[b]++-1:++n}for(;n>=0&&p;--n){var m=s[n].s;y[m]==e&&(--y[m],++p)}d=e}return{t:new rc(y),l:d}},Rc=function(t,e,r){return-1==t.s?Math.max(Rc(t.l,e,r+1),Rc(t.r,e,r+1)):e[t.s]=r},Tc=function(t){for(var e=t.length;e&&!t[--e];);for(var r=new nc(++e),n=0,i=t[0],s=1,a=function(t){r[n++]=t},o=1;o<=e;++o)if(t[o]==i&&o!=e)++s;else{if(!i&&s>2){for(;s>138;s-=138)a(32754);s>2&&(a(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(a(i),--s;s>6;s-=6)a(8304);s>2&&(a(s-3<<5|8208),s=0)}for(;s--;)a(i);s=1,i=t[o]}return{c:r.subarray(0,n),n:e}},Mc=function(t,e){for(var r=0,n=0;n<e.length;++n)r+=t[n]*e[n];return r},Nc=function(t,e,r){var n=r.length,i=Kc(e+2);t[i]=255&n,t[i+1]=n>>8,t[i+2]=255^t[i],t[i+3]=255^t[i+1];for(var s=0;s<n;++s)t[i+s+4]=r[s];return 8*(i+4+n)},Oc=function(t,e,r,n,i,s,a,o,c,u,l){Pc(e,l++,r),++i[256];for(var f=_c(i,15),h=f.t,y=f.l,d=_c(s,15),p=d.t,g=d.l,A=Tc(h),w=A.c,b=A.n,m=Tc(p),v=m.c,E=m.n,k=new nc(19),B=0;B<w.length;++B)++k[31&w[B]];for(B=0;B<v.length;++B)++k[31&v[B]];for(var I=_c(k,7),S=I.t,C=I.l,K=19;K>4&&!S[oc[K-1]];--K);var D,U,x,P,Q=u+5<<3,_=Mc(i,bc)+Mc(s,mc)+a,R=Mc(i,h)+Mc(s,p)+a+14+3*K+Mc(k,S)+2*k[16]+3*k[17]+7*k[18];if(c>=0&&Q<=_&&Q<=R)return Nc(e,l,t.subarray(c,c+u));if(Pc(e,l,1+(R<_)),l+=2,R<_){D=wc(h,y,0),U=h,x=wc(p,g,0),P=p;var T=wc(S,C,0);for(Pc(e,l,b-257),Pc(e,l+5,E-1),Pc(e,l+10,K-4),l+=14,B=0;B<K;++B)Pc(e,l+3*B,S[oc[B]]);l+=3*K;for(var M=[w,v],N=0;N<2;++N){var O=M[N];for(B=0;B<O.length;++B){var F=31&O[B];Pc(e,l,T[F]),l+=S[F],F>15&&(Pc(e,l,O[B]>>5&127),l+=O[B]>>12)}}}else D=vc,U=bc,x=kc,P=mc;for(B=0;B<o;++B){var L=n[B];if(L>255){Qc(e,l,D[257+(F=L>>18&31)]),l+=U[F+257],F>7&&(Pc(e,l,L>>23&31),l+=sc[F]);var H=31&L;Qc(e,l,x[H]),l+=P[H],H>3&&(Qc(e,l,L>>5&8191),l+=ac[H])}else Qc(e,l,D[L]),l+=U[L]}return Qc(e,l,D[256]),l+U[256]},Fc=new ic([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Lc=new rc(0),Hc=function(){var t=1,e=0;return{p:function(r){for(var n=t,i=e,s=0|r.length,a=0;a!=s;){for(var o=Math.min(a+2655,s);a<o;++a)i+=n+=r[a];n=(65535&n)+15*(n>>16),i=(65535&i)+15*(i>>16)}t=n,e=i},d:function(){return(255&(t%=65521))<<24|(65280&t)<<8|(255&(e%=65521))<<8|e>>8}}},zc=function(t,e,r,n,i){if(!i&&(i={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),a=new rc(s.length+t.length);a.set(s),a.set(t,s.length),t=a,i.w=s.length}return function(t,e,r,n,i,s){var a=s.z||t.length,o=new rc(n+a+5*(1+Math.ceil(a/7e3))+i),c=o.subarray(n,o.length-i),u=s.l,l=7&(s.r||0);if(e){l&&(c[0]=s.r>>3);for(var f=Fc[e-1],h=f>>13,y=8191&f,d=(1<<r)-1,p=s.p||new nc(32768),g=s.h||new nc(d+1),A=Math.ceil(r/3),w=2*A,b=function(e){return(t[e]^t[e+1]<<A^t[e+2]<<w)&d},m=new ic(25e3),v=new nc(288),E=new nc(32),k=0,B=0,I=s.i||0,S=0,C=s.w||0,K=0;I+2<a;++I){var D=b(I),U=32767&I,x=g[D];if(p[U]=x,g[D]=U,C<=I){var P=a-I;if((k>7e3||S>24576)&&(P>423||!u)){l=Oc(t,c,0,m,v,E,B,S,K,I-K,l),S=k=B=0,K=I;for(var Q=0;Q<286;++Q)v[Q]=0;for(Q=0;Q<30;++Q)E[Q]=0}var _=2,R=0,T=y,M=U-x&32767;if(P>2&&D==b(I-M))for(var N=Math.min(h,P)-1,O=Math.min(32767,I),F=Math.min(258,P);M<=O&&--T&&U!=x;){if(t[I+_]==t[I+_-M]){for(var L=0;L<F&&t[I+L]==t[I+L-M];++L);if(L>_){if(_=L,R=M,L>N)break;var H=Math.min(M,L-2),z=0;for(Q=0;Q<H;++Q){var G=I-M+Q&32767,$=G-p[G]&32767;$>z&&(z=$,x=G)}}}M+=(U=x)-(x=p[U])&32767}if(R){m[S++]=268435456|fc[_]<<18|dc[R];var j=31&fc[_],V=31&dc[R];B+=sc[j]+ac[V],++v[257+j],++E[V],C=I+_,++k}else m[S++]=t[I],++v[t[I]]}}for(I=Math.max(I,C);I<a;++I)m[S++]=t[I],++v[t[I]];l=Oc(t,c,u,m,v,E,B,S,K,I-K,l),u||(s.r=7&l|c[l/8|0]<<3,l-=7,s.h=g,s.p=p,s.i=I,s.w=C)}else{for(I=s.w||0;I<a+u;I+=65535){var q=I+65535;q>=a&&(c[l/8|0]=u,q=a),l=Nc(c,l+1,t.subarray(I,q))}s.i=a}return Dc(o,0,n+Kc(l)+i)}(t,null==e.level?6:e.level,null==e.mem?i.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(t.length)))):20:12+e.mem,r,n,i)},Gc=function(t,e,r){for(;r;++e)t[e]=r,r>>>=8},$c=function(){function t(t,e){if("function"==typeof t&&(e=t,t={}),this.ondata=e,this.o=t||{},this.s={l:0,i:32768,w:32768,z:32768},this.b=new rc(98304),this.o.dictionary){var r=this.o.dictionary.subarray(-32768);this.b.set(r,32768-r.length),this.s.i=32768-r.length}}return t.prototype.p=function(t,e){this.ondata(zc(t,this.o,0,0,this.s),e)},t.prototype.push=function(t,e){this.ondata||xc(5),this.s.l&&xc(4);var r=t.length+this.s.z;if(r>this.b.length){if(r>2*this.b.length-32768){var n=new rc(-32768&r);n.set(this.b.subarray(0,this.s.z)),this.b=n}var i=this.b.length-this.s.z;this.b.set(t.subarray(0,i),this.s.z),this.s.z=this.b.length,this.p(this.b,!1),this.b.set(this.b.subarray(-32768)),this.b.set(t.subarray(i),32768),this.s.z=t.length-i+32768,this.s.i=32766,this.s.w=32768}else this.b.set(t,this.s.z),this.s.z+=t.length;this.s.l=1&e,(this.s.z>this.s.w+8191||e)&&(this.p(this.b,e||!1),this.s.w=this.s.i,this.s.i-=2)},t.prototype.flush=function(){this.ondata||xc(5),this.s.l&&xc(4),this.p(this.b,!1),this.s.w=this.s.i,this.s.i-=2},t}(),jc=function(){function t(t,e){"function"==typeof t&&(e=t,t={}),this.ondata=e;var r=t&&t.dictionary&&t.dictionary.subarray(-32768);this.s={i:0,b:r?r.length:0},this.o=new rc(32768),this.p=new rc(0),r&&this.o.set(r)}return t.prototype.e=function(t){if(this.ondata||xc(5),this.d&&xc(4),this.p.length){if(t.length){var e=new rc(this.p.length+t.length);e.set(this.p),e.set(t,this.p.length),this.p=e}}else this.p=t},t.prototype.c=function(t){this.s.i=+(this.d=t||!1);var e=this.s.b,r=function(t,e,r){var n=t.length;if(!n||e.f&&!e.l)return r||new rc(0);var i=!r,s=i||2!=e.i,a=e.i;i&&(r=new rc(3*n));var o=function(t){var e=r.length;if(t>e){var n=new rc(Math.max(2*e,t));n.set(r),r=n}},c=e.f||0,u=e.p||0,l=e.b||0,f=e.l,h=e.d,y=e.m,d=e.n,p=8*n;do{if(!f){c=Sc(t,u,1);var g=Sc(t,u+1,3);if(u+=3,!g){var A=t[(K=Kc(u)+4)-4]|t[K-3]<<8,w=K+A;if(w>n){a&&xc(0);break}s&&o(l+A),r.set(t.subarray(K,w),l),e.b=l+=A,e.p=u=8*w,e.f=c;continue}if(1==g)f=Ec,h=Bc,y=9,d=5;else if(2==g){var b=Sc(t,u,31)+257,m=Sc(t,u+10,15)+4,v=b+Sc(t,u+5,31)+1;u+=14;for(var E=new rc(v),k=new rc(19),B=0;B<m;++B)k[oc[B]]=Sc(t,u+3*B,7);u+=3*m;var I=Ic(k),S=(1<<I)-1,C=wc(k,I,1);for(B=0;B<v;){var K,D=C[Sc(t,u,S)];if(u+=15&D,(K=D>>4)<16)E[B++]=K;else{var U=0,x=0;for(16==K?(x=3+Sc(t,u,3),u+=2,U=E[B-1]):17==K?(x=3+Sc(t,u,7),u+=3):18==K&&(x=11+Sc(t,u,127),u+=7);x--;)E[B++]=U}}var P=E.subarray(0,b),Q=E.subarray(b);y=Ic(P),d=Ic(Q),f=wc(P,y,1),h=wc(Q,d,1)}else xc(1);if(u>p){a&&xc(0);break}}s&&o(l+131072);for(var _=(1<<y)-1,R=(1<<d)-1,T=u;;T=u){var M=(U=f[Cc(t,u)&_])>>4;if((u+=15&U)>p){a&&xc(0);break}if(U||xc(2),M<256)r[l++]=M;else{if(256==M){T=u,f=null;break}var N=M-254;if(M>264){var O=sc[B=M-257];N=Sc(t,u,(1<<O)-1)+lc[B],u+=O}var F=h[Cc(t,u)&R],L=F>>4;if(F||xc(3),u+=15&F,Q=yc[L],L>3&&(O=ac[L],Q+=Cc(t,u)&(1<<O)-1,u+=O),u>p){a&&xc(0);break}s&&o(l+131072);var H=l+N;if(l<Q){var z=0-Q,G=Math.min(Q,H);for(z+l<0&&xc(3);l<G;++l)r[l]=(void 0)[z+l]}for(;l<H;++l)r[l]=r[l-Q]}}e.l=f,e.p=T,e.b=l,e.f=c,f&&(c=1,e.m=y,e.d=h,e.n=d)}while(!c);return l!=r.length&&i?Dc(r,0,l):r.subarray(0,l)}(this.p,this.s,this.o);this.ondata(Dc(r,e,this.s.b),this.d),this.o=Dc(r,this.s.b-32768),this.s.b=this.o.length,this.p=Dc(this.p,this.s.p/8|0),this.s.p&=7},t.prototype.push=function(t,e){this.e(t),this.c(e)},t}(),Vc=function(){function t(t,e){this.c=Hc(),this.v=1,$c.call(this,t,e)}return t.prototype.push=function(t,e){this.c.p(t),$c.prototype.push.call(this,t,e)},t.prototype.p=function(t,e){var r=zc(t,this.o,this.v&&(this.o.dictionary?6:2),e&&4,this.s);this.v&&(function(t,e){var r=e.level,n=0==r?0:r<6?1:9==r?3:2;if(t[0]=120,t[1]=n<<6|(e.dictionary&&32),t[1]|=31-(t[0]<<8|t[1])%31,e.dictionary){var i=Hc();i.p(e.dictionary),Gc(t,2,i.d())}}(r,this.o),this.v=0),e&&Gc(r,r.length-4,this.c.d()),this.ondata(r,e)},t.prototype.flush=function(){$c.prototype.flush.call(this)},t}(),qc=function(){function t(t,e){jc.call(this,t,e),this.v=t&&t.dictionary?2:1}return t.prototype.push=function(t,e){if(jc.prototype.e.call(this,t),this.v){if(this.p.length<6&&!e)return;this.p=this.p.subarray((r=this.p,n=this.v-1,(8!=(15&r[0])||r[0]>>4>7||(r[0]<<8|r[1])%31)&&xc(6,"invalid zlib data"),(r[1]>>5&1)==+!n&&xc(6,"invalid zlib data: "+(32&r[1]?"need":"unexpected")+" dictionary"),2+(r[1]>>3&4))),this.v=0}var r,n;e&&(this.p.length<4&&xc(6,"invalid zlib data"),this.p=this.p.subarray(0,-4)),jc.prototype.c.call(this,e)},t}(),Yc="undefined"!=typeof TextDecoder&&new TextDecoder;try{Yc.decode(Lc,{stream:!0})}catch(fn){}class Zc{static get tag(){return $n.packet.literalData}constructor(t=new Date){this.format=$n.literal.utf8,this.date=qn.normalizeDate(t),this.text=null,this.data=null,this.filename=""}setText(t,e=$n.literal.utf8){this.format=e,this.text=t,this.data=null}getText(t=!1){return(null===this.text||qn.isStream(this.text))&&(this.text=qn.decodeUTF8(qn.nativeEOL(this.getBytes(t)))),this.text}setBytes(t,e){this.format=e,this.data=t,this.text=null}getBytes(t=!1){return null===this.data&&(this.data=qn.canonicalizeEOL(qn.encodeUTF8(this.text))),t?Tn(this.data):this.data}setFilename(t){this.filename=t}getFilename(){return this.filename}async read(t){await _n(t,async t=>{const e=await t.readByte(),r=await t.readByte();this.filename=qn.decodeUTF8(await t.readBytes(r)),this.date=qn.readDate(await t.readBytes(4));let n=t.remainder();wn(n)&&(n=await On(n)),this.setBytes(n,e)})}writeHeader(){const t=qn.encodeUTF8(this.filename),e=new Uint8Array([t.length]),r=new Uint8Array([this.format]),n=qn.writeDate(this.date);return qn.concatUint8Array([r,e,t,n])}write(){const t=this.writeHeader(),e=this.getBytes();return qn.concat([t,e])}}class Jc{constructor(){this.bytes=""}read(t){return this.bytes=qn.uint8ArrayToString(t.subarray(0,8)),this.bytes.length}write(){return qn.stringToUint8Array(this.bytes)}toHex(){return qn.uint8ArrayToHex(qn.stringToUint8Array(this.bytes))}equals(t,e=!1){return e&&(t.isWildcard()||this.isWildcard())||this.bytes===t.bytes}isNull(){return""===this.bytes}isWildcard(){return/^0+$/.test(this.toHex())}static mapToHex(t){return t.toHex()}static fromID(t){const e=new Jc;return e.read(qn.hexToUint8Array(t)),e}static wildcard(){const t=new Jc;return t.read(new Uint8Array(8)),t}}const Wc=Symbol("verified"),Xc="salt@notations.openpgpjs.org",tu=new Set([$n.signatureSubpacket.issuerKeyID,$n.signatureSubpacket.issuerFingerprint,$n.signatureSubpacket.embeddedSignature]);class eu{static get tag(){return $n.packet.signature}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.signatureData=null,this.unhashedSubpackets=[],this.unknownSubpackets=[],this.signedHashValue=null,this.salt=null,this.created=null,this.signatureExpirationTime=null,this.signatureNeverExpires=!0,this.exportable=null,this.trustLevel=null,this.trustAmount=null,this.regularExpression=null,this.revocable=null,this.keyExpirationTime=null,this.keyNeverExpires=null,this.preferredSymmetricAlgorithms=null,this.revocationKeyClass=null,this.revocationKeyAlgorithm=null,this.revocationKeyFingerprint=null,this.issuerKeyID=new Jc,this.rawNotations=[],this.notations={},this.preferredHashAlgorithms=null,this.preferredCompressionAlgorithms=null,this.keyServerPreferences=null,this.preferredKeyServer=null,this.isPrimaryUserID=null,this.policyURI=null,this.keyFlags=null,this.signersUserID=null,this.reasonForRevocationFlag=null,this.reasonForRevocationString=null,this.features=null,this.signatureTargetPublicKeyAlgorithm=null,this.signatureTargetHashAlgorithm=null,this.signatureTargetHash=null,this.embeddedSignature=null,this.issuerKeyVersion=null,this.issuerFingerprint=null,this.preferredAEADAlgorithms=null,this.preferredCipherSuites=null,this.revoked=null,this[Wc]=null}read(t,e=jn){let r=0;if(this.version=t[r++],5===this.version&&!e.enableParsingV5Entities)throw new as("Support for v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4!==this.version&&5!==this.version&&6!==this.version)throw new as(`Version ${this.version} of the signature packet is unsupported.`);if(this.signatureType=t[r++],this.publicKeyAlgorithm=t[r++],this.hashAlgorithm=t[r++],r+=this.readSubPackets(t.subarray(r,t.length),!0),!this.created)throw Error("Missing signature creation time subpacket.");if(this.signatureData=t.subarray(0,r),r+=this.readSubPackets(t.subarray(r,t.length),!1),this.signedHashValue=t.subarray(r,r+2),r+=2,6===this.version){const e=t[r++];this.salt=t.subarray(r,r+e),r+=e}const n=t.subarray(r,t.length),{read:i,signatureParams:s}=function(t,e){let r=0;switch(t){case $n.publicKey.rsaEncryptSign:case $n.publicKey.rsaEncrypt:case $n.publicKey.rsaSign:{const t=qn.readMPI(e.subarray(r));return r+=t.length+2,{read:r,signatureParams:{s:t}}}case $n.publicKey.dsa:case $n.publicKey.ecdsa:{const t=qn.readMPI(e.subarray(r));r+=t.length+2;const n=qn.readMPI(e.subarray(r));return r+=n.length+2,{read:r,signatureParams:{r:t,s:n}}}case $n.publicKey.eddsaLegacy:{const t=qn.readMPI(e.subarray(r));r+=t.length+2;const n=qn.readMPI(e.subarray(r));return r+=n.length+2,{read:r,signatureParams:{r:t,s:n}}}case $n.publicKey.ed25519:case $n.publicKey.ed448:{const n=2*hs(t),i=qn.readExactSubarray(e,r,r+n);return r+=i.length,{read:r,signatureParams:{RS:i}}}default:throw new as("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,n);if(i<n.length)throw Error("Error reading MPIs");this.params=s}writeParams(){return this.params instanceof Promise?Ln(async()=>so(this.publicKeyAlgorithm,await this.params)):so(this.publicKeyAlgorithm,this.params)}write(){const t=[];return t.push(this.signatureData),t.push(this.writeUnhashedSubPackets()),t.push(this.signedHashValue),6===this.version&&(t.push(new Uint8Array([this.salt.length])),t.push(this.salt)),t.push(this.writeParams()),qn.concat(t)}async sign(t,e,r=new Date,n=!1,i){this.version=t.version,this.created=qn.normalizeDate(r),this.issuerKeyVersion=t.version,this.issuerFingerprint=t.getFingerprintBytes(),this.issuerKeyID=t.getKeyID();const s=[new Uint8Array([this.version,this.signatureType,this.publicKeyAlgorithm,this.hashAlgorithm])];if(6===this.version){const t=nu(this.hashAlgorithm);if(null===this.salt)this.salt=vi(t);else if(t!==this.salt.length)throw Error("Provided salt does not have the required length")}else if(i.nonDeterministicSignaturesViaNotation){if(0!==this.rawNotations.filter(({name:t})=>t===Xc).length)throw Error("Unexpected existing salt notation");{const t=vi(nu(this.hashAlgorithm));this.rawNotations.push({name:Xc,value:t,humanReadable:!1,critical:!1})}}s.push(this.writeHashedSubPackets()),this.unhashedSubpackets=[],this.signatureData=qn.concat(s);const a=this.toHash(this.signatureType,e,n),o=await this.hash(this.signatureType,e,a,n);this.signedHashValue=Nn(Rn(o),0,2);const c=async()=>async function(t,e,r,n,i,s){if(!r||!n)throw Error("Missing key parameters");switch(t){case $n.publicKey.rsaEncryptSign:case $n.publicKey.rsaEncrypt:case $n.publicKey.rsaSign:{const{n:t,e:a}=r,{d:o,p:c,q:u,u:l}=n;return{s:await ji(e,i,t,a,o,c,u,l,s)}}case $n.publicKey.dsa:{const{g:t,p:e,q:i}=r,{x:a}=n;return async function(t,e,r,n,i,s){const a=BigInt(0);let o,c,u,l;n=yi(n),i=yi(i),r=yi(r),s=yi(s),r=di(r,n),s=di(s,i);const f=di(yi(e.subarray(0,wi(i))),i);for(;;){if(o=Ei(to,i),c=di(pi(r,o,n),i),c===a)continue;const t=di(s*c,i);if(l=di(f+t,i),u=di(Ai(o,i)*l,i),u!==a)break}return{r:bi(c,"be",wi(n)),s:bi(u,"be",wi(n))}}(0,s,t,e,i,a)}case $n.publicKey.elgamal:throw Error("Signing with Elgamal is not defined in the OpenPGP standard.");case $n.publicKey.ecdsa:{const{oid:t,Q:a}=r,{d:o}=n;return async function(t,e,r,n,i,s){const a=new Oa(t);if(Fa(a,n),r&&!qn.isStream(r)){const s={publicKey:n,privateKey:i};switch(a.type){case"web":try{return await async function(t,e,r,n){const i=t.payloadSize,s=Ga(t.payloadSize,Ra[t.name],n.publicKey,n.privateKey),a=await $a.importKey("jwk",s,{name:"ECDSA",namedCurve:Ra[t.name],hash:{name:$n.read($n.webHash,t.hash)}},!1,["sign"]),o=new Uint8Array(await $a.sign({name:"ECDSA",namedCurve:Ra[t.name],hash:{name:$n.read($n.webHash,e)}},a,r));return{r:o.slice(0,i),s:o.slice(i,i<<1)}}(a,e,r,s)}catch(t){if("nistP521"!==a.name&&("DataError"===t.name||"OperationError"===t.name))throw t;qn.printDebugError("Browser did not support signing: "+t.message)}break;case"node":return async function(t,e,r,n){const i=qn.nodeRequire("eckey-utils"),s=qn.getNodeBuffer(),{privateKey:a}=i.generateDer({curveName:Ma[t.name],privateKey:s.from(n)}),o=ja.createSign($n.read($n.hash,e));o.write(r),o.end();const c=new Uint8Array(o.sign({key:a,format:"der",type:"sec1",dsaEncoding:"ieee-p1363"})),u=t.payloadSize;return{r:c.subarray(0,u),s:c.subarray(u,u<<1)}}(a,e,r,i)}}const o=(await qn.getNobleCurve($n.publicKey.ecdsa,a.name)).sign(s,i,{lowS:!1});return{r:bi(o.r,"be",a.payloadSize),s:bi(o.s,"be",a.payloadSize)}}(t,e,i,a,o,s)}case $n.publicKey.eddsaLegacy:{const{oid:t,Q:i}=r,{seed:a}=n;return async function(t,e,r,n,i,s){if(Fa(new Oa(t),n),Ni(e)<Ni($n.hash.sha256))throw Error("Hash algorithm too weak for EdDSA.");const{RS:a}=await ls($n.publicKey.ed25519,e,0,n.subarray(1),i,s);return{r:a.subarray(0,32),s:a.subarray(32)}}(t,e,0,i,a,s)}case $n.publicKey.ed25519:case $n.publicKey.ed448:{const{A:i}=r,{seed:a}=n;return ls(t,e,0,i,a,s)}default:throw Error("Unknown signature algorithm.")}}(this.publicKeyAlgorithm,this.hashAlgorithm,t.publicParams,t.privateParams,a,await On(o));qn.isStream(o)?this.params=c():(this.params=await c(),this[Wc]=!0)}writeHashedSubPackets(){const t=$n.signatureSubpacket,e=[];let r;if(null===this.created)throw Error("Missing signature creation time");e.push(ru(t.signatureCreationTime,!0,qn.writeDate(this.created))),null!==this.signatureExpirationTime&&e.push(ru(t.signatureExpirationTime,!0,qn.writeNumber(this.signatureExpirationTime,4))),null!==this.exportable&&e.push(ru(t.exportableCertification,!0,new Uint8Array([this.exportable?1:0]))),null!==this.trustLevel&&(r=new Uint8Array([this.trustLevel,this.trustAmount]),e.push(ru(t.trustSignature,!0,r))),null!==this.regularExpression&&e.push(ru(t.regularExpression,!0,this.regularExpression)),null!==this.revocable&&e.push(ru(t.revocable,!0,new Uint8Array([this.revocable?1:0]))),null!==this.keyExpirationTime&&e.push(ru(t.keyExpirationTime,!0,qn.writeNumber(this.keyExpirationTime,4))),null!==this.preferredSymmetricAlgorithms&&(r=qn.stringToUint8Array(qn.uint8ArrayToString(this.preferredSymmetricAlgorithms)),e.push(ru(t.preferredSymmetricAlgorithms,!1,r))),null!==this.revocationKeyClass&&(r=new Uint8Array([this.revocationKeyClass,this.revocationKeyAlgorithm]),r=qn.concat([r,this.revocationKeyFingerprint]),e.push(ru(t.revocationKey,!1,r))),!this.issuerKeyID.isNull()&&this.issuerKeyVersion<5&&e.push(ru(t.issuerKeyID,!1,this.issuerKeyID.write())),this.rawNotations.forEach(({name:n,value:i,humanReadable:s,critical:a})=>{r=[new Uint8Array([s?128:0,0,0,0])];const o=qn.encodeUTF8(n);r.push(qn.writeNumber(o.length,2)),r.push(qn.writeNumber(i.length,2)),r.push(o),r.push(i),r=qn.concat(r),e.push(ru(t.notationData,a,r))}),null!==this.preferredHashAlgorithms&&(r=qn.stringToUint8Array(qn.uint8ArrayToString(this.preferredHashAlgorithms)),e.push(ru(t.preferredHashAlgorithms,!1,r))),null!==this.preferredCompressionAlgorithms&&(r=qn.stringToUint8Array(qn.uint8ArrayToString(this.preferredCompressionAlgorithms)),e.push(ru(t.preferredCompressionAlgorithms,!1,r))),null!==this.keyServerPreferences&&(r=qn.stringToUint8Array(qn.uint8ArrayToString(this.keyServerPreferences)),e.push(ru(t.keyServerPreferences,!1,r))),null!==this.preferredKeyServer&&e.push(ru(t.preferredKeyServer,!1,qn.encodeUTF8(this.preferredKeyServer))),null!==this.isPrimaryUserID&&e.push(ru(t.primaryUserID,!1,new Uint8Array([this.isPrimaryUserID?1:0]))),null!==this.policyURI&&e.push(ru(t.policyURI,!1,qn.encodeUTF8(this.policyURI))),null!==this.keyFlags&&(r=qn.stringToUint8Array(qn.uint8ArrayToString(this.keyFlags)),e.push(ru(t.keyFlags,!0,r))),null!==this.signersUserID&&e.push(ru(t.signersUserID,!1,qn.encodeUTF8(this.signersUserID))),null!==this.reasonForRevocationFlag&&(r=qn.stringToUint8Array(String.fromCharCode(this.reasonForRevocationFlag)+this.reasonForRevocationString),e.push(ru(t.reasonForRevocation,!0,r))),null!==this.features&&(r=qn.stringToUint8Array(qn.uint8ArrayToString(this.features)),e.push(ru(t.features,!1,r))),null!==this.signatureTargetPublicKeyAlgorithm&&(r=[new Uint8Array([this.signatureTargetPublicKeyAlgorithm,this.signatureTargetHashAlgorithm])],r.push(qn.stringToUint8Array(this.signatureTargetHash)),r=qn.concat(r),e.push(ru(t.signatureTarget,!0,r))),null!==this.embeddedSignature&&e.push(ru(t.embeddedSignature,!0,this.embeddedSignature.write())),null!==this.issuerFingerprint&&(r=[new Uint8Array([this.issuerKeyVersion]),this.issuerFingerprint],r=qn.concat(r),e.push(ru(t.issuerFingerprint,this.version>=5,r))),null!==this.preferredAEADAlgorithms&&(r=qn.stringToUint8Array(qn.uint8ArrayToString(this.preferredAEADAlgorithms)),e.push(ru(t.preferredAEADAlgorithms,!1,r))),null!==this.preferredCipherSuites&&(r=new Uint8Array([].concat(...this.preferredCipherSuites)),e.push(ru(t.preferredCipherSuites,!1,r)));const n=qn.concat(e),i=qn.writeNumber(n.length,6===this.version?4:2);return qn.concat([i,n])}writeUnhashedSubPackets(){const t=this.unhashedSubpackets.map(({type:t,critical:e,body:r})=>ru(t,e,r)),e=qn.concat(t),r=qn.writeNumber(e.length,6===this.version?4:2);return qn.concat([r,e])}readSubPacket(t,e=!0){let r=0;const n=!!(128&t[r]),i=127&t[r];if(r++,e||(this.unhashedSubpackets.push({type:i,critical:n,body:t.subarray(r,t.length)}),tu.has(i)))switch(i){case $n.signatureSubpacket.signatureCreationTime:this.created=qn.readDate(t.subarray(r,t.length));break;case $n.signatureSubpacket.signatureExpirationTime:{const e=qn.readNumber(t.subarray(r,t.length));this.signatureNeverExpires=0===e,this.signatureExpirationTime=e;break}case $n.signatureSubpacket.exportableCertification:this.exportable=1===t[r++];break;case $n.signatureSubpacket.trustSignature:this.trustLevel=t[r++],this.trustAmount=t[r++];break;case $n.signatureSubpacket.regularExpression:this.regularExpression=t[r];break;case $n.signatureSubpacket.revocable:this.revocable=1===t[r++];break;case $n.signatureSubpacket.keyExpirationTime:{const e=qn.readNumber(t.subarray(r,t.length));this.keyExpirationTime=e,this.keyNeverExpires=0===e;break}case $n.signatureSubpacket.preferredSymmetricAlgorithms:this.preferredSymmetricAlgorithms=[...t.subarray(r,t.length)];break;case $n.signatureSubpacket.revocationKey:this.revocationKeyClass=t[r++],this.revocationKeyAlgorithm=t[r++],this.revocationKeyFingerprint=t.subarray(r,r+20);break;case $n.signatureSubpacket.issuerKeyID:if(4===this.version)this.issuerKeyID.read(t.subarray(r,t.length));else if(e)throw Error("Unexpected Issuer Key ID subpacket");break;case $n.signatureSubpacket.notationData:{const e=!!(128&t[r]);r+=4;const i=qn.readNumber(t.subarray(r,r+2));r+=2;const s=qn.readNumber(t.subarray(r,r+2));r+=2;const a=qn.decodeUTF8(t.subarray(r,r+i)),o=t.subarray(r+i,r+i+s);this.rawNotations.push({name:a,humanReadable:e,value:o,critical:n}),e&&(this.notations[a]=qn.decodeUTF8(o));break}case $n.signatureSubpacket.preferredHashAlgorithms:this.preferredHashAlgorithms=[...t.subarray(r,t.length)];break;case $n.signatureSubpacket.preferredCompressionAlgorithms:this.preferredCompressionAlgorithms=[...t.subarray(r,t.length)];break;case $n.signatureSubpacket.keyServerPreferences:this.keyServerPreferences=[...t.subarray(r,t.length)];break;case $n.signatureSubpacket.preferredKeyServer:this.preferredKeyServer=qn.decodeUTF8(t.subarray(r,t.length));break;case $n.signatureSubpacket.primaryUserID:this.isPrimaryUserID=0!==t[r++];break;case $n.signatureSubpacket.policyURI:this.policyURI=qn.decodeUTF8(t.subarray(r,t.length));break;case $n.signatureSubpacket.keyFlags:this.keyFlags=[...t.subarray(r,t.length)];break;case $n.signatureSubpacket.signersUserID:this.signersUserID=qn.decodeUTF8(t.subarray(r,t.length));break;case $n.signatureSubpacket.reasonForRevocation:this.reasonForRevocationFlag=t[r++],this.reasonForRevocationString=qn.decodeUTF8(t.subarray(r,t.length));break;case $n.signatureSubpacket.features:this.features=[...t.subarray(r,t.length)];break;case $n.signatureSubpacket.signatureTarget:{this.signatureTargetPublicKeyAlgorithm=t[r++],this.signatureTargetHashAlgorithm=t[r++];const e=Ni(this.signatureTargetHashAlgorithm);this.signatureTargetHash=qn.uint8ArrayToString(t.subarray(r,r+e));break}case $n.signatureSubpacket.embeddedSignature:this.embeddedSignature=new eu,this.embeddedSignature.read(t.subarray(r,t.length));break;case $n.signatureSubpacket.issuerFingerprint:this.issuerKeyVersion=t[r++],this.issuerFingerprint=t.subarray(r,t.length),this.issuerKeyVersion>=5?this.issuerKeyID.read(this.issuerFingerprint):this.issuerKeyID.read(this.issuerFingerprint.subarray(-8));break;case $n.signatureSubpacket.preferredAEADAlgorithms:this.preferredAEADAlgorithms=[...t.subarray(r,t.length)];break;case $n.signatureSubpacket.preferredCipherSuites:this.preferredCipherSuites=[];for(let e=r;e<t.length;e+=2)this.preferredCipherSuites.push([t[e],t[e+1]]);break;default:this.unknownSubpackets.push({type:i,critical:n,body:t.subarray(r,t.length)})}}readSubPackets(t,e=!0,r){const n=6===this.version?4:2,i=qn.readNumber(t.subarray(0,n));let s=n;for(;s<2+i;){const n=Xi(t.subarray(s,t.length));s+=n.offset,this.readSubPacket(t.subarray(s,s+n.len),e,r),s+=n.len}return s}toSign(t,e){const r=$n.signature;switch(t){case r.binary:return null!==e.text?qn.encodeUTF8(e.getText(!0)):e.getBytes(!0);case r.text:{const t=e.getBytes(!0);return qn.canonicalizeEOL(t)}case r.standalone:return new Uint8Array(0);case r.certGeneric:case r.certPersona:case r.certCasual:case r.certPositive:case r.certRevocation:{let t,n;if(e.userID)n=180,t=e.userID;else{if(!e.userAttribute)throw Error("Either a userID or userAttribute packet needs to be supplied for certification.");n=209,t=e.userAttribute}const i=t.write();return qn.concat([this.toSign(r.key,e),new Uint8Array([n]),qn.writeNumber(i.length,4),i])}case r.subkeyBinding:case r.subkeyRevocation:case r.keyBinding:return qn.concat([this.toSign(r.key,e),this.toSign(r.key,{key:e.bind})]);case r.key:if(void 0===e.key)throw Error("Key packet is required for this signature.");return e.key.writeForHash(this.version);case r.keyRevocation:return this.toSign(r.key,e);case r.timestamp:return new Uint8Array(0);case r.thirdParty:throw Error("Not implemented");default:throw Error("Unknown signature type.")}}calculateTrailer(t,e){let r=0;return Pn(Rn(this.signatureData),t=>{r+=t.length},()=>{const n=[];return 5!==this.version||this.signatureType!==$n.signature.binary&&this.signatureType!==$n.signature.text||(e?n.push(new Uint8Array(6)):n.push(t.writeHeader())),n.push(new Uint8Array([this.version,255])),5===this.version&&n.push(new Uint8Array(4)),n.push(qn.writeNumber(r,4)),qn.concat(n)})}toHash(t,e,r=!1){const n=this.toSign(t,e);return qn.concat([this.salt||new Uint8Array,n,this.signatureData,this.calculateTrailer(e,r)])}async hash(t,e,r,n=!1){if(6===this.version&&this.salt.length!==nu(this.hashAlgorithm))throw Error("Signature salt does not have the expected length");return r||(r=this.toHash(t,e,n)),Mi(this.hashAlgorithm,r)}async verify(t,e,r,n=new Date,i=!1,s=jn){if(!this.issuerKeyID.equals(t.getKeyID()))throw Error("Signature was not issued by the given public key");if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Public key algorithm used to sign signature does not match issuer key algorithm.");const a=e===$n.signature.binary||e===$n.signature.text;if(!this[Wc]||a){let n,s;if(this.hashed?s=await this.hashed:(n=this.toHash(e,r,i),s=await this.hash(e,r,n)),s=await On(s),this.signedHashValue[0]!==s[0]||this.signedHashValue[1]!==s[1])throw Error("Signed digest did not match");if(this.params=await this.params,this[Wc]=await qo(this.publicKeyAlgorithm,this.hashAlgorithm,this.params,t.publicParams,n,s),!this[Wc])throw Error("Signature verification failed")}const o=qn.normalizeDate(n);if(o&&this.created>o)throw Error("Signature creation time is in the future");if(o&&o>=this.getExpirationTime())throw Error("Signature is expired");if(s.rejectHashAlgorithms.has(this.hashAlgorithm))throw Error("Insecure hash algorithm: "+$n.read($n.hash,this.hashAlgorithm).toUpperCase());if(s.rejectMessageHashAlgorithms.has(this.hashAlgorithm)&&[$n.signature.binary,$n.signature.text].includes(this.signatureType))throw Error("Insecure message hash algorithm: "+$n.read($n.hash,this.hashAlgorithm).toUpperCase());if(this.unknownSubpackets.forEach(({type:t,critical:e})=>{if(e)throw Error("Unknown critical signature subpacket type "+t)}),this.rawNotations.forEach(({name:t,critical:e})=>{if(e&&s.knownNotations.indexOf(t)<0)throw Error("Unknown critical notation: "+t)}),null!==this.revocationKeyClass)throw Error("This key is intended to be revoked with an authorized key, which OpenPGP.js does not support.")}isExpired(t=new Date){const e=qn.normalizeDate(t);return null!==e&&!(this.created<=e&&e<this.getExpirationTime())}getExpirationTime(){return this.signatureNeverExpires?1/0:new Date(this.created.getTime()+1e3*this.signatureExpirationTime)}}function ru(t,e,r){const n=[];return n.push(ts(r.length+1)),n.push(new Uint8Array([(e?128:0)|t])),n.push(r),qn.concat(n)}function nu(t){switch(t){case $n.hash.sha256:return 16;case $n.hash.sha384:return 24;case $n.hash.sha512:return 32;case $n.hash.sha224:case $n.hash.sha3_256:return 16;case $n.hash.sha3_512:return 32;default:throw Error("Unsupported hash function")}}class iu{static get tag(){return $n.packet.onePassSignature}static fromSignaturePacket(t,e){const r=new iu;return r.version=6===t.version?6:3,r.signatureType=t.signatureType,r.hashAlgorithm=t.hashAlgorithm,r.publicKeyAlgorithm=t.publicKeyAlgorithm,r.issuerKeyID=t.issuerKeyID,r.salt=t.salt,r.issuerFingerprint=t.issuerFingerprint,r.flags=e?1:0,r}constructor(){this.version=null,this.signatureType=null,this.hashAlgorithm=null,this.publicKeyAlgorithm=null,this.salt=null,this.issuerKeyID=null,this.issuerFingerprint=null,this.flags=null}read(t){let e=0;if(this.version=t[e++],3!==this.version&&6!==this.version)throw new as(`Version ${this.version} of the one-pass signature packet is unsupported.`);if(this.signatureType=t[e++],this.hashAlgorithm=t[e++],this.publicKeyAlgorithm=t[e++],6===this.version){const r=t[e++];this.salt=t.subarray(e,e+r),e+=r,this.issuerFingerprint=t.subarray(e,e+32),e+=32,this.issuerKeyID=new Jc,this.issuerKeyID.read(this.issuerFingerprint)}else this.issuerKeyID=new Jc,this.issuerKeyID.read(t.subarray(e,e+8)),e+=8;return this.flags=t[e++],this}write(){const t=[new Uint8Array([this.version,this.signatureType,this.hashAlgorithm,this.publicKeyAlgorithm])];return 6===this.version?t.push(new Uint8Array([this.salt.length]),this.salt,this.issuerFingerprint):t.push(this.issuerKeyID.write()),t.push(new Uint8Array([this.flags])),qn.concatUint8Array(t)}calculateTrailer(...t){return Ln(async()=>eu.prototype.calculateTrailer.apply(await this.correspondingSig,t))}async verify(){const t=await this.correspondingSig;if(!t||t.constructor.tag!==$n.packet.signature)throw Error("Corresponding signature packet missing");if(t.signatureType!==this.signatureType||t.hashAlgorithm!==this.hashAlgorithm||t.publicKeyAlgorithm!==this.publicKeyAlgorithm||!t.issuerKeyID.equals(this.issuerKeyID)||3===this.version&&6===t.version||6===this.version&&6!==t.version||6===this.version&&!qn.equalsUint8Array(t.issuerFingerprint,this.issuerFingerprint)||6===this.version&&!qn.equalsUint8Array(t.salt,this.salt))throw Error("Corresponding signature packet does not match one-pass signature packet");return t.hashed=this.hashed,t.verify.apply(t,arguments)}}function su(t,e){if(!e[t]){let r;try{r=$n.read($n.packet,t)}catch(e){throw new os("Unknown packet type with tag: "+t)}throw Error("Packet not allowed in this context: "+r)}return new e[t]}iu.prototype.hash=eu.prototype.hash,iu.prototype.toHash=eu.prototype.toHash,iu.prototype.toSign=eu.prototype.toSign;class au extends Array{static async fromBinary(t,e,r=jn,n=null,i=!1){const s=new au;return await s.read(t,e,r,n,i),s}async read(t,e,r=jn,n=null,i=!1){let s;r.additionalAllowedPackets.length&&(s=qn.constructAllowedPackets(r.additionalAllowedPackets),e={...e,...s}),this.stream=Qn(t,async(t,a)=>{const o=Hn(t),c=zn(a);try{let a=qn.isStream(t);for(;;){let u,l;if(await c.ready,await ss(o,a,async t=>{try{if(t.tag===$n.packet.marker||t.tag===$n.packet.trust||t.tag===$n.packet.padding)return;const i=su(t.tag,e);try{n?.recordPacket(t.tag,s)}catch(t){if(r.enforceGrammar)throw t;qn.printDebugError(t)}i.packets=new au,i.fromStream=qn.isStream(t.packet),l=i.fromStream;try{await i.read(t.packet,r)}catch(t){if(!(t instanceof as))throw qn.wrapError(new cs(`Parsing ${i.constructor.name} failed`),t);throw t}await c.write(i)}catch(e){const n=e instanceof os&&t.tag<=39,s=e instanceof as&&!(e instanceof os)&&!r.ignoreUnsupportedPackets,a=e instanceof cs&&!r.ignoreMalformedPackets,o=is(t.tag);if(n||s||a||o||!(e instanceof os||e instanceof as||e instanceof cs))i?u=e:await c.abort(e);else{const e=new us(t.tag,t.packet);await c.write(e)}qn.printDebugError(e)}}),l&&(a=null),u)throw await o.readToEnd(),u;const f=await o.peekBytes(2);if(!f||!f.length){try{n?.recordEnd()}catch(t){if(r.enforceGrammar)throw t;qn.printDebugError(t)}return await c.ready,void await c.close()}}}catch(t){await c.abort(t)}});const a=Hn(this.stream);for(;;){const{done:t,value:e}=await a.read();if(t?this.stream=null:this.push(e),t||is(e.constructor.tag))break}a.releaseLock()}write(){const t=[];for(let e=0;e<this.length;e++){const r=this[e]instanceof us?this[e].tag:this[e].constructor.tag,n=this[e].write();if(qn.isStream(n)&&is(this[e].constructor.tag)){let e=[],i=0;const s=512;t.push(rs(r)),t.push(Pn(n,t=>{if(e.push(t),i+=t.length,i>=s){const t=Math.min(Math.log(i)/Math.LN2|0,30),r=2**t,n=qn.concat([es(t)].concat(e));return e=[n.subarray(1+r)],i=e[0].length,n.subarray(0,1+r)}},()=>qn.concat([ts(i)].concat(e))))}else{if(qn.isStream(n)){let e=0;t.push(Pn(Rn(n),t=>{e+=t.length},()=>ns(r,e)))}else t.push(ns(r,n.length));t.push(n)}}return qn.concat(t)}filterByTag(...t){const e=new au,r=t=>e=>t===e;for(let n=0;n<this.length;n++)t.some(r(this[n].constructor.tag))&&e.push(this[n]);return e}findPacket(t){return this.find(e=>e.constructor.tag===t)}indexOfTag(...t){const e=[],r=this,n=t=>e=>t===e;for(let i=0;i<this.length;i++)t.some(n(r[i].constructor.tag))&&e.push(i);return e}}class ou extends Error{constructor(...t){super(...t),Error.captureStackTrace&&Error.captureStackTrace(this,ou),this.name="GrammarError"}}var cu;!function(t){t[t.EmptyMessage=0]="EmptyMessage",t[t.PlaintextOrEncryptedData=1]="PlaintextOrEncryptedData",t[t.EncryptedSessionKeys=2]="EncryptedSessionKeys",t[t.StandaloneAdditionalAllowedData=3]="StandaloneAdditionalAllowedData"}(cu||(cu={}));class uu{constructor(){this.state=cu.EmptyMessage,this.leadingOnePassSignatureCounter=0}recordPacket(t,e){switch(this.state){case cu.EmptyMessage:case cu.StandaloneAdditionalAllowedData:switch(t){case $n.packet.literalData:case $n.packet.compressedData:case $n.packet.aeadEncryptedData:case $n.packet.symEncryptedIntegrityProtectedData:case $n.packet.symmetricallyEncryptedData:return void(this.state=cu.PlaintextOrEncryptedData);case $n.packet.signature:if(this.state===cu.StandaloneAdditionalAllowedData&&--this.leadingOnePassSignatureCounter<0)throw new ou("Trailing signature packet without OPS");return;case $n.packet.onePassSignature:if(this.state===cu.StandaloneAdditionalAllowedData)throw new ou("OPS following StandaloneAdditionalAllowedData");return void this.leadingOnePassSignatureCounter++;case $n.packet.publicKeyEncryptedSessionKey:case $n.packet.symEncryptedSessionKey:return void(this.state=cu.EncryptedSessionKeys);default:if(!e?.[t])throw new ou(`Unexpected packet ${t} in state ${this.state}`);return void(this.state=cu.StandaloneAdditionalAllowedData)}case cu.PlaintextOrEncryptedData:if(t===$n.packet.signature){if(--this.leadingOnePassSignatureCounter<0)throw new ou("Trailing signature packet without OPS");return void(this.state=cu.PlaintextOrEncryptedData)}if(!e?.[t])throw new ou(`Unexpected packet ${t} in state ${this.state}`);return void(this.state=cu.PlaintextOrEncryptedData);case cu.EncryptedSessionKeys:switch(t){case $n.packet.publicKeyEncryptedSessionKey:case $n.packet.symEncryptedSessionKey:return void(this.state=cu.EncryptedSessionKeys);case $n.packet.symEncryptedIntegrityProtectedData:case $n.packet.aeadEncryptedData:case $n.packet.symmetricallyEncryptedData:return void(this.state=cu.PlaintextOrEncryptedData);case $n.packet.signature:if(--this.leadingOnePassSignatureCounter<0)throw new ou("Trailing signature packet without OPS");return void(this.state=cu.PlaintextOrEncryptedData);default:if(!e?.[t])throw new ou(`Unexpected packet ${t} in state ${this.state}`);this.state=cu.EncryptedSessionKeys}}}recordEnd(){switch(this.state){case cu.EmptyMessage:case cu.PlaintextOrEncryptedData:case cu.EncryptedSessionKeys:case cu.StandaloneAdditionalAllowedData:if(this.leadingOnePassSignatureCounter>0)throw new ou("Missing trailing signature packets")}}}const lu=qn.constructAllowedPackets([Zc,iu,eu]);class fu{static get tag(){return $n.packet.compressedData}constructor(t=jn){this.packets=null,this.algorithm=t.preferredCompressionAlgorithm,this.compressed=null}async read(t,e=jn){await _n(t,async t=>{this.algorithm=await t.readByte(),this.compressed=t.remainder(),await this.decompress(e)})}write(){return null===this.compressed&&this.compress(),qn.concat([new Uint8Array([this.algorithm]),this.compressed])}async decompress(t=jn){const e=$n.read($n.compression,this.algorithm),r=gu[e];if(!r)throw Error(e+" decompression not supported");this.packets=await au.fromBinary(await r(this.compressed),lu,t,new uu)}compress(){const t=$n.read($n.compression,this.algorithm),e=pu[t];if(!e)throw Error(t+" compression not supported");this.compressed=e(this.packets.write())}}function hu(t,e){return r=>{if(!qn.isStream(r)||wn(r))return Ln(()=>On(r).then(t=>new Promise((r,n)=>{const i=new e,s=[];i.ondata=(t,e)=>{s.push(t),e&&r(qn.concatUint8Array(s))};try{i.push(t,!0)}catch(t){n(t)}})));if(t)try{const e=t();return r.pipeThrough(e)}catch(t){if("TypeError"!==t.name)throw t}const n=r.getReader(),i=new e;return new ReadableStream({async start(t){for(i.ondata=async(e,r)=>{t.enqueue(e),r&&t.close()};;){const{done:t,value:e}=await n.read();if(t)return void i.push(new Uint8Array,!0);e.length&&i.push(e)}}})}}function yu(){return async function(t){const{decode:e}=await Promise.resolve().then(function(){return tg});return Ln(async()=>e(await On(t)))}}const du=t=>({compressor:"undefined"!=typeof CompressionStream&&(()=>new CompressionStream(t)),decompressor:"undefined"!=typeof DecompressionStream&&(()=>new DecompressionStream(t))}),pu={zip:hu(du("deflate-raw").compressor,$c),zlib:hu(du("deflate").compressor,Vc)},gu={uncompressed:t=>t,zip:hu(du("deflate-raw").decompressor,jc),zlib:hu(du("deflate").decompressor,qc),bzip2:yu()},Au=qn.constructAllowedPackets([Zc,fu,iu,eu]);class wu{static get tag(){return $n.packet.symEncryptedIntegrityProtectedData}static fromObject({version:t,aeadAlgorithm:e}){if(1!==t&&2!==t)throw Error("Unsupported SEIPD version");const r=new wu;return r.version=t,2===t&&(r.aeadAlgorithm=e),r}constructor(){this.version=null,this.cipherAlgorithm=null,this.aeadAlgorithm=null,this.chunkSizeByte=null,this.salt=null,this.encrypted=null,this.packets=null}async read(t){await _n(t,async t=>{if(this.version=await t.readByte(),1!==this.version&&2!==this.version)throw new as(`Version ${this.version} of the SEIP packet is unsupported.`);2===this.version&&(this.cipherAlgorithm=await t.readByte(),this.aeadAlgorithm=await t.readByte(),this.chunkSizeByte=await t.readByte(),this.salt=await t.readBytes(32)),this.encrypted=t.remainder()})}write(){return 2===this.version?qn.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.salt,this.encrypted]):qn.concat([new Uint8Array([this.version]),this.encrypted])}async encrypt(t,e,r=jn){const{blockSize:n,keySize:i}=Ea(t);if(e.length!==i)throw Error("Unexpected session key size");let s=this.packets.write();if(wn(s)&&(s=await On(s)),2===this.version)this.cipherAlgorithm=t,this.salt=vi(32),this.chunkSizeByte=r.aeadChunkSizeByte,this.encrypted=await bu(this,"encrypt",e,s);else{const r=await yo(t),i=new Uint8Array([211,20]),a=qn.concat([r,s,i]),o=await Mi($n.hash.sha1,Tn(a)),c=qn.concat([a,o]);this.encrypted=await po(t,e,c,new Uint8Array(n))}return!0}async decrypt(t,e,r=jn){if(e.length!==Ea(t).keySize)throw Error("Unexpected session key size");let n,i=Rn(this.encrypted);wn(i)&&(i=await On(i));let s=!1;if(2===this.version){if(this.cipherAlgorithm!==t)throw Error("Unexpected session key algorithm");n=await bu(this,"decrypt",e,i)}else{const{blockSize:a}=Ea(t),o=await go(t,e,i,new Uint8Array(a)),c=Nn(Tn(o),-20),u=Nn(o,0,-20),l=Promise.all([On(await Mi($n.hash.sha1,Tn(u))),On(c)]).then(([t,e])=>{if(!qn.equalsUint8Array(t,e))throw Error("Modification detected.");return new Uint8Array}),f=Nn(u,a+2);n=Nn(f,0,-2),n=Kn([n,Ln(()=>l)]),qn.isStream(i)&&r.allowUnauthenticatedStream?s=!0:n=await On(n)}return this.packets=await au.fromBinary(n,Au,r,new uu,s),!0}}async function bu(t,e,r,n){const i=t instanceof wu&&2===t.version,s=!i&&t.constructor.tag===$n.packet.aeadEncryptedData;if(!i&&!s)throw Error("Unexpected packet type");const a=Vo(t.aeadAlgorithm,s),o="decrypt"===e?a.tagLength:0,c="encrypt"===e?a.tagLength:0,u=2**(t.chunkSizeByte+6)+o,l=s?8:0,f=new ArrayBuffer(13+l),h=new Uint8Array(f,0,5+l),y=new Uint8Array(f),d=new DataView(f),p=new Uint8Array(f,5,8);h.set([192|t.constructor.tag,t.version,t.cipherAlgorithm,t.aeadAlgorithm,t.chunkSizeByte],0);let g,A,w=0,b=Promise.resolve(),m=0,v=0;if(i){const{keySize:e}=Ea(t.cipherAlgorithm),{ivLength:n}=a,i=new Uint8Array(f,0,5),s=await Sa($n.hash.sha256,r,t.salt,i,e+n);r=s.subarray(0,e),g=s.subarray(e),g.fill(0,g.length-8),A=new DataView(g.buffer,g.byteOffset,g.byteLength)}else g=t.iv;const E=await a(t.cipherAlgorithm,r);return Qn(n,async(r,n)=>{if("array"!==qn.isStream(r)){const e=new TransformStream({},{highWaterMark:qn.getHardwareConcurrency()*2**(t.chunkSizeByte+6),size:t=>t.length});Dn(e.readable,n),n=e.writable}const s=Hn(r),a=zn(n);try{for(;;){let t=await s.readBytes(u+o)||new Uint8Array;const r=t.subarray(t.length-o);let n,f,k;if(t=t.subarray(0,t.length-o),i)k=g;else{k=g.slice();for(let t=0;t<8;t++)k[g.length-8+t]^=p[t]}if(!w||t.length?(s.unshift(r),n=E[e](t,k,h),n.catch(()=>{}),v+=t.length-o+c):(d.setInt32(5+l+4,m),n=E[e](r,k,y),n.catch(()=>{}),v+=c,f=!0),m+=t.length-o,b=b.then(()=>n).then(async t=>{await a.ready,await a.write(t),v-=t.length}).catch(t=>a.abort(t)),(f||v>a.desiredSize)&&await b,f){await a.close();break}i?A.setInt32(g.length-4,++w):d.setInt32(9,++w)}}catch(t){await a.ready.catch(()=>{}),await a.abort(t)}})}const mu=qn.constructAllowedPackets([Zc,fu,iu,eu]);class vu{static get tag(){return $n.packet.publicKeyEncryptedSessionKey}constructor(){this.version=null,this.publicKeyID=new Jc,this.publicKeyVersion=null,this.publicKeyFingerprint=null,this.publicKeyAlgorithm=null,this.sessionKey=null,this.sessionKeyAlgorithm=null,this.encrypted={}}static fromObject({version:t,encryptionKeyPacket:e,anonymousRecipient:r,sessionKey:n,sessionKeyAlgorithm:i}){const s=new vu;if(3!==t&&6!==t)throw Error("Unsupported PKESK version");return s.version=t,6===t&&(s.publicKeyVersion=r?null:e.version,s.publicKeyFingerprint=r?null:e.getFingerprintBytes()),s.publicKeyID=r?Jc.wildcard():e.getKeyID(),s.publicKeyAlgorithm=e.algorithm,s.sessionKey=n,s.sessionKeyAlgorithm=i,s}read(t){let e=0;if(this.version=t[e++],3!==this.version&&6!==this.version)throw new as(`Version ${this.version} of the PKESK packet is unsupported.`);if(6===this.version){const r=t[e++];if(r){this.publicKeyVersion=t[e++];const n=r-1;this.publicKeyFingerprint=t.subarray(e,e+n),e+=n,this.publicKeyVersion>=5?this.publicKeyID.read(this.publicKeyFingerprint):this.publicKeyID.read(this.publicKeyFingerprint.subarray(-8))}else this.publicKeyID=Jc.wildcard()}else e+=this.publicKeyID.read(t.subarray(e,e+8));if(this.publicKeyAlgorithm=t[e++],this.encrypted=function(t,e){let r=0;switch(t){case $n.publicKey.rsaEncrypt:case $n.publicKey.rsaEncryptSign:return{c:qn.readMPI(e.subarray(r))};case $n.publicKey.elgamal:{const t=qn.readMPI(e.subarray(r));return r+=t.length+2,{c1:t,c2:qn.readMPI(e.subarray(r))}}case $n.publicKey.ecdh:{const t=qn.readMPI(e.subarray(r));r+=t.length+2;const n=new eo;return n.read(e.subarray(r)),{V:t,C:n}}case $n.publicKey.x25519:case $n.publicKey.x448:{const n=co(t),i=qn.readExactSubarray(e,r,r+n);r+=i.length;const s=new no;return s.read(e.subarray(r)),{ephemeralPublicKey:i,C:s}}default:throw new as("Unknown public key encryption algorithm.")}}(this.publicKeyAlgorithm,t.subarray(e)),this.publicKeyAlgorithm===$n.publicKey.x25519||this.publicKeyAlgorithm===$n.publicKey.x448)if(3===this.version)this.sessionKeyAlgorithm=$n.write($n.symmetric,this.encrypted.C.algorithm);else if(null!==this.encrypted.C.algorithm)throw Error("Unexpected cleartext symmetric algorithm")}write(){const t=[new Uint8Array([this.version])];return 6===this.version?null!==this.publicKeyFingerprint?(t.push(new Uint8Array([this.publicKeyFingerprint.length+1,this.publicKeyVersion])),t.push(this.publicKeyFingerprint)):t.push(new Uint8Array([0])):t.push(this.publicKeyID.write()),t.push(new Uint8Array([this.publicKeyAlgorithm]),so(this.publicKeyAlgorithm,this.encrypted)),qn.concatUint8Array(t)}async encrypt(t){const e=$n.write($n.publicKey,this.publicKeyAlgorithm),r=3===this.version?this.sessionKeyAlgorithm:null,n=5===t.version?t.getFingerprintBytes().subarray(0,20):t.getFingerprintBytes(),i=Eu(this.version,e,r,this.sessionKey);this.encrypted=await async function(t,e,r,n,i){switch(t){case $n.publicKey.rsaEncrypt:case $n.publicKey.rsaEncryptSign:{const{n:t,e}=r;return{c:await Vi(n,t,e)}}case $n.publicKey.elgamal:{const{p:t,g:e,y:i}=r;return async function(t,e,r,n){e=yi(e),r=yi(r),n=yi(n);const i=yi(Fi(t,wi(e))),s=Ei(Zi,e-Zi);return{c1:bi(pi(r,s,e)),c2:bi(di(pi(n,s,e)*i,e))}}(n,t,e,i)}case $n.publicKey.ecdh:{const{oid:t,Q:e,kdfParams:s}=r,{publicKey:a,wrappedKey:o}=await async function(t,e,r,n,i){const s=function(t){const e=8-t.length%8,r=new Uint8Array(t.length+e).fill(e);return r.set(t),r}(r),a=new Oa(t);Fa(a,n);const{publicKey:o,sharedKey:c}=await async function(t,e){switch(t.type){case"curve25519Legacy":{const{sharedSecret:r,ephemeralPublicKey:n}=await Da($n.publicKey.x25519,e.subarray(1));return{publicKey:qn.concatUint8Array([new Uint8Array([t.wireFormatLeadingByte]),n]),sharedKey:r}}case"web":if(t.web&&qn.getWebCrypto())try{return await async function(t,e){const r=qn.getWebCrypto(),n=za(t.payloadSize,t.web,e);let i=r.generateKey({name:"ECDH",namedCurve:t.web},!0,["deriveKey","deriveBits"]),s=r.importKey("jwk",n,{name:"ECDH",namedCurve:t.web},!1,[]);[i,s]=await Promise.all([i,s]);let a=r.deriveBits({name:"ECDH",namedCurve:t.web,public:s},i.privateKey,t.sharedSize),o=r.exportKey("jwk",i.publicKey);[a,o]=await Promise.all([a,o]);const c=new Uint8Array(a);return{publicKey:new Uint8Array(Ha(o,t.wireFormatLeadingByte)),sharedKey:c}}(t,e)}catch(r){return qn.printDebugError(r),Wa(t,e)}break;case"node":return async function(t,e){const r=qn.getNodeCrypto().createECDH(t.node);r.generateKeys();const n=new Uint8Array(r.computeSecret(e));return{publicKey:new Uint8Array(r.getPublicKey()),sharedKey:n}}(t,e);default:return Wa(t,e)}}(a,n),u=Ya($n.publicKey.ecdh,t,e,i),{keySize:l}=Ea(e.cipher),f=await Za(e.hash,c,l,u);return{publicKey:o,wrappedKey:await Ba(e.cipher,f,s)}}(t,s,n,e,i);return{V:a,C:new eo(o)}}case $n.publicKey.x25519:case $n.publicKey.x448:{if(e&&!qn.isAES(e))throw Error("X25519 and X448 keys can only encrypt AES session keys");const{A:i}=r,{ephemeralPublicKey:s,wrappedKey:a}=await async function(t,e,r){const{ephemeralPublicKey:n,sharedSecret:i}=await Da(t,r),s=qn.concatUint8Array([n,r,i]);switch(t){case $n.publicKey.x25519:{const t=$n.symmetric.aes128,{keySize:r}=Ea(t),i=await Sa($n.hash.sha256,s,new Uint8Array,Ca.x25519,r);return{ephemeralPublicKey:n,wrappedKey:await Ba(t,i,e)}}case $n.publicKey.x448:{const t=$n.symmetric.aes256,{keySize:r}=Ea($n.symmetric.aes256),i=await Sa($n.hash.sha512,s,new Uint8Array,Ca.x448,r);return{ephemeralPublicKey:n,wrappedKey:await Ba(t,i,e)}}default:throw Error("Unsupported ECDH algorithm")}}(t,n,i);return{ephemeralPublicKey:s,C:no.fromObject({algorithm:e,wrappedKey:a})}}default:return[]}}(e,r,t.publicParams,i,n)}async decrypt(t,e){if(this.publicKeyAlgorithm!==t.algorithm)throw Error("Decryption error");const r=e?Eu(this.version,this.publicKeyAlgorithm,e.sessionKeyAlgorithm,e.sessionKey):null,n=5===t.version?t.getFingerprintBytes().subarray(0,20):t.getFingerprintBytes(),i=await io(this.publicKeyAlgorithm,t.publicParams,t.privateParams,this.encrypted,n,r),{sessionKey:s,sessionKeyAlgorithm:a}=function(t,e,r,n){switch(e){case $n.publicKey.rsaEncrypt:case $n.publicKey.rsaEncryptSign:case $n.publicKey.elgamal:case $n.publicKey.ecdh:{const e=r.subarray(0,r.length-2),i=r.subarray(r.length-2),s=qn.writeChecksum(e.subarray(e.length%8)),a=s[0]===i[0]&s[1]===i[1],o=6===t?{sessionKeyAlgorithm:null,sessionKey:e}:{sessionKeyAlgorithm:e[0],sessionKey:e.subarray(1)};if(n){const e=a&o.sessionKeyAlgorithm===n.sessionKeyAlgorithm&o.sessionKey.length===n.sessionKey.length;return{sessionKey:qn.selectUint8Array(e,o.sessionKey,n.sessionKey),sessionKeyAlgorithm:6===t?null:qn.selectUint8(e,o.sessionKeyAlgorithm,n.sessionKeyAlgorithm)}}if(a&&(6===t||$n.read($n.symmetric,o.sessionKeyAlgorithm)))return o;throw Error("Decryption error")}case $n.publicKey.x25519:case $n.publicKey.x448:return{sessionKeyAlgorithm:null,sessionKey:r};default:throw Error("Unsupported public key algorithm")}}(this.version,this.publicKeyAlgorithm,i,e);if(3===this.version){const t=this.publicKeyAlgorithm!==$n.publicKey.x25519&&this.publicKeyAlgorithm!==$n.publicKey.x448;if(this.sessionKeyAlgorithm=t?a:this.sessionKeyAlgorithm,s.length!==Ea(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}this.sessionKey=s}}function Eu(t,e,r,n){switch(e){case $n.publicKey.rsaEncrypt:case $n.publicKey.rsaEncryptSign:case $n.publicKey.elgamal:case $n.publicKey.ecdh:return qn.concatUint8Array([new Uint8Array(6===t?[]:[r]),n,qn.writeChecksum(n.subarray(n.length%8))]);case $n.publicKey.x25519:case $n.publicKey.x448:return n;default:throw Error("Unsupported public key algorithm")}}class ku{static get tag(){return $n.packet.symEncryptedSessionKey}constructor(t=jn){this.version=t.aeadProtect?6:4,this.sessionKey=null,this.sessionKeyEncryptionAlgorithm=null,this.sessionKeyAlgorithm=null,this.aeadAlgorithm=$n.write($n.aead,t.preferredAEADAlgorithm),this.encrypted=null,this.s2k=null,this.iv=null}read(t){let e=0;if(this.version=t[e++],4!==this.version&&5!==this.version&&6!==this.version)throw new as(`Version ${this.version} of the SKESK packet is unsupported.`);6===this.version&&e++;const r=t[e++];this.version>=5&&(this.aeadAlgorithm=t[e++],6===this.version&&e++);const n=t[e++];if(this.s2k=ec(n),e+=this.s2k.read(t.subarray(e,t.length)),this.version>=5){const r=Vo(this.aeadAlgorithm,!0);this.iv=t.subarray(e,e+=r.ivLength)}this.version>=5||e<t.length?(this.encrypted=t.subarray(e,t.length),this.sessionKeyEncryptionAlgorithm=r):this.sessionKeyAlgorithm=r}write(){const t=null===this.encrypted?this.sessionKeyAlgorithm:this.sessionKeyEncryptionAlgorithm;let e;const r=this.s2k.write();if(6===this.version){const n=r.length,i=3+n+this.iv.length;e=qn.concatUint8Array([new Uint8Array([this.version,i,t,this.aeadAlgorithm,n]),r,this.iv,this.encrypted])}else 5===this.version?e=qn.concatUint8Array([new Uint8Array([this.version,t,this.aeadAlgorithm]),r,this.iv,this.encrypted]):(e=qn.concatUint8Array([new Uint8Array([this.version,t]),r]),null!==this.encrypted&&(e=qn.concatUint8Array([e,this.encrypted])));return e}async decrypt(t){const e=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm,{blockSize:r,keySize:n}=Ea(e),i=await this.s2k.produceKey(t,n);if(this.version>=5){const t=Vo(this.aeadAlgorithm,!0),r=new Uint8Array([192|ku.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),s=6===this.version?await Sa($n.hash.sha256,i,new Uint8Array,r,n):i,a=await t(e,s);this.sessionKey=await a.decrypt(this.encrypted,this.iv,r)}else if(null!==this.encrypted){const t=await go(e,i,this.encrypted,new Uint8Array(r));if(this.sessionKeyAlgorithm=$n.write($n.symmetric,t[0]),this.sessionKey=t.subarray(1,t.length),this.sessionKey.length!==Ea(this.sessionKeyAlgorithm).keySize)throw Error("Unexpected session key size")}else this.sessionKey=i}async encrypt(t,e=jn){const r=null!==this.sessionKeyEncryptionAlgorithm?this.sessionKeyEncryptionAlgorithm:this.sessionKeyAlgorithm;this.sessionKeyEncryptionAlgorithm=r,this.s2k=function(t){const{s2kType:e}=t;if(!tc.has(e))throw Error("The provided `config.s2kType` value is not allowed");return ec(e,t)}(e),this.s2k.generateSalt();const{blockSize:n,keySize:i}=Ea(r),s=await this.s2k.produceKey(t,i);if(null===this.sessionKey&&(this.sessionKey=ao(this.sessionKeyAlgorithm)),this.version>=5){const t=Vo(this.aeadAlgorithm);this.iv=vi(t.ivLength);const e=new Uint8Array([192|ku.tag,this.version,this.sessionKeyEncryptionAlgorithm,this.aeadAlgorithm]),n=6===this.version?await Sa($n.hash.sha256,s,new Uint8Array,e,i):s,a=await t(r,n);this.encrypted=await a.encrypt(this.sessionKey,this.iv,e)}else{const t=qn.concatUint8Array([new Uint8Array([this.sessionKeyAlgorithm]),this.sessionKey]);this.encrypted=await po(r,s,t,new Uint8Array(n))}}}class Bu{static get tag(){return $n.packet.publicKey}constructor(t=new Date,e=jn){this.version=e.v6Keys?6:4,this.created=qn.normalizeDate(t),this.algorithm=null,this.publicParams=null,this.expirationTimeV3=0,this.fingerprint=null,this.keyID=null}static fromSecretKeyPacket(t){const e=new Bu,{version:r,created:n,algorithm:i,publicParams:s,keyID:a,fingerprint:o}=t;return e.version=r,e.created=n,e.algorithm=i,e.publicParams=s,e.keyID=a,e.fingerprint=o,e}async read(t,e=jn){let r=0;if(this.version=t[r++],5===this.version&&!e.enableParsingV5Entities)throw new as("Support for parsing v5 entities is disabled; turn on `config.enableParsingV5Entities` if needed");if(4===this.version||5===this.version||6===this.version){this.created=qn.readDate(t.subarray(r,r+4)),r+=4,this.algorithm=t[r++],this.version>=5&&(r+=4);const{read:e,publicParams:n}=function(t,e){let r=0;switch(t){case $n.publicKey.rsaEncrypt:case $n.publicKey.rsaEncryptSign:case $n.publicKey.rsaSign:{const t=qn.readMPI(e.subarray(r));r+=t.length+2;const n=qn.readMPI(e.subarray(r));return r+=n.length+2,{read:r,publicParams:{n:t,e:n}}}case $n.publicKey.dsa:{const t=qn.readMPI(e.subarray(r));r+=t.length+2;const n=qn.readMPI(e.subarray(r));r+=n.length+2;const i=qn.readMPI(e.subarray(r));r+=i.length+2;const s=qn.readMPI(e.subarray(r));return r+=s.length+2,{read:r,publicParams:{p:t,q:n,g:i,y:s}}}case $n.publicKey.elgamal:{const t=qn.readMPI(e.subarray(r));r+=t.length+2;const n=qn.readMPI(e.subarray(r));r+=n.length+2;const i=qn.readMPI(e.subarray(r));return r+=i.length+2,{read:r,publicParams:{p:t,g:n,y:i}}}case $n.publicKey.ecdsa:{const t=new Wi;r+=t.read(e),oo(t);const n=qn.readMPI(e.subarray(r));return r+=n.length+2,{read:r,publicParams:{oid:t,Q:n}}}case $n.publicKey.eddsaLegacy:{const t=new Wi;if(r+=t.read(e),oo(t),t.getName()!==$n.curve.ed25519Legacy)throw Error("Unexpected OID for eddsaLegacy");let n=qn.readMPI(e.subarray(r));return r+=n.length+2,n=qn.leftPad(n,33),{read:r,publicParams:{oid:t,Q:n}}}case $n.publicKey.ecdh:{const t=new Wi;r+=t.read(e),oo(t);const n=qn.readMPI(e.subarray(r));r+=n.length+2;const i=new ro;return r+=i.read(e.subarray(r)),{read:r,publicParams:{oid:t,Q:n,kdfParams:i}}}case $n.publicKey.ed25519:case $n.publicKey.ed448:case $n.publicKey.x25519:case $n.publicKey.x448:{const n=qn.readExactSubarray(e,r,r+co(t));return r+=n.length,{read:r,publicParams:{A:n}}}default:throw new as("Unknown public key encryption algorithm.")}}(this.algorithm,t.subarray(r));if(6===this.version&&n.oid&&(n.oid.getName()===$n.curve.curve25519Legacy||n.oid.getName()===$n.curve.ed25519Legacy))throw Error("Legacy curve25519 cannot be used with v6 keys");return this.publicParams=n,r+=e,await this.computeFingerprintAndKeyID(),r}throw new as(`Version ${this.version} of the key packet is unsupported.`)}write(){const t=[];t.push(new Uint8Array([this.version])),t.push(qn.writeDate(this.created)),t.push(new Uint8Array([this.algorithm]));const e=so(this.algorithm,this.publicParams);return this.version>=5&&t.push(qn.writeNumber(e.length,4)),t.push(e),qn.concatUint8Array(t)}writeForHash(t){const e=this.writePublicKey(),r=149+t,n=t>=5?4:2;return qn.concatUint8Array([new Uint8Array([r]),qn.writeNumber(e.length,n),e])}isDecrypted(){return null}getCreationTime(){return this.created}getKeyID(){return this.keyID}async computeFingerprintAndKeyID(){if(await this.computeFingerprint(),this.keyID=new Jc,this.version>=5)this.keyID.read(this.fingerprint.subarray(0,8));else{if(4!==this.version)throw Error("Unsupported key version");this.keyID.read(this.fingerprint.subarray(12,20))}}async computeFingerprint(){const t=this.writeForHash(this.version);if(this.version>=5)this.fingerprint=await Mi($n.hash.sha256,t);else{if(4!==this.version)throw Error("Unsupported key version");this.fingerprint=await Mi($n.hash.sha1,t)}}getFingerprintBytes(){return this.fingerprint}getFingerprint(){return qn.uint8ArrayToHex(this.getFingerprintBytes())}hasSameFingerprintAs(t){return this.version===t.version&&qn.equalsUint8Array(this.writePublicKey(),t.writePublicKey())}getAlgorithmInfo(){const t={};t.algorithm=$n.read($n.publicKey,this.algorithm);const e=this.publicParams.n||this.publicParams.p;return e?t.bits=qn.uint8ArrayBitLength(e):this.publicParams.oid&&(t.curve=this.publicParams.oid.getName()),t}}Bu.prototype.readPublicKey=Bu.prototype.read,Bu.prototype.writePublicKey=Bu.prototype.write;const Iu=qn.constructAllowedPackets([Zc,fu,iu,eu]);class Su{constructor(t){this.packets=t||new au}write(){return this.packets.write()}armor(t=jn){const e=this.packets.some(t=>t.constructor.tag===eu.tag&&6!==t.version);return li($n.armor.signature,this.write(),void 0,void 0,void 0,e,t)}getSigningKeyIDs(){return this.packets.map(t=>t.issuerKeyID)}}async function Cu(t,e,r,n,i=new Date,s){let a,o;for(let c=t.length-1;c>=0;c--)try{(!a||t[c].created>=a.created)&&(await t[c].verify(e,r,n,i,void 0,s),a=t[c])}catch(t){o=t}if(!a)throw qn.wrapError(`Could not find valid ${$n.read($n.signature,r)} signature in key ${e.getKeyID().toHex()}`.replace("certGeneric ","self-").replace(/([a-z])([A-Z])/g,(t,e,r)=>e+" "+r.toLowerCase()),o);return a}function Ku(t,e,r=new Date){const n=qn.normalizeDate(r);if(null!==n){const r=Pu(t,e);return!(t.created<=n&&n<r)}return!1}async function Du(t,e,r,n,i,s,a=[],o=!1,c){if(r.isDummy())throw Error("Cannot sign with a gnu-dummy key.");if(!r.isDecrypted())throw Error("Signing key is not decrypted.");const u=new eu;return Object.assign(u,n),u.publicKeyAlgorithm=r.algorithm,u.hashAlgorithm=await async function(t,e,r=new Date,n=[],i){const s=$n.hash.sha256,a=i.preferredHashAlgorithm,o=await Promise.all(t.map(async(t,e)=>(await t.getPrimarySelfSignature(r,n[e],i)).preferredHashAlgorithms||[])),c=new Map;for(const t of o)for(const e of t)try{const t=$n.write($n.hash,e);c.set(t,c.has(t)?c.get(t)+1:1)}catch{}const u=e=>0===t.length||c.get(e)===t.length||e===s,l=()=>{if(0===c.size)return s;const t=Array.from(c.keys()).filter(t=>u(t)).sort((t,e)=>Ni(t)-Ni(e))[0];return Ni(t)>=Ni(s)?t:s};if(new Set([$n.publicKey.ecdsa,$n.publicKey.eddsaLegacy,$n.publicKey.ed25519,$n.publicKey.ed448]).has(e.algorithm)){const t=function(t,e){switch(t){case $n.publicKey.ecdsa:case $n.publicKey.eddsaLegacy:return function(t){return Na[t.getName()].hash}(e);case $n.publicKey.ed25519:case $n.publicKey.ed448:return ys(t);default:throw Error("Unknown elliptic signing algo")}}(e.algorithm,e.publicParams.oid),r=u(a),n=Ni(a)>=Ni(t);if(r&&n)return a;{const e=l();return Ni(e)>=Ni(t)?e:t}}return u(a)?a:l()}(e,r,i,s,c),u.rawNotations=[...a],await u.sign(r,t,i,o,c),u}async function Uu(t,e,r,n=new Date,i){(t=t[r])&&(e[r].length?await Promise.all(t.map(async function(t){t.isExpired(n)||i&&!await i(t)||e[r].some(function(e){return qn.equalsUint8Array(e.writeParams(),t.writeParams())})||e[r].push(t)})):e[r]=t)}async function xu(t,e,r,n,i,s,a=new Date,o){s=s||t;const c=[];return await Promise.all(n.map(async function(t){try{if(!i||t.issuerKeyID.equals(i.issuerKeyID)){const n=![$n.reasonForRevocation.keyRetired,$n.reasonForRevocation.keySuperseded,$n.reasonForRevocation.userIDInvalid].includes(t.reasonForRevocationFlag);await t.verify(s,e,r,n?null:a,!1,o),c.push(t.issuerKeyID)}}catch(t){}})),i?(i.revoked=!!c.some(t=>t.equals(i.issuerKeyID))||i.revoked||!1,i.revoked):c.length>0}function Pu(t,e){let r;return!1===e.keyNeverExpires&&(r=t.created.getTime()+1e3*e.keyExpirationTime),r?new Date(r):1/0}function Qu(t,e,r){switch(t.algorithm){case $n.publicKey.rsaEncryptSign:case $n.publicKey.rsaSign:case $n.publicKey.dsa:case $n.publicKey.ecdsa:case $n.publicKey.eddsaLegacy:case $n.publicKey.ed25519:case $n.publicKey.ed448:if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!e.keyFlags||!!(e.keyFlags[0]&$n.keyFlags.signData);default:return!1}}function _u(t,e,r){switch(t.algorithm){case $n.publicKey.rsaEncryptSign:case $n.publicKey.rsaEncrypt:case $n.publicKey.elgamal:case $n.publicKey.ecdh:case $n.publicKey.x25519:case $n.publicKey.x448:if(!e.keyFlags&&!r.allowMissingKeyFlags)throw Error("None of the key flags is set: consider passing `config.allowMissingKeyFlags`");return!e.keyFlags||!!(e.keyFlags[0]&$n.keyFlags.encryptCommunication)||!!(e.keyFlags[0]&$n.keyFlags.encryptStorage);default:return!1}}function Ru(t,e){const r=$n.write($n.publicKey,t.algorithm),n=t.getAlgorithmInfo();if(e.rejectPublicKeyAlgorithms.has(r))throw Error(n.algorithm+" keys are considered too weak.");switch(r){case $n.publicKey.rsaEncryptSign:case $n.publicKey.rsaSign:case $n.publicKey.rsaEncrypt:if(n.bits<e.minRSABits)throw Error(`RSA keys shorter than ${e.minRSABits} bits are considered too weak.`);break;case $n.publicKey.ecdsa:case $n.publicKey.eddsaLegacy:case $n.publicKey.ecdh:if(e.rejectCurves.has(n.curve))throw Error(`Support for ${n.algorithm} keys using curve ${n.curve} is disabled.`)}}class Tu{constructor(t,e){this.userID=t.constructor.tag===$n.packet.userID?t:null,this.userAttribute=t.constructor.tag===$n.packet.userAttribute?t:null,this.selfCertifications=[],this.otherCertifications=[],this.revocationSignatures=[],this.mainKey=e}toPacketList(){const t=new au;return t.push(this.userID||this.userAttribute),t.push(...this.revocationSignatures),t.push(...this.selfCertifications),t.push(...this.otherCertifications),t}clone(){const t=new Tu(this.userID||this.userAttribute,this.mainKey);return t.selfCertifications=[...this.selfCertifications],t.otherCertifications=[...this.otherCertifications],t.revocationSignatures=[...this.revocationSignatures],t}async certify(t,e,r){const n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n},s=new Tu(i.userID||i.userAttribute,this.mainKey);return s.otherCertifications=await Promise.all(t.map(async function(t){if(!t.isPrivate())throw Error("Need private key for signing");if(t.hasSameFingerprintAs(n))throw Error("The user's own key can only be used for self-certifications");const s=await t.getSigningKey(void 0,e,void 0,r);return Du(i,[t],s.keyPacket,{signatureType:$n.signature.certGeneric,keyFlags:[$n.keyFlags.certifyKeys|$n.keyFlags.signData]},e,void 0,void 0,void 0,r)})),await s.update(this,e,r),s}async isRevoked(t,e,r=new Date,n=jn){const i=this.mainKey.keyPacket;return xu(i,$n.signature.certRevocation,{key:i,userID:this.userID,userAttribute:this.userAttribute},this.revocationSignatures,t,e,r,n)}async verifyCertificate(t,e,r=new Date,n){const i=this,s=this.mainKey.keyPacket,a={userID:this.userID,userAttribute:this.userAttribute,key:s},{issuerKeyID:o}=t,c=e.filter(t=>t.getKeys(o).length>0);return 0===c.length?null:(await Promise.all(c.map(async e=>{const s=await e.getSigningKey(o,t.created,void 0,n);if(t.revoked||await i.isRevoked(t,s.keyPacket,r,n))throw Error("User certificate is revoked");try{await t.verify(s.keyPacket,$n.signature.certGeneric,a,r,void 0,n)}catch(t){throw qn.wrapError("User certificate is invalid",t)}})),!0)}async verifyAllCertifications(t,e=new Date,r){const n=this,i=this.selfCertifications.concat(this.otherCertifications);return Promise.all(i.map(async i=>({keyID:i.issuerKeyID,valid:await n.verifyCertificate(i,t,e,r).catch(()=>!1)})))}async verify(t=new Date,e){if(!this.selfCertifications.length)throw Error("No self-certifications found");const r=this,n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n};let s;for(let a=this.selfCertifications.length-1;a>=0;a--)try{const s=this.selfCertifications[a];if(s.revoked||await r.isRevoked(s,void 0,t,e))throw Error("Self-certification is revoked");try{await s.verify(n,$n.signature.certGeneric,i,t,void 0,e)}catch(t){throw qn.wrapError("Self-certification is invalid",t)}return!0}catch(t){s=t}throw s}async update(t,e,r){const n=this.mainKey.keyPacket,i={userID:this.userID,userAttribute:this.userAttribute,key:n};await Uu(t,this,"selfCertifications",e,async function(t){try{return await t.verify(n,$n.signature.certGeneric,i,e,!1,r),!0}catch(t){return!1}}),await Uu(t,this,"otherCertifications",e),await Uu(t,this,"revocationSignatures",e,function(t){return xu(n,$n.signature.certRevocation,i,[t],void 0,void 0,e,r)})}async revoke(t,{flag:e=$n.reasonForRevocation.noReason,string:r=""}={},n=new Date,i=jn){const s={userID:this.userID,userAttribute:this.userAttribute,key:t},a=new Tu(s.userID||s.userAttribute,this.mainKey);return a.revocationSignatures.push(await Du(s,[],t,{signatureType:$n.signature.certRevocation,reasonForRevocationFlag:$n.write($n.reasonForRevocation,e),reasonForRevocationString:r},n,void 0,void 0,!1,i)),await a.update(this),a}}class Mu{constructor(t,e){this.keyPacket=t,this.bindingSignatures=[],this.revocationSignatures=[],this.mainKey=e}toPacketList(){const t=new au;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.bindingSignatures),t}clone(){const t=new Mu(this.keyPacket,this.mainKey);return t.bindingSignatures=[...this.bindingSignatures],t.revocationSignatures=[...this.revocationSignatures],t}async isRevoked(t,e,r=new Date,n=jn){const i=this.mainKey.keyPacket;return xu(i,$n.signature.subkeyRevocation,{key:i,bind:this.keyPacket},this.revocationSignatures,t,e,r,n)}async verify(t=new Date,e=jn){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket},i=await Cu(this.bindingSignatures,r,$n.signature.subkeyBinding,n,t,e);if(i.revoked||await this.isRevoked(i,null,t,e))throw Error("Subkey is revoked");if(Ku(this.keyPacket,i,t))throw Error("Subkey is expired");return i}async getExpirationTime(t=new Date,e=jn){const r=this.mainKey.keyPacket,n={key:r,bind:this.keyPacket};let i;try{i=await Cu(this.bindingSignatures,r,$n.signature.subkeyBinding,n,t,e)}catch(t){return null}const s=Pu(this.keyPacket,i),a=i.getExpirationTime();return s<a?s:a}async update(t,e=new Date,r=jn){const n=this.mainKey.keyPacket;if(!this.hasSameFingerprintAs(t))throw Error("Subkey update method: fingerprints of subkeys not equal");this.keyPacket.constructor.tag===$n.packet.publicSubkey&&t.keyPacket.constructor.tag===$n.packet.secretSubkey&&(this.keyPacket=t.keyPacket);const i=this,s={key:n,bind:i.keyPacket};await Uu(t,this,"bindingSignatures",e,async function(t){for(let e=0;e<i.bindingSignatures.length;e++)if(i.bindingSignatures[e].issuerKeyID.equals(t.issuerKeyID))return t.created>i.bindingSignatures[e].created&&(i.bindingSignatures[e]=t),!1;try{return await t.verify(n,$n.signature.subkeyBinding,s,e,void 0,r),!0}catch(t){return!1}}),await Uu(t,this,"revocationSignatures",e,function(t){return xu(n,$n.signature.subkeyRevocation,s,[t],void 0,void 0,e,r)})}async revoke(t,{flag:e=$n.reasonForRevocation.noReason,string:r=""}={},n=new Date,i=jn){const s={key:t,bind:this.keyPacket},a=new Mu(this.keyPacket,this.mainKey);return a.revocationSignatures.push(await Du(s,[],t,{signatureType:$n.signature.subkeyRevocation,reasonForRevocationFlag:$n.write($n.reasonForRevocation,e),reasonForRevocationString:r},n,void 0,void 0,!1,i)),await a.update(this),a}hasSameFingerprintAs(t){return this.keyPacket.hasSameFingerprintAs(t.keyPacket||t)}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","isDecrypted"].forEach(t=>{Mu.prototype[t]=function(){return this.keyPacket[t]()}});const Nu=qn.constructAllowedPackets([eu]),Ou=new Set([$n.packet.publicKey,$n.packet.privateKey]),Fu=new Set([$n.packet.publicKey,$n.packet.privateKey,$n.packet.publicSubkey,$n.packet.privateSubkey]);class Lu{packetListToStructure(t,e=new Set){let r,n,i,s;for(const a of t){if(a instanceof us){Fu.has(a.tag)&&!s&&(s=Ou.has(a.tag)?Ou:Fu);continue}const t=a.constructor.tag;if(s){if(!s.has(t))continue;s=null}if(e.has(t))throw Error("Unexpected packet type: "+t);switch(t){case $n.packet.publicKey:case $n.packet.secretKey:if(this.keyPacket)throw Error("Key block contains multiple keys");if(this.keyPacket=a,n=this.getKeyID(),!n)throw Error("Missing Key ID");break;case $n.packet.userID:case $n.packet.userAttribute:r=new Tu(a,this),this.users.push(r);break;case $n.packet.publicSubkey:case $n.packet.secretSubkey:r=null,i=new Mu(a,this),this.subkeys.push(i);break;case $n.packet.signature:switch(a.signatureType){case $n.signature.certGeneric:case $n.signature.certPersona:case $n.signature.certCasual:case $n.signature.certPositive:if(!r){qn.printDebug("Dropping certification signatures without preceding user packet");continue}a.issuerKeyID.equals(n)?r.selfCertifications.push(a):r.otherCertifications.push(a);break;case $n.signature.certRevocation:r?r.revocationSignatures.push(a):this.directSignatures.push(a);break;case $n.signature.key:this.directSignatures.push(a);break;case $n.signature.subkeyBinding:if(!i){qn.printDebug("Dropping subkey binding signature without preceding subkey packet");continue}i.bindingSignatures.push(a);break;case $n.signature.keyRevocation:this.revocationSignatures.push(a);break;case $n.signature.subkeyRevocation:if(!i){qn.printDebug("Dropping subkey revocation signature without preceding subkey packet");continue}i.revocationSignatures.push(a)}}}}toPacketList(){const t=new au;return t.push(this.keyPacket),t.push(...this.revocationSignatures),t.push(...this.directSignatures),this.users.map(e=>t.push(...e.toPacketList())),this.subkeys.map(e=>t.push(...e.toPacketList())),t}clone(t=!1){const e=new this.constructor(this.toPacketList());return t&&e.getKeys().forEach(t=>{if(t.keyPacket=Object.create(Object.getPrototypeOf(t.keyPacket),Object.getOwnPropertyDescriptors(t.keyPacket)),!t.keyPacket.isDecrypted())return;const e={};Object.keys(t.keyPacket.privateParams).forEach(r=>{e[r]=new Uint8Array(t.keyPacket.privateParams[r])}),t.keyPacket.privateParams=e}),e}getSubkeys(t=null){return this.subkeys.filter(e=>!t||e.getKeyID().equals(t,!0))}getKeys(t=null){const e=[];return t&&!this.getKeyID().equals(t,!0)||e.push(this),e.concat(this.getSubkeys(t))}getKeyIDs(){return this.getKeys().map(t=>t.getKeyID())}getUserIDs(){return this.users.map(t=>t.userID?t.userID.userID:null).filter(t=>null!==t)}write(){return this.toPacketList().write()}async getSigningKey(t=null,e=new Date,r={},n=jn){await this.verifyPrimaryKey(e,r,n);const i=this.keyPacket;try{Ru(i,n)}catch(t){throw qn.wrapError("Could not verify primary key",t)}const s=this.subkeys.slice().sort((t,e)=>e.keyPacket.created-t.keyPacket.created||e.keyPacket.algorithm-t.keyPacket.algorithm);let a;for(const r of s)if(!t||r.getKeyID().equals(t))try{await r.verify(e,n);const t={key:i,bind:r.keyPacket},s=await Cu(r.bindingSignatures,i,$n.signature.subkeyBinding,t,e,n);if(!Qu(r.keyPacket,s,n))continue;if(!s.embeddedSignature)throw Error("Missing embedded signature");return await Cu([s.embeddedSignature],r.keyPacket,$n.signature.keyBinding,t,e,n),Ru(r.keyPacket,n),r}catch(t){a=t}try{const s=await this.getPrimarySelfSignature(e,r,n);if((!t||i.getKeyID().equals(t))&&Qu(i,s,n))return Ru(i,n),this}catch(t){a=t}throw qn.wrapError("Could not find valid signing key packet in key "+this.getKeyID().toHex(),a)}async getEncryptionKey(t,e=new Date,r={},n=jn){await this.verifyPrimaryKey(e,r,n);const i=this.keyPacket;try{Ru(i,n)}catch(t){throw qn.wrapError("Could not verify primary key",t)}const s=this.subkeys.slice().sort((t,e)=>e.keyPacket.created-t.keyPacket.created||e.keyPacket.algorithm-t.keyPacket.algorithm);let a;for(const r of s)if(!t||r.getKeyID().equals(t))try{await r.verify(e,n);const t={key:i,bind:r.keyPacket},s=await Cu(r.bindingSignatures,i,$n.signature.subkeyBinding,t,e,n);if(_u(r.keyPacket,s,n))return Ru(r.keyPacket,n),r}catch(t){a=t}try{const s=await this.getPrimarySelfSignature(e,r,n);if((!t||i.getKeyID().equals(t))&&_u(i,s,n))return Ru(i,n),this}catch(t){a=t}throw qn.wrapError("Could not find valid encryption key packet in key "+this.getKeyID().toHex(),a)}async isRevoked(t,e,r=new Date,n=jn){return xu(this.keyPacket,$n.signature.keyRevocation,{key:this.keyPacket},this.revocationSignatures,t,e,r,n)}async verifyPrimaryKey(t=new Date,e={},r=jn){const n=this.keyPacket;if(await this.isRevoked(null,null,t,r))throw Error("Primary key is revoked");if(Ku(n,await this.getPrimarySelfSignature(t,e,r),t))throw Error("Primary key is expired");if(6!==n.version){const e=await Cu(this.directSignatures,n,$n.signature.key,{key:n},t,r).catch(()=>{});if(e&&Ku(n,e,t))throw Error("Primary key is expired")}}async getExpirationTime(t,e=jn){let r;try{const n=await this.getPrimarySelfSignature(null,t,e),i=Pu(this.keyPacket,n),s=n.getExpirationTime(),a=6!==this.keyPacket.version&&await Cu(this.directSignatures,this.keyPacket,$n.signature.key,{key:this.keyPacket},null,e).catch(()=>{});if(a){const t=Pu(this.keyPacket,a);r=Math.min(i,s,t)}else r=i<s?i:s}catch(t){r=null}return qn.normalizeDate(r)}async getPrimarySelfSignature(t=new Date,e={},r=jn){const n=this.keyPacket;if(6===n.version)return Cu(this.directSignatures,n,$n.signature.key,{key:n},t,r);const{selfCertification:i}=await this.getPrimaryUser(t,e,r);return i}async getPrimaryUser(t=new Date,e={},r=jn){const n=this.keyPacket,i=[];let s;for(let a=0;a<this.users.length;a++)try{const s=this.users[a];if(!s.userID)continue;if(void 0!==e.name&&s.userID.name!==e.name||void 0!==e.email&&s.userID.email!==e.email||void 0!==e.comment&&s.userID.comment!==e.comment)throw Error("Could not find user that matches that user ID");const o={userID:s.userID,key:n},c=await Cu(s.selfCertifications,n,$n.signature.certGeneric,o,t,r);i.push({index:a,user:s,selfCertification:c})}catch(t){s=t}if(!i.length)throw s||Error("Could not find primary user");await Promise.all(i.map(async function(e){return e.selfCertification.revoked||e.user.isRevoked(e.selfCertification,null,t,r)}));const a=i.sort(function(t,e){const r=t.selfCertification,n=e.selfCertification;return n.revoked-r.revoked||r.isPrimaryUserID-n.isPrimaryUserID||r.created-n.created}).pop(),{user:o,selfCertification:c}=a;if(c.revoked||await o.isRevoked(c,null,t,r))throw Error("Primary user is revoked");return a}async update(t,e=new Date,r=jn){if(!this.hasSameFingerprintAs(t))throw Error("Primary key fingerprints must be equal to update the key");if(!this.isPrivate()&&t.isPrivate()){if(this.subkeys.length!==t.subkeys.length||!this.subkeys.every(e=>t.subkeys.some(t=>e.hasSameFingerprintAs(t))))throw Error("Cannot update public key with private key if subkeys mismatch");return t.update(this,r)}const n=this.clone();return await Uu(t,n,"revocationSignatures",e,i=>xu(n.keyPacket,$n.signature.keyRevocation,n,[i],null,t.keyPacket,e,r)),await Uu(t,n,"directSignatures",e),await Promise.all(t.users.map(async t=>{const i=n.users.filter(e=>t.userID&&t.userID.equals(e.userID)||t.userAttribute&&t.userAttribute.equals(e.userAttribute));if(i.length>0)await Promise.all(i.map(n=>n.update(t,e,r)));else{const e=t.clone();e.mainKey=n,n.users.push(e)}})),await Promise.all(t.subkeys.map(async t=>{const i=n.subkeys.filter(e=>e.hasSameFingerprintAs(t));if(i.length>0)await Promise.all(i.map(n=>n.update(t,e,r)));else{const e=t.clone();e.mainKey=n,n.subkeys.push(e)}})),n}async getRevocationCertificate(t=new Date,e=jn){const r={key:this.keyPacket},n=await Cu(this.revocationSignatures,this.keyPacket,$n.signature.keyRevocation,r,t,e),i=new au;i.push(n);const s=6!==this.keyPacket.version;return li($n.armor.publicKey,i.write(),null,null,"This is a revocation certificate",s,e)}async applyRevocationCertificate(t,e=new Date,r=jn){const n=await ui(t),i=(await au.fromBinary(n.data,Nu,r)).findPacket($n.packet.signature);if(!i||i.signatureType!==$n.signature.keyRevocation)throw Error("Could not find revocation signature packet");if(!i.issuerKeyID.equals(this.getKeyID()))throw Error("Revocation signature does not match key");try{await i.verify(this.keyPacket,$n.signature.keyRevocation,{key:this.keyPacket},e,void 0,r)}catch(t){throw qn.wrapError("Could not verify revocation signature",t)}const s=this.clone();return s.revocationSignatures.push(i),s}async signPrimaryUser(t,e,r,n=jn){const{index:i,user:s}=await this.getPrimaryUser(e,r,n),a=await s.certify(t,e,n),o=this.clone();return o.users[i]=a,o}async signAllUsers(t,e=new Date,r=jn){const n=this.clone();return n.users=await Promise.all(this.users.map(function(n){return n.certify(t,e,r)})),n}async verifyPrimaryUser(t,e=new Date,r,n=jn){const i=this.keyPacket,{user:s}=await this.getPrimaryUser(e,r,n);return t?await s.verifyAllCertifications(t,e,n):[{keyID:i.getKeyID(),valid:await s.verify(e,n).catch(()=>!1)}]}async verifyAllUsers(t,e=new Date,r=jn){const n=this.keyPacket,i=[];return await Promise.all(this.users.map(async s=>{const a=t?await s.verifyAllCertifications(t,e,r):[{keyID:n.getKeyID(),valid:await s.verify(e,r).catch(()=>!1)}];i.push(...a.map(t=>({userID:s.userID?s.userID.userID:null,userAttribute:s.userAttribute,keyID:t.keyID,valid:t.valid})))})),i}}["getKeyID","getFingerprint","getAlgorithmInfo","getCreationTime","hasSameFingerprintAs"].forEach(t=>{Lu.prototype[t]=Mu.prototype[t]});const Hu=qn.constructAllowedPackets([Zc,fu,class{static get tag(){return $n.packet.aeadEncryptedData}constructor(){this.version=1,this.cipherAlgorithm=null,this.aeadAlgorithm=$n.aead.eax,this.chunkSizeByte=null,this.iv=null,this.encrypted=null,this.packets=null}async read(t){await _n(t,async t=>{const e=await t.readByte();if(1!==e)throw new as(`Version ${e} of the AEAD-encrypted data packet is not supported.`);this.cipherAlgorithm=await t.readByte(),this.aeadAlgorithm=await t.readByte(),this.chunkSizeByte=await t.readByte();const r=Vo(this.aeadAlgorithm,!0);this.iv=await t.readBytes(r.ivLength),this.encrypted=t.remainder()})}write(){return qn.concat([new Uint8Array([this.version,this.cipherAlgorithm,this.aeadAlgorithm,this.chunkSizeByte]),this.iv,this.encrypted])}async decrypt(t,e,r=jn){this.packets=await au.fromBinary(await bu(this,"decrypt",e,Rn(this.encrypted)),mu,r,new uu)}async encrypt(t,e,r=jn){this.cipherAlgorithm=t;const{ivLength:n}=Vo(this.aeadAlgorithm,!0);this.iv=vi(n),this.chunkSizeByte=r.aeadChunkSizeByte;const i=this.packets.write();this.encrypted=await bu(this,"encrypt",e,i)}},wu,class{static get tag(){return $n.packet.symmetricallyEncryptedData}constructor(){this.encrypted=null,this.packets=null}read(t){this.encrypted=t}write(){return this.encrypted}async decrypt(t,e,r=jn){if(!r.allowUnauthenticatedMessages)throw Error("Message is not authenticated.");const{blockSize:n}=Ea(t),i=await On(Rn(this.encrypted)),s=await go(t,e,i.subarray(n+2),i.subarray(2,n+2));this.packets=await au.fromBinary(s,Iu,r)}async encrypt(t,e,r=jn){const n=this.packets.write(),{blockSize:i}=Ea(t),s=await yo(t),a=await po(t,e,s,new Uint8Array(i)),o=await po(t,e,n,a.subarray(2));this.encrypted=qn.concat([a,o])}},vu,ku,iu,eu]),zu=qn.constructAllowedPackets([ku]),Gu=qn.constructAllowedPackets([eu]);class $u{constructor(t){this.packets=t||new au}getEncryptionKeyIDs(){const t=[];return this.packets.filterByTag($n.packet.publicKeyEncryptedSessionKey).forEach(function(e){t.push(e.publicKeyID)}),t}getSigningKeyIDs(){const t=this.unwrapCompressed(),e=t.packets.filterByTag($n.packet.onePassSignature);return e.length>0?e.map(t=>t.issuerKeyID):t.packets.filterByTag($n.packet.signature).map(t=>t.issuerKeyID)}async decrypt(t,e,r,n=new Date,i=jn){const s=this.packets.filterByTag($n.packet.symmetricallyEncryptedData,$n.packet.symEncryptedIntegrityProtectedData,$n.packet.aeadEncryptedData);if(0===s.length)throw Error("No encrypted data found");const a=s[0],o=a.cipherAlgorithm,c=r||await this.decryptSessionKeys(t,e,o,n,i);let u=null;const l=Promise.all(c.map(async({algorithm:t,data:e})=>{if(!qn.isUint8Array(e)||!a.cipherAlgorithm&&!qn.isString(t))throw Error("Invalid session key for decryption.");try{const r=a.cipherAlgorithm||$n.write($n.symmetric,t);await a.decrypt(r,e,i)}catch(t){qn.printDebugError(t),u=t}}));if(Fn(a.encrypted),a.encrypted=null,await l,!a.packets||!a.packets.length)throw u||Error("Decryption failed.");const f=new $u(a.packets);return a.packets=new au,f}async decryptSessionKeys(t,e,r,n=new Date,i=jn){let s,a=[];if(e){const t=this.packets.filterByTag($n.packet.symEncryptedSessionKey);if(0===t.length)throw Error("No symmetrically encrypted session key packet found.");await Promise.all(e.map(async function(e,r){let n;n=r?await au.fromBinary(t.write(),zu,i):t,await Promise.all(n.map(async function(t){try{await t.decrypt(e),a.push(t)}catch(t){qn.printDebugError(t),t instanceof Yo&&(s=t)}}))}))}else{if(!t)throw Error("No key or password specified.");{const e=this.packets.filterByTag($n.packet.publicKeyEncryptedSessionKey);if(0===e.length)throw Error("No public key encrypted session key packet found.");await Promise.all(e.map(async function(e){await Promise.all(t.map(async function(t){let o;try{o=(await t.getDecryptionKeys(e.publicKeyID,null,void 0,i)).map(t=>t.keyPacket)}catch(t){return void(s=t)}let c=[$n.symmetric.aes256,$n.symmetric.aes128,$n.symmetric.tripledes,$n.symmetric.cast5];try{const e=await t.getPrimarySelfSignature(n,void 0,i);e.preferredSymmetricAlgorithms&&(c=c.concat(e.preferredSymmetricAlgorithms))}catch(t){}await Promise.all(o.map(async function(t){if(!t.isDecrypted())throw Error("Decryption key is not decrypted.");if(!i.constantTimePKCS1Decryption||e.publicKeyAlgorithm!==$n.publicKey.rsaEncrypt&&e.publicKeyAlgorithm!==$n.publicKey.rsaEncryptSign&&e.publicKeyAlgorithm!==$n.publicKey.rsaSign&&e.publicKeyAlgorithm!==$n.publicKey.elgamal)try{await e.decrypt(t);const n=r||e.sessionKeyAlgorithm;if(n&&!c.includes($n.write($n.symmetric,n)))throw Error("A non-preferred symmetric algorithm was used.");a.push(e)}catch(t){qn.printDebugError(t),s=t}else{const n=e.write();await Promise.all((r?[r]:Array.from(i.constantTimePKCS1DecryptionSupportedSymmetricAlgorithms)).map(async e=>{const r=new vu;r.read(n);const i={sessionKeyAlgorithm:e,sessionKey:ao(e)};try{await r.decrypt(t,i),a.push(r)}catch(t){qn.printDebugError(t),s=t}}))}}))})),Fn(e.encrypted),e.encrypted=null}))}}if(a.length>0){if(a.length>1){const t=new Set;a=a.filter(e=>{const r=e.sessionKeyAlgorithm+qn.uint8ArrayToString(e.sessionKey);return!t.has(r)&&(t.add(r),!0)})}return a.map(t=>({data:t.sessionKey,algorithm:t.sessionKeyAlgorithm&&$n.read($n.symmetric,t.sessionKeyAlgorithm)}))}throw s||Error("Session key decryption failed.")}getLiteralData(){const t=this.unwrapCompressed().packets.findPacket($n.packet.literalData);return t&&t.getBytes()||null}getFilename(){const t=this.unwrapCompressed().packets.findPacket($n.packet.literalData);return t&&t.getFilename()||null}getText(){const t=this.unwrapCompressed().packets.findPacket($n.packet.literalData);return t?t.getText():null}static async generateSessionKey(t=[],e=new Date,r=[],n=jn){const{symmetricAlgo:i,aeadAlgo:s}=await async function(t=[],e=new Date,r=[],n=jn){const i=await Promise.all(t.map((t,i)=>t.getPrimarySelfSignature(e,r[i],n)));if(t.length?i.every(t=>t.features&&t.features[0]&$n.features.seipdv2):n.aeadProtect){const t={symmetricAlgo:$n.symmetric.aes128,aeadAlgo:$n.aead.ocb},e=[{symmetricAlgo:n.preferredSymmetricAlgorithm,aeadAlgo:n.preferredAEADAlgorithm},{symmetricAlgo:n.preferredSymmetricAlgorithm,aeadAlgo:$n.aead.ocb},{symmetricAlgo:$n.symmetric.aes128,aeadAlgo:n.preferredAEADAlgorithm}];for(const t of e)if(i.every(e=>e.preferredCipherSuites&&e.preferredCipherSuites.some(e=>e[0]===t.symmetricAlgo&&e[1]===t.aeadAlgo)))return t;return t}const s=$n.symmetric.aes128,a=n.preferredSymmetricAlgorithm;return{symmetricAlgo:i.every(t=>t.preferredSymmetricAlgorithms&&t.preferredSymmetricAlgorithms.includes(a))?a:s,aeadAlgo:void 0}}(t,e,r,n),a=$n.read($n.symmetric,i),o=s?$n.read($n.aead,s):void 0;return await Promise.all(t.map(t=>t.getEncryptionKey().catch(()=>null).then(t=>{if(t&&(t.keyPacket.algorithm===$n.publicKey.x25519||t.keyPacket.algorithm===$n.publicKey.x448)&&!o&&!qn.isAES(i))throw Error("Could not generate a session key compatible with the given `encryptionKeys`: X22519 and X448 keys can only be used to encrypt AES session keys; change `config.preferredSymmetricAlgorithm` accordingly.")}))),{data:ao(i),algorithm:a,aeadAlgorithm:o}}async encrypt(t,e,r,n=!1,i=[],s=new Date,a=[],o=jn){if(r){if(!qn.isUint8Array(r.data)||!qn.isString(r.algorithm))throw Error("Invalid session key for encryption.")}else if(t&&t.length)r=await $u.generateSessionKey(t,s,a,o);else{if(!e||!e.length)throw Error("No keys, passwords, or session key provided.");r=await $u.generateSessionKey(void 0,void 0,void 0,o)}const{data:c,algorithm:u,aeadAlgorithm:l}=r,f=await $u.encryptSessionKey(c,u,l,t,e,n,i,s,a,o),h=wu.fromObject({version:l?2:1,aeadAlgorithm:l?$n.write($n.aead,l):null});h.packets=this.packets;const y=$n.write($n.symmetric,u);return await h.encrypt(y,c,o),f.packets.push(h),h.packets=new au,f}static async encryptSessionKey(t,e,r,n,i,s=!1,a=[],o=new Date,c=[],u=jn){const l=new au,f=$n.write($n.symmetric,e),h=r&&$n.write($n.aead,r);if(n){const e=await Promise.all(n.map(async function(e,r){const n=await e.getEncryptionKey(a[r],o,c,u),i=vu.fromObject({version:h?6:3,encryptionKeyPacket:n.keyPacket,anonymousRecipient:s,sessionKey:t,sessionKeyAlgorithm:f});return await i.encrypt(n.keyPacket),delete i.sessionKey,i}));l.push(...e)}if(i){const e=async function(t,e){try{return await t.decrypt(e),1}catch(t){return 0}},r=(t,e)=>t+e,n=async function(t,s,a,o){const c=new ku(u);return c.sessionKey=t,c.sessionKeyAlgorithm=s,a&&(c.aeadAlgorithm=a),await c.encrypt(o,u),u.passwordCollisionCheck&&1!==(await Promise.all(i.map(t=>e(c,t)))).reduce(r)?n(t,s,o):(delete c.sessionKey,c)},s=await Promise.all(i.map(e=>n(t,f,h,e)));l.push(...s)}return new $u(l)}async sign(t=[],e=[],r=null,n=[],i=new Date,s=[],a=[],o=[],c=jn){const u=new au,l=this.packets.findPacket($n.packet.literalData);if(!l)throw Error("No literal data packet to sign.");const f=await ju(l,t,e,r,n,i,s,a,o,!1,c),h=f.map((t,e)=>iu.fromSignaturePacket(t,0===e)).reverse();return u.push(...h),u.push(l),u.push(...f),new $u(u)}compress(t,e=jn){if(t===$n.compression.uncompressed)return this;const r=new fu(e);r.algorithm=t,r.packets=this.packets;const n=new au;return n.push(r),new $u(n)}async signDetached(t=[],e=[],r=null,n=[],i=[],s=new Date,a=[],o=[],c=jn){const u=this.packets.findPacket($n.packet.literalData);if(!u)throw Error("No literal data packet to sign.");return new Su(await ju(u,t,e,r,n,i,s,a,o,!0,c))}async verify(t,e=new Date,r=jn){const n=this.unwrapCompressed(),i=n.packets.filterByTag($n.packet.literalData);if(1!==i.length)throw Error("Can only verify message with one literal data packet.");let s=n.packets;wn(s.stream)&&(s=s.concat(await On(s.stream,t=>t||[])));const a=s.filterByTag($n.packet.onePassSignature).reverse(),o=s.filterByTag($n.packet.signature);return a.length&&!o.length&&qn.isStream(s.stream)&&!wn(s.stream)?(await Promise.all(a.map(async t=>{t.correspondingSig=new Promise((e,r)=>{t.correspondingSigResolve=e,t.correspondingSigReject=r}),t.signatureData=Ln(async()=>(await t.correspondingSig).signatureData),t.hashed=On(await t.hash(t.signatureType,i[0],void 0,!1)),t.hashed.catch(()=>{})})),s.stream=Qn(s.stream,async(t,e)=>{const r=Hn(t),n=zn(e);try{for(let t=0;t<a.length;t++){const{value:e}=await r.read();a[t].correspondingSigResolve(e)}await r.readToEnd(),await n.ready,await n.close()}catch(t){a.forEach(e=>{e.correspondingSigReject(t)}),await n.abort(t)}}),Vu(a,i,t,e,!1,r)):Vu(o,i,t,e,!1,r)}verifyDetached(t,e,r=new Date,n=jn){const i=this.unwrapCompressed().packets.filterByTag($n.packet.literalData);if(1!==i.length)throw Error("Can only verify message with one literal data packet.");return Vu(t.packets.filterByTag($n.packet.signature),i,e,r,!0,n)}unwrapCompressed(){const t=this.packets.filterByTag($n.packet.compressedData);return t.length?new $u(t[0].packets):this}async appendSignature(t,e=jn){await this.packets.read(qn.isUint8Array(t)?t:(await ui(t)).data,Gu,e)}write(){return this.packets.write()}armor(t=jn){const e=this.packets[this.packets.length-1],r=e.constructor.tag===wu.tag?2!==e.version:this.packets.some(t=>t.constructor.tag===eu.tag&&6!==t.version);return li($n.armor.message,this.write(),null,null,null,r,t)}}async function ju(t,e,r=[],n=null,i=[],s=new Date,a=[],o=[],c=[],u=!1,l=jn){const f=new au,h=null===t.text?$n.signature.binary:$n.signature.text;if(await Promise.all(e.map(async(e,n)=>{const f=a[n];if(!e.isPrivate())throw Error("Need private key for signing");const y=await e.getSigningKey(i[n],s,f,l);return Du(t,r.length?r:[e],y.keyPacket,{signatureType:h},s,o,c,u,l)})).then(t=>{f.push(...t)}),n){const t=n.packets.filterByTag($n.packet.signature);f.push(...t)}return f}async function Vu(t,e,r,n=new Date,i=!1,s=jn){return Promise.all(t.filter(function(t){return["text","binary"].includes($n.read($n.signature,t.signatureType))}).map(async function(t){return async function(t,e,r,n=new Date,i=!1,s=jn){let a,o;for(const e of r){const r=e.getKeys(t.issuerKeyID);if(r.length>0){a=e,o=r[0];break}}const c=t instanceof iu?t.correspondingSig:t,u={keyID:t.issuerKeyID,verified:(async()=>{if(!o)throw Error("Could not find signing key with key ID "+t.issuerKeyID.toHex());await t.verify(o.keyPacket,t.signatureType,e[0],n,i,s);const r=await c;if(o.getCreationTime()>r.created)throw Error("Key is newer than the signature");try{await a.getSigningKey(o.getKeyID(),r.created,void 0,s)}catch(t){if(!s.allowInsecureVerificationWithReformattedKeys||!t.message.match(/Signature creation time is in the future/))throw t;await a.getSigningKey(o.getKeyID(),n,void 0,s)}return!0})(),signature:(async()=>{const t=await c,e=new au;return t&&e.push(t),new Su(e)})()};return u.signature.catch(()=>{}),u.verified.catch(()=>{}),u}(t,e,r,n,i,s)}))}function qu(t){if(!(t instanceof $u))throw Error("Parameter [message] needs to be of type Message")}const Yu=Object.keys(jn).length;function Zu(t){const e=Object.keys(t);if(e.length!==Yu)for(const t of e)if(void 0===jn[t])throw Error("Unknown config property: "+t)}function Ju(t){return t&&!qn.isArray(t)&&(t=[t]),t}async function Wu(t){return"array"===qn.isStream(t)?On(t):t}const Xu="object"==typeof fn&&"crypto"in fn?fn.crypto:void 0;function tl(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&"Uint8Array"===t.constructor.name}function el(t){if(!Number.isSafeInteger(t)||t<0)throw Error("positive integer expected, got "+t)}function rl(t,...e){if(!tl(t))throw Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw Error("Uint8Array expected of length "+e+", got length="+t.length)}function nl(t){if("function"!=typeof t||"function"!=typeof t.create)throw Error("Hash should be wrapped by utils.createHasher");el(t.outputLen),el(t.blockLen)}function il(t,e=!0){if(t.destroyed)throw Error("Hash instance has been destroyed");if(e&&t.finished)throw Error("Hash#digest() has already been called")}function sl(t,e){rl(t);const r=e.outputLen;if(t.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function al(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}function ol(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function cl(t,e){return t<<32-e|t>>>e}function ul(t,e){return t<<e|t>>>32-e>>>0}const ll=(()=>68===new Uint8Array(new Uint32Array([287454020]).buffer)[0])()?t=>t:function(t){for(let r=0;r<t.length;r++)t[r]=(e=t[r])<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255;var e;return t},fl=(()=>"function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex)(),hl=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function yl(t){if(rl(t),fl)return t.toHex();let e="";for(let r=0;r<t.length;r++)e+=hl[t[r]];return e}function dl(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-55:t>=97&&t<=102?t-87:void 0}function pl(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);if(fl)return Uint8Array.fromHex(t);const e=t.length,r=e/2;if(e%2)throw Error("hex string expected, got unpadded hex of length "+e);const n=new Uint8Array(r);for(let e=0,i=0;e<r;e++,i+=2){const r=dl(t.charCodeAt(i)),s=dl(t.charCodeAt(i+1));if(void 0===r||void 0===s){const e=t[i]+t[i+1];throw Error('hex string expected, got non-hex character "'+e+'" at index '+i)}n[e]=16*r+s}return n}function gl(t){return"string"==typeof t&&(t=function(t){if("string"!=typeof t)throw Error("string expected");return new Uint8Array((new TextEncoder).encode(t))}(t)),rl(t),t}function Al(...t){let e=0;for(let r=0;r<t.length;r++){const n=t[r];rl(n),e+=n.length}const r=new Uint8Array(e);for(let e=0,n=0;e<t.length;e++){const i=t[e];r.set(i,n),n+=i.length}return r}class wl{}function bl(t){const e=e=>t().update(gl(e)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}const ml=bl;function vl(t=32){if(Xu&&"function"==typeof Xu.getRandomValues)return Xu.getRandomValues(new Uint8Array(t));if(Xu&&"function"==typeof Xu.randomBytes)return Uint8Array.from(Xu.randomBytes(t));throw Error("crypto.getRandomValues must be defined")}const El=BigInt(0),kl=BigInt(1);function Bl(t,e=""){if("boolean"!=typeof t)throw Error((e&&`"${e}"`)+"expected boolean, got type="+typeof t);return t}function Il(t,e,r=""){const n=tl(t),i=t?.length,s=void 0!==e;if(!n||s&&i!==e)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(s?" of length "+e:"")+", got "+(n?"length="+i:"type="+typeof t));return t}function Sl(t){const e=t.toString(16);return 1&e.length?"0"+e:e}function Cl(t){if("string"!=typeof t)throw Error("hex string expected, got "+typeof t);return""===t?El:BigInt("0x"+t)}function Kl(t){return Cl(yl(t))}function Dl(t){return rl(t),Cl(yl(Uint8Array.from(t).reverse()))}function Ul(t,e){return pl(t.toString(16).padStart(2*e,"0"))}function xl(t,e){return Ul(t,e).reverse()}function Pl(t,e,r){let n;if("string"==typeof e)try{n=pl(e)}catch(e){throw Error(t+" must be hex string or Uint8Array, cause: "+e)}else{if(!tl(e))throw Error(t+" must be hex string or Uint8Array");n=Uint8Array.from(e)}const i=n.length;if("number"==typeof r&&i!==r)throw Error(t+" of length "+r+" expected, got "+i);return n}function Ql(t){return Uint8Array.from(t)}const _l=t=>"bigint"==typeof t&&El<=t;function Rl(t,e,r,n){if(!function(t,e,r){return _l(t)&&_l(e)&&_l(r)&&e<=t&&t<r}(e,r,n))throw Error("expected valid "+t+": "+r+" <= n < "+n+", got "+e)}function Tl(t){let e;for(e=0;t>El;t>>=kl,e+=1);return e}const Ml=t=>(kl<<BigInt(t))-kl;function Nl(t,e,r={}){if(!t||"object"!=typeof t)throw Error("expected valid options object");function n(e,r,n){const i=t[e];if(n&&void 0===i)return;const s=typeof i;if(s!==r||null===i)throw Error(`param "${e}" is invalid: expected ${r}, got ${s}`)}Object.entries(e).forEach(([t,e])=>n(t,e,!1)),Object.entries(r).forEach(([t,e])=>n(t,e,!0))}function Ol(t){const e=new WeakMap;return(r,...n)=>{const i=e.get(r);if(void 0!==i)return i;const s=t(r,...n);return e.set(r,s),s}}const Fl=BigInt(0),Ll=BigInt(1),Hl=BigInt(2),zl=BigInt(3),Gl=BigInt(4),$l=BigInt(5),jl=BigInt(7),Vl=BigInt(8),ql=BigInt(9),Yl=BigInt(16);function Zl(t,e){const r=t%e;return r>=Fl?r:e+r}function Jl(t,e,r){let n=t;for(;e-- >Fl;)n*=n,n%=r;return n}function Wl(t,e){if(t===Fl)throw Error("invert: expected non-zero number");if(e<=Fl)throw Error("invert: expected positive modulus, got "+e);let r=Zl(t,e),n=e,i=Fl,s=Ll;for(;r!==Fl;){const t=n%r,e=i-s*(n/r);n=r,r=t,i=s,s=e}if(n!==Ll)throw Error("invert: does not exist");return Zl(i,e)}function Xl(t,e,r){if(!t.eql(t.sqr(e),r))throw Error("Cannot find square root")}function tf(t,e){const r=(t.ORDER+Ll)/Gl,n=t.pow(e,r);return Xl(t,n,e),n}function ef(t,e){const r=(t.ORDER-$l)/Vl,n=t.mul(e,Hl),i=t.pow(n,r),s=t.mul(e,i),a=t.mul(t.mul(s,Hl),i),o=t.mul(s,t.sub(a,t.ONE));return Xl(t,o,e),o}function rf(t){if(t<zl)throw Error("sqrt is not defined for small field");let e=t-Ll,r=0;for(;e%Hl===Fl;)e/=Hl,r++;let n=Hl;const i=cf(t);for(;1===af(i,n);)if(n++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return tf;let s=i.pow(n,e);const a=(e+Ll)/Hl;return function(t,n){if(t.is0(n))return n;if(1!==af(t,n))throw Error("Cannot find square root");let i=r,o=t.mul(t.ONE,s),c=t.pow(n,e),u=t.pow(n,a);for(;!t.eql(c,t.ONE);){if(t.is0(c))return t.ZERO;let e=1,r=t.sqr(c);for(;!t.eql(r,t.ONE);)if(e++,r=t.sqr(r),e===i)throw Error("Cannot find square root");const n=Ll<<BigInt(i-e-1),s=t.pow(o,n);i=e,o=t.sqr(s),c=t.mul(c,o),u=t.mul(u,s)}return u}}const nf=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function sf(t,e,r=!1){const n=Array(e.length).fill(r?t.ZERO:void 0),i=e.reduce((e,r,i)=>t.is0(r)?e:(n[i]=e,t.mul(e,r)),t.ONE),s=t.inv(i);return e.reduceRight((e,r,i)=>t.is0(r)?e:(n[i]=t.mul(e,n[i]),t.mul(e,r)),s),n}function af(t,e){const r=(t.ORDER-Ll)/Hl,n=t.pow(e,r),i=t.eql(n,t.ONE),s=t.eql(n,t.ZERO),a=t.eql(n,t.neg(t.ONE));if(!i&&!s&&!a)throw Error("invalid Legendre symbol result");return i?1:s?0:-1}function of(t,e){void 0!==e&&el(e);const r=void 0!==e?e:t.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function cf(t,e,r=!1,n={}){if(t<=Fl)throw Error("invalid field: expected ORDER > 0, got "+t);let i,s,a,o=!1;if("object"==typeof e&&null!=e){if(n.sqrt||r)throw Error("cannot specify opts in two arguments");const t=e;t.BITS&&(i=t.BITS),t.sqrt&&(s=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE),"boolean"==typeof t.modFromBytes&&(o=t.modFromBytes),a=t.allowedLengths}else"number"==typeof e&&(i=e),n.sqrt&&(s=n.sqrt);const{nBitLength:c,nByteLength:u}=of(t,i);if(u>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let l;const f=Object.freeze({ORDER:t,isLE:r,BITS:c,BYTES:u,MASK:Ml(c),ZERO:Fl,ONE:Ll,allowedLengths:a,create:e=>Zl(e,t),isValid:e=>{if("bigint"!=typeof e)throw Error("invalid field element: expected bigint, got "+typeof e);return Fl<=e&&e<t},is0:t=>t===Fl,isValidNot0:t=>!f.is0(t)&&f.isValid(t),isOdd:t=>(t&Ll)===Ll,neg:e=>Zl(-e,t),eql:(t,e)=>t===e,sqr:e=>Zl(e*e,t),add:(e,r)=>Zl(e+r,t),sub:(e,r)=>Zl(e-r,t),mul:(e,r)=>Zl(e*r,t),pow:(t,e)=>function(t,e,r){if(r<Fl)throw Error("invalid exponent, negatives unsupported");if(r===Fl)return t.ONE;if(r===Ll)return e;let n=t.ONE,i=e;for(;r>Fl;)r&Ll&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Ll;return n}(f,t,e),div:(e,r)=>Zl(e*Wl(r,t),t),sqrN:t=>t*t,addN:(t,e)=>t+e,subN:(t,e)=>t-e,mulN:(t,e)=>t*e,inv:e=>Wl(e,t),sqrt:s||(e=>(l||(l=function(t){return t%Gl===zl?tf:t%Vl===$l?ef:t%Yl===ql?function(t){const e=cf(t),r=rf(t),n=r(e,e.neg(e.ONE)),i=r(e,n),s=r(e,e.neg(n)),a=(t+jl)/Yl;return(t,e)=>{let r=t.pow(e,a),o=t.mul(r,n);const c=t.mul(r,i),u=t.mul(r,s),l=t.eql(t.sqr(o),e),f=t.eql(t.sqr(c),e);r=t.cmov(r,o,l),o=t.cmov(u,c,f);const h=t.eql(t.sqr(o),e),y=t.cmov(r,o,h);return Xl(t,y,e),y}}(t):rf(t)}(t)),l(f,e))),toBytes:t=>r?xl(t,u):Ul(t,u),fromBytes:(e,n=!0)=>{if(a){if(!a.includes(e.length)||e.length>u)throw Error("Field.fromBytes: expected "+a+" bytes, got "+e.length);const t=new Uint8Array(u);t.set(e,r?0:t.length-e.length),e=t}if(e.length!==u)throw Error("Field.fromBytes: expected "+u+" bytes, got "+e.length);let i=r?Dl(e):Kl(e);if(o&&(i=Zl(i,t)),!n&&!f.isValid(i))throw Error("invalid field element: outside of range 0..ORDER");return i},invertBatch:t=>sf(f,t),cmov:(t,e,r)=>r?e:t});return Object.freeze(f)}function uf(t){if("bigint"!=typeof t)throw Error("field order must be bigint");const e=t.toString(2).length;return Math.ceil(e/8)}function lf(t){const e=uf(t);return e+Math.ceil(e/2)}function ff(t,e,r){return t&e^~t&r}function hf(t,e,r){return t&e^t&r^e&r}class yf extends wl{constructor(t,e,r,n){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=e,this.padOffset=r,this.isLE=n,this.buffer=new Uint8Array(t),this.view=ol(this.buffer)}update(t){il(this),rl(t=gl(t));const{view:e,buffer:r,blockLen:n}=this,i=t.length;for(let s=0;s<i;){const a=Math.min(n-this.pos,i-s);if(a!==n)r.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===n&&(this.process(e,0),this.pos=0);else{const e=ol(t);for(;n<=i-s;s+=n)this.process(e,s)}}return this.length+=t.length,this.roundClean(),this}digestInto(t){il(this),sl(t,this),this.finished=!0;const{buffer:e,view:r,blockLen:n,isLE:i}=this;let{pos:s}=this;e[s++]=128,al(this.buffer.subarray(s)),this.padOffset>n-s&&(this.process(r,0),s=0);for(let t=s;t<n;t++)e[t]=0;!function(t,e,r,n){if("function"==typeof t.setBigUint64)return t.setBigUint64(e,r,n);const i=BigInt(32),s=BigInt(4294967295),a=Number(r>>i&s),o=Number(r&s),c=n?4:0,u=n?0:4;t.setUint32(e+c,a,n),t.setUint32(e+u,o,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);const a=ol(t),o=this.outputLen;if(o%4)throw Error("_sha2: outputLen should be aligned to 32bit");const c=o/4,u=this.get();if(c>u.length)throw Error("_sha2: outputLen bigger than state");for(let t=0;t<c;t++)a.setUint32(4*t,u[t],i)}digest(){const{buffer:t,outputLen:e}=this;this.digestInto(t);const r=t.slice(0,e);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:e,buffer:r,length:n,finished:i,destroyed:s,pos:a}=this;return t.destroyed=s,t.finished=i,t.length=n,t.pos=a,n%e&&t.buffer.set(r),t}clone(){return this._cloneInto()}}const df=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),pf=Uint32Array.from([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]),gf=Uint32Array.from([3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]),Af=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]),wf=BigInt(2**32-1),bf=BigInt(32);function mf(t,e=!1){return e?{h:Number(t&wf),l:Number(t>>bf&wf)}:{h:0|Number(t>>bf&wf),l:0|Number(t&wf)}}function vf(t,e=!1){const r=t.length;let n=new Uint32Array(r),i=new Uint32Array(r);for(let s=0;s<r;s++){const{h:r,l:a}=mf(t[s],e);[n[s],i[s]]=[r,a]}return[n,i]}const Ef=(t,e,r)=>t>>>r,kf=(t,e,r)=>t<<32-r|e>>>r,Bf=(t,e,r)=>t>>>r|e<<32-r,If=(t,e,r)=>t<<32-r|e>>>r,Sf=(t,e,r)=>t<<64-r|e>>>r-32,Cf=(t,e,r)=>t>>>r-32|e<<64-r;function Kf(t,e,r,n){const i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:0|i}}const Df=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Uf=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,xf=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),Pf=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,Qf=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),_f=(t,e,r,n,i,s)=>e+r+n+i+s+(t/2**32|0)|0,Rf=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Tf=new Uint32Array(64);class Mf extends yf{constructor(t=32){super(64,t,8,!1),this.A=0|df[0],this.B=0|df[1],this.C=0|df[2],this.D=0|df[3],this.E=0|df[4],this.F=0|df[5],this.G=0|df[6],this.H=0|df[7]}get(){const{A:t,B:e,C:r,D:n,E:i,F:s,G:a,H:o}=this;return[t,e,r,n,i,s,a,o]}set(t,e,r,n,i,s,a,o){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|s,this.G=0|a,this.H=0|o}process(t,e){for(let r=0;r<16;r++,e+=4)Tf[r]=t.getUint32(e,!1);for(let t=16;t<64;t++){const e=Tf[t-15],r=Tf[t-2],n=cl(e,7)^cl(e,18)^e>>>3,i=cl(r,17)^cl(r,19)^r>>>10;Tf[t]=i+Tf[t-7]+n+Tf[t-16]|0}let{A:r,B:n,C:i,D:s,E:a,F:o,G:c,H:u}=this;for(let t=0;t<64;t++){const e=u+(cl(a,6)^cl(a,11)^cl(a,25))+ff(a,o,c)+Rf[t]+Tf[t]|0,l=(cl(r,2)^cl(r,13)^cl(r,22))+hf(r,n,i)|0;u=c,c=o,o=a,a=s+e|0,s=i,i=n,n=r,r=e+l|0}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,o=o+this.F|0,c=c+this.G|0,u=u+this.H|0,this.set(r,n,i,s,a,o,c,u)}roundClean(){al(Tf)}destroy(){this.set(0,0,0,0,0,0,0,0),al(this.buffer)}}class Nf extends Mf{constructor(){super(28),this.A=0|pf[0],this.B=0|pf[1],this.C=0|pf[2],this.D=0|pf[3],this.E=0|pf[4],this.F=0|pf[5],this.G=0|pf[6],this.H=0|pf[7]}}const Of=(()=>vf(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))))(),Ff=(()=>Of[0])(),Lf=(()=>Of[1])(),Hf=new Uint32Array(80),zf=new Uint32Array(80);class Gf extends yf{constructor(t=64){super(128,t,16,!1),this.Ah=0|Af[0],this.Al=0|Af[1],this.Bh=0|Af[2],this.Bl=0|Af[3],this.Ch=0|Af[4],this.Cl=0|Af[5],this.Dh=0|Af[6],this.Dl=0|Af[7],this.Eh=0|Af[8],this.El=0|Af[9],this.Fh=0|Af[10],this.Fl=0|Af[11],this.Gh=0|Af[12],this.Gl=0|Af[13],this.Hh=0|Af[14],this.Hl=0|Af[15]}get(){const{Ah:t,Al:e,Bh:r,Bl:n,Ch:i,Cl:s,Dh:a,Dl:o,Eh:c,El:u,Fh:l,Fl:f,Gh:h,Gl:y,Hh:d,Hl:p}=this;return[t,e,r,n,i,s,a,o,c,u,l,f,h,y,d,p]}set(t,e,r,n,i,s,a,o,c,u,l,f,h,y,d,p){this.Ah=0|t,this.Al=0|e,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|s,this.Dh=0|a,this.Dl=0|o,this.Eh=0|c,this.El=0|u,this.Fh=0|l,this.Fl=0|f,this.Gh=0|h,this.Gl=0|y,this.Hh=0|d,this.Hl=0|p}process(t,e){for(let r=0;r<16;r++,e+=4)Hf[r]=t.getUint32(e),zf[r]=t.getUint32(e+=4);for(let t=16;t<80;t++){const e=0|Hf[t-15],r=0|zf[t-15],n=Bf(e,r,1)^Bf(e,r,8)^Ef(e,0,7),i=If(e,r,1)^If(e,r,8)^kf(e,r,7),s=0|Hf[t-2],a=0|zf[t-2],o=Bf(s,a,19)^Sf(s,a,61)^Ef(s,0,6),c=If(s,a,19)^Cf(s,a,61)^kf(s,a,6),u=xf(i,c,zf[t-7],zf[t-16]),l=Pf(u,n,o,Hf[t-7],Hf[t-16]);Hf[t]=0|l,zf[t]=0|u}let{Ah:r,Al:n,Bh:i,Bl:s,Ch:a,Cl:o,Dh:c,Dl:u,Eh:l,El:f,Fh:h,Fl:y,Gh:d,Gl:p,Hh:g,Hl:A}=this;for(let t=0;t<80;t++){const e=Bf(l,f,14)^Bf(l,f,18)^Sf(l,f,41),w=If(l,f,14)^If(l,f,18)^Cf(l,f,41),b=l&h^~l&d,m=Qf(A,w,f&y^~f&p,Lf[t],zf[t]),v=_f(m,g,e,b,Ff[t],Hf[t]),E=0|m,k=Bf(r,n,28)^Sf(r,n,34)^Sf(r,n,39),B=If(r,n,28)^Cf(r,n,34)^Cf(r,n,39),I=r&i^r&a^i&a,S=n&s^n&o^s&o;g=0|d,A=0|p,d=0|h,p=0|y,h=0|l,y=0|f,({h:l,l:f}=Kf(0|c,0|u,0|v,0|E)),c=0|a,u=0|o,a=0|i,o=0|s,i=0|r,s=0|n;const C=Df(E,B,S);r=Uf(C,v,k,I),n=0|C}({h:r,l:n}=Kf(0|this.Ah,0|this.Al,0|r,0|n)),({h:i,l:s}=Kf(0|this.Bh,0|this.Bl,0|i,0|s)),({h:a,l:o}=Kf(0|this.Ch,0|this.Cl,0|a,0|o)),({h:c,l:u}=Kf(0|this.Dh,0|this.Dl,0|c,0|u)),({h:l,l:f}=Kf(0|this.Eh,0|this.El,0|l,0|f)),({h,l:y}=Kf(0|this.Fh,0|this.Fl,0|h,0|y)),({h:d,l:p}=Kf(0|this.Gh,0|this.Gl,0|d,0|p)),({h:g,l:A}=Kf(0|this.Hh,0|this.Hl,0|g,0|A)),this.set(r,n,i,s,a,o,c,u,l,f,h,y,d,p,g,A)}roundClean(){al(Hf,zf)}destroy(){al(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class $f extends Gf{constructor(){super(48),this.Ah=0|gf[0],this.Al=0|gf[1],this.Bh=0|gf[2],this.Bl=0|gf[3],this.Ch=0|gf[4],this.Cl=0|gf[5],this.Dh=0|gf[6],this.Dl=0|gf[7],this.Eh=0|gf[8],this.El=0|gf[9],this.Fh=0|gf[10],this.Fl=0|gf[11],this.Gh=0|gf[12],this.Gl=0|gf[13],this.Hh=0|gf[14],this.Hl=0|gf[15]}}const jf=bl(()=>new Mf),Vf=bl(()=>new Nf),qf=bl(()=>new Gf),Yf=bl(()=>new $f);class Zf extends wl{constructor(t,e){super(),this.finished=!1,this.destroyed=!1,nl(t);const r=gl(e);if(this.iHash=t.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,i=new Uint8Array(n);i.set(r.length>n?t.create().update(r).digest():r);for(let t=0;t<i.length;t++)i[t]^=54;this.iHash.update(i),this.oHash=t.create();for(let t=0;t<i.length;t++)i[t]^=106;this.oHash.update(i),al(i)}update(t){return il(this),this.iHash.update(t),this}digestInto(t){il(this),rl(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:e,iHash:r,finished:n,destroyed:i,blockLen:s,outputLen:a}=this;return t.finished=n,t.destroyed=i,t.blockLen=s,t.outputLen=a,t.oHash=e._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const Jf=(t,e,r)=>new Zf(t,e).update(r).digest();Jf.create=(t,e)=>new Zf(t,e);const Wf=BigInt(0),Xf=BigInt(1);function th(t,e){const r=e.negate();return t?r:e}function eh(t,e){const r=sf(t.Fp,e.map(t=>t.Z));return e.map((e,n)=>t.fromAffine(e.toAffine(r[n])))}function rh(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw Error("invalid window size, expected [1.."+e+"], got W="+t)}function nh(t,e){rh(t,e);const r=2**t;return{windows:Math.ceil(e/t)+1,windowSize:2**(t-1),mask:Ml(t),maxNumber:r,shiftBy:BigInt(t)}}function ih(t,e,r){const{windowSize:n,mask:i,maxNumber:s,shiftBy:a}=r;let o=Number(t&i),c=t>>a;o>n&&(o-=s,c+=Xf);const u=e*n;return{nextN:c,offset:u+Math.abs(o)-1,isZero:0===o,isNeg:o<0,isNegF:e%2!=0,offsetF:u}}const sh=new WeakMap,ah=new WeakMap;function oh(t){return ah.get(t)||1}function ch(t){if(t!==Wf)throw Error("invalid wNAF")}class uh{constructor(t,e){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=e}_unsafeLadder(t,e,r=this.ZERO){let n=t;for(;e>Wf;)e&Xf&&(r=r.add(n)),n=n.double(),e>>=Xf;return r}precomputeWindow(t,e){const{windows:r,windowSize:n}=nh(e,this.bits),i=[];let s=t,a=s;for(let t=0;t<r;t++){a=s,i.push(a);for(let t=1;t<n;t++)a=a.add(s),i.push(a);s=a.double()}return i}wNAF(t,e,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let n=this.ZERO,i=this.BASE;const s=nh(t,this.bits);for(let t=0;t<s.windows;t++){const{nextN:a,offset:o,isZero:c,isNeg:u,isNegF:l,offsetF:f}=ih(r,t,s);r=a,c?i=i.add(th(l,e[f])):n=n.add(th(u,e[o]))}return ch(r),{p:n,f:i}}wNAFUnsafe(t,e,r,n=this.ZERO){const i=nh(t,this.bits);for(let t=0;t<i.windows&&r!==Wf;t++){const{nextN:s,offset:a,isZero:o,isNeg:c}=ih(r,t,i);if(r=s,!o){const t=e[a];n=n.add(c?t.negate():t)}}return ch(r),n}getPrecomputes(t,e,r){let n=sh.get(e);return n||(n=this.precomputeWindow(e,t),1!==t&&("function"==typeof r&&(n=r(n)),sh.set(e,n))),n}cached(t,e,r){const n=oh(t);return this.wNAF(n,this.getPrecomputes(n,t,r),e)}unsafe(t,e,r,n){const i=oh(t);return 1===i?this._unsafeLadder(t,e,n):this.wNAFUnsafe(i,this.getPrecomputes(i,t,r),e,n)}createCache(t,e){rh(e,this.bits),ah.set(t,e),sh.delete(t)}hasCache(t){return 1!==oh(t)}}function lh(t,e,r,n){!function(t,e){if(!Array.isArray(t))throw Error("array expected");t.forEach((t,r)=>{if(!(t instanceof e))throw Error("invalid point at index "+r)})}(r,t),function(t,e){if(!Array.isArray(t))throw Error("array of scalars expected");t.forEach((t,r)=>{if(!e.isValid(t))throw Error("invalid scalar at index "+r)})}(n,e);const i=r.length,s=n.length;if(i!==s)throw Error("arrays of points and scalars must have equal length");const a=t.ZERO,o=Tl(BigInt(i));let c=1;o>12?c=o-3:o>4?c=o-2:o>0&&(c=2);const u=Ml(c),l=Array(Number(u)+1).fill(a);let f=a;for(let t=Math.floor((e.BITS-1)/c)*c;t>=0;t-=c){l.fill(a);for(let e=0;e<s;e++){const i=n[e],s=Number(i>>BigInt(t)&u);l[s]=l[s].add(r[e])}let e=a;for(let t=l.length-1,r=a;t>0;t--)r=r.add(l[t]),e=e.add(r);if(f=f.add(e),0!==t)for(let t=0;t<c;t++)f=f.double()}return f}function fh(t,e,r){if(e){if(e.ORDER!==t)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return function(t){Nl(t,nf.reduce((t,e)=>(t[e]="function",t),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"}))}(e),e}return cf(t,{isLE:r})}function hh(t,e,r={},n){if(void 0===n&&(n="edwards"===t),!e||"object"!=typeof e)throw Error(`expected valid ${t} CURVE object`);for(const t of["p","n","h"]){const r=e[t];if(!("bigint"==typeof r&&r>Wf))throw Error(`CURVE.${t} must be positive bigint`)}const i=fh(e.p,r.Fp,n),s=fh(e.n,r.Fn,n),a=["Gx","Gy","a","weierstrass"===t?"b":"d"];for(const t of a)if(!i.isValid(e[t]))throw Error(`CURVE.${t} must be valid field element of CURVE.Fp`);return{CURVE:e=Object.freeze(Object.assign({},e)),Fp:i,Fn:s}}const yh=(t,e)=>(t+(t>=0?e:-e)/bh)/e;function dh(t){if(!["compact","recovered","der"].includes(t))throw Error('Signature format must be "compact", "recovered", or "der"');return t}function ph(t,e){const r={};for(let n of Object.keys(e))r[n]=void 0===t[n]?e[n]:t[n];return Bl(r.lowS,"lowS"),Bl(r.prehash,"prehash"),void 0!==r.format&&dh(r.format),r}const gh={Err:class extends Error{constructor(t=""){super(t)}},_tlv:{encode:(t,e)=>{const{Err:r}=gh;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(1&e.length)throw new r("tlv.encode: unpadded data");const n=e.length/2,i=Sl(n);if(i.length/2&128)throw new r("tlv.encode: long form length too big");const s=n>127?Sl(i.length/2|128):"";return Sl(t)+s+i+e},decode(t,e){const{Err:r}=gh;let n=0;if(t<0||t>256)throw new r("tlv.encode: wrong tag");if(e.length<2||e[n++]!==t)throw new r("tlv.decode: wrong tlv");const i=e[n++];let s=0;if(128&i){const t=127&i;if(!t)throw new r("tlv.decode(long): indefinite length not supported");if(t>4)throw new r("tlv.decode(long): byte length is too big");const a=e.subarray(n,n+t);if(a.length!==t)throw new r("tlv.decode: length bytes not complete");if(0===a[0])throw new r("tlv.decode(long): zero leftmost byte");for(const t of a)s=s<<8|t;if(n+=t,s<128)throw new r("tlv.decode(long): not minimal encoding")}else s=i;const a=e.subarray(n,n+s);if(a.length!==s)throw new r("tlv.decode: wrong value length");return{v:a,l:e.subarray(n+s)}}},_int:{encode(t){const{Err:e}=gh;if(t<Ah)throw new e("integer: negative integers are not allowed");let r=Sl(t);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new e("unexpected DER parsing assertion: unpadded hex");return r},decode(t){const{Err:e}=gh;if(128&t[0])throw new e("invalid signature integer: negative");if(0===t[0]&&!(128&t[1]))throw new e("invalid signature integer: unnecessary leading zero");return Kl(t)}},toSig(t){const{Err:e,_int:r,_tlv:n}=gh,i=Pl("signature",t),{v:s,l:a}=n.decode(48,i);if(a.length)throw new e("invalid signature: left bytes after parsing");const{v:o,l:c}=n.decode(2,s),{v:u,l}=n.decode(2,c);if(l.length)throw new e("invalid signature: left bytes after parsing");return{r:r.decode(o),s:r.decode(u)}},hexFromSig(t){const{_tlv:e,_int:r}=gh,n=e.encode(2,r.encode(t.r))+e.encode(2,r.encode(t.s));return e.encode(48,n)}},Ah=BigInt(0),wh=BigInt(1),bh=BigInt(2),mh=BigInt(3),vh=BigInt(4);function Eh(t,e){const{BYTES:r}=t;let n;if("bigint"==typeof e)n=e;else{let i=Pl("private key",e);try{n=t.fromBytes(i)}catch(t){throw Error(`invalid private key: expected ui8a of size ${r}, got ${typeof e}`)}}if(!t.isValidNot0(n))throw Error("invalid private key: out of range [1..N-1]");return n}function kh(t){return Uint8Array.of(t?2:3)}function Bh(t,e){return{secretKey:e.BYTES,publicKey:1+t.BYTES,publicKeyUncompressed:1+2*t.BYTES,publicKeyHasPrefix:!0,signature:2*e.BYTES}}function Ih(t){const{CURVE:e,curveOpts:r,hash:n,ecdsaOpts:i}=function(t){const{CURVE:e,curveOpts:r}=function(t){const e={a:t.a,b:t.b,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r=t.Fp;let n=t.allowedPrivateKeyLengths?Array.from(new Set(t.allowedPrivateKeyLengths.map(t=>Math.ceil(t/2)))):void 0;return{CURVE:e,curveOpts:{Fp:r,Fn:cf(e.n,{BITS:t.nBitLength,allowedLengths:n,modFromBytes:t.wrapPrivateKey}),allowInfinityPoint:t.allowInfinityPoint,endo:t.endo,isTorsionFree:t.isTorsionFree,clearCofactor:t.clearCofactor,fromBytes:t.fromBytes,toBytes:t.toBytes}}}(t),n={hmac:t.hmac,randomBytes:t.randomBytes,lowS:t.lowS,bits2int:t.bits2int,bits2int_modN:t.bits2int_modN};return{CURVE:e,curveOpts:r,hash:t.hash,ecdsaOpts:n}}(t);return function(t,e){const r=e.Point;return Object.assign({},e,{ProjectivePoint:r,CURVE:Object.assign({},t,of(r.Fn.ORDER,r.Fn.BITS))})}(t,function(t,e,r={}){nl(e),Nl(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});const n=r.randomBytes||vl,i=r.hmac||((t,...r)=>Jf(e,t,Al(...r))),{Fp:s,Fn:a}=t,{ORDER:o,BITS:c}=a,{keygen:u,getPublicKey:l,getSharedSecret:f,utils:h,lengths:y}=function(t,e={}){const{Fn:r}=t,n=e.randomBytes||vl,i=Object.assign(Bh(t.Fp,r),{seed:lf(r.ORDER)});function s(t){try{return!!Eh(r,t)}catch(t){return!1}}function a(t=n(i.seed)){return function(t,e,r=!1){const n=t.length,i=uf(e),s=lf(e);if(n<16||n<s||n>1024)throw Error("expected "+s+"-1024 bytes of input, got "+n);const a=Zl(r?Dl(t):Kl(t),e-Ll)+Ll;return r?xl(a,i):Ul(a,i)}(Il(t,i.seed,"seed"),r.ORDER)}function o(e,n=!0){return t.BASE.multiply(Eh(r,e)).toBytes(n)}function c(e){if("bigint"==typeof e)return!1;if(e instanceof t)return!0;const{secretKey:n,publicKey:s,publicKeyUncompressed:a}=i;if(r.allowedLengths||n===s)return;const o=Pl("key",e).length;return o===s||o===a}const u={isValidSecretKey:s,isValidPublicKey:function(e,r){const{publicKey:n,publicKeyUncompressed:s}=i;try{const i=e.length;return!(!0===r&&i!==n||!1===r&&i!==s||!t.fromBytes(e))}catch(t){return!1}},randomSecretKey:a,isValidPrivateKey:s,randomPrivateKey:a,normPrivateKeyToScalar:t=>Eh(r,t),precompute:(e=8,r=t.BASE)=>r.precompute(e,!1)};return Object.freeze({getPublicKey:o,getSharedSecret:function(e,n,i=!0){if(!0===c(e))throw Error("first arg must be private key");if(!1===c(n))throw Error("second arg must be public key");const s=Eh(r,e);return t.fromHex(n).multiply(s).toBytes(i)},keygen:function(t){const e=a(t);return{secretKey:e,publicKey:o(e)}},Point:t,utils:u,lengths:i})}(t,r),d={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},p="compact";function g(t){return t>o>>wh}function A(t,e){if(!a.isValidNot0(e))throw Error(`invalid signature ${t}: out of range 1..Point.Fn.ORDER`);return e}class w{constructor(t,e,r){this.r=A("r",t),this.s=A("s",e),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(t,e=p){let r;if(function(t,e){dh(e);const r=y.signature;Il(t,"compact"===e?r:"recovered"===e?r+1:void 0,e+" signature")}(t,e),"der"===e){const{r:e,s:r}=gh.toSig(Il(t));return new w(e,r)}"recovered"===e&&(r=t[0],e="compact",t=t.subarray(1));const n=a.BYTES,i=t.subarray(0,n),s=t.subarray(n,2*n);return new w(a.fromBytes(i),a.fromBytes(s),r)}static fromHex(t,e){return this.fromBytes(pl(t),e)}addRecoveryBit(t){return new w(this.r,this.s,t)}recoverPublicKey(e){const r=s.ORDER,{r:n,s:i,recovery:c}=this;if(null==c||![0,1,2,3].includes(c))throw Error("recovery id invalid");if(o*bh<r&&c>1)throw Error("recovery id is ambiguous for h>1 curve");const u=2===c||3===c?n+o:n;if(!s.isValid(u))throw Error("recovery id 2 or 3 invalid");const l=s.toBytes(u),f=t.fromBytes(Al(kh(!(1&c)),l)),h=a.inv(u),y=m(Pl("msgHash",e)),d=a.create(-y*h),p=a.create(i*h),g=t.BASE.multiplyUnsafe(d).add(f.multiplyUnsafe(p));if(g.is0())throw Error("point at infinify");return g.assertValidity(),g}hasHighS(){return g(this.s)}toBytes(t=p){if(dh(t),"der"===t)return pl(gh.hexFromSig(this));const e=a.toBytes(this.r),r=a.toBytes(this.s);if("recovered"===t){if(null==this.recovery)throw Error("recovery bit must be present");return Al(Uint8Array.of(this.recovery),e,r)}return Al(e,r)}toHex(t){return yl(this.toBytes(t))}assertValidity(){}static fromCompact(t){return w.fromBytes(Pl("sig",t),"compact")}static fromDER(t){return w.fromBytes(Pl("sig",t),"der")}normalizeS(){return this.hasHighS()?new w(this.r,a.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return yl(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return yl(this.toBytes("compact"))}}const b=r.bits2int||function(t){if(t.length>8192)throw Error("input is too large");const e=Kl(t),r=8*t.length-c;return r>0?e>>BigInt(r):e},m=r.bits2int_modN||function(t){return a.create(b(t))},v=Ml(c);function E(t){return Rl("num < 2^"+c,t,Ah,v),a.toBytes(t)}function k(t,r){return Il(t,void 0,"message"),r?Il(e(t),void 0,"prehashed message"):t}return Object.freeze({keygen:u,getPublicKey:l,getSharedSecret:f,utils:h,lengths:y,Point:t,sign:function(r,s,o={}){r=Pl("message",r);const{seed:c,k2sig:u}=function(e,r,i){if(["recovered","canonical"].some(t=>t in i))throw Error("sign() legacy options not supported");const{lowS:s,prehash:o,extraEntropy:c}=ph(i,d);e=k(e,o);const u=m(e),l=Eh(a,r),f=[E(l),E(u)];if(null!=c&&!1!==c){const t=!0===c?n(y.secretKey):c;f.push(Pl("extraEntropy",t))}const h=Al(...f),p=u;return{seed:h,k2sig:function(e){const r=b(e);if(!a.isValidNot0(r))return;const n=a.inv(r),i=t.BASE.multiply(r).toAffine(),o=a.create(i.x);if(o===Ah)return;const c=a.create(n*a.create(p+o*l));if(c===Ah)return;let u=(i.x===o?0:2)|Number(i.y&wh),f=c;return s&&g(c)&&(f=a.neg(c),u^=1),new w(o,f,u)}}}(r,s,o),l=function(t,e,r){if("number"!=typeof t||t<2)throw Error("hashLen must be a number");if("number"!=typeof e||e<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");const n=t=>new Uint8Array(t),i=t=>Uint8Array.of(t);let s=n(t),a=n(t),o=0;const c=()=>{s.fill(1),a.fill(0),o=0},u=(...t)=>r(a,s,...t),l=(t=n(0))=>{a=u(i(0),t),s=u(),0!==t.length&&(a=u(i(1),t),s=u())},f=()=>{if(o++>=1e3)throw Error("drbg: tried 1000 values");let t=0;const r=[];for(;t<e;){s=u();const e=s.slice();r.push(e),t+=s.length}return Al(...r)};return(t,e)=>{let r;for(c(),l(t);!(r=e(f()));)l();return c(),r}}(e.outputLen,a.BYTES,i);return l(c,u)},verify:function(e,r,n,i={}){const{lowS:s,prehash:o,format:c}=ph(i,d);if(n=Pl("publicKey",n),r=k(Pl("message",r),o),"strict"in i)throw Error("options.strict was renamed to lowS");const u=void 0===c?function(t){let e;const r="string"==typeof t||tl(t),n=!r&&null!==t&&"object"==typeof t&&"bigint"==typeof t.r&&"bigint"==typeof t.s;if(!r&&!n)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(n)e=new w(t.r,t.s);else if(r){try{e=w.fromBytes(Pl("sig",t),"der")}catch(t){if(!(t instanceof gh.Err))throw t}if(!e)try{e=w.fromBytes(Pl("sig",t),"compact")}catch(t){return!1}}return e||!1}(e):w.fromBytes(Pl("sig",e),c);if(!1===u)return!1;try{const e=t.fromBytes(n);if(s&&u.hasHighS())return!1;const{r:i,s:o}=u,c=m(r),l=a.inv(o),f=a.create(c*l),h=a.create(i*l),y=t.BASE.multiplyUnsafe(f).add(e.multiplyUnsafe(h));return!y.is0()&&a.create(y.x)===i}catch(t){return!1}},recoverPublicKey:function(t,e,r={}){const{prehash:n}=ph(r,d);return e=k(e,n),w.fromBytes(t,"recovered").recoverPublicKey(e).toBytes()},Signature:w,hash:e})}(function(t,e={}){const r=hh("weierstrass",t,e),{Fp:n,Fn:i}=r;let s=r.CURVE;const{h:a,n:o}=s;Nl(e,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});const{endo:c}=e;if(c&&(!n.is0(s.a)||"bigint"!=typeof c.beta||!Array.isArray(c.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');const u=Bh(n,i);function l(){if(!n.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}const f=e.toBytes||function(t,e,r){const{x:i,y:s}=e.toAffine(),a=n.toBytes(i);return Bl(r,"isCompressed"),r?(l(),Al(kh(!n.isOdd(s)),a)):Al(Uint8Array.of(4),a,n.toBytes(s))},h=e.fromBytes||function(t){Il(t,void 0,"Point");const{publicKey:e,publicKeyUncompressed:r}=u,i=t.length,s=t[0],a=t.subarray(1);if(i!==e||2!==s&&3!==s){if(i===r&&4===s){const t=n.BYTES,e=n.fromBytes(a.subarray(0,t)),r=n.fromBytes(a.subarray(t,2*t));if(!d(e,r))throw Error("bad point: is not on curve");return{x:e,y:r}}throw Error(`bad point: got length ${i}, expected compressed=${e} or uncompressed=${r}`)}{const e=n.fromBytes(a);if(!n.isValid(e))throw Error("bad point: is not on curve, wrong x");const r=y(e);let i;try{i=n.sqrt(r)}catch(t){const e=t instanceof Error?": "+t.message:"";throw Error("bad point: is not on curve, sqrt error"+e)}return l(),!(1&~s)!==n.isOdd(i)&&(i=n.neg(i)),{x:e,y:i}}};function y(t){const e=n.sqr(t),r=n.mul(e,t);return n.add(n.add(r,n.mul(t,s.a)),s.b)}function d(t,e){const r=n.sqr(e),i=y(t);return n.eql(r,i)}if(!d(s.Gx,s.Gy))throw Error("bad curve params: generator point");const p=n.mul(n.pow(s.a,mh),vh),g=n.mul(n.sqr(s.b),BigInt(27));if(n.is0(n.add(p,g)))throw Error("bad curve params: a or b");function A(t,e,r=!1){if(!n.isValid(e)||r&&n.is0(e))throw Error("bad point coordinate "+t);return e}function w(t){if(!(t instanceof k))throw Error("ProjectivePoint expected")}function b(t){if(!c||!c.basises)throw Error("no endo");return function(t,e,r){const[[n,i],[s,a]]=e,o=yh(a*t,r),c=yh(-i*t,r);let u=t-o*n-c*s,l=-o*i-c*a;const f=u<Ah,h=l<Ah;f&&(u=-u),h&&(l=-l);const y=Ml(Math.ceil(Tl(r)/2))+wh;if(u<Ah||u>=y||l<Ah||l>=y)throw Error("splitScalar (endomorphism): failed, k="+t);return{k1neg:f,k1:u,k2neg:h,k2:l}}(t,c.basises,i.ORDER)}const m=Ol((t,e)=>{const{X:r,Y:i,Z:s}=t;if(n.eql(s,n.ONE))return{x:r,y:i};const a=t.is0();null==e&&(e=a?n.ONE:n.inv(s));const o=n.mul(r,e),c=n.mul(i,e),u=n.mul(s,e);if(a)return{x:n.ZERO,y:n.ZERO};if(!n.eql(u,n.ONE))throw Error("invZ was invalid");return{x:o,y:c}}),v=Ol(t=>{if(t.is0()){if(e.allowInfinityPoint&&!n.is0(t.Y))return;throw Error("bad point: ZERO")}const{x:r,y:i}=t.toAffine();if(!n.isValid(r)||!n.isValid(i))throw Error("bad point: x or y not field elements");if(!d(r,i))throw Error("bad point: equation left != right");if(!t.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function E(t,e,r,i,s){return r=new k(n.mul(r.X,t),r.Y,r.Z),e=th(i,e),r=th(s,r),e.add(r)}class k{constructor(t,e,r){this.X=A("x",t),this.Y=A("y",e,!0),this.Z=A("z",r),Object.freeze(this)}static CURVE(){return s}static fromAffine(t){const{x:e,y:r}=t||{};if(!t||!n.isValid(e)||!n.isValid(r))throw Error("invalid affine point");if(t instanceof k)throw Error("projective point not allowed");return n.is0(e)&&n.is0(r)?k.ZERO:new k(e,r,n.ONE)}static fromBytes(t){const e=k.fromAffine(h(Il(t,void 0,"point")));return e.assertValidity(),e}static fromHex(t){return k.fromBytes(Pl("pointHex",t))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(t=8,e=!0){return I.createCache(this,t),e||this.multiply(mh),this}assertValidity(){v(this)}hasEvenY(){const{y:t}=this.toAffine();if(!n.isOdd)throw Error("Field doesn't support isOdd");return!n.isOdd(t)}equals(t){w(t);const{X:e,Y:r,Z:i}=this,{X:s,Y:a,Z:o}=t,c=n.eql(n.mul(e,o),n.mul(s,i)),u=n.eql(n.mul(r,o),n.mul(a,i));return c&&u}negate(){return new k(this.X,n.neg(this.Y),this.Z)}double(){const{a:t,b:e}=s,r=n.mul(e,mh),{X:i,Y:a,Z:o}=this;let c=n.ZERO,u=n.ZERO,l=n.ZERO,f=n.mul(i,i),h=n.mul(a,a),y=n.mul(o,o),d=n.mul(i,a);return d=n.add(d,d),l=n.mul(i,o),l=n.add(l,l),c=n.mul(t,l),u=n.mul(r,y),u=n.add(c,u),c=n.sub(h,u),u=n.add(h,u),u=n.mul(c,u),c=n.mul(d,c),l=n.mul(r,l),y=n.mul(t,y),d=n.sub(f,y),d=n.mul(t,d),d=n.add(d,l),l=n.add(f,f),f=n.add(l,f),f=n.add(f,y),f=n.mul(f,d),u=n.add(u,f),y=n.mul(a,o),y=n.add(y,y),f=n.mul(y,d),c=n.sub(c,f),l=n.mul(y,h),l=n.add(l,l),l=n.add(l,l),new k(c,u,l)}add(t){w(t);const{X:e,Y:r,Z:i}=this,{X:a,Y:o,Z:c}=t;let u=n.ZERO,l=n.ZERO,f=n.ZERO;const h=s.a,y=n.mul(s.b,mh);let d=n.mul(e,a),p=n.mul(r,o),g=n.mul(i,c),A=n.add(e,r),b=n.add(a,o);A=n.mul(A,b),b=n.add(d,p),A=n.sub(A,b),b=n.add(e,i);let m=n.add(a,c);return b=n.mul(b,m),m=n.add(d,g),b=n.sub(b,m),m=n.add(r,i),u=n.add(o,c),m=n.mul(m,u),u=n.add(p,g),m=n.sub(m,u),f=n.mul(h,b),u=n.mul(y,g),f=n.add(u,f),u=n.sub(p,f),f=n.add(p,f),l=n.mul(u,f),p=n.add(d,d),p=n.add(p,d),g=n.mul(h,g),b=n.mul(y,b),p=n.add(p,g),g=n.sub(d,g),g=n.mul(h,g),b=n.add(b,g),d=n.mul(p,b),l=n.add(l,d),d=n.mul(m,b),u=n.mul(A,u),u=n.sub(u,d),d=n.mul(A,p),f=n.mul(m,f),f=n.add(f,d),new k(u,l,f)}subtract(t){return this.add(t.negate())}is0(){return this.equals(k.ZERO)}multiply(t){const{endo:r}=e;if(!i.isValidNot0(t))throw Error("invalid scalar: out of range");let n,s;const a=t=>I.cached(this,t,t=>eh(k,t));if(r){const{k1neg:e,k1:i,k2neg:o,k2:c}=b(t),{p:u,f:l}=a(i),{p:f,f:h}=a(c);s=l.add(h),n=E(r.beta,u,f,e,o)}else{const{p:e,f:r}=a(t);n=e,s=r}return eh(k,[n,s])[0]}multiplyUnsafe(t){const{endo:r}=e,n=this;if(!i.isValid(t))throw Error("invalid scalar: out of range");if(t===Ah||n.is0())return k.ZERO;if(t===wh)return n;if(I.hasCache(this))return this.multiply(t);if(r){const{k1neg:e,k1:i,k2neg:s,k2:a}=b(t),{p1:o,p2:c}=function(t,e,r,n){let i=e,s=t.ZERO,a=t.ZERO;for(;r>Wf||n>Wf;)r&Xf&&(s=s.add(i)),n&Xf&&(a=a.add(i)),i=i.double(),r>>=Xf,n>>=Xf;return{p1:s,p2:a}}(k,n,i,a);return E(r.beta,o,c,e,s)}return I.unsafe(n,t)}multiplyAndAddUnsafe(t,e,r){const n=this.multiplyUnsafe(e).add(t.multiplyUnsafe(r));return n.is0()?void 0:n}toAffine(t){return m(this,t)}isTorsionFree(){const{isTorsionFree:t}=e;return a===wh||(t?t(k,this):I.unsafe(this,o).is0())}clearCofactor(){const{clearCofactor:t}=e;return a===wh?this:t?t(k,this):this.multiplyUnsafe(a)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}toBytes(t=!0){return Bl(t,"isCompressed"),this.assertValidity(),f(k,this,t)}toHex(t=!0){return yl(this.toBytes(t))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(t=!0){return this.toBytes(t)}_setWindowSize(t){this.precompute(t)}static normalizeZ(t){return eh(k,t)}static msm(t,e){return lh(k,i,t,e)}static fromPrivateKey(t){return k.BASE.multiply(Eh(i,t))}}k.BASE=new k(s.Gx,s.Gy,n.ONE),k.ZERO=new k(n.ZERO,n.ONE,n.ZERO),k.Fp=n,k.Fn=i;const B=i.BITS,I=new uh(k,e.endo?Math.ceil(B/2):B);return k.BASE.precompute(8),k}(e,r),n,i))}function Sh(t,e){const r=e=>Ih({...t,hash:e});return{...r(e),create:r}}const Ch={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},Kh={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},Dh={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},Uh=cf(Ch.p),xh=cf(Kh.p),Ph=cf(Dh.p),Qh=Sh({...Ch,Fp:Uh,lowS:!1},jf),_h=Sh({...Kh,Fp:xh,lowS:!1},Yf),Rh=Sh({...Dh,Fp:Ph,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},qf),Th=BigInt(0),Mh=BigInt(1),Nh=BigInt(2),Oh=BigInt(7),Fh=BigInt(256),Lh=BigInt(113),Hh=[],zh=[],Gh=[];for(let Dg=0,Ug=Mh,xg=1,Pg=0;Dg<24;Dg++){[xg,Pg]=[Pg,(2*xg+3*Pg)%5],Hh.push(2*(5*Pg+xg)),zh.push((Dg+1)*(Dg+2)/2%64);let Qg=Th;for(let _g=0;_g<7;_g++)Ug=(Ug<<Mh^(Ug>>Oh)*Lh)%Fh,Ug&Nh&&(Qg^=Mh<<(Mh<<BigInt(_g))-Mh);Gh.push(Qg)}const $h=vf(Gh,!0),jh=$h[0],Vh=$h[1],qh=(t,e,r)=>r>32?((t,e,r)=>e<<r-32|t>>>64-r)(t,e,r):((t,e,r)=>t<<r|e>>>32-r)(t,e,r),Yh=(t,e,r)=>r>32?((t,e,r)=>t<<r-32|e>>>64-r)(t,e,r):((t,e,r)=>e<<r|t>>>32-r)(t,e,r);class Zh extends wl{constructor(t,e,r,n=!1,i=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=t,this.suffix=e,this.outputLen=r,this.enableXOF=n,this.rounds=i,el(r),!(0<t&&t<200))throw Error("only keccak-f1600 function is supported");var s;this.state=new Uint8Array(200),this.state32=(s=this.state,new Uint32Array(s.buffer,s.byteOffset,Math.floor(s.byteLength/4)))}clone(){return this._cloneInto()}keccak(){ll(this.state32),function(t,e=24){const r=new Uint32Array(10);for(let n=24-e;n<24;n++){for(let e=0;e<10;e++)r[e]=t[e]^t[e+10]^t[e+20]^t[e+30]^t[e+40];for(let e=0;e<10;e+=2){const n=(e+8)%10,i=(e+2)%10,s=r[i],a=r[i+1],o=qh(s,a,1)^r[n],c=Yh(s,a,1)^r[n+1];for(let r=0;r<50;r+=10)t[e+r]^=o,t[e+r+1]^=c}let e=t[2],i=t[3];for(let r=0;r<24;r++){const n=zh[r],s=qh(e,i,n),a=Yh(e,i,n),o=Hh[r];e=t[o],i=t[o+1],t[o]=s,t[o+1]=a}for(let e=0;e<50;e+=10){for(let n=0;n<10;n++)r[n]=t[e+n];for(let n=0;n<10;n++)t[e+n]^=~r[(n+2)%10]&r[(n+4)%10]}t[0]^=jh[n],t[1]^=Vh[n]}al(r)}(this.state32,this.rounds),ll(this.state32),this.posOut=0,this.pos=0}update(t){il(this),rl(t=gl(t));const{blockLen:e,state:r}=this,n=t.length;for(let i=0;i<n;){const s=Math.min(e-this.pos,n-i);for(let e=0;e<s;e++)r[this.pos++]^=t[i++];this.pos===e&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:t,suffix:e,pos:r,blockLen:n}=this;t[r]^=e,128&e&&r===n-1&&this.keccak(),t[n-1]^=128,this.keccak()}writeInto(t){il(this,!1),rl(t),this.finish();const e=this.state,{blockLen:r}=this;for(let n=0,i=t.length;n<i;){this.posOut>=r&&this.keccak();const s=Math.min(r-this.posOut,i-n);t.set(e.subarray(this.posOut,this.posOut+s),n),this.posOut+=s,n+=s}return t}xofInto(t){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(t)}xof(t){return el(t),this.xofInto(new Uint8Array(t))}digestInto(t){if(sl(t,this),this.finished)throw Error("digest() was already called");return this.writeInto(t),this.destroy(),t}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,al(this.state)}_cloneInto(t){const{blockLen:e,suffix:r,outputLen:n,rounds:i,enableXOF:s}=this;return t||(t=new Zh(e,r,n,s,i)),t.state32.set(this.state32),t.pos=this.pos,t.posOut=this.posOut,t.finished=this.finished,t.rounds=i,t.suffix=r,t.outputLen=n,t.enableXOF=s,t.destroyed=this.destroyed,t}}const Jh=(t,e,r)=>bl(()=>new Zh(e,t,r)),Wh=(()=>Jh(6,136,32))(),Xh=(()=>Jh(6,72,64))(),ty=(()=>function(t){const e=(e,r)=>t(r).update(gl(e)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=e=>t(e),e}((t={})=>new Zh(136,31,void 0===t.dkLen?32:t.dkLen,!0)))(),ey=BigInt(0),ry=BigInt(1),ny=BigInt(2),iy=BigInt(8);function sy(t,e={}){const r=hh("edwards",t,e,e.FpFnLE),{Fp:n,Fn:i}=r;let s=r.CURVE;const{h:a}=s;Nl(e,{},{uvRatio:"function"});const o=ny<<BigInt(8*i.BYTES)-ry,c=t=>n.create(t),u=e.uvRatio||((t,e)=>{try{return{isValid:!0,value:n.sqrt(n.div(t,e))}}catch(t){return{isValid:!1,value:ey}}});if(!function(t,e,r,n){const i=t.sqr(r),s=t.sqr(n),a=t.add(t.mul(e.a,i),s),o=t.add(t.ONE,t.mul(e.d,t.mul(i,s)));return t.eql(a,o)}(n,s,s.Gx,s.Gy))throw Error("bad curve params: generator point");function l(t,e,r=!1){return Rl("coordinate "+t,e,r?ry:ey,o),e}function f(t){if(!(t instanceof d))throw Error("ExtendedPoint expected")}const h=Ol((t,e)=>{const{X:r,Y:i,Z:s}=t,a=t.is0();null==e&&(e=a?iy:n.inv(s));const o=c(r*e),u=c(i*e),l=n.mul(s,e);if(a)return{x:ey,y:ry};if(l!==ry)throw Error("invZ was invalid");return{x:o,y:u}}),y=Ol(t=>{const{a:e,d:r}=s;if(t.is0())throw Error("bad point: ZERO");const{X:n,Y:i,Z:a,T:o}=t,u=c(n*n),l=c(i*i),f=c(a*a),h=c(f*f),y=c(u*e);if(c(f*c(y+l))!==c(h+c(r*c(u*l))))throw Error("bad point: equation left != right (1)");if(c(n*i)!==c(a*o))throw Error("bad point: equation left != right (2)");return!0});class d{constructor(t,e,r,n){this.X=l("x",t),this.Y=l("y",e),this.Z=l("z",r,!0),this.T=l("t",n),Object.freeze(this)}static CURVE(){return s}static fromAffine(t){if(t instanceof d)throw Error("extended point not allowed");const{x:e,y:r}=t||{};return l("x",e),l("y",r),new d(e,r,ry,c(e*r))}static fromBytes(t,e=!1){const r=n.BYTES,{a:i,d:a}=s;t=Ql(Il(t,r,"point")),Bl(e,"zip215");const l=Ql(t),f=t[r-1];l[r-1]=-129&f;const h=Dl(l),y=e?o:n.ORDER;Rl("point.y",h,ey,y);const p=c(h*h),g=c(p-ry),A=c(a*p-i);let{isValid:w,value:b}=u(g,A);if(!w)throw Error("bad point: invalid y coordinate");const m=(b&ry)===ry,v=!!(128&f);if(!e&&b===ey&&v)throw Error("bad point: x=0 and x_0=1");return v!==m&&(b=c(-b)),d.fromAffine({x:b,y:h})}static fromHex(t,e=!1){return d.fromBytes(Pl("point",t),e)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(t=8,e=!0){return p.createCache(this,t),e||this.multiply(ny),this}assertValidity(){y(this)}equals(t){f(t);const{X:e,Y:r,Z:n}=this,{X:i,Y:s,Z:a}=t,o=c(e*a),u=c(i*n),l=c(r*a),h=c(s*n);return o===u&&l===h}is0(){return this.equals(d.ZERO)}negate(){return new d(c(-this.X),this.Y,this.Z,c(-this.T))}double(){const{a:t}=s,{X:e,Y:r,Z:n}=this,i=c(e*e),a=c(r*r),o=c(ny*c(n*n)),u=c(t*i),l=e+r,f=c(c(l*l)-i-a),h=u+a,y=h-o,p=u-a,g=c(f*y),A=c(h*p),w=c(f*p),b=c(y*h);return new d(g,A,b,w)}add(t){f(t);const{a:e,d:r}=s,{X:n,Y:i,Z:a,T:o}=this,{X:u,Y:l,Z:h,T:y}=t,p=c(n*u),g=c(i*l),A=c(o*r*y),w=c(a*h),b=c((n+i)*(u+l)-p-g),m=w-A,v=w+A,E=c(g-e*p),k=c(b*m),B=c(v*E),I=c(b*E),S=c(m*v);return new d(k,B,S,I)}subtract(t){return this.add(t.negate())}multiply(t){if(!i.isValidNot0(t))throw Error("invalid scalar: expected 1 <= sc < curve.n");const{p:e,f:r}=p.cached(this,t,t=>eh(d,t));return eh(d,[e,r])[0]}multiplyUnsafe(t,e=d.ZERO){if(!i.isValid(t))throw Error("invalid scalar: expected 0 <= sc < curve.n");return t===ey?d.ZERO:this.is0()||t===ry?this:p.unsafe(this,t,t=>eh(d,t),e)}isSmallOrder(){return this.multiplyUnsafe(a).is0()}isTorsionFree(){return p.unsafe(this,s.n).is0()}toAffine(t){return h(this,t)}clearCofactor(){return a===ry?this:this.multiplyUnsafe(a)}toBytes(){const{x:t,y:e}=this.toAffine(),r=n.toBytes(e);return r[r.length-1]|=t&ry?128:0,r}toHex(){return yl(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get ex(){return this.X}get ey(){return this.Y}get ez(){return this.Z}get et(){return this.T}static normalizeZ(t){return eh(d,t)}static msm(t,e){return lh(d,i,t,e)}_setWindowSize(t){this.precompute(t)}toRawBytes(){return this.toBytes()}}d.BASE=new d(s.Gx,s.Gy,ry,c(s.Gx*s.Gy)),d.ZERO=new d(ey,ry,ry,ey),d.Fp=n,d.Fn=i;const p=new uh(d,i.BITS);return d.BASE.precompute(8),d}const ay=BigInt(0),oy=BigInt(1),cy=BigInt(2),uy={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x3fffffffffffffffffffffffffffffffffffffffffffffffffffffff7cca23e9c44edb49aed63690216cc2728dc58f552378c292ab5844f3"),h:BigInt(4),a:BigInt(1),d:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffffffffffffffffffffffffffffffffffffffffffffffff6756"),Gx:BigInt("0x4f1970c66bed0ded221d15a622bf36da9e146570470f1767ea6de324a3d3a46412ae1af72ab66511433b80e18b00938e2626a82bc70cc05e"),Gy:BigInt("0x693f46716eb6bc248876203756c9c7624bea73736ca3984087789c1e05a0c2d73ad3ff1ce67c39c4fdbd132c4ed7c8ad9808795bf230fa14")},ly=Object.assign({},uy,{d:BigInt("0xd78b4bdc7f0daf19f24f38c29373a2ccad46157242a50f37809b1da3412a12e79ccc9c81264cfe9ad080997058fb61c4243cc32dbaa156b9"),Gx:BigInt("0x79a70b2b70400553ae7c9df416c792c61128751ac92969240c25a07d728bdc93e21f7787ed6972249de732f38496cd11698713093e9c04fc"),Gy:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffff80000000000000000000000000000000000000000000000000000001")}),fy=bl(()=>ty.create({dkLen:114})),hy=BigInt(1),yy=BigInt(2),dy=BigInt(3);BigInt(4);const py=BigInt(11),gy=BigInt(22),Ay=BigInt(44),wy=BigInt(88),by=BigInt(223);function my(t){const e=uy.p,r=t*t*t%e,n=r*r*t%e,i=Jl(n,dy,e)*n%e,s=Jl(i,dy,e)*n%e,a=Jl(s,yy,e)*r%e,o=Jl(a,py,e)*a%e,c=Jl(o,gy,e)*o%e,u=Jl(c,Ay,e)*c%e,l=Jl(u,wy,e)*u%e,f=Jl(l,Ay,e)*c%e,h=Jl(f,yy,e)*r%e,y=Jl(h,hy,e)*t%e;return Jl(y,by,e)*h%e}function vy(t){return t[0]&=252,t[55]|=128,t[56]=0,t}function Ey(t,e){const r=uy.p,n=Zl(t*t*e,r),i=Zl(n*t,r),s=Zl(i*n*e,r),a=Zl(i*my(s),r),o=Zl(a*a,r);return{isValid:Zl(o*e,r)===t,value:a}}const ky=(()=>cf(uy.p,{BITS:456,isLE:!0}))(),By=(()=>cf(uy.n,{BITS:456,isLE:!0}))();function Iy(t,e,r){if(e.length>255)throw Error("context must be smaller than 255, got: "+e.length);return Al((n="SigEd448",Uint8Array.from(n,(t,e)=>{const r=t.charCodeAt(0);if(1!==t.length||r>127)throw Error(`string contains non-ASCII character "${n[e]}" with code ${r} at position ${e}`);return r})),new Uint8Array([r?1:0,e.length]),e,t);var n}const Sy=function(t){const{CURVE:e,curveOpts:r,hash:n,eddsaOpts:i}=function(t){const e={a:t.a,d:t.d,p:t.Fp.ORDER,n:t.n,h:t.h,Gx:t.Gx,Gy:t.Gy},r={Fp:t.Fp,Fn:cf(e.n,t.nBitLength,!0),uvRatio:t.uvRatio},n={randomBytes:t.randomBytes,adjustScalarBytes:t.adjustScalarBytes,domain:t.domain,prehash:t.prehash,mapToCurve:t.mapToCurve};return{CURVE:e,curveOpts:r,hash:t.hash,eddsaOpts:n}}(t);return function(t,e){const r=e.Point;return Object.assign({},e,{ExtendedPoint:r,CURVE:t,nBitLength:r.Fn.BITS,nByteLength:r.Fn.BYTES})}(t,function(t,e,r={}){if("function"!=typeof e)throw Error('"hash" function param is required');Nl(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});const{prehash:n}=r,{BASE:i,Fp:s,Fn:a}=t,o=r.randomBytes||vl,c=r.adjustScalarBytes||(t=>t),u=r.domain||((t,e,r)=>{if(Bl(r,"phflag"),e.length||r)throw Error("Contexts/pre-hash are not supported");return t});function l(t){return a.create(Dl(t))}function f(t){const{head:r,prefix:n,scalar:s}=function(t){const r=g.secretKey;t=Pl("private key",t,r);const n=Pl("hashed private key",e(t),2*r),i=c(n.slice(0,r));return{head:i,prefix:n.slice(r,2*r),scalar:l(i)}}(t),a=i.multiply(s),o=a.toBytes();return{head:r,prefix:n,scalar:s,point:a,pointBytes:o}}function h(t){return f(t).pointBytes}function y(t=Uint8Array.of(),...r){const i=Al(...r);return l(e(u(i,Pl("context",t),!!n)))}const d={zip215:!0},p=s.BYTES,g={secretKey:p,publicKey:p,signature:2*p,seed:p};function A(t=o(g.seed)){return Il(t,g.seed,"seed")}const w={getExtendedPublicKey:f,randomSecretKey:A,isValidSecretKey:function(t){return tl(t)&&t.length===a.BYTES},isValidPublicKey:function(e,r){try{return!!t.fromBytes(e,r)}catch(t){return!1}},toMontgomery(e){const{y:r}=t.fromBytes(e),n=g.publicKey,i=32===n;if(!i&&57!==n)throw Error("only defined for 25519 and 448");const a=i?s.div(ry+r,ry-r):s.div(r-ry,r+ry);return s.toBytes(a)},toMontgomeryPriv(t){const r=g.secretKey;Il(t,r);const n=e(t.subarray(0,r));return c(n).subarray(0,r)},randomPrivateKey:A,precompute:(e=8,r=t.BASE)=>r.precompute(e,!1)};return Object.freeze({keygen:function(t){const e=w.randomSecretKey(t);return{secretKey:e,publicKey:h(e)}},getPublicKey:h,sign:function(t,e,r={}){t=Pl("message",t),n&&(t=n(t));const{prefix:s,scalar:o,pointBytes:c}=f(e),u=y(r.context,s,t),l=i.multiply(u).toBytes(),h=y(r.context,l,c,t),d=a.create(u+h*o);if(!a.isValid(d))throw Error("sign failed: invalid s");return Il(Al(l,a.toBytes(d)),g.signature,"result")},verify:function(e,r,s,a=d){const{context:o,zip215:c}=a,u=g.signature;e=Pl("signature",e,u),r=Pl("message",r),s=Pl("publicKey",s,g.publicKey),void 0!==c&&Bl(c,"zip215"),n&&(r=n(r));const l=u/2,f=e.subarray(0,l),h=Dl(e.subarray(l,u));let p,A,w;try{p=t.fromBytes(s,c),A=t.fromBytes(f,c),w=i.multiplyUnsafe(h)}catch(t){return!1}if(!c&&p.isSmallOrder())return!1;const b=y(o,A.toBytes(),p.toBytes(),r);return A.add(p.multiplyUnsafe(b)).subtract(w).clearCofactor().is0()},utils:w,Point:t,lengths:g})}(sy(e,r),n,i))}((()=>({...uy,Fp:ky,Fn:By,nBitLength:By.BITS,hash:fy,adjustScalarBytes:vy,domain:Iy,uvRatio:Ey}))());sy(ly);const Cy=(()=>{const t=uy.p;return function(t){const e=(Nl(r=t,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...r}));var r;const{P:n,type:i,adjustScalarBytes:s,powPminus2:a,randomBytes:o}=e,c="x25519"===i;if(!c&&"x448"!==i)throw Error("invalid type");const u=o||vl,l=c?255:448,f=c?32:56,h=c?BigInt(9):BigInt(5),y=c?BigInt(121665):BigInt(39081),d=c?cy**BigInt(254):cy**BigInt(447),p=c?BigInt(8)*cy**BigInt(251)-oy:BigInt(4)*cy**BigInt(445)-oy,g=d+p+oy,A=t=>Zl(t,n),w=b(h);function b(t){return xl(A(t),f)}function m(t,e){const r=function(t,e){Rl("u",t,ay,n),Rl("scalar",e,d,g);const r=e,i=t;let s=oy,o=ay,c=t,u=oy,f=ay;for(let t=BigInt(l-1);t>=ay;t--){const e=r>>t&oy;f^=e,({x_2:s,x_3:c}=E(f,s,c)),({x_2:o,x_3:u}=E(f,o,u)),f=e;const n=s+o,a=A(n*n),l=s-o,h=A(l*l),d=a-h,p=c+u,g=A((c-u)*n),w=A(p*l),b=g+w,m=g-w;c=A(b*b),u=A(i*A(m*m)),s=A(a*h),o=A(d*(a+A(y*d)))}({x_2:s,x_3:c}=E(f,s,c)),({x_2:o,x_3:u}=E(f,o,u));const h=a(o);return A(s*h)}(function(t){const e=Pl("u coordinate",t,f);return c&&(e[31]&=127),A(Dl(e))}(e),function(t){return Dl(s(Pl("scalar",t,f)))}(t));if(r===ay)throw Error("invalid private or public key received");return b(r)}function v(t){return m(t,w)}function E(t,e,r){const n=A(t*(e-r));return{x_2:e=A(e-n),x_3:r=A(r+n)}}const k={secretKey:f,publicKey:f,seed:f},B=(t=u(f))=>(rl(t,k.seed),t);return{keygen:function(t){const e=B(t);return{secretKey:e,publicKey:v(e)}},getSharedSecret:(t,e)=>m(t,e),getPublicKey:t=>v(t),scalarMult:m,scalarMultBase:v,utils:{randomSecretKey:B,randomPrivateKey:B},GuBytes:w.slice(),lengths:k}}({P:t,type:"x448",powPminus2:e=>Zl(Jl(my(e),yy,t)*e,t),adjustScalarBytes:vy})})(),Ky={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},Dy={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]},Uy=BigInt(2),xy=cf(Ky.p,{sqrt:function(t){const e=Ky.p,r=BigInt(3),n=BigInt(6),i=BigInt(11),s=BigInt(22),a=BigInt(23),o=BigInt(44),c=BigInt(88),u=t*t*t%e,l=u*u*t%e,f=Jl(l,r,e)*l%e,h=Jl(f,r,e)*l%e,y=Jl(h,Uy,e)*u%e,d=Jl(y,i,e)*y%e,p=Jl(d,s,e)*d%e,g=Jl(p,o,e)*p%e,A=Jl(g,c,e)*g%e,w=Jl(A,o,e)*p%e,b=Jl(w,r,e)*l%e,m=Jl(b,a,e)*d%e,v=Jl(m,n,e)*u%e,E=Jl(v,Uy,e);if(!xy.eql(xy.sqr(E),t))throw Error("Cannot find square root");return E}}),Py=Sh({...Ky,Fp:xy,lowS:!0,endo:Dy},jf),Qy=jf,_y=Vf,Ry=cf(BigInt("0xa9fb57dba1eea9bc3e660a909d838d726e3bf623d52620282013481d1f6e5377")),Ty=Sh({a:Ry.create(BigInt("0x7d5a0975fc2c3057eef67530417affe7fb8055c126dc5c6ce94a4b44f330b5d9")),b:BigInt("0x26dc5c6ce94a4b44f330b5d9bbd77cbf958416295cf7e1ce6bccdc18ff8c07b6"),Fp:Ry,n:BigInt("0xa9fb57dba1eea9bc3e660a909d838d718c397aa3b561a6f7901e0e82974856a7"),Gx:BigInt("0x8bd2aeb9cb7e57cb2c4b482ffc81b7afb9de27e1e3bd23c23a4453bd9ace3262"),Gy:BigInt("0x547ef835c3dac4fd97f8461a14611dc9c27745132ded8e545c1d54c72f046997"),h:BigInt(1),lowS:!1},Qy),My=qf,Ny=Yf,Oy=cf(BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b412b1da197fb71123acd3a729901d1a71874700133107ec53")),Fy=Sh({a:Oy.create(BigInt("0x7bc382c63d8c150c3c72080ace05afa0c2bea28e4fb22787139165efba91f90f8aa5814a503ad4eb04a8c7dd22ce2826")),b:BigInt("0x04a8c7dd22ce28268b39b55416f0447c2fb77de107dcd2a62e880ea53eeb62d57cb4390295dbc9943ab78696fa504c11"),Fp:Oy,n:BigInt("0x8cb91e82a3386d280f5d6f7e50e641df152f7109ed5456b31f166e6cac0425a7cf3ab6af6b7fc3103b883202e9046565"),Gx:BigInt("0x1d1c64f068cf45ffa2a63a81b7c13f6b8847a3e77ef14fe3db7fcafe0cbd10e8e826e03436d646aaef87b2e247d4af1e"),Gy:BigInt("0x8abe1d7520f9c2a45cb1eb8e95cfd55262b70b29feec5864e19c054ff99129280e4646217791811142820341263c5315"),h:BigInt(1),lowS:!1},Ny),Ly=cf(BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca703308717d4d9b009bc66842aecda12ae6a380e62881ff2f2d82c68528aa6056583a48f3")),Hy=Sh({a:Ly.create(BigInt("0x7830a3318b603b89e2327145ac234cc594cbdd8d3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94ca")),b:BigInt("0x3df91610a83441caea9863bc2ded5d5aa8253aa10a2ef1c98b9ac8b57f1117a72bf2c7b9e7c1ac4d77fc94cadc083e67984050b75ebae5dd2809bd638016f723"),Fp:Ly,n:BigInt("0xaadd9db8dbe9c48b3fd4e6ae33c9fc07cb308db3b3c9d20ed6639cca70330870553e5c414ca92619418661197fac10471db1d381085ddaddb58796829ca90069"),Gx:BigInt("0x81aee4bdd82ed9645a21322e9c4c6a9385ed9f70b5d916c1b43b62eef4d0098eff3b1f78e2d0d48d50d1687b93b97d5f7c6d5047406a5e688b352209bcb9f822"),Gy:BigInt("0x7dde385d566332ecc0eabfa9cf7822fdf209f70024a57b1aa000c55b881f8111b2dcde494a5f485e5bca4bd88a2763aed1ca2b2fa8f0540678cd1e0f3ad80892"),h:BigInt(1),lowS:!1},My),zy=new Map(Object.entries({nistP256:Qh,nistP384:_h,nistP521:Rh,brainpoolP256r1:Ty,brainpoolP384r1:Fy,brainpoolP512r1:Hy,secp256k1:Py,x448:Cy,ed448:Sy}));var Gy=Object.freeze({__proto__:null,nobleCurves:zy});const $y=Uint32Array.from([1732584193,4023233417,2562383102,271733878,3285377520]),jy=new Uint32Array(80);class Vy extends yf{constructor(){super(64,20,8,!1),this.A=0|$y[0],this.B=0|$y[1],this.C=0|$y[2],this.D=0|$y[3],this.E=0|$y[4]}get(){const{A:t,B:e,C:r,D:n,E:i}=this;return[t,e,r,n,i]}set(t,e,r,n,i){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n,this.E=0|i}process(t,e){for(let r=0;r<16;r++,e+=4)jy[r]=t.getUint32(e,!1);for(let t=16;t<80;t++)jy[t]=ul(jy[t-3]^jy[t-8]^jy[t-14]^jy[t-16],1);let{A:r,B:n,C:i,D:s,E:a}=this;for(let t=0;t<80;t++){let e,o;t<20?(e=ff(n,i,s),o=1518500249):t<40?(e=n^i^s,o=1859775393):t<60?(e=hf(n,i,s),o=2400959708):(e=n^i^s,o=3395469782);const c=ul(r,5)+e+a+o+jy[t]|0;a=s,s=i,i=ul(n,30),n=r,r=c}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,a=a+this.E|0,this.set(r,n,i,s,a)}roundClean(){al(jy)}destroy(){this.set(0,0,0,0,0),al(this.buffer)}}const qy=bl(()=>new Vy),Yy=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),Zy=(()=>Uint8Array.from(Array(16).fill(0).map((t,e)=>e)))(),Jy=(()=>Zy.map(t=>(9*t+5)%16))(),Wy=(()=>{const t=[[Zy],[Jy]];for(let e=0;e<4;e++)for(let r of t)r.push(r[e].map(t=>Yy[t]));return t})(),Xy=(()=>Wy[0])(),td=(()=>Wy[1])(),ed=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>Uint8Array.from(t)),rd=Xy.map((t,e)=>t.map(t=>ed[e][t])),nd=td.map((t,e)=>t.map(t=>ed[e][t])),id=Uint32Array.from([0,1518500249,1859775393,2400959708,2840853838]),sd=Uint32Array.from([1352829926,1548603684,1836072691,2053994217,0]);function ad(t,e,r,n){return 0===t?e^r^n:1===t?e&r|~e&n:2===t?(e|~r)^n:3===t?e&n|r&~n:e^(r|~n)}const od=new Uint32Array(16);class cd extends yf{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){const{h0:t,h1:e,h2:r,h3:n,h4:i}=this;return[t,e,r,n,i]}set(t,e,r,n,i){this.h0=0|t,this.h1=0|e,this.h2=0|r,this.h3=0|n,this.h4=0|i}process(t,e){for(let r=0;r<16;r++,e+=4)od[r]=t.getUint32(e,!0);let r=0|this.h0,n=r,i=0|this.h1,s=i,a=0|this.h2,o=a,c=0|this.h3,u=c,l=0|this.h4,f=l;for(let t=0;t<5;t++){const e=4-t,h=id[t],y=sd[t],d=Xy[t],p=td[t],g=rd[t],A=nd[t];for(let e=0;e<16;e++){const n=ul(r+ad(t,i,a,c)+od[d[e]]+h,g[e])+l|0;r=l,l=c,c=0|ul(a,10),a=i,i=n}for(let t=0;t<16;t++){const r=ul(n+ad(e,s,o,u)+od[p[t]]+y,A[t])+f|0;n=f,f=u,u=0|ul(o,10),o=s,s=r}}this.set(this.h1+a+u|0,this.h2+c+f|0,this.h3+l+n|0,this.h4+r+s|0,this.h0+i+o|0)}roundClean(){al(od)}destroy(){this.destroyed=!0,al(this.buffer),this.set(0,0,0,0,0)}}const ud=qy,ld=bl(()=>new cd),fd=Array.from({length:64},(t,e)=>Math.floor(2**32*Math.abs(Math.sin(e+1)))),hd=(t,e,r)=>t&e^~t&r,yd=new Uint32Array([1732584193,4023233417,2562383102,271733878]),dd=new Uint32Array(16);class pd extends yf{constructor(){super(64,16,8,!0),this.A=0|yd[0],this.B=0|yd[1],this.C=0|yd[2],this.D=0|yd[3]}get(){const{A:t,B:e,C:r,D:n}=this;return[t,e,r,n]}set(t,e,r,n){this.A=0|t,this.B=0|e,this.C=0|r,this.D=0|n}process(t,e){for(let r=0;r<16;r++,e+=4)dd[r]=t.getUint32(e,!0);let{A:r,B:n,C:i,D:s}=this;for(let t=0;t<64;t++){let e,a,o;t<16?(e=hd(n,i,s),a=t,o=[7,12,17,22]):t<32?(e=hd(s,n,i),a=(5*t+1)%16,o=[5,9,14,20]):t<48?(e=n^i^s,a=(3*t+5)%16,o=[4,11,16,23]):(e=i^(n|~s),a=7*t%16,o=[6,10,15,21]),e=e+r+fd[t]+dd[a],r=s,s=i,i=n,n+=ul(e,o[t%4])}r=r+this.A|0,n=n+this.B|0,i=i+this.C|0,s=s+this.D|0,this.set(r,n,i,s)}roundClean(){dd.fill(0)}destroy(){this.set(0,0,0,0),this.buffer.fill(0)}}const gd=new Map(Object.entries({md5:ml(()=>new pd),sha1:ud,sha224:_y,sha256:Qy,sha384:Ny,sha512:My,sha3_256:Wh,sha3_512:Xh,ripemd160:ld}));var Ad=Object.freeze({__proto__:null,nobleHashes:gd});const wd="object"==typeof fn&&"crypto"in fn?fn.crypto:void 0,bd={};var md=function(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;e++)r[e]=t[e];return r},vd=function(){throw Error("no PRNG")},Ed=new Uint8Array(32);Ed[0]=9;var kd=md(),Bd=md([1]),Id=md([56129,1]),Sd=md([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Cd=md([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),Kd=md([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Dd=md([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),Ud=md([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function xd(t,e,r,n){t[e]=r>>24&255,t[e+1]=r>>16&255,t[e+2]=r>>8&255,t[e+3]=255&r,t[e+4]=n>>24&255,t[e+5]=n>>16&255,t[e+6]=n>>8&255,t[e+7]=255&n}function Pd(t,e,r,n){return function(t,e,r,n){var i,s=0;for(i=0;i<32;i++)s|=t[e+i]^r[n+i];return(1&s-1>>>8)-1}(t,e,r,n)}function Qd(t,e){var r;for(r=0;r<16;r++)t[r]=0|e[r]}function _d(t){var e,r,n=1;for(e=0;e<16;e++)r=t[e]+n+65535,n=Math.floor(r/65536),t[e]=r-65536*n;t[0]+=n-1+37*(n-1)}function Rd(t,e,r){for(var n,i=~(r-1),s=0;s<16;s++)n=i&(t[s]^e[s]),t[s]^=n,e[s]^=n}function Td(t,e){var r,n,i,s=md(),a=md();for(r=0;r<16;r++)a[r]=e[r];for(_d(a),_d(a),_d(a),n=0;n<2;n++){for(s[0]=a[0]-65517,r=1;r<15;r++)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,Rd(a,s,1-i)}for(r=0;r<16;r++)t[2*r]=255&a[r],t[2*r+1]=a[r]>>8}function Md(t,e){var r=new Uint8Array(32),n=new Uint8Array(32);return Td(r,t),Td(n,e),Pd(r,0,n,0)}function Nd(t){var e=new Uint8Array(32);return Td(e,t),1&e[0]}function Od(t,e){var r;for(r=0;r<16;r++)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function Fd(t,e,r){for(var n=0;n<16;n++)t[n]=e[n]+r[n]}function Ld(t,e,r){for(var n=0;n<16;n++)t[n]=e[n]-r[n]}function Hd(t,e,r){var n,i,s=0,a=0,o=0,c=0,u=0,l=0,f=0,h=0,y=0,d=0,p=0,g=0,A=0,w=0,b=0,m=0,v=0,E=0,k=0,B=0,I=0,S=0,C=0,K=0,D=0,U=0,x=0,P=0,Q=0,_=0,R=0,T=r[0],M=r[1],N=r[2],O=r[3],F=r[4],L=r[5],H=r[6],z=r[7],G=r[8],$=r[9],j=r[10],V=r[11],q=r[12],Y=r[13],Z=r[14],J=r[15];s+=(n=e[0])*T,a+=n*M,o+=n*N,c+=n*O,u+=n*F,l+=n*L,f+=n*H,h+=n*z,y+=n*G,d+=n*$,p+=n*j,g+=n*V,A+=n*q,w+=n*Y,b+=n*Z,m+=n*J,a+=(n=e[1])*T,o+=n*M,c+=n*N,u+=n*O,l+=n*F,f+=n*L,h+=n*H,y+=n*z,d+=n*G,p+=n*$,g+=n*j,A+=n*V,w+=n*q,b+=n*Y,m+=n*Z,v+=n*J,o+=(n=e[2])*T,c+=n*M,u+=n*N,l+=n*O,f+=n*F,h+=n*L,y+=n*H,d+=n*z,p+=n*G,g+=n*$,A+=n*j,w+=n*V,b+=n*q,m+=n*Y,v+=n*Z,E+=n*J,c+=(n=e[3])*T,u+=n*M,l+=n*N,f+=n*O,h+=n*F,y+=n*L,d+=n*H,p+=n*z,g+=n*G,A+=n*$,w+=n*j,b+=n*V,m+=n*q,v+=n*Y,E+=n*Z,k+=n*J,u+=(n=e[4])*T,l+=n*M,f+=n*N,h+=n*O,y+=n*F,d+=n*L,p+=n*H,g+=n*z,A+=n*G,w+=n*$,b+=n*j,m+=n*V,v+=n*q,E+=n*Y,k+=n*Z,B+=n*J,l+=(n=e[5])*T,f+=n*M,h+=n*N,y+=n*O,d+=n*F,p+=n*L,g+=n*H,A+=n*z,w+=n*G,b+=n*$,m+=n*j,v+=n*V,E+=n*q,k+=n*Y,B+=n*Z,I+=n*J,f+=(n=e[6])*T,h+=n*M,y+=n*N,d+=n*O,p+=n*F,g+=n*L,A+=n*H,w+=n*z,b+=n*G,m+=n*$,v+=n*j,E+=n*V,k+=n*q,B+=n*Y,I+=n*Z,S+=n*J,h+=(n=e[7])*T,y+=n*M,d+=n*N,p+=n*O,g+=n*F,A+=n*L,w+=n*H,b+=n*z,m+=n*G,v+=n*$,E+=n*j,k+=n*V,B+=n*q,I+=n*Y,S+=n*Z,C+=n*J,y+=(n=e[8])*T,d+=n*M,p+=n*N,g+=n*O,A+=n*F,w+=n*L,b+=n*H,m+=n*z,v+=n*G,E+=n*$,k+=n*j,B+=n*V,I+=n*q,S+=n*Y,C+=n*Z,K+=n*J,d+=(n=e[9])*T,p+=n*M,g+=n*N,A+=n*O,w+=n*F,b+=n*L,m+=n*H,v+=n*z,E+=n*G,k+=n*$,B+=n*j,I+=n*V,S+=n*q,C+=n*Y,K+=n*Z,D+=n*J,p+=(n=e[10])*T,g+=n*M,A+=n*N,w+=n*O,b+=n*F,m+=n*L,v+=n*H,E+=n*z,k+=n*G,B+=n*$,I+=n*j,S+=n*V,C+=n*q,K+=n*Y,D+=n*Z,U+=n*J,g+=(n=e[11])*T,A+=n*M,w+=n*N,b+=n*O,m+=n*F,v+=n*L,E+=n*H,k+=n*z,B+=n*G,I+=n*$,S+=n*j,C+=n*V,K+=n*q,D+=n*Y,U+=n*Z,x+=n*J,A+=(n=e[12])*T,w+=n*M,b+=n*N,m+=n*O,v+=n*F,E+=n*L,k+=n*H,B+=n*z,I+=n*G,S+=n*$,C+=n*j,K+=n*V,D+=n*q,U+=n*Y,x+=n*Z,P+=n*J,w+=(n=e[13])*T,b+=n*M,m+=n*N,v+=n*O,E+=n*F,k+=n*L,B+=n*H,I+=n*z,S+=n*G,C+=n*$,K+=n*j,D+=n*V,U+=n*q,x+=n*Y,P+=n*Z,Q+=n*J,b+=(n=e[14])*T,m+=n*M,v+=n*N,E+=n*O,k+=n*F,B+=n*L,I+=n*H,S+=n*z,C+=n*G,K+=n*$,D+=n*j,U+=n*V,x+=n*q,P+=n*Y,Q+=n*Z,_+=n*J,m+=(n=e[15])*T,a+=38*(E+=n*N),o+=38*(k+=n*O),c+=38*(B+=n*F),u+=38*(I+=n*L),l+=38*(S+=n*H),f+=38*(C+=n*z),h+=38*(K+=n*G),y+=38*(D+=n*$),d+=38*(U+=n*j),p+=38*(x+=n*V),g+=38*(P+=n*q),A+=38*(Q+=n*Y),w+=38*(_+=n*Z),b+=38*(R+=n*J),s=(n=(s+=38*(v+=n*M))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),A=(n=A+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),s=(n=(s+=i-1+37*(i-1))+(i=1)+65535)-65536*(i=Math.floor(n/65536)),a=(n=a+i+65535)-65536*(i=Math.floor(n/65536)),o=(n=o+i+65535)-65536*(i=Math.floor(n/65536)),c=(n=c+i+65535)-65536*(i=Math.floor(n/65536)),u=(n=u+i+65535)-65536*(i=Math.floor(n/65536)),l=(n=l+i+65535)-65536*(i=Math.floor(n/65536)),f=(n=f+i+65535)-65536*(i=Math.floor(n/65536)),h=(n=h+i+65535)-65536*(i=Math.floor(n/65536)),y=(n=y+i+65535)-65536*(i=Math.floor(n/65536)),d=(n=d+i+65535)-65536*(i=Math.floor(n/65536)),p=(n=p+i+65535)-65536*(i=Math.floor(n/65536)),g=(n=g+i+65535)-65536*(i=Math.floor(n/65536)),A=(n=A+i+65535)-65536*(i=Math.floor(n/65536)),w=(n=w+i+65535)-65536*(i=Math.floor(n/65536)),b=(n=b+i+65535)-65536*(i=Math.floor(n/65536)),m=(n=m+i+65535)-65536*(i=Math.floor(n/65536)),s+=i-1+37*(i-1),t[0]=s,t[1]=a,t[2]=o,t[3]=c,t[4]=u,t[5]=l,t[6]=f,t[7]=h,t[8]=y,t[9]=d,t[10]=p,t[11]=g,t[12]=A,t[13]=w,t[14]=b,t[15]=m}function zd(t,e){Hd(t,e,e)}function Gd(t,e){var r,n=md();for(r=0;r<16;r++)n[r]=e[r];for(r=253;r>=0;r--)zd(n,n),2!==r&&4!==r&&Hd(n,n,e);for(r=0;r<16;r++)t[r]=n[r]}function $d(t,e,r){var n,i,s=new Uint8Array(32),a=new Float64Array(80),o=md(),c=md(),u=md(),l=md(),f=md(),h=md();for(i=0;i<31;i++)s[i]=e[i];for(s[31]=127&e[31]|64,s[0]&=248,Od(a,r),i=0;i<16;i++)c[i]=a[i],l[i]=o[i]=u[i]=0;for(o[0]=l[0]=1,i=254;i>=0;--i)Rd(o,c,n=s[i>>>3]>>>(7&i)&1),Rd(u,l,n),Fd(f,o,u),Ld(o,o,u),Fd(u,c,l),Ld(c,c,l),zd(l,f),zd(h,o),Hd(o,u,o),Hd(u,c,f),Fd(f,o,u),Ld(o,o,u),zd(c,o),Ld(u,l,h),Hd(o,u,Id),Fd(o,o,l),Hd(u,u,o),Hd(o,l,h),Hd(l,c,a),zd(c,f),Rd(o,c,n),Rd(u,l,n);for(i=0;i<16;i++)a[i+16]=o[i],a[i+32]=u[i],a[i+48]=c[i],a[i+64]=l[i];var y=a.subarray(32),d=a.subarray(16);return Gd(y,y),Hd(d,d,y),Td(t,d),0}function jd(t,e){return $d(t,e,Ed)}var Vd=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function qd(t,e,r,n){for(var i,s,a,o,c,u,l,f,h,y,d,p,g,A,w,b,m,v,E,k,B,I,S,C,K,D,U=new Int32Array(16),x=new Int32Array(16),P=t[0],Q=t[1],_=t[2],R=t[3],T=t[4],M=t[5],N=t[6],O=t[7],F=e[0],L=e[1],H=e[2],z=e[3],G=e[4],$=e[5],j=e[6],V=e[7],q=0;n>=128;){for(E=0;E<16;E++)k=8*E+q,U[E]=r[k+0]<<24|r[k+1]<<16|r[k+2]<<8|r[k+3],x[E]=r[k+4]<<24|r[k+5]<<16|r[k+6]<<8|r[k+7];for(E=0;E<80;E++)if(i=P,s=Q,a=_,o=R,c=T,u=M,l=N,h=F,y=L,d=H,p=z,g=G,A=$,w=j,S=65535&(I=V),C=I>>>16,K=65535&(B=O),D=B>>>16,S+=65535&(I=(G>>>14|T<<18)^(G>>>18|T<<14)^(T>>>9|G<<23)),C+=I>>>16,K+=65535&(B=(T>>>14|G<<18)^(T>>>18|G<<14)^(G>>>9|T<<23)),D+=B>>>16,S+=65535&(I=G&$^~G&j),C+=I>>>16,K+=65535&(B=T&M^~T&N),D+=B>>>16,S+=65535&(I=Vd[2*E+1]),C+=I>>>16,K+=65535&(B=Vd[2*E]),D+=B>>>16,B=U[E%16],C+=(I=x[E%16])>>>16,K+=65535&B,D+=B>>>16,K+=(C+=(S+=65535&I)>>>16)>>>16,S=65535&(I=v=65535&S|C<<16),C=I>>>16,K=65535&(B=m=65535&K|(D+=K>>>16)<<16),D=B>>>16,S+=65535&(I=(F>>>28|P<<4)^(P>>>2|F<<30)^(P>>>7|F<<25)),C+=I>>>16,K+=65535&(B=(P>>>28|F<<4)^(F>>>2|P<<30)^(F>>>7|P<<25)),D+=B>>>16,C+=(I=F&L^F&H^L&H)>>>16,K+=65535&(B=P&Q^P&_^Q&_),D+=B>>>16,f=65535&(K+=(C+=(S+=65535&I)>>>16)>>>16)|(D+=K>>>16)<<16,b=65535&S|C<<16,S=65535&(I=p),C=I>>>16,K=65535&(B=o),D=B>>>16,C+=(I=v)>>>16,K+=65535&(B=m),D+=B>>>16,Q=i,_=s,R=a,T=o=65535&(K+=(C+=(S+=65535&I)>>>16)>>>16)|(D+=K>>>16)<<16,M=c,N=u,O=l,P=f,L=h,H=y,z=d,G=p=65535&S|C<<16,$=g,j=A,V=w,F=b,E%16==15)for(k=0;k<16;k++)B=U[k],S=65535&(I=x[k]),C=I>>>16,K=65535&B,D=B>>>16,B=U[(k+9)%16],S+=65535&(I=x[(k+9)%16]),C+=I>>>16,K+=65535&B,D+=B>>>16,m=U[(k+1)%16],S+=65535&(I=((v=x[(k+1)%16])>>>1|m<<31)^(v>>>8|m<<24)^(v>>>7|m<<25)),C+=I>>>16,K+=65535&(B=(m>>>1|v<<31)^(m>>>8|v<<24)^m>>>7),D+=B>>>16,m=U[(k+14)%16],C+=(I=((v=x[(k+14)%16])>>>19|m<<13)^(m>>>29|v<<3)^(v>>>6|m<<26))>>>16,K+=65535&(B=(m>>>19|v<<13)^(v>>>29|m<<3)^m>>>6),D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,U[k]=65535&K|D<<16,x[k]=65535&S|C<<16;S=65535&(I=F),C=I>>>16,K=65535&(B=P),D=B>>>16,B=t[0],C+=(I=e[0])>>>16,K+=65535&B,D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,t[0]=P=65535&K|D<<16,e[0]=F=65535&S|C<<16,S=65535&(I=L),C=I>>>16,K=65535&(B=Q),D=B>>>16,B=t[1],C+=(I=e[1])>>>16,K+=65535&B,D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,t[1]=Q=65535&K|D<<16,e[1]=L=65535&S|C<<16,S=65535&(I=H),C=I>>>16,K=65535&(B=_),D=B>>>16,B=t[2],C+=(I=e[2])>>>16,K+=65535&B,D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,t[2]=_=65535&K|D<<16,e[2]=H=65535&S|C<<16,S=65535&(I=z),C=I>>>16,K=65535&(B=R),D=B>>>16,B=t[3],C+=(I=e[3])>>>16,K+=65535&B,D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,t[3]=R=65535&K|D<<16,e[3]=z=65535&S|C<<16,S=65535&(I=G),C=I>>>16,K=65535&(B=T),D=B>>>16,B=t[4],C+=(I=e[4])>>>16,K+=65535&B,D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,t[4]=T=65535&K|D<<16,e[4]=G=65535&S|C<<16,S=65535&(I=$),C=I>>>16,K=65535&(B=M),D=B>>>16,B=t[5],C+=(I=e[5])>>>16,K+=65535&B,D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,t[5]=M=65535&K|D<<16,e[5]=$=65535&S|C<<16,S=65535&(I=j),C=I>>>16,K=65535&(B=N),D=B>>>16,B=t[6],C+=(I=e[6])>>>16,K+=65535&B,D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,t[6]=N=65535&K|D<<16,e[6]=j=65535&S|C<<16,S=65535&(I=V),C=I>>>16,K=65535&(B=O),D=B>>>16,B=t[7],C+=(I=e[7])>>>16,K+=65535&B,D+=B>>>16,D+=(K+=(C+=(S+=65535&I)>>>16)>>>16)>>>16,t[7]=O=65535&K|D<<16,e[7]=V=65535&S|C<<16,q+=128,n-=128}return n}function Yd(t,e,r){var n,i=new Int32Array(8),s=new Int32Array(8),a=new Uint8Array(256),o=r;for(i[0]=1779033703,i[1]=3144134277,i[2]=1013904242,i[3]=2773480762,i[4]=1359893119,i[5]=2600822924,i[6]=528734635,i[7]=1541459225,s[0]=4089235720,s[1]=2227873595,s[2]=4271175723,s[3]=1595750129,s[4]=2917565137,s[5]=725511199,s[6]=4215389547,s[7]=327033209,qd(i,s,e,r),r%=128,n=0;n<r;n++)a[n]=e[o-r+n];for(a[r]=128,a[(r=256-128*(r<112?1:0))-9]=0,xd(a,r-8,o/536870912|0,o<<3),qd(i,s,a,r),n=0;n<8;n++)xd(t,8*n,i[n],s[n]);return 0}function Zd(t,e){var r=md(),n=md(),i=md(),s=md(),a=md(),o=md(),c=md(),u=md(),l=md();Ld(r,t[1],t[0]),Ld(l,e[1],e[0]),Hd(r,r,l),Fd(n,t[0],t[1]),Fd(l,e[0],e[1]),Hd(n,n,l),Hd(i,t[3],e[3]),Hd(i,i,Cd),Hd(s,t[2],e[2]),Fd(s,s,s),Ld(a,n,r),Ld(o,s,i),Fd(c,s,i),Fd(u,n,r),Hd(t[0],a,o),Hd(t[1],u,c),Hd(t[2],c,o),Hd(t[3],a,u)}function Jd(t,e,r){var n;for(n=0;n<4;n++)Rd(t[n],e[n],r)}function Wd(t,e){var r=md(),n=md(),i=md();Gd(i,e[2]),Hd(r,e[0],i),Hd(n,e[1],i),Td(t,n),t[31]^=Nd(r)<<7}function Xd(t,e,r){var n,i;for(Qd(t[0],kd),Qd(t[1],Bd),Qd(t[2],Bd),Qd(t[3],kd),i=255;i>=0;--i)Jd(t,e,n=r[i/8|0]>>(7&i)&1),Zd(e,t),Zd(t,t),Jd(t,e,n)}function tp(t,e){var r=[md(),md(),md(),md()];Qd(r[0],Kd),Qd(r[1],Dd),Qd(r[2],Bd),Hd(r[3],Kd,Dd),Xd(t,r,e)}function ep(t,e,r){var n,i=new Uint8Array(64),s=[md(),md(),md(),md()];for(r||vd(e,32),Yd(i,e,32),i[0]&=248,i[31]&=127,i[31]|=64,tp(s,i),Wd(t,s),n=0;n<32;n++)e[n+32]=t[n];return 0}var rp=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function np(t,e){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)e[i]+=r-16*e[n]*rp[i-(n-32)],r=Math.floor((e[i]+128)/256),e[i]-=256*r;e[i]+=r,e[n]=0}for(r=0,i=0;i<32;i++)e[i]+=r-(e[31]>>4)*rp[i],r=e[i]>>8,e[i]&=255;for(i=0;i<32;i++)e[i]-=r*rp[i];for(n=0;n<32;n++)e[n+1]+=e[n]>>8,t[n]=255&e[n]}function ip(t){var e,r=new Float64Array(64);for(e=0;e<64;e++)r[e]=t[e];for(e=0;e<64;e++)t[e]=0;np(t,r)}var sp=64;function ap(){for(var t=0;t<arguments.length;t++)if(!(arguments[t]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}bd.scalarMult=function(t,e){if(ap(t,e),32!==t.length)throw Error("bad n size");if(32!==e.length)throw Error("bad p size");var r=new Uint8Array(32);return $d(r,t,e),r},bd.box={},bd.box.keyPair=function(){var t=new Uint8Array(32),e=new Uint8Array(32);return function(t,e){vd(e,32),jd(t,e)}(t,e),{publicKey:t,secretKey:e}},bd.box.keyPair.fromSecretKey=function(t){if(ap(t),32!==t.length)throw Error("bad secret key size");var e=new Uint8Array(32);return jd(e,t),{publicKey:e,secretKey:new Uint8Array(t)}},bd.sign=function(t,e){if(ap(t,e),64!==e.length)throw Error("bad secret key size");var r=new Uint8Array(sp+t.length);return function(t,e,r,n){var i,s,a=new Uint8Array(64),o=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),l=[md(),md(),md(),md()];for(Yd(a,n,32),a[0]&=248,a[31]&=127,a[31]|=64,i=0;i<r;i++)t[64+i]=e[i];for(i=0;i<32;i++)t[32+i]=a[32+i];for(Yd(c,t.subarray(32),r+32),ip(c),tp(l,c),Wd(t,l),i=32;i<64;i++)t[i]=n[i];for(Yd(o,t,r+64),ip(o),i=0;i<64;i++)u[i]=0;for(i=0;i<32;i++)u[i]=c[i];for(i=0;i<32;i++)for(s=0;s<32;s++)u[i+s]+=o[i]*a[s];np(t.subarray(32),u)}(r,t,t.length,e),r},bd.sign.detached=function(t,e){for(var r=bd.sign(t,e),n=new Uint8Array(sp),i=0;i<n.length;i++)n[i]=r[i];return n},bd.sign.detached.verify=function(t,e,r){if(ap(t,e,r),e.length!==sp)throw Error("bad signature size");if(32!==r.length)throw Error("bad public key size");var n,i=new Uint8Array(sp+t.length),s=new Uint8Array(sp+t.length);for(n=0;n<sp;n++)i[n]=e[n];for(n=0;n<t.length;n++)i[n+sp]=t[n];return function(t,e,r,n){var i,s=new Uint8Array(32),a=new Uint8Array(64),o=[md(),md(),md(),md()],c=[md(),md(),md(),md()];if(r<64)return-1;if(function(t,e){var r=md(),n=md(),i=md(),s=md(),a=md(),o=md(),c=md();return Qd(t[2],Bd),Od(t[1],e),zd(i,t[1]),Hd(s,i,Sd),Ld(i,i,t[2]),Fd(s,t[2],s),zd(a,s),zd(o,a),Hd(c,o,a),Hd(r,c,i),Hd(r,r,s),function(t,e){var r,n=md();for(r=0;r<16;r++)n[r]=e[r];for(r=250;r>=0;r--)zd(n,n),1!==r&&Hd(n,n,e);for(r=0;r<16;r++)t[r]=n[r]}(r,r),Hd(r,r,i),Hd(r,r,s),Hd(r,r,s),Hd(t[0],r,s),zd(n,t[0]),Hd(n,n,s),Md(n,i)&&Hd(t[0],t[0],Ud),zd(n,t[0]),Hd(n,n,s),Md(n,i)?-1:(Nd(t[0])===e[31]>>7&&Ld(t[0],kd,t[0]),Hd(t[3],t[0],t[1]),0)}(c,n))return-1;for(i=0;i<r;i++)t[i]=e[i];for(i=0;i<32;i++)t[i+32]=n[i];if(Yd(a,t,r),ip(a),Xd(o,c,a),tp(c,e.subarray(32)),Zd(o,c),Wd(s,o),r-=64,Pd(e,0,s,0)){for(i=0;i<r;i++)t[i]=0;return-1}for(i=0;i<r;i++)t[i]=e[i+64];return r}(s,i,i.length,r)>=0},bd.sign.keyPair=function(){var t=new Uint8Array(32),e=new Uint8Array(64);return ep(t,e),{publicKey:t,secretKey:e}},bd.sign.keyPair.fromSecretKey=function(t){if(ap(t),64!==t.length)throw Error("bad secret key size");for(var e=new Uint8Array(32),r=0;r<e.length;r++)e[r]=t[32+r];return{publicKey:e,secretKey:new Uint8Array(t)}},bd.sign.keyPair.fromSeed=function(t){if(ap(t),32!==t.length)throw Error("bad seed size");for(var e=new Uint8Array(32),r=new Uint8Array(64),n=0;n<32;n++)r[n]=t[n];return ep(e,r,!0),{publicKey:e,secretKey:r}},bd.setPRNG=function(t){vd=t},wd&&wd.getRandomValues&&bd.setPRNG(function(t,e){var r,n=new Uint8Array(e);for(r=0;r<e;r+=65536)wd.getRandomValues(n.subarray(r,r+Math.min(e-r,65536)));for(r=0;r<e;r++)t[r]=n[r];!function(t){for(var e=0;e<t.length;e++)t[e]=0}(n)});var op=Object.freeze({__proto__:null,default:bd});function cp(t,e,r,n,i,s){const a=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],o=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],c=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],u=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],l=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],f=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],h=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],y=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];let d,p,g,A,w,b,m,v,E,k,B=0,I=e.length;const S=32===t.length?3:9;v=3===S?r?[0,32,2]:[30,-2,-2]:r?[0,32,2,62,30,-2,64,96,2]:[94,62,-2,32,64,2,30,-2,-2],r&&(e=function(t){const e=8-t.length%8;let r;if(!(e<8)){if(8===e)return t;throw Error("des: invalid padding")}r=0;const n=new Uint8Array(t.length+e);for(let e=0;e<t.length;e++)n[e]=t[e];for(let r=0;r<e;r++)n[t.length+r]=0;return n}(e),I=e.length);let C=new Uint8Array(I),K=0;for(;B<I;){for(b=e[B++]<<24|e[B++]<<16|e[B++]<<8|e[B++],m=e[B++]<<24|e[B++]<<16|e[B++]<<8|e[B++],g=252645135&(b>>>4^m),m^=g,b^=g<<4,g=65535&(b>>>16^m),m^=g,b^=g<<16,g=858993459&(m>>>2^b),b^=g,m^=g<<2,g=16711935&(m>>>8^b),b^=g,m^=g<<8,g=1431655765&(b>>>1^m),m^=g,b^=g<<1,b=b<<1|b>>>31,m=m<<1|m>>>31,p=0;p<S;p+=3){for(E=v[p+1],k=v[p+2],d=v[p];d!==E;d+=k)A=m^t[d],w=(m>>>4|m<<28)^t[d+1],g=b,b=m,m=g^(o[A>>>24&63]|u[A>>>16&63]|f[A>>>8&63]|y[63&A]|a[w>>>24&63]|c[w>>>16&63]|l[w>>>8&63]|h[63&w]);g=b,b=m,m=g}b=b>>>1|b<<31,m=m>>>1|m<<31,g=1431655765&(b>>>1^m),m^=g,b^=g<<1,g=16711935&(m>>>8^b),b^=g,m^=g<<8,g=858993459&(m>>>2^b),b^=g,m^=g<<2,g=65535&(b>>>16^m),m^=g,b^=g<<16,g=252645135&(b>>>4^m),m^=g,b^=g<<4,C[K++]=b>>>24,C[K++]=b>>>16&255,C[K++]=b>>>8&255,C[K++]=255&b,C[K++]=m>>>24,C[K++]=m>>>16&255,C[K++]=m>>>8&255,C[K++]=255&m}return r||(C=function(t){let e,r=null;if(e=0,!r){for(r=1;0===t[t.length-r];)r++;r--}return t.subarray(0,t.length-r)}(C)),C}function up(t){const e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],c=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],l=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],h=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],y=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],d=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],p=t.length>8?3:1,g=Array(32*p),A=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0];let w,b,m,v=0,E=0;for(let k=0;k<p;k++){let p=t[v++]<<24|t[v++]<<16|t[v++]<<8|t[v++],k=t[v++]<<24|t[v++]<<16|t[v++]<<8|t[v++];m=252645135&(p>>>4^k),k^=m,p^=m<<4,m=65535&(k>>>-16^p),p^=m,k^=m<<-16,m=858993459&(p>>>2^k),k^=m,p^=m<<2,m=65535&(k>>>-16^p),p^=m,k^=m<<-16,m=1431655765&(p>>>1^k),k^=m,p^=m<<1,m=16711935&(k>>>8^p),p^=m,k^=m<<8,m=1431655765&(p>>>1^k),k^=m,p^=m<<1,m=p<<8|k>>>20&240,p=k<<24|k<<8&16711680|k>>>8&65280|k>>>24&240,k=m;for(let t=0;t<16;t++)A[t]?(p=p<<2|p>>>26,k=k<<2|k>>>26):(p=p<<1|p>>>27,k=k<<1|k>>>27),p&=-15,k&=-15,w=e[p>>>28]|r[p>>>24&15]|n[p>>>20&15]|i[p>>>16&15]|s[p>>>12&15]|a[p>>>8&15]|o[p>>>4&15],b=c[k>>>28]|u[k>>>24&15]|l[k>>>20&15]|f[k>>>16&15]|h[k>>>12&15]|y[k>>>8&15]|d[k>>>4&15],m=65535&(b>>>16^w),g[E++]=w^m,g[E++]=b^m<<16}return g}function lp(t){this.key=[];for(let e=0;e<3;e++)this.key.push(new Uint8Array(t.subarray(8*e,8*e+8)));this.encrypt=function(t){return cp(up(this.key[2]),cp(up(this.key[1]),cp(up(this.key[0]),t,!0),!1),!0)}}function fp(){this.BlockSize=8,this.KeySize=16,this.setKey=function(t){if(this.masking=Array(16),this.rotate=Array(16),this.reset(),t.length!==this.KeySize)throw Error("CAST-128: keys must be 16 bytes");return this.keySchedule(t),!0},this.reset=function(){for(let t=0;t<16;t++)this.masking[t]=0,this.rotate[t]=0},this.getBlockSize=function(){return this.BlockSize},this.encrypt=function(t){const e=Array(t.length);for(let s=0;s<t.length;s+=8){let a,o=t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3],c=t[s+4]<<24|t[s+5]<<16|t[s+6]<<8|t[s+7];a=c,c=o^r(c,this.masking[0],this.rotate[0]),o=a,a=c,c=o^n(c,this.masking[1],this.rotate[1]),o=a,a=c,c=o^i(c,this.masking[2],this.rotate[2]),o=a,a=c,c=o^r(c,this.masking[3],this.rotate[3]),o=a,a=c,c=o^n(c,this.masking[4],this.rotate[4]),o=a,a=c,c=o^i(c,this.masking[5],this.rotate[5]),o=a,a=c,c=o^r(c,this.masking[6],this.rotate[6]),o=a,a=c,c=o^n(c,this.masking[7],this.rotate[7]),o=a,a=c,c=o^i(c,this.masking[8],this.rotate[8]),o=a,a=c,c=o^r(c,this.masking[9],this.rotate[9]),o=a,a=c,c=o^n(c,this.masking[10],this.rotate[10]),o=a,a=c,c=o^i(c,this.masking[11],this.rotate[11]),o=a,a=c,c=o^r(c,this.masking[12],this.rotate[12]),o=a,a=c,c=o^n(c,this.masking[13],this.rotate[13]),o=a,a=c,c=o^i(c,this.masking[14],this.rotate[14]),o=a,a=c,c=o^r(c,this.masking[15],this.rotate[15]),o=a,e[s]=c>>>24&255,e[s+1]=c>>>16&255,e[s+2]=c>>>8&255,e[s+3]=255&c,e[s+4]=o>>>24&255,e[s+5]=o>>>16&255,e[s+6]=o>>>8&255,e[s+7]=255&o}return e},this.decrypt=function(t){const e=Array(t.length);for(let s=0;s<t.length;s+=8){let a,o=t[s]<<24|t[s+1]<<16|t[s+2]<<8|t[s+3],c=t[s+4]<<24|t[s+5]<<16|t[s+6]<<8|t[s+7];a=c,c=o^r(c,this.masking[15],this.rotate[15]),o=a,a=c,c=o^i(c,this.masking[14],this.rotate[14]),o=a,a=c,c=o^n(c,this.masking[13],this.rotate[13]),o=a,a=c,c=o^r(c,this.masking[12],this.rotate[12]),o=a,a=c,c=o^i(c,this.masking[11],this.rotate[11]),o=a,a=c,c=o^n(c,this.masking[10],this.rotate[10]),o=a,a=c,c=o^r(c,this.masking[9],this.rotate[9]),o=a,a=c,c=o^i(c,this.masking[8],this.rotate[8]),o=a,a=c,c=o^n(c,this.masking[7],this.rotate[7]),o=a,a=c,c=o^r(c,this.masking[6],this.rotate[6]),o=a,a=c,c=o^i(c,this.masking[5],this.rotate[5]),o=a,a=c,c=o^n(c,this.masking[4],this.rotate[4]),o=a,a=c,c=o^r(c,this.masking[3],this.rotate[3]),o=a,a=c,c=o^i(c,this.masking[2],this.rotate[2]),o=a,a=c,c=o^n(c,this.masking[1],this.rotate[1]),o=a,a=c,c=o^r(c,this.masking[0],this.rotate[0]),o=a,e[s]=c>>>24&255,e[s+1]=c>>>16&255,e[s+2]=c>>>8&255,e[s+3]=255&c,e[s+4]=o>>>24&255,e[s+5]=o>>16&255,e[s+6]=o>>8&255,e[s+7]=255&o}return e};const t=[,,,,];t[0]=[,,,,],t[0][0]=[4,0,13,15,12,14,8],t[0][1]=[5,2,16,18,17,19,10],t[0][2]=[6,3,23,22,21,20,9],t[0][3]=[7,1,26,25,27,24,11],t[1]=[,,,,],t[1][0]=[0,6,21,23,20,22,16],t[1][1]=[1,4,0,2,1,3,18],t[1][2]=[2,5,7,6,5,4,17],t[1][3]=[3,7,10,9,11,8,19],t[2]=[,,,,],t[2][0]=[4,0,13,15,12,14,8],t[2][1]=[5,2,16,18,17,19,10],t[2][2]=[6,3,23,22,21,20,9],t[2][3]=[7,1,26,25,27,24,11],t[3]=[,,,,],t[3][0]=[0,6,21,23,20,22,16],t[3][1]=[1,4,0,2,1,3,18],t[3][2]=[2,5,7,6,5,4,17],t[3][3]=[3,7,10,9,11,8,19];const e=[,,,,];function r(t,e,r){const n=e+t,i=n<<r|n>>>32-r;return(s[0][i>>>24]^s[1][i>>>16&255])-s[2][i>>>8&255]+s[3][255&i]}function n(t,e,r){const n=e^t,i=n<<r|n>>>32-r;return s[0][i>>>24]-s[1][i>>>16&255]+s[2][i>>>8&255]^s[3][255&i]}function i(t,e,r){const n=e-t,i=n<<r|n>>>32-r;return(s[0][i>>>24]+s[1][i>>>16&255]^s[2][i>>>8&255])-s[3][255&i]}e[0]=[,,,,],e[0][0]=[24,25,23,22,18],e[0][1]=[26,27,21,20,22],e[0][2]=[28,29,19,18,25],e[0][3]=[30,31,17,16,28],e[1]=[,,,,],e[1][0]=[3,2,12,13,8],e[1][1]=[1,0,14,15,13],e[1][2]=[7,6,8,9,3],e[1][3]=[5,4,10,11,7],e[2]=[,,,,],e[2][0]=[19,18,28,29,25],e[2][1]=[17,16,30,31,28],e[2][2]=[23,22,24,25,18],e[2][3]=[21,20,26,27,22],e[3]=[,,,,],e[3][0]=[8,9,7,6,3],e[3][1]=[10,11,5,4,7],e[3][2]=[12,13,3,2,8],e[3][3]=[14,15,1,0,13],this.keySchedule=function(r){const n=[,,,,,,,,],i=Array(32);let a;for(let t=0;t<4;t++)a=4*t,n[t]=r[a]<<24|r[a+1]<<16|r[a+2]<<8|r[a+3];const o=[6,7,4,5];let c,u=0;for(let r=0;r<2;r++)for(let r=0;r<4;r++){for(a=0;a<4;a++){const e=t[r][a];c=n[e[1]],c^=s[4][n[e[2]>>>2]>>>24-8*(3&e[2])&255],c^=s[5][n[e[3]>>>2]>>>24-8*(3&e[3])&255],c^=s[6][n[e[4]>>>2]>>>24-8*(3&e[4])&255],c^=s[7][n[e[5]>>>2]>>>24-8*(3&e[5])&255],c^=s[o[a]][n[e[6]>>>2]>>>24-8*(3&e[6])&255],n[e[0]]=c}for(a=0;a<4;a++){const t=e[r][a];c=s[4][n[t[0]>>>2]>>>24-8*(3&t[0])&255],c^=s[5][n[t[1]>>>2]>>>24-8*(3&t[1])&255],c^=s[6][n[t[2]>>>2]>>>24-8*(3&t[2])&255],c^=s[7][n[t[3]>>>2]>>>24-8*(3&t[3])&255],c^=s[4+a][n[t[4]>>>2]>>>24-8*(3&t[4])&255],i[u]=c,u++}}for(let t=0;t<16;t++)this.masking[t]=i[t],this.rotate[t]=31&i[16+t]};const s=[,,,,,,,,];s[0]=[821772500,2678128395,1810681135,1059425402,505495343,2617265619,1610868032,3483355465,3218386727,2294005173,3791863952,2563806837,1852023008,365126098,3269944861,584384398,677919599,3229601881,4280515016,2002735330,1136869587,3744433750,2289869850,2731719981,2714362070,879511577,1639411079,575934255,717107937,2857637483,576097850,2731753936,1725645e3,2810460463,5111599,767152862,2543075244,1251459544,1383482551,3052681127,3089939183,3612463449,1878520045,1510570527,2189125840,2431448366,582008916,3163445557,1265446783,1354458274,3529918736,3202711853,3073581712,3912963487,3029263377,1275016285,4249207360,2905708351,3304509486,1442611557,3585198765,2712415662,2731849581,3248163920,2283946226,208555832,2766454743,1331405426,1447828783,3315356441,3108627284,2957404670,2981538698,3339933917,1669711173,286233437,1465092821,1782121619,3862771680,710211251,980974943,1651941557,430374111,2051154026,704238805,4128970897,3144820574,2857402727,948965521,3333752299,2227686284,718756367,2269778983,2731643755,718440111,2857816721,3616097120,1113355533,2478022182,410092745,1811985197,1944238868,2696854588,1415722873,1682284203,1060277122,1998114690,1503841958,82706478,2315155686,1068173648,845149890,2167947013,1768146376,1993038550,3566826697,3390574031,940016341,3355073782,2328040721,904371731,1205506512,4094660742,2816623006,825647681,85914773,2857843460,1249926541,1417871568,3287612,3211054559,3126306446,1975924523,1353700161,2814456437,2438597621,1800716203,722146342,2873936343,1151126914,4160483941,2877670899,458611604,2866078500,3483680063,770352098,2652916994,3367839148,3940505011,3585973912,3809620402,718646636,2504206814,2914927912,3631288169,2857486607,2860018678,575749918,2857478043,718488780,2069512688,3548183469,453416197,1106044049,3032691430,52586708,3378514636,3459808877,3211506028,1785789304,218356169,3571399134,3759170522,1194783844,1523787992,3007827094,1975193539,2555452411,1341901877,3045838698,3776907964,3217423946,2802510864,2889438986,1057244207,1636348243,3761863214,1462225785,2632663439,481089165,718503062,24497053,3332243209,3344655856,3655024856,3960371065,1195698900,2971415156,3710176158,2115785917,4027663609,3525578417,2524296189,2745972565,3564906415,1372086093,1452307862,2780501478,1476592880,3389271281,18495466,2378148571,901398090,891748256,3279637769,3157290713,2560960102,1447622437,4284372637,216884176,2086908623,1879786977,3588903153,2242455666,2938092967,3559082096,2810645491,758861177,1121993112,215018983,642190776,4169236812,1196255959,2081185372,3508738393,941322904,4124243163,2877523539,1848581667,2205260958,3180453958,2589345134,3694731276,550028657,2519456284,3789985535,2973870856,2093648313,443148163,46942275,2734146937,1117713533,1115362972,1523183689,3717140224,1551984063],s[1]=[522195092,4010518363,1776537470,960447360,4267822970,4005896314,1435016340,1929119313,2913464185,1310552629,3579470798,3724818106,2579771631,1594623892,417127293,2715217907,2696228731,1508390405,3994398868,3925858569,3695444102,4019471449,3129199795,3770928635,3520741761,990456497,4187484609,2783367035,21106139,3840405339,631373633,3783325702,532942976,396095098,3548038825,4267192484,2564721535,2011709262,2039648873,620404603,3776170075,2898526339,3612357925,4159332703,1645490516,223693667,1567101217,3362177881,1029951347,3470931136,3570957959,1550265121,119497089,972513919,907948164,3840628539,1613718692,3594177948,465323573,2659255085,654439692,2575596212,2699288441,3127702412,277098644,624404830,4100943870,2717858591,546110314,2403699828,3655377447,1321679412,4236791657,1045293279,4010672264,895050893,2319792268,494945126,1914543101,2777056443,3894764339,2219737618,311263384,4275257268,3458730721,669096869,3584475730,3835122877,3319158237,3949359204,2005142349,2713102337,2228954793,3769984788,569394103,3855636576,1425027204,108000370,2736431443,3671869269,3043122623,1750473702,2211081108,762237499,3972989403,2798899386,3061857628,2943854345,867476300,964413654,1591880597,1594774276,2179821409,552026980,3026064248,3726140315,2283577634,3110545105,2152310760,582474363,1582640421,1383256631,2043843868,3322775884,1217180674,463797851,2763038571,480777679,2718707717,2289164131,3118346187,214354409,200212307,3810608407,3025414197,2674075964,3997296425,1847405948,1342460550,510035443,4080271814,815934613,833030224,1620250387,1945732119,2703661145,3966000196,1388869545,3456054182,2687178561,2092620194,562037615,1356438536,3409922145,3261847397,1688467115,2150901366,631725691,3840332284,549916902,3455104640,394546491,837744717,2114462948,751520235,2221554606,2415360136,3999097078,2063029875,803036379,2702586305,821456707,3019566164,360699898,4018502092,3511869016,3677355358,2402471449,812317050,49299192,2570164949,3259169295,2816732080,3331213574,3101303564,2156015656,3705598920,3546263921,143268808,3200304480,1638124008,3165189453,3341807610,578956953,2193977524,3638120073,2333881532,807278310,658237817,2969561766,1641658566,11683945,3086995007,148645947,1138423386,4158756760,1981396783,2401016740,3699783584,380097457,2680394679,2803068651,3334260286,441530178,4016580796,1375954390,761952171,891809099,2183123478,157052462,3683840763,1592404427,341349109,2438483839,1417898363,644327628,2233032776,2353769706,2201510100,220455161,1815641738,182899273,2995019788,3627381533,3702638151,2890684138,1052606899,588164016,1681439879,4038439418,2405343923,4229449282,167996282,1336969661,1688053129,2739224926,1543734051,1046297529,1138201970,2121126012,115334942,1819067631,1902159161,1941945968,2206692869,1159982321],s[2]=[2381300288,637164959,3952098751,3893414151,1197506559,916448331,2350892612,2932787856,3199334847,4009478890,3905886544,1373570990,2450425862,4037870920,3778841987,2456817877,286293407,124026297,3001279700,1028597854,3115296800,4208886496,2691114635,2188540206,1430237888,1218109995,3572471700,308166588,570424558,2187009021,2455094765,307733056,1310360322,3135275007,1384269543,2388071438,863238079,2359263624,2801553128,3380786597,2831162807,1470087780,1728663345,4072488799,1090516929,532123132,2389430977,1132193179,2578464191,3051079243,1670234342,1434557849,2711078940,1241591150,3314043432,3435360113,3091448339,1812415473,2198440252,267246943,796911696,3619716990,38830015,1526438404,2806502096,374413614,2943401790,1489179520,1603809326,1920779204,168801282,260042626,2358705581,1563175598,2397674057,1356499128,2217211040,514611088,2037363785,2186468373,4022173083,2792511869,2913485016,1173701892,4200428547,3896427269,1334932762,2455136706,602925377,2835607854,1613172210,41346230,2499634548,2457437618,2188827595,41386358,4172255629,1313404830,2405527007,3801973774,2217704835,873260488,2528884354,2478092616,4012915883,2555359016,2006953883,2463913485,575479328,2218240648,2099895446,660001756,2341502190,3038761536,3888151779,3848713377,3286851934,1022894237,1620365795,3449594689,1551255054,15374395,3570825345,4249311020,4151111129,3181912732,310226346,1133119310,530038928,136043402,2476768958,3107506709,2544909567,1036173560,2367337196,1681395281,1758231547,3641649032,306774401,1575354324,3716085866,1990386196,3114533736,2455606671,1262092282,3124342505,2768229131,4210529083,1833535011,423410938,660763973,2187129978,1639812e3,3508421329,3467445492,310289298,272797111,2188552562,2456863912,310240523,677093832,1013118031,901835429,3892695601,1116285435,3036471170,1337354835,243122523,520626091,277223598,4244441197,4194248841,1766575121,594173102,316590669,742362309,3536858622,4176435350,3838792410,2501204839,1229605004,3115755532,1552908988,2312334149,979407927,3959474601,1148277331,176638793,3614686272,2083809052,40992502,1340822838,2731552767,3535757508,3560899520,1354035053,122129617,7215240,2732932949,3118912700,2718203926,2539075635,3609230695,3725561661,1928887091,2882293555,1988674909,2063640240,2491088897,1459647954,4189817080,2302804382,1113892351,2237858528,1927010603,4002880361,1856122846,1594404395,2944033133,3855189863,3474975698,1643104450,4054590833,3431086530,1730235576,2984608721,3084664418,2131803598,4178205752,267404349,1617849798,1616132681,1462223176,736725533,2327058232,551665188,2945899023,1749386277,2575514597,1611482493,674206544,2201269090,3642560800,728599968,1680547377,2620414464,1388111496,453204106,4156223445,1094905244,2754698257,2201108165,3757000246,2704524545,3922940700,3996465027],s[3]=[2645754912,532081118,2814278639,3530793624,1246723035,1689095255,2236679235,4194438865,2116582143,3859789411,157234593,2045505824,4245003587,1687664561,4083425123,605965023,672431967,1336064205,3376611392,214114848,4258466608,3232053071,489488601,605322005,3998028058,264917351,1912574028,756637694,436560991,202637054,135989450,85393697,2152923392,3896401662,2895836408,2145855233,3535335007,115294817,3147733898,1922296357,3464822751,4117858305,1037454084,2725193275,2127856640,1417604070,1148013728,1827919605,642362335,2929772533,909348033,1346338451,3547799649,297154785,1917849091,4161712827,2883604526,3968694238,1469521537,3780077382,3375584256,1763717519,136166297,4290970789,1295325189,2134727907,2798151366,1566297257,3672928234,2677174161,2672173615,965822077,2780786062,289653839,1133871874,3491843819,35685304,1068898316,418943774,672553190,642281022,2346158704,1954014401,3037126780,4079815205,2030668546,3840588673,672283427,1776201016,359975446,3750173538,555499703,2769985273,1324923,69110472,152125443,3176785106,3822147285,1340634837,798073664,1434183902,15393959,216384236,1303690150,3881221631,3711134124,3960975413,106373927,2578434224,1455997841,1801814300,1578393881,1854262133,3188178946,3258078583,2302670060,1539295533,3505142565,3078625975,2372746020,549938159,3278284284,2620926080,181285381,2865321098,3970029511,68876850,488006234,1728155692,2608167508,836007927,2435231793,919367643,3339422534,3655756360,1457871481,40520939,1380155135,797931188,234455205,2255801827,3990488299,397000196,739833055,3077865373,2871719860,4022553888,772369276,390177364,3853951029,557662966,740064294,1640166671,1699928825,3535942136,622006121,3625353122,68743880,1742502,219489963,1664179233,1577743084,1236991741,410585305,2366487942,823226535,1050371084,3426619607,3586839478,212779912,4147118561,1819446015,1911218849,530248558,3486241071,3252585495,2886188651,3410272728,2342195030,20547779,2982490058,3032363469,3631753222,312714466,1870521650,1493008054,3491686656,615382978,4103671749,2534517445,1932181,2196105170,278426614,6369430,3274544417,2913018367,697336853,2143000447,2946413531,701099306,1558357093,2805003052,3500818408,2321334417,3567135975,216290473,3591032198,23009561,1996984579,3735042806,2024298078,3739440863,569400510,2339758983,3016033873,3097871343,3639523026,3844324983,3256173865,795471839,2951117563,4101031090,4091603803,3603732598,971261452,534414648,428311343,3389027175,2844869880,694888862,1227866773,2456207019,3043454569,2614353370,3749578031,3676663836,459166190,4132644070,1794958188,51825668,2252611902,3084671440,2036672799,3436641603,1099053433,2469121526,3059204941,1323291266,2061838604,1018778475,2233344254,2553501054,334295216,3556750194,1065731521,183467730],s[4]=[2127105028,745436345,2601412319,2788391185,3093987327,500390133,1155374404,389092991,150729210,3891597772,3523549952,1935325696,716645080,946045387,2901812282,1774124410,3869435775,4039581901,3293136918,3438657920,948246080,363898952,3867875531,1286266623,1598556673,68334250,630723836,1104211938,1312863373,613332731,2377784574,1101634306,441780740,3129959883,1917973735,2510624549,3238456535,2544211978,3308894634,1299840618,4076074851,1756332096,3977027158,297047435,3790297736,2265573040,3621810518,1311375015,1667687725,47300608,3299642885,2474112369,201668394,1468347890,576830978,3594690761,3742605952,1958042578,1747032512,3558991340,1408974056,3366841779,682131401,1033214337,1545599232,4265137049,206503691,103024618,2855227313,1337551222,2428998917,2963842932,4015366655,3852247746,2796956967,3865723491,3747938335,247794022,3755824572,702416469,2434691994,397379957,851939612,2314769512,218229120,1380406772,62274761,214451378,3170103466,2276210409,3845813286,28563499,446592073,1693330814,3453727194,29968656,3093872512,220656637,2470637031,77972100,1667708854,1358280214,4064765667,2395616961,325977563,4277240721,4220025399,3605526484,3355147721,811859167,3069544926,3962126810,652502677,3075892249,4132761541,3498924215,1217549313,3250244479,3858715919,3053989961,1538642152,2279026266,2875879137,574252750,3324769229,2651358713,1758150215,141295887,2719868960,3515574750,4093007735,4194485238,1082055363,3417560400,395511885,2966884026,179534037,3646028556,3738688086,1092926436,2496269142,257381841,3772900718,1636087230,1477059743,2499234752,3811018894,2675660129,3285975680,90732309,1684827095,1150307763,1723134115,3237045386,1769919919,1240018934,815675215,750138730,2239792499,1234303040,1995484674,138143821,675421338,1145607174,1936608440,3238603024,2345230278,2105974004,323969391,779555213,3004902369,2861610098,1017501463,2098600890,2628620304,2940611490,2682542546,1171473753,3656571411,3687208071,4091869518,393037935,159126506,1662887367,1147106178,391545844,3452332695,1891500680,3016609650,1851642611,546529401,1167818917,3194020571,2848076033,3953471836,575554290,475796850,4134673196,450035699,2351251534,844027695,1080539133,86184846,1554234488,3692025454,1972511363,2018339607,1491841390,1141460869,1061690759,4244549243,2008416118,2351104703,2868147542,1598468138,722020353,1027143159,212344630,1387219594,1725294528,3745187956,2500153616,458938280,4129215917,1828119673,544571780,3503225445,2297937496,1241802790,267843827,2694610800,1397140384,1558801448,3782667683,1806446719,929573330,2234912681,400817706,616011623,4121520928,3603768725,1761550015,1968522284,4053731006,4192232858,4005120285,872482584,3140537016,3894607381,2287405443,1963876937,3663887957,1584857e3,2975024454,1833426440,4025083860],s[5]=[4143615901,749497569,1285769319,3795025788,2514159847,23610292,3974978748,844452780,3214870880,3751928557,2213566365,1676510905,448177848,3730751033,4086298418,2307502392,871450977,3222878141,4110862042,3831651966,2735270553,1310974780,2043402188,1218528103,2736035353,4274605013,2702448458,3936360550,2693061421,162023535,2827510090,687910808,23484817,3784910947,3371371616,779677500,3503626546,3473927188,4157212626,3500679282,4248902014,2466621104,3899384794,1958663117,925738300,1283408968,3669349440,1840910019,137959847,2679828185,1239142320,1315376211,1547541505,1690155329,739140458,3128809933,3933172616,3876308834,905091803,1548541325,4040461708,3095483362,144808038,451078856,676114313,2861728291,2469707347,993665471,373509091,2599041286,4025009006,4170239449,2149739950,3275793571,3749616649,2794760199,1534877388,572371878,2590613551,1753320020,3467782511,1405125690,4270405205,633333386,3026356924,3475123903,632057672,2846462855,1404951397,3882875879,3915906424,195638627,2385783745,3902872553,1233155085,3355999740,2380578713,2702246304,2144565621,3663341248,3894384975,2502479241,4248018925,3094885567,1594115437,572884632,3385116731,767645374,1331858858,1475698373,3793881790,3532746431,1321687957,619889600,1121017241,3440213920,2070816767,2833025776,1933951238,4095615791,890643334,3874130214,859025556,360630002,925594799,1764062180,3920222280,4078305929,979562269,2810700344,4087740022,1949714515,546639971,1165388173,3069891591,1495988560,922170659,1291546247,2107952832,1813327274,3406010024,3306028637,4241950635,153207855,2313154747,1608695416,1150242611,1967526857,721801357,1220138373,3691287617,3356069787,2112743302,3281662835,1111556101,1778980689,250857638,2298507990,673216130,2846488510,3207751581,3562756981,3008625920,3417367384,2198807050,529510932,3547516680,3426503187,2364944742,102533054,2294910856,1617093527,1204784762,3066581635,1019391227,1069574518,1317995090,1691889997,3661132003,510022745,3238594800,1362108837,1817929911,2184153760,805817662,1953603311,3699844737,120799444,2118332377,207536705,2282301548,4120041617,145305846,2508124933,3086745533,3261524335,1877257368,2977164480,3160454186,2503252186,4221677074,759945014,254147243,2767453419,3801518371,629083197,2471014217,907280572,3900796746,940896768,2751021123,2625262786,3161476951,3661752313,3260732218,1425318020,2977912069,1496677566,3988592072,2140652971,3126511541,3069632175,977771578,1392695845,1698528874,1411812681,1369733098,1343739227,3620887944,1142123638,67414216,3102056737,3088749194,1626167401,2546293654,3941374235,697522451,33404913,143560186,2595682037,994885535,1247667115,3859094837,2699155541,3547024625,4114935275,2968073508,3199963069,2732024527,1237921620,951448369,1898488916,1211705605,2790989240,2233243581,3598044975],s[6]=[2246066201,858518887,1714274303,3485882003,713916271,2879113490,3730835617,539548191,36158695,1298409750,419087104,1358007170,749914897,2989680476,1261868530,2995193822,2690628854,3443622377,3780124940,3796824509,2976433025,4259637129,1551479e3,512490819,1296650241,951993153,2436689437,2460458047,144139966,3136204276,310820559,3068840729,643875328,1969602020,1680088954,2185813161,3283332454,672358534,198762408,896343282,276269502,3014846926,84060815,197145886,376173866,3943890818,3813173521,3545068822,1316698879,1598252827,2633424951,1233235075,859989710,2358460855,3503838400,3409603720,1203513385,1193654839,2792018475,2060853022,207403770,1144516871,3068631394,1121114134,177607304,3785736302,326409831,1929119770,2983279095,4183308101,3474579288,3200513878,3228482096,119610148,1170376745,3378393471,3163473169,951863017,3337026068,3135789130,2907618374,1183797387,2015970143,4045674555,2182986399,2952138740,3928772205,384012900,2454997643,10178499,2879818989,2596892536,111523738,2995089006,451689641,3196290696,235406569,1441906262,3890558523,3013735005,4158569349,1644036924,376726067,1006849064,3664579700,2041234796,1021632941,1374734338,2566452058,371631263,4007144233,490221539,206551450,3140638584,1053219195,1853335209,3412429660,3562156231,735133835,1623211703,3104214392,2738312436,4096837757,3366392578,3110964274,3956598718,3196820781,2038037254,3877786376,2339753847,300912036,3766732888,2372630639,1516443558,4200396704,1574567987,4069441456,4122592016,2699739776,146372218,2748961456,2043888151,35287437,2596680554,655490400,1132482787,110692520,1031794116,2188192751,1324057718,1217253157,919197030,686247489,3261139658,1028237775,3135486431,3059715558,2460921700,986174950,2661811465,4062904701,2752986992,3709736643,367056889,1353824391,731860949,1650113154,1778481506,784341916,357075625,3608602432,1074092588,2480052770,3811426202,92751289,877911070,3600361838,1231880047,480201094,3756190983,3094495953,434011822,87971354,363687820,1717726236,1901380172,3926403882,2481662265,400339184,1490350766,2661455099,1389319756,2558787174,784598401,1983468483,30828846,3550527752,2716276238,3841122214,1765724805,1955612312,1277890269,1333098070,1564029816,2704417615,1026694237,3287671188,1260819201,3349086767,1016692350,1582273796,1073413053,1995943182,694588404,1025494639,3323872702,3551898420,4146854327,453260480,1316140391,1435673405,3038941953,3486689407,1622062951,403978347,817677117,950059133,4246079218,3278066075,1486738320,1417279718,481875527,2549965225,3933690356,760697757,1452955855,3897451437,1177426808,1702951038,4085348628,2447005172,1084371187,3516436277,3068336338,1073369276,1027665953,3284188590,1230553676,1368340146,2226246512,267243139,2274220762,4070734279,2497715176,2423353163,2504755875],s[7]=[3793104909,3151888380,2817252029,895778965,2005530807,3871412763,237245952,86829237,296341424,3851759377,3974600970,2475086196,709006108,1994621201,2972577594,937287164,3734691505,168608556,3189338153,2225080640,3139713551,3033610191,3025041904,77524477,185966941,1208824168,2344345178,1721625922,3354191921,1066374631,1927223579,1971335949,2483503697,1551748602,2881383779,2856329572,3003241482,48746954,1398218158,2050065058,313056748,4255789917,393167848,1912293076,940740642,3465845460,3091687853,2522601570,2197016661,1727764327,364383054,492521376,1291706479,3264136376,1474851438,1685747964,2575719748,1619776915,1814040067,970743798,1561002147,2925768690,2123093554,1880132620,3151188041,697884420,2550985770,2607674513,2659114323,110200136,1489731079,997519150,1378877361,3527870668,478029773,2766872923,1022481122,431258168,1112503832,897933369,2635587303,669726182,3383752315,918222264,163866573,3246985393,3776823163,114105080,1903216136,761148244,3571337562,1690750982,3166750252,1037045171,1888456500,2010454850,642736655,616092351,365016990,1185228132,4174898510,1043824992,2023083429,2241598885,3863320456,3279669087,3674716684,108438443,2132974366,830746235,606445527,4173263986,2204105912,1844756978,2532684181,4245352700,2969441100,3796921661,1335562986,4061524517,2720232303,2679424040,634407289,885462008,3294724487,3933892248,2094100220,339117932,4048830727,3202280980,1458155303,2689246273,1022871705,2464987878,3714515309,353796843,2822958815,4256850100,4052777845,551748367,618185374,3778635579,4020649912,1904685140,3069366075,2670879810,3407193292,2954511620,4058283405,2219449317,3135758300,1120655984,3447565834,1474845562,3577699062,550456716,3466908712,2043752612,881257467,869518812,2005220179,938474677,3305539448,3850417126,1315485940,3318264702,226533026,965733244,321539988,1136104718,804158748,573969341,3708209826,937399083,3290727049,2901666755,1461057207,4013193437,4066861423,3242773476,2421326174,1581322155,3028952165,786071460,3900391652,3918438532,1485433313,4023619836,3708277595,3678951060,953673138,1467089153,1930354364,1533292819,2492563023,1346121658,1685000834,1965281866,3765933717,4190206607,2052792609,3515332758,690371149,3125873887,2180283551,2903598061,3933952357,436236910,289419410,14314871,1242357089,2904507907,1616633776,2666382180,585885352,3471299210,2699507360,1432659641,277164553,3354103607,770115018,2303809295,3741942315,3177781868,2853364978,2269453327,3774259834,987383833,1290892879,225909803,1741533526,890078084,1496906255,1111072499,916028167,243534141,1252605537,2204162171,531204876,290011180,3916834213,102027703,237315147,209093447,1486785922,220223953,2758195998,4175039106,82940208,3127791296,2569425252,518464269,1353887104,3941492737,2377294467,3935040926]}function hp(t){this.cast5=new fp,this.cast5.setKey(t),this.encrypt=function(t){return this.cast5.encrypt(t)}}lp.keySize=lp.prototype.keySize=24,lp.blockSize=lp.prototype.blockSize=8,hp.blockSize=hp.prototype.blockSize=8,hp.keySize=hp.prototype.keySize=16;const yp=4294967295;function dp(t,e){return(t<<e|t>>>32-e)&yp}function pp(t,e){return t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24}function gp(t,e,r){t.splice(e,4,255&r,r>>>8&255,r>>>16&255,r>>>24&255)}function Ap(t,e){return t>>>8*e&255}function wp(t){this.tf=function(){let t=null,e=null,r=-1,n=[],i=[[],[],[],[]];function s(t){return i[0][Ap(t,0)]^i[1][Ap(t,1)]^i[2][Ap(t,2)]^i[3][Ap(t,3)]}function a(t){return i[0][Ap(t,3)]^i[1][Ap(t,0)]^i[2][Ap(t,1)]^i[3][Ap(t,2)]}function o(t,e){let r=s(e[0]),i=a(e[1]);e[2]=dp(e[2]^r+i+n[4*t+8]&yp,31),e[3]=dp(e[3],1)^r+2*i+n[4*t+9]&yp,r=s(e[2]),i=a(e[3]),e[0]=dp(e[0]^r+i+n[4*t+10]&yp,31),e[1]=dp(e[1],1)^r+2*i+n[4*t+11]&yp}function c(t,e){let r=s(e[0]),i=a(e[1]);e[2]=dp(e[2],1)^r+i+n[4*t+10]&yp,e[3]=dp(e[3]^r+2*i+n[4*t+11]&yp,31),r=s(e[2]),i=a(e[3]),e[0]=dp(e[0],1)^r+i+n[4*t+8]&yp,e[1]=dp(e[1]^r+2*i+n[4*t+9]&yp,31)}return{name:"twofish",blocksize:16,open:function(e){let r,s,a,o,c;t=e;const u=[],l=[],f=[];let h;const y=[];let d,p,g;const A=[[8,1,7,13,6,15,3,2,0,11,5,9,14,12,10,4],[2,8,11,13,15,7,6,14,3,1,9,4,0,10,12,5]],w=[[14,12,11,8,1,2,3,5,15,4,10,6,7,0,9,13],[1,14,2,11,4,12,3,7,6,13,10,5,15,9,0,8]],b=[[11,10,5,14,6,13,9,0,12,8,15,3,2,4,7,1],[4,12,7,5,1,6,9,10,0,14,13,8,2,11,3,15]],m=[[13,7,15,4,1,2,6,14,9,11,3,0,8,5,12,10],[11,9,5,1,12,3,13,14,6,4,7,15,2,0,8,10]],v=[0,8,1,9,2,10,3,11,4,12,5,13,6,14,7,15],E=[0,9,2,11,4,13,6,15,8,1,10,3,12,5,14,7],k=[[],[]],B=[[],[],[],[]];function I(t){return t^t>>2^[0,90,180,238][3&t]}function S(t){return t^t>>1^t>>2^[0,238,180,90][3&t]}function C(t,e){let r,n,i;for(r=0;r<8;r++)n=e>>>24,e=e<<8&yp|t>>>24,t=t<<8&yp,i=n<<1,128&n&&(i^=333),e^=n^i<<16,i^=n>>>1,1&n&&(i^=166),e^=i<<24|i<<8;return e}function K(t,e){const r=e>>4,n=15&e,i=A[t][r^n],s=w[t][v[n]^E[r]];return m[t][v[s]^E[i]]<<4|b[t][i^s]}function D(t,e){let r=Ap(t,0),n=Ap(t,1),i=Ap(t,2),s=Ap(t,3);switch(h){case 4:r=k[1][r]^Ap(e[3],0),n=k[0][n]^Ap(e[3],1),i=k[0][i]^Ap(e[3],2),s=k[1][s]^Ap(e[3],3);case 3:r=k[1][r]^Ap(e[2],0),n=k[1][n]^Ap(e[2],1),i=k[0][i]^Ap(e[2],2),s=k[0][s]^Ap(e[2],3);case 2:r=k[0][k[0][r]^Ap(e[1],0)]^Ap(e[0],0),n=k[0][k[1][n]^Ap(e[1],1)]^Ap(e[0],1),i=k[1][k[0][i]^Ap(e[1],2)]^Ap(e[0],2),s=k[1][k[1][s]^Ap(e[1],3)]^Ap(e[0],3)}return B[0][r]^B[1][n]^B[2][i]^B[3][s]}for(t=t.slice(0,32),r=t.length;16!==r&&24!==r&&32!==r;)t[r++]=0;for(r=0;r<t.length;r+=4)f[r>>2]=pp(t,r);for(r=0;r<256;r++)k[0][r]=K(0,r),k[1][r]=K(1,r);for(r=0;r<256;r++)d=k[1][r],p=I(d),g=S(d),B[0][r]=d+(p<<8)+(g<<16)+(g<<24),B[2][r]=p+(g<<8)+(d<<16)+(g<<24),d=k[0][r],p=I(d),g=S(d),B[1][r]=g+(g<<8)+(p<<16)+(d<<24),B[3][r]=p+(d<<8)+(g<<16)+(p<<24);for(h=f.length/2,r=0;r<h;r++)s=f[r+r],u[r]=s,a=f[r+r+1],l[r]=a,y[h-r-1]=C(s,a);for(r=0;r<40;r+=2)s=16843009*r,a=s+16843009,s=D(s,u),a=dp(D(a,l),8),n[r]=s+a&yp,n[r+1]=dp(s+2*a,9);for(r=0;r<256;r++)switch(s=a=o=c=r,h){case 4:s=k[1][s]^Ap(y[3],0),a=k[0][a]^Ap(y[3],1),o=k[0][o]^Ap(y[3],2),c=k[1][c]^Ap(y[3],3);case 3:s=k[1][s]^Ap(y[2],0),a=k[1][a]^Ap(y[2],1),o=k[0][o]^Ap(y[2],2),c=k[0][c]^Ap(y[2],3);case 2:i[0][r]=B[0][k[0][k[0][s]^Ap(y[1],0)]^Ap(y[0],0)],i[1][r]=B[1][k[0][k[1][a]^Ap(y[1],1)]^Ap(y[0],1)],i[2][r]=B[2][k[1][k[0][o]^Ap(y[1],2)]^Ap(y[0],2)],i[3][r]=B[3][k[1][k[1][c]^Ap(y[1],3)]^Ap(y[0],3)]}},close:function(){n=[],i=[[],[],[],[]]},encrypt:function(t,i){e=t,r=i;const s=[pp(e,r)^n[0],pp(e,r+4)^n[1],pp(e,r+8)^n[2],pp(e,r+12)^n[3]];for(let t=0;t<8;t++)o(t,s);return gp(e,r,s[2]^n[4]),gp(e,r+4,s[3]^n[5]),gp(e,r+8,s[0]^n[6]),gp(e,r+12,s[1]^n[7]),r+=16,e},decrypt:function(t,i){e=t,r=i;const s=[pp(e,r)^n[4],pp(e,r+4)^n[5],pp(e,r+8)^n[6],pp(e,r+12)^n[7]];for(let t=7;t>=0;t--)c(t,s);gp(e,r,s[2]^n[0]),gp(e,r+4,s[3]^n[1]),gp(e,r+8,s[0]^n[2]),gp(e,r+12,s[1]^n[3]),r+=16},finalize:function(){return e}}}(),this.tf.open(Array.from(t),0),this.encrypt=function(t){return this.tf.encrypt(Array.from(t),0)}}function bp(){}function mp(t){this.bf=new bp,this.bf.init(t),this.encrypt=function(t){return this.bf.encryptBlock(t)}}wp.keySize=wp.prototype.keySize=32,wp.blockSize=wp.prototype.blockSize=16,bp.prototype.BLOCKSIZE=8,bp.prototype.SBOXES=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]],bp.prototype.PARRAY=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],bp.prototype.NN=16,bp.prototype._clean=function(t){return t<0&&(t=2147483648+(2147483647&t)),t},bp.prototype._F=function(t){let e;const r=255&t,n=255&(t>>>=8),i=255&(t>>>=8),s=255&(t>>>=8);return e=this.sboxes[0][s]+this.sboxes[1][i],e^=this.sboxes[2][n],e+=this.sboxes[3][r],e},bp.prototype._encryptBlock=function(t){let e,r=t[0],n=t[1];for(e=0;e<this.NN;++e){r^=this.parray[e],n=this._F(r)^n;const t=r;r=n,n=t}r^=this.parray[this.NN+0],n^=this.parray[this.NN+1],t[0]=this._clean(n),t[1]=this._clean(r)},bp.prototype.encryptBlock=function(t){let e;const r=[0,0],n=this.BLOCKSIZE/2;for(e=0;e<this.BLOCKSIZE/2;++e)r[0]=r[0]<<8|255&t[e+0],r[1]=r[1]<<8|255&t[e+n];this._encryptBlock(r);const i=[];for(e=0;e<this.BLOCKSIZE/2;++e)i[e+0]=r[0]>>>24-8*e&255,i[e+n]=r[1]>>>24-8*e&255;return i},bp.prototype._decryptBlock=function(t){let e,r=t[0],n=t[1];for(e=this.NN+1;e>1;--e){r^=this.parray[e],n=this._F(r)^n;const t=r;r=n,n=t}r^=this.parray[1],n^=this.parray[0],t[0]=this._clean(n),t[1]=this._clean(r)},bp.prototype.init=function(t){let e,r=0;for(this.parray=[],e=0;e<this.NN+2;++e){let n=0;for(let e=0;e<4;++e)n=n<<8|255&t[r],++r>=t.length&&(r=0);this.parray[e]=this.PARRAY[e]^n}for(this.sboxes=[],e=0;e<4;++e)for(this.sboxes[e]=[],r=0;r<256;++r)this.sboxes[e][r]=this.SBOXES[e][r];const n=[0,0];for(e=0;e<this.NN+2;e+=2)this._encryptBlock(n),this.parray[e+0]=n[0],this.parray[e+1]=n[1];for(e=0;e<4;++e)for(r=0;r<256;r+=2)this._encryptBlock(n),this.sboxes[e][r+0]=n[0],this.sboxes[e][r+1]=n[1]},mp.keySize=mp.prototype.keySize=16,mp.blockSize=mp.prototype.blockSize=8;const vp=new Map(Object.entries({tripledes:lp,cast5:hp,twofish:wp,blowfish:mp}));var Ep=Object.freeze({__proto__:null,legacyCiphers:vp});function kp(t,e,r,n){t[e]+=r[n],t[e+1]+=r[n+1]+(t[e]<r[n])}function Bp(t,e){t[0]+=e,t[1]+=t[0]<e}function Ip(t,e,r,n,i,s,a,o){kp(t,r,t,n),kp(t,r,e,a);let c=t[s]^t[r],u=t[s+1]^t[r+1];t[s]=u,t[s+1]=c,kp(t,i,t,s),c=t[n]^t[i],u=t[n+1]^t[i+1],t[n]=c>>>24^u<<8,t[n+1]=u>>>24^c<<8,kp(t,r,t,n),kp(t,r,e,o),c=t[s]^t[r],u=t[s+1]^t[r+1],t[s]=c>>>16^u<<16,t[s+1]=u>>>16^c<<16,kp(t,i,t,s),c=t[n]^t[i],u=t[n+1]^t[i+1],t[n]=u>>>31^c<<1,t[n+1]=c>>>31^u<<1}const Sp=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),Cp=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(t=>2*t));function Kp(t,e){const r=new Uint32Array(32),n=new Uint32Array(t.b.buffer,t.b.byteOffset,32);for(let e=0;e<16;e++)r[e]=t.h[e],r[e+16]=Sp[e];r[24]^=t.t0[0],r[25]^=t.t0[1];const i=e?4294967295:0;r[28]^=i,r[29]^=i;for(let t=0;t<12;t++){const e=t<<4;Ip(r,n,0,8,16,24,Cp[e+0],Cp[e+1]),Ip(r,n,2,10,18,26,Cp[e+2],Cp[e+3]),Ip(r,n,4,12,20,28,Cp[e+4],Cp[e+5]),Ip(r,n,6,14,22,30,Cp[e+6],Cp[e+7]),Ip(r,n,0,10,20,30,Cp[e+8],Cp[e+9]),Ip(r,n,2,12,22,24,Cp[e+10],Cp[e+11]),Ip(r,n,4,14,16,26,Cp[e+12],Cp[e+13]),Ip(r,n,6,8,18,28,Cp[e+14],Cp[e+15])}for(let e=0;e<16;e++)t.h[e]^=r[e]^r[e+16]}class Dp{constructor(t,e,r,n){const i=new Uint8Array(64);this.S={b:new Uint8Array(Pp),h:new Uint32Array(xp/4),t0:new Uint32Array(2),c:0,outlen:t},i[0]=t,e&&(i[1]=e.length),i[2]=1,i[3]=1,r&&i.set(r,32),n&&i.set(n,48);const s=new Uint32Array(i.buffer,i.byteOffset,i.length/Uint32Array.BYTES_PER_ELEMENT);for(let t=0;t<16;t++)this.S.h[t]=Sp[t]^s[t];if(e){const t=new Uint8Array(Pp);t.set(e),this.update(t)}}update(t){if(!(t instanceof Uint8Array))throw Error("Input must be Uint8Array or Buffer");let e=0;for(;e<t.length;){this.S.c===Pp&&(Bp(this.S.t0,this.S.c),Kp(this.S,!1),this.S.c=0);let r=Pp-this.S.c;this.S.b.set(t.subarray(e,e+r),this.S.c);const n=Math.min(r,t.length-e);this.S.c+=n,e+=n}return this}digest(t){Bp(this.S.t0,this.S.c),this.S.b.fill(0,this.S.c),this.S.c=Pp,Kp(this.S,!0);const e=t||new Uint8Array(this.S.outlen);for(let t=0;t<this.S.outlen;t++)e[t]=this.S.h[t>>2]>>8*(3&t);return this.S.h=null,e.buffer}}function Up(t,e,r,n){if(t>xp)throw Error(`outlen must be at most ${xp} (given: ${t})`);return new Dp(t,e,r,n)}const xp=64,Pp=128,Qp=1024,_p=205===new Uint8Array(new Uint16Array([43981]).buffer)[0];function Rp(t,e,r){return t[r+0]=e,t[r+1]=e>>8,t[r+2]=e>>16,t[r+3]=e>>24,t}function Tp(t,e,r){if(e>Number.MAX_SAFE_INTEGER)throw Error("LE64: large numbers unsupported");let n=e;for(let e=r;e<r+7;e++)t[e]=n,n=(n-t[e])/256;return t}function Mp(t,e,r){const n=new Uint8Array(64),i=new Uint8Array(4+e.length);if(Rp(i,t,0),i.set(e,4),t<=64)return Up(t).update(i).digest(r),r;const s=Math.ceil(t/32)-2;for(let t=0;t<s;t++)Up(64).update(0===t?i:n).digest(n),r.set(n.subarray(0,32),32*t);const a=new Uint8Array(Up(t-32*s).update(n).digest());return r.set(a,32*s),r}function Np(t,e,r,n){return t.fn.XOR(e.byteOffset,r.byteOffset,n.byteOffset),e}function Op(t,e,r,n){return t.fn.G(e.byteOffset,r.byteOffset,n.byteOffset,t.refs.gZ.byteOffset),n}function Fp(t,e,r,n){return t.fn.G2(e.byteOffset,r.byteOffset,n.byteOffset,t.refs.gZ.byteOffset),n}function*Lp(t,e,r,n,i,s,a,o){t.refs.prngTmp.fill(0);const c=t.refs.prngTmp.subarray(0,48);Tp(c,e,0),Tp(c,r,8),Tp(c,n,16),Tp(c,i,24),Tp(c,s,32),Tp(c,2,40);for(let e=1;e<=a;e++){Tp(t.refs.prngTmp,e,c.length);const r=Fp(t,t.refs.ZERO1024,t.refs.prngTmp,t.refs.prngR);for(let t=1===e?8*o:0;t<r.length;t+=8)yield r.subarray(t,t+8)}return[]}let Hp;function zp(t,e,r,n){var i=null,s=fn.atob(r),a=s.length;i=new Uint8Array(new ArrayBuffer(a));for(var o=0;o<a;o++)i[o]=s.charCodeAt(o);return function(t,e){var r=WebAssembly.instantiate,n=WebAssembly.compile;return e?r(t,e):n(t)}(i,n)}var Gp,$p,jp,Vp,qp,Yp,Zp,Jp,Wp=Object.freeze({__proto__:null,default:async()=>async function(t,e){const r=new WebAssembly.Memory({initial:1040,maximum:65536}),n=await async function(t,e,r){const n={env:{memory:t}};if(void 0===Hp)try{const t=await e(n);return Hp=!0,t}catch(t){Hp=!1}return(Hp?e:r)(n)}(r,t,e);return t=>function(t,{memory:e,instance:r}){if(!_p)throw Error("BigEndian system not supported");const n=function({type:t,version:e,tagLength:r,password:n,salt:i,ad:s,secret:a,parallelism:o,memorySize:c,passes:u}){const l=(t,e,r,n)=>{if(e<r||e>n)throw Error(`${t} size should be between ${r} and ${n} bytes`)};if(2!==t||19!==e)throw Error("Unsupported type or version");return l("password",n,8,4294967295),l("salt",i,8,4294967295),l("tag",r,4,4294967295),l("memory",c,8*o,4294967295),s&&l("associated data",s,0,4294967295),a&&l("secret",a,0,32),{type:t,version:e,tagLength:r,password:n,salt:i,ad:s,secret:a,lanes:o,memorySize:c,passes:u}}({type:2,version:19,...t}),{G:i,G2:s,xor:a,getLZ:o}=r.exports,c={},u={};u.G=i,u.G2=s,u.XOR=a;const l=4*n.lanes*Math.floor(n.memorySize/(4*n.lanes)),f=l*Qp+10240;if(e.buffer.byteLength<f){const t=Math.ceil((f-e.buffer.byteLength)/65536);e.grow(t)}let h=0;c.gZ=new Uint8Array(e.buffer,h,Qp),h+=c.gZ.length,c.prngR=new Uint8Array(e.buffer,h,Qp),h+=c.prngR.length,c.prngTmp=new Uint8Array(e.buffer,h,Qp),h+=c.prngTmp.length,c.ZERO1024=new Uint8Array(e.buffer,h,1024),h+=c.ZERO1024.length;const y=new Uint32Array(e.buffer,h,2);h+=y.length*Uint32Array.BYTES_PER_ELEMENT;const d={fn:u,refs:c},p=new Uint8Array(e.buffer,h,Qp);h+=p.length;const g=new Uint8Array(e.buffer,h,n.memorySize*Qp),A=new Uint8Array(e.buffer,0,h),w=function(t){const e=Up(64),r=new Uint8Array(4),n=new Uint8Array(24);Rp(n,t.lanes,0),Rp(n,t.tagLength,4),Rp(n,t.memorySize,8),Rp(n,t.passes,12),Rp(n,t.version,16),Rp(n,t.type,20);const i=[n];t.password?(i.push(Rp(new Uint8Array(4),t.password.length,0)),i.push(t.password)):i.push(r),t.salt?(i.push(Rp(new Uint8Array(4),t.salt.length,0)),i.push(t.salt)):i.push(r),t.secret?(i.push(Rp(new Uint8Array(4),t.secret.length,0)),i.push(t.secret)):i.push(r),t.ad?(i.push(Rp(new Uint8Array(4),t.ad.length,0)),i.push(t.ad)):i.push(r),e.update(function(t){if(1===t.length)return t[0];let e=0;for(let r=0;r<t.length;r++){if(!(t[r]instanceof Uint8Array))throw Error("concatArrays: Data must be in the form of a Uint8Array");e+=t[r].length}const r=new Uint8Array(e);let n=0;return t.forEach(t=>{r.set(t,n),n+=t.length}),r}(i));const s=e.digest();return new Uint8Array(s)}(n),b=l/n.lanes,m=Array(n.lanes).fill(null).map(()=>Array(b)),v=(t,e)=>(m[t][e]=g.subarray(t*b*1024+1024*e,t*b*1024+1024*e+Qp),m[t][e]);for(let t=0;t<n.lanes;t++){const e=new Uint8Array(w.length+8);e.set(w),Rp(e,0,w.length),Rp(e,t,w.length+4),Mp(Qp,e,v(t,0)),Rp(e,1,w.length),Mp(Qp,e,v(t,1))}const E=b/4;for(let t=0;t<n.passes;t++)for(let e=0;e<4;e++){const r=0===t&&e<=1;for(let i=0;i<n.lanes;i++){let s=0===e&&0===t?2:0;const a=r?Lp(d,t,i,e,l,n.passes,E,s):null;for(;s<E;s++){const c=e*E+s,u=c>0?m[i][c-1]:m[i][b-1],l=r?a.next().value:u;o(y.byteOffset,l.byteOffset,i,n.lanes,t,e,s,4,E);const f=y[0],h=y[1];0===t&&v(i,c),Op(d,u,m[f][h],t>0?p:m[i][c]),t>0&&Np(d,m[i][c],p,m[i][c])}}}const k=m[0][b-1];for(let t=1;t<n.lanes;t++)Np(d,k,k,m[t][b-1]);const B=Mp(n.tagLength,k,new Uint8Array(n.tagLength));return A.fill(0),e.grow(0),B}(t,{instance:n.instance,memory:r})}(t=>zp(0,0,"AGFzbQEAAAABKwdgBH9/f38AYAABf2AAAGADf39/AGAJf39/f39/f39/AX9gAX8AYAF/AX8CEwEDZW52Bm1lbW9yeQIBkAiAgAQDCgkCAwAABAEFBgEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwACAkcyAAMFZ2V0TFoABBlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAgJc3RhY2tTYXZlAAUMc3RhY2tSZXN0b3JlAAYKc3RhY2tBbGxvYwAHCQcBAEEBCwEACs0gCQMAAQtYAQJ/A0AgACAEQQR0IgNqIAIgA2r9AAQAIAEgA2r9AAQA/VH9CwQAIAAgA0EQciIDaiACIANq/QAEACABIANq/QAEAP1R/QsEACAEQQJqIgRBwABHDQALC7ceAgt7A38DQCADIBFBBHQiD2ogASAPav0ABAAgACAPav0ABAD9USIF/QsEACACIA9qIAX9CwQAIAMgD0EQciIPaiABIA9q/QAEACAAIA9q/QAEAP1RIgX9CwQAIAIgD2ogBf0LBAAgEUECaiIRQcAARw0ACwNAIAMgEEEHdGoiAEEQaiAA/QAEcCAA/QAEMCIFIAD9AAQQIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEUCIG/c4BIAkgCf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAX9USIFQSj9ywEgBUEY/c0B/VAiCCAE/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAEIAT9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAogCf1RIgVBMP3LASAFQRD9zQH9UCIFIAb9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCP1RIgRBAf3LASAEQT/9zQH9UCIMIAD9AARgIAD9AAQgIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIABBQGsiAf0ABAAiB/3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiByAE/VEiBEEo/csBIARBGP3NAf1QIgsgBv3OASALIAv9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAI/VEiBEEw/csBIARBEP3NAf1QIgQgB/3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgByAH/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAL/VEiB0EB/csBIAdBP/3NAf1QIg0gDf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eHyIH/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIKIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/VEiC0Eg/csBIAtBIP3NAf1QIgsgCP3OASALIAv9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCCAH/VEiB0Eo/csBIAdBGP3NAf1QIgcgCv3OASAHIAf9DQABAgMICQoLAAECAwgJCgsgCiAK/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiDv0LBAAgACAGIA0gDCAM/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgr9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgYgBSAEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USIFQSD9ywEgBUEg/c0B/VAiBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAr9USIEQSj9ywEgBEEY/c0B/VAiCiAG/c4BIAogCv0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAQgBf1RIgVBMP3LASAFQRD9zQH9UCIFIA4gC/1RIgRBMP3LASAEQRD9zQH9UCIEIAT9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRgIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwRwIAEgBCAI/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIE/QsEACAAIAUgCf3OASAFIAX9DQABAgMICQoLAAECAwgJCgsgCSAJ/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCf0LBFAgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEICAAIAQgBSAF/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEMCAQQQFqIhBBCEcNAAtBACEQA0AgAyAQQQR0aiIAQYABaiAA/QAEgAcgAP0ABIADIgUgAP0ABIABIgT9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAQgBP0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9USIJQSD9ywEgCUEg/c0B/VAiCSAA/QAEgAUiBv3OASAJIAn9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAF/VEiBUEo/csBIAVBGP3NAf1QIgggBP3OASAIIAj9DQABAgMICQoLAAECAwgJCgsgBCAE/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiCiAKIAn9USIFQTD9ywEgBUEQ/c0B/VAiBSAG/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJIAj9USIEQQH9ywEgBEE//c0B/VAiDCAA/QAEgAYgAP0ABIACIgQgAP0ABAAiBv3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBv1RIghBIP3LASAIQSD9zQH9UCIIIAD9AASABCIH/c4BIAggCP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIHIAT9USIEQSj9ywEgBEEY/c0B/VAiCyAG/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAGIAb9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIGIAj9USIEQTD9ywEgBEEQ/c0B/VAiBCAH/c4BIAQgBP0NAAECAwgJCgsAAQIDCAkKCyAHIAf9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAv9USIHQQH9ywEgB0E//c0B/VAiDSAN/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4fIgf9zgEgByAH/Q0AAQIDCAkKCwABAgMICQoLIAogCv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgogBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9USILQSD9ywEgC0Eg/c0B/VAiCyAI/c4BIAsgC/0NAAECAwgJCgsAAQIDCAkKCyAIIAj9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIIIAf9USIHQSj9ywEgB0EY/c0B/VAiByAK/c4BIAcgB/0NAAECAwgJCgsAAQIDCAkKCyAKIAr9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIO/QsEACAAIAYgDSAMIAz9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh8iCv3OASAKIAr9DQABAgMICQoLAAECAwgJCgsgBiAG/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBiAFIAQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/1RIgVBIP3LASAFQSD9zQH9UCIFIAn9zgEgBSAF/Q0AAQIDCAkKCwABAgMICQoLIAkgCf0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgkgCv1RIgRBKP3LASAEQRj9zQH9UCIKIAb9zgEgCiAK/Q0AAQIDCAkKCwABAgMICQoLIAYgBv0NAAECAwgJCgsAAQIDCAkKC/3eAUEB/csB/c4BIgT9CwQAIAAgBCAF/VEiBUEw/csBIAVBEP3NAf1QIgUgDiAL/VEiBEEw/csBIARBEP3NAf1QIgQgBP0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIAGIAAgBCAFIAX9DQABAgMEBQYHEBESExQVFhf9DQgJCgsMDQ4PGBkaGxwdHh/9CwSAByAAIAQgCP3OASAEIAT9DQABAgMICQoLAAECAwgJCgsgCCAI/Q0AAQIDCAkKCwABAgMICQoL/d4BQQH9ywH9zgEiBP0LBIAEIAAgBSAJ/c4BIAUgBf0NAAECAwgJCgsAAQIDCAkKCyAJIAn9DQABAgMICQoLAAECAwgJCgv93gFBAf3LAf3OASIJ/QsEgAUgACAEIAf9USIFQQH9ywEgBUE//c0B/VAiBSAJIAr9USIEQQH9ywEgBEE//c0B/VAiBCAE/Q0AAQIDBAUGBxAREhMUFRYX/Q0ICQoLDA0ODxgZGhscHR4f/QsEgAIgACAEIAUgBf0NAAECAwQFBgcQERITFBUWF/0NCAkKCwwNDg8YGRobHB0eH/0LBIADIBBBAWoiEEEIRw0AC0EAIRADQCACIBBBBHQiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACACIABBEHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBIHIiAWoiDyABIANq/QAEACAP/QAEAP1R/QsEACACIABBMHIiAGoiASAAIANq/QAEACAB/QAEAP1R/QsEACAQQQRqIhBBwABHDQALCxYAIAAgASACIAMQAiAAIAIgAiADEAILewIBfwF+IAIhCSABNQIAIQogBCAFcgRAIAEoAgQgA3AhCQsgACAJNgIAIAAgB0EBayAFIAQbIAhsIAZBAWtBAEF/IAYbIAIgCUYbaiIBIAVBAWogCGxBACAEG2ogAa0gCiAKfkIgiH5CIIinQX9zaiAHIAhscDYCBCAACwQAIwALBgAgACQACxAAIwAgAGtBcHEiACQAIAALBQBBgAgL",t),t=>zp(0,0,"AGFzbQEAAAABPwhgBH9/f38AYAABf2AAAGADf39/AGARf39/f39/f39/f39/f39/f38AYAl/f39/f39/f38Bf2ABfwBgAX8BfwITAQNlbnYGbWVtb3J5AgGQCICABAMLCgIDBAAABQEGBwEEBQFwAQICBgkBfwFBkIjAAgsHfQoDeG9yAAEBRwADAkcyAAQFZ2V0TFoABRlfX2luZGlyZWN0X2Z1bmN0aW9uX3RhYmxlAQALX2luaXRpYWxpemUAABBfX2Vycm5vX2xvY2F0aW9uAAkJc3RhY2tTYXZlAAYMc3RhY2tSZXN0b3JlAAcKc3RhY2tBbGxvYwAICQcBAEEBCwEACssaCgMAAQtQAQJ/A0AgACAEQQN0IgNqIAIgA2opAwAgASADaikDAIU3AwAgACADQQhyIgNqIAIgA2opAwAgASADaikDAIU3AwAgBEECaiIEQYABRw0ACwveDwICfgF/IAAgAUEDdGoiEyATKQMAIhEgACAFQQN0aiIBKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA1BA3RqIgUgESAFKQMAhUIgiSIRNwMAIAAgCUEDdGoiCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIoiSIRNwMAIBMgESATKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAFIBEgBSkDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgASARIAEpAwCFQgGJNwMAIAAgAkEDdGoiDSANKQMAIhEgACAGQQN0aiICKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA5BA3RqIgYgESAGKQMAhUIgiSIRNwMAIAAgCkEDdGoiCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIoiSIRNwMAIA0gESANKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAKIBEgCikDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAiARIAIpAwCFQgGJNwMAIAAgA0EDdGoiDiAOKQMAIhEgACAHQQN0aiIDKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIA9BA3RqIgcgESAHKQMAhUIgiSIRNwMAIAAgC0EDdGoiCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAMgESADKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAHIBEgBykDAIVCMIkiETcDACALIBEgCykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQgGJNwMAIAAgBEEDdGoiDyAPKQMAIhEgACAIQQN0aiIEKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAAIBBBA3RqIgggESAIKQMAhUIgiSIRNwMAIAAgDEEDdGoiACARIAApAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA8gESAPKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAIIBEgCCkDAIVCMIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIBMgEykDACIRIAIpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAggESAIKQMAhUIgiSIRNwMAIAsgESALKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACACIBEgAikDAIVCKIkiETcDACATIBEgEykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgCCARIAgpAwCFQjCJIhE3AwAgCyARIAspAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAIgESACKQMAhUIBiTcDACANIA0pAwAiESADKQMAIhJ8IBFCAYZC/v///x+DIBJC/////w+DfnwiETcDACAFIBEgBSkDAIVCIIkiETcDACAAIBEgACkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgAyARIAMpAwCFQiiJIhE3AwAgDSARIA0pAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAUgESAFKQMAhUIwiSIRNwMAIAAgESAAKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACADIBEgAykDAIVCAYk3AwAgDiAOKQMAIhEgBCkDACISfCARQgGGQv7///8fgyASQv////8Pg358IhE3AwAgBiARIAYpAwCFQiCJIhE3AwAgCSARIAkpAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAQgESAEKQMAhUIoiSIRNwMAIA4gESAOKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACAGIBEgBikDAIVCMIkiETcDACAJIBEgCSkDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgBCARIAQpAwCFQgGJNwMAIA8gDykDACIRIAEpAwAiEnwgEUIBhkL+////H4MgEkL/////D4N+fCIRNwMAIAcgESAHKQMAhUIgiSIRNwMAIAogESAKKQMAIhJ8IBFC/////w+DIBJCAYZC/v///x+DfnwiETcDACABIBEgASkDAIVCKIkiETcDACAPIBEgDykDACISfCARQv////8PgyASQgGGQv7///8fg358IhE3AwAgByARIAcpAwCFQjCJIhE3AwAgCiARIAopAwAiEnwgEUL/////D4MgEkIBhkL+////H4N+fCIRNwMAIAEgESABKQMAhUIBiTcDAAvdCAEPfwNAIAIgBUEDdCIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAIgBkEIciIGaiABIAZqKQMAIAAgBmopAwCFNwMAIAVBAmoiBUGAAUcNAAsDQCADIARBA3QiAGogACACaikDADcDACADIARBAXIiAEEDdCIBaiABIAJqKQMANwMAIAMgBEECciIBQQN0IgVqIAIgBWopAwA3AwAgAyAEQQNyIgVBA3QiBmogAiAGaikDADcDACADIARBBHIiBkEDdCIHaiACIAdqKQMANwMAIAMgBEEFciIHQQN0IghqIAIgCGopAwA3AwAgAyAEQQZyIghBA3QiCWogAiAJaikDADcDACADIARBB3IiCUEDdCIKaiACIApqKQMANwMAIAMgBEEIciIKQQN0IgtqIAIgC2opAwA3AwAgAyAEQQlyIgtBA3QiDGogAiAMaikDADcDACADIARBCnIiDEEDdCINaiACIA1qKQMANwMAIAMgBEELciINQQN0Ig5qIAIgDmopAwA3AwAgAyAEQQxyIg5BA3QiD2ogAiAPaikDADcDACADIARBDXIiD0EDdCIQaiACIBBqKQMANwMAIAMgBEEOciIQQQN0IhFqIAIgEWopAwA3AwAgAyAEQQ9yIhFBA3QiEmogAiASaikDADcDACADIARB//8DcSAAQf//A3EgAUH//wNxIAVB//8DcSAGQf//A3EgB0H//wNxIAhB//8DcSAJQf//A3EgCkH//wNxIAtB//8DcSAMQf//A3EgDUH//wNxIA5B//8DcSAPQf//A3EgEEH//wNxIBFB//8DcRACIARB8ABJIQAgBEEQaiEEIAANAAtBACEBIANBAEEBQRBBEUEgQSFBMEExQcAAQcEAQdAAQdEAQeAAQeEAQfAAQfEAEAIgA0ECQQNBEkETQSJBI0EyQTNBwgBBwwBB0gBB0wBB4gBB4wBB8gBB8wAQAiADQQRBBUEUQRVBJEElQTRBNUHEAEHFAEHUAEHVAEHkAEHlAEH0AEH1ABACIANBBkEHQRZBF0EmQSdBNkE3QcYAQccAQdYAQdcAQeYAQecAQfYAQfcAEAIgA0EIQQlBGEEZQShBKUE4QTlByABByQBB2ABB2QBB6ABB6QBB+ABB+QAQAiADQQpBC0EaQRtBKkErQTpBO0HKAEHLAEHaAEHbAEHqAEHrAEH6AEH7ABACIANBDEENQRxBHUEsQS1BPEE9QcwAQc0AQdwAQd0AQewAQe0AQfwAQf0AEAIgA0EOQQ9BHkEfQS5BL0E+QT9BzgBBzwBB3gBB3wBB7gBB7wBB/gBB/wAQAgNAIAIgAUEDdCIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAiAAQQhyIgRqIgUgAyAEaikDACAFKQMAhTcDACACIABBEHIiBGoiBSADIARqKQMAIAUpAwCFNwMAIAIgAEEYciIAaiIEIAAgA2opAwAgBCkDAIU3AwAgAUEEaiIBQYABRw0ACwsWACAAIAEgAiADEAMgACACIAIgAxADC3sCAX8BfiACIQkgATUCACEKIAQgBXIEQCABKAIEIANwIQkLIAAgCTYCACAAIAdBAWsgBSAEGyAIbCAGQQFrQQBBfyAGGyACIAlGG2oiASAFQQFqIAhsQQAgBBtqIAGtIAogCn5CIIh+QiCIp0F/c2ogByAIbHA2AgQgAAsEACMACwYAIAAkAAsQACMAIABrQXBxIgAkACAACwUAQYAICw==",t))}),Xp=function(){if(Jp)return Zp;Jp=1;var t,e=function(){if($p)return Gp;$p=1;var t=[0,1,3,7,15,31,63,127,255],e=function(t){this.stream=t,this.bitOffset=0,this.curByte=0,this.hasByte=!1};return e.prototype._ensureByte=function(){this.hasByte||(this.curByte=this.stream.readByte(),this.hasByte=!0)},e.prototype.read=function(e){for(var r=0;e>0;){this._ensureByte();var n=8-this.bitOffset;if(e>=n)r<<=n,r|=t[n]&this.curByte,this.hasByte=!1,this.bitOffset=0,e-=n;else{r<<=e;var i=n-e;r|=(this.curByte&t[e]<<i)>>i,this.bitOffset+=e,e=0}}return r},e.prototype.seek=function(t){var e=t%8,r=(t-e)/8;this.bitOffset=e,this.stream.seek(r),this.hasByte=!1},e.prototype.pi=function(){var t,e=new Uint8Array(6);for(t=0;t<e.length;t++)e[t]=this.read(8);return function(t){return Array.prototype.map.call(t,t=>("00"+t.toString(16)).slice(-2)).join("")}(e)},Gp=e}(),r=function(){if(Vp)return jp;Vp=1;var t=function(){};return t.prototype.readByte=function(){throw Error("abstract method readByte() not implemented")},t.prototype.read=function(t,e,r){for(var n=0;n<r;){var i=this.readByte();if(i<0)return 0===n?-1:n;t[e++]=i,n++}return n},t.prototype.seek=function(t){throw Error("abstract method seek() not implemented")},t.prototype.writeByte=function(t){throw Error("abstract method readByte() not implemented")},t.prototype.write=function(t,e,r){var n;for(n=0;n<r;n++)this.writeByte(t[e++]);return r},t.prototype.flush=function(){},jp=t}(),n=Yp?qp:(Yp=1,t=new Uint32Array([0,79764919,159529838,222504665,319059676,398814059,445009330,507990021,638119352,583659535,797628118,726387553,890018660,835552979,1015980042,944750013,1276238704,1221641927,1167319070,1095957929,1595256236,1540665371,1452775106,1381403509,1780037320,1859660671,1671105958,1733955601,2031960084,2111593891,1889500026,1952343757,2552477408,2632100695,2443283854,2506133561,2334638140,2414271883,2191915858,2254759653,3190512472,3135915759,3081330742,3009969537,2905550212,2850959411,2762807018,2691435357,3560074640,3505614887,3719321342,3648080713,3342211916,3287746299,3467911202,3396681109,4063920168,4143685023,4223187782,4286162673,3779000052,3858754371,3904687514,3967668269,881225847,809987520,1023691545,969234094,662832811,591600412,771767749,717299826,311336399,374308984,453813921,533576470,25881363,88864420,134795389,214552010,2023205639,2086057648,1897238633,1976864222,1804852699,1867694188,1645340341,1724971778,1587496639,1516133128,1461550545,1406951526,1302016099,1230646740,1142491917,1087903418,2896545431,2825181984,2770861561,2716262478,3215044683,3143675388,3055782693,3001194130,2326604591,2389456536,2200899649,2280525302,2578013683,2640855108,2418763421,2498394922,3769900519,3832873040,3912640137,3992402750,4088425275,4151408268,4197601365,4277358050,3334271071,3263032808,3476998961,3422541446,3585640067,3514407732,3694837229,3640369242,1762451694,1842216281,1619975040,1682949687,2047383090,2127137669,1938468188,2001449195,1325665622,1271206113,1183200824,1111960463,1543535498,1489069629,1434599652,1363369299,622672798,568075817,748617968,677256519,907627842,853037301,1067152940,995781531,51762726,131386257,177728840,240578815,269590778,349224269,429104020,491947555,4046411278,4126034873,4172115296,4234965207,3794477266,3874110821,3953728444,4016571915,3609705398,3555108353,3735388376,3664026991,3290680682,3236090077,3449943556,3378572211,3174993278,3120533705,3032266256,2961025959,2923101090,2868635157,2813903052,2742672763,2604032198,2683796849,2461293480,2524268063,2284983834,2364738477,2175806836,2238787779,1569362073,1498123566,1409854455,1355396672,1317987909,1246755826,1192025387,1137557660,2072149281,2135122070,1912620623,1992383480,1753615357,1816598090,1627664531,1707420964,295390185,358241886,404320391,483945776,43990325,106832002,186451547,266083308,932423249,861060070,1041341759,986742920,613929101,542559546,756411363,701822548,3316196985,3244833742,3425377559,3370778784,3601682597,3530312978,3744426955,3689838204,3819031489,3881883254,3928223919,4007849240,4037393693,4100235434,4180117107,4259748804,2310601993,2373574846,2151335527,2231098320,2596047829,2659030626,2470359227,2550115596,2947551409,2876312838,2788305887,2733848168,3165939309,3094707162,3040238851,2985771188]),qp=function(){var e=4294967295;this.getCRC=function(){return~e>>>0},this.updateCRC=function(r){e=e<<8^t[255&(e>>>24^r)]},this.updateCRCRun=function(r,n){for(;n-- >0;)e=e<<8^t[255&(e>>>24^r)]}}),i=function(t,e){var r,n=t[e];for(r=e;r>0;r--)t[r]=t[r-1];return t[0]=n,n},s={OK:0,LAST_BLOCK:-1,NOT_BZIP_DATA:-2,UNEXPECTED_INPUT_EOF:-3,UNEXPECTED_OUTPUT_EOF:-4,DATA_ERROR:-5,OUT_OF_MEMORY:-6,OBSOLETE_INPUT:-7,END_OF_BLOCK:-8},a={};a[s.LAST_BLOCK]="Bad file checksum",a[s.NOT_BZIP_DATA]="Not bzip data",a[s.UNEXPECTED_INPUT_EOF]="Unexpected input EOF",a[s.UNEXPECTED_OUTPUT_EOF]="Unexpected output EOF",a[s.DATA_ERROR]="Data error",a[s.OUT_OF_MEMORY]="Out of memory",a[s.OBSOLETE_INPUT]="Obsolete (pre 0.9.5) bzip format not supported.";var o=function(t,e){var r=a[t]||"unknown error";e&&(r+=": "+e);var n=new TypeError(r);throw n.errorCode=t,n},c=function(t,e){this.writePos=this.writeCurrent=this.writeCount=0,this._start_bunzip(t,e)};c.prototype._init_block=function(){return this._get_next_block()?(this.blockCRC=new n,!0):(this.writeCount=-1,!1)},c.prototype._start_bunzip=function(t,r){var n=new Uint8Array(4);4===t.read(n,0,4)&&"BZh"===String.fromCharCode(n[0],n[1],n[2])||o(s.NOT_BZIP_DATA,"bad magic");var i=n[3]-48;(i<1||i>9)&&o(s.NOT_BZIP_DATA,"level out of range"),this.reader=new e(t),this.dbufSize=1e5*i,this.nextoutput=0,this.outputStream=r,this.streamCRC=0},c.prototype._get_next_block=function(){var t,e,r,n=this.reader,a=n.pi();if("177245385090"===a)return!1;"314159265359"!==a&&o(s.NOT_BZIP_DATA),this.targetBlockCRC=n.read(32)>>>0,this.streamCRC=(this.targetBlockCRC^(this.streamCRC<<1|this.streamCRC>>>31))>>>0,n.read(1)&&o(s.OBSOLETE_INPUT);var c=n.read(24);c>this.dbufSize&&o(s.DATA_ERROR,"initial position out of bounds");var u=n.read(16),l=new Uint8Array(256),f=0;for(t=0;t<16;t++)if(u&1<<15-t){var h=16*t;for(r=n.read(16),e=0;e<16;e++)r&1<<15-e&&(l[f++]=h+e)}var y=n.read(3);(y<2||y>6)&&o(s.DATA_ERROR);var d=n.read(15);0===d&&o(s.DATA_ERROR);var p=new Uint8Array(256);for(t=0;t<y;t++)p[t]=t;var g=new Uint8Array(d);for(t=0;t<d;t++){for(e=0;n.read(1);e++)e>=y&&o(s.DATA_ERROR);g[t]=i(p,e)}var A,w=f+2,b=[];for(e=0;e<y;e++){var m,v,E=new Uint8Array(w),k=new Uint16Array(21);for(u=n.read(5),t=0;t<w;t++){for(;(u<1||u>20)&&o(s.DATA_ERROR),n.read(1);)n.read(1)?u--:u++;E[t]=u}for(m=v=E[0],t=1;t<w;t++)E[t]>v?v=E[t]:E[t]<m&&(m=E[t]);A={},b.push(A),A.permute=new Uint16Array(258),A.limit=new Uint32Array(22),A.base=new Uint32Array(21),A.minLen=m,A.maxLen=v;var B=0;for(t=m;t<=v;t++)for(k[t]=A.limit[t]=0,u=0;u<w;u++)E[u]===t&&(A.permute[B++]=u);for(t=0;t<w;t++)k[E[t]]++;for(B=u=0,t=m;t<v;t++)B+=k[t],A.limit[t]=B-1,B<<=1,u+=k[t],A.base[t+1]=B-u;A.limit[v+1]=Number.MAX_VALUE,A.limit[v]=B+k[v]-1,A.base[m]=0}var I=new Uint32Array(256);for(t=0;t<256;t++)p[t]=t;var S,C=0,K=0,D=0,U=this.dbuf=new Uint32Array(this.dbufSize);for(w=0;;){for(w--||(w=49,D>=d&&o(s.DATA_ERROR),A=b[g[D++]]),t=A.minLen,e=n.read(t);t>A.maxLen&&o(s.DATA_ERROR),!(e<=A.limit[t]);t++)e=e<<1|n.read(1);((e-=A.base[t])<0||e>=258)&&o(s.DATA_ERROR);var x=A.permute[e];if(0!==x&&1!==x){if(C)for(C=0,K+u>this.dbufSize&&o(s.DATA_ERROR),I[S=l[p[0]]]+=u;u--;)U[K++]=S;if(x>f)break;K>=this.dbufSize&&o(s.DATA_ERROR),I[S=l[S=i(p,t=x-1)]]++,U[K++]=S}else C||(C=1,u=0),u+=0===x?C:2*C,C<<=1}for((c<0||c>=K)&&o(s.DATA_ERROR),e=0,t=0;t<256;t++)r=e+I[t],I[t]=e,e=r;for(t=0;t<K;t++)U[I[S=255&U[t]]]|=t<<8,I[S]++;var P=0,Q=0,_=0;return K&&(Q=255&(P=U[c]),P>>=8,_=-1),this.writePos=P,this.writeCurrent=Q,this.writeCount=K,this.writeRun=_,!0},c.prototype._read_bunzip=function(t,e){var r,n,i;if(this.writeCount<0)return 0;var a=this.dbuf,c=this.writePos,u=this.writeCurrent,l=this.writeCount;this.outputsize;for(var f=this.writeRun;l;){for(l--,n=u,u=255&(c=a[c]),c>>=8,3==f++?(r=u,i=n,u=-1):(r=1,i=u),this.blockCRC.updateCRCRun(i,r);r--;)this.outputStream.writeByte(i),this.nextoutput++;u!=n&&(f=0)}return this.writeCount=l,this.blockCRC.getCRC()!==this.targetBlockCRC&&o(s.DATA_ERROR,"Bad block CRC (got "+this.blockCRC.getCRC().toString(16)+" expected "+this.targetBlockCRC.toString(16)+")"),this.nextoutput};var u=function(t){if("readByte"in t)return t;var e=new r;return e.pos=0,e.readByte=function(){return t[this.pos++]},e.seek=function(t){this.pos=t},e.eof=function(){return this.pos>=t.length},e},l=function(t){var e=new r,n=!0;if(t)if("number"==typeof t)e.buffer=new Uint8Array(t),n=!1;else{if("writeByte"in t)return t;e.buffer=t,n=!1}else e.buffer=new Uint8Array(16384);return e.pos=0,e.writeByte=function(t){if(n&&this.pos>=this.buffer.length){var e=new Uint8Array(2*this.buffer.length);e.set(this.buffer),this.buffer=e}this.buffer[this.pos++]=t},e.getBuffer=function(){if(this.pos!==this.buffer.length){if(!n)throw new TypeError("outputsize does not match decoded input");var t=new Uint8Array(this.pos);t.set(this.buffer.subarray(0,this.pos)),this.buffer=t}return this.buffer},e._coerced=!0,e};return Zp={Bunzip:c,Stream:r,Err:s,decode:function(t,e,r){for(var n=u(t),i=l(e),a=new c(n,i);!("eof"in n)||!n.eof();)if(a._init_block())a._read_bunzip();else{var f=a.reader.read(32)>>>0;if(f!==a.streamCRC&&o(s.DATA_ERROR,"Bad stream CRC (got "+a.streamCRC.toString(16)+" expected "+f.toString(16)+")"),!r||!("eof"in n)||n.eof())break;a._start_bunzip(n,i)}if("getBuffer"in i)return i.getBuffer()},decodeBlock:function(t,e,r){var i=u(t),s=l(r),a=new c(i,s);if(a.reader.seek(e),a._get_next_block()&&(a.blockCRC=new n,a.writeCopies=0,a._read_bunzip()),"getBuffer"in s)return s.getBuffer()},table:function(t,e,n){var i=new r;i.delegate=u(t),i.pos=0,i.readByte=function(){return this.pos++,this.delegate.readByte()},i.delegate.eof&&(i.eof=i.delegate.eof.bind(i.delegate));var s=new r;s.pos=0,s.writeByte=function(){this.pos++};for(var a=new c(i,s),o=a.dbufSize;!("eof"in i)||!i.eof();){var l=8*i.pos+a.reader.bitOffset;if(a.reader.hasByte&&(l-=8),a._init_block()){var f=s.pos;a._read_bunzip(),e(l,s.pos-f)}else{if(a.reader.read(32),!n||!("eof"in i)||i.eof())break;a._start_bunzip(i,s),console.assert(a.dbufSize===o,"shouldn't change block size within multistream file")}}}}}(),tg=hn({__proto__:null},[Xp]),eg=(t,e)=>{try{navigator.clipboard.readText().then(t=>qt(e,t,!0))}catch(t){qt(e,"클립보드 읽기 실패: "+t)}},rg=(t,e,r)=>qt(e,an(or(r)),!0),ng=(t,e,r)=>qt(e,nn(an(or(r))),!0),ig=(t,e,r)=>{try{qt(e,on(or(r)),!0)}catch(t){qt(e,"디코딩 실패: 올바른 Base64 문자열이 아닙니다.")}},sg=wr('<button type="button">인코딩</button> <button type="button">투명 인코딩</button> <button type="button">디코딩</button>',1),ag=(t,e,r)=>qt(e,nn(or(r)),!0),og=(t,e,r)=>qt(e,sn(or(r)),!0),cg=wr('아스키 범위 밖의 문자열 사용 시 투명하지 않을 수 있습니다. 다만 투명 인코딩 With Base64에 비해 글자 수를 줄일 수 있습니다.<br/> <button type="button">인코딩</button> <button type="button">디코딩</button>',1),ug=(t,e,r)=>qt(e,nn(an(or(r))),!0),lg=(t,e,r)=>qt(e,on(sn(function(t){let e,r;try{const n=rn(t,jr.__wbindgen_malloc,jr.__wbindgen_realloc),i=Xr,s=jr.ext_encode(n,i);return e=s[0],r=s[1],Wr(s[0],s[1])}finally{jr.__wbindgen_free(e,r,1)}}(or(r)))),!0),fg=wr('<button type="button">인코딩</button> <button type="button">디코딩</button>',1),hg=(t,e)=>{try{navigator.clipboard.readText().then(t=>qt(e,t,!0))}catch(t){qt(e,"클립보드 읽기 실패: "+t)}},yg=async(t,e,r,n)=>{const i=await async function({text:t,binary:e,filename:r,date:n=new Date,format:i=(void 0!==t?"utf8":"binary"),...s}){const a=void 0!==t?t:e;if(void 0===a)throw Error("createMessage: must pass options object containing `text` or `binary`");if(t&&!qn.isString(t)&&!qn.isStream(t))throw Error("createMessage: options.text must be a string or stream");if(e&&!qn.isUint8Array(e)&&!qn.isStream(e))throw Error("createMessage: options.binary must be a Uint8Array or stream");const o=Object.keys(s);if(o.length>0)throw Error("Unknown option: "+o.join(", "));const c=qn.isStream(a),u=new Zc(n);void 0!==t?u.setText(a,$n.write($n.literal,i)):u.setBytes(a,$n.write($n.literal,i)),void 0!==r&&u.setFilename(r);const l=new au;l.push(u);const f=new $u(l);return f.fromStream=c,f}({text:or(e)});console.log(i);const s=await async function({message:t,encryptionKeys:e,signingKeys:r,passwords:n,sessionKey:i,format:s="armored",signature:a=null,wildcard:o=!1,signingKeyIDs:c=[],encryptionKeyIDs:u=[],date:l=new Date,signingUserIDs:f=[],encryptionUserIDs:h=[],signatureNotations:y=[],config:d,...p}){if(Zu(d={...jn,...d}),qu(t),function(t){if("armored"!==t&&"binary"!==t&&"object"!==t)throw Error("Unsupported format "+t)}(s),e=Ju(e),r=Ju(r),n=Ju(n),c=Ju(c),u=Ju(u),f=Ju(f),h=Ju(h),y=Ju(y),p.detached)throw Error("The `detached` option has been removed from openpgp.encrypt, separately call openpgp.sign instead. Don't forget to remove the `privateKeys` option as well.");if(p.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.encrypt, pass `encryptionKeys` instead");if(p.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.encrypt, pass `signingKeys` instead");if(void 0!==p.armor)throw Error("The `armor` option has been removed from openpgp.encrypt, pass `format` instead.");const g=Object.keys(p);if(g.length>0)throw Error("Unknown option: "+g.join(", "));r||(r=[]);try{if((r.length||a)&&(t=await t.sign(r,e,a,c,l,f,u,y,d)),t=t.compress(await async function(t=[],e=new Date,r=[],n=jn){const i=$n.compression.uncompressed,s=n.preferredCompressionAlgorithm,a=await Promise.all(t.map(async function(t,i){const a=(await t.getPrimarySelfSignature(e,r[i],n)).preferredCompressionAlgorithms;return!!a&&a.indexOf(s)>=0}));return a.every(Boolean)?s:i}(e,l,h,d),d),t=await t.encrypt(e,n,i,o,u,l,h,d),"object"===s)return t;const p="armored"===s?t.armor(d):t.write();return await Wu(p)}catch(t){throw qn.wrapError("Error encrypting message",t)}}({message:i,passwords:[or(r)]});qt(n,s,!0)},dg=async(t,e,r,n)=>{try{const t=await async function({armoredMessage:t,binaryMessage:e,config:r,...n}){r={...jn,...r};let i=t||e;if(!i)throw Error("readMessage: must pass options object containing `armoredMessage` or `binaryMessage`");if(t&&!qn.isString(t)&&!qn.isStream(t))throw Error("readMessage: options.armoredMessage must be a string or stream");if(e&&!qn.isUint8Array(e)&&!qn.isStream(e))throw Error("readMessage: options.binaryMessage must be a Uint8Array or stream");const s=Object.keys(n);if(s.length>0)throw Error("Unknown option: "+s.join(", "));const a=qn.isStream(i);if(t){const{type:t,data:e}=await ui(i);if(t!==$n.armor.message)throw Error("Armored text not of type message");i=e}const o=await au.fromBinary(i,Hu,r,new uu),c=new $u(o);return c.fromStream=a,c}({armoredMessage:or(e)}),{data:i}=await async function({message:t,decryptionKeys:e,passwords:r,sessionKeys:n,verificationKeys:i,expectSigned:s=!1,format:a="utf8",signature:o=null,date:c=new Date,config:u,...l}){if(Zu(u={...jn,...u}),qu(t),i=Ju(i),e=Ju(e),r=Ju(r),n=Ju(n),l.privateKeys)throw Error("The `privateKeys` option has been removed from openpgp.decrypt, pass `decryptionKeys` instead");if(l.publicKeys)throw Error("The `publicKeys` option has been removed from openpgp.decrypt, pass `verificationKeys` instead");const f=Object.keys(l);if(f.length>0)throw Error("Unknown option: "+f.join(", "));try{const l=await t.decrypt(e,r,n,c,u);i||(i=[]);const f={};if(f.signatures=o?await l.verifyDetached(o,i,c,u):await l.verify(i,c,u),f.data="binary"===a?l.getLiteralData():l.getText(),f.filename=l.getFilename(),function(t,e,...r){t.data=Qn(e.packets.stream,async(e,n)=>{await Dn(t.data,n,{preventClose:!0});const i=zn(n);try{await On(e,t=>t),await Promise.all(r.map(t=>On(t.packets.stream,t=>t))),await i.close()}catch(t){await i.abort(t)}})}(f,t,...new Set([l,l.unwrapCompressed()])),s){if(0===i.length)throw Error("Verification keys are required to verify message signatures");if(0===f.signatures.length)throw Error("Message is not signed");f.data=Kn([f.data,Ln(async()=>(await qn.anyPromise(f.signatures.map(t=>t.verified)),"binary"===a?new Uint8Array:""))])}return f.data=await Wu(f.data),f}catch(t){throw qn.wrapError("Error decrypting message",t)}}({message:t,passwords:[or(r)]});qt(n,i,!0)}catch(t){qt(n,"오류:"+t)}},pg=wr('<form role="group"><textarea class="key" placeholder="암호화/복호화 키"></textarea> <button type="button">붙여넣기</button></form> <button type="button">암호화</button> <button type="button">복호화</button>',1),gg=wr("<p>이것이 보인다면 무언가 잘못된 것이니 사이트 개발자에게 알려주십시오</p>"),Ag=(t,e)=>navigator.clipboard.writeText(or(e)),wg=(t,e,r)=>qt(e,or(r),!0),bg=(t,e,r)=>qt(e,or(e)+or(r)),mg=(t,e)=>navigator.clipboard.writeText(or(e)),vg=wr('<header class="container"><nav><ul><li><h1><strong>WebCrypt</strong></h1></li></ul></nav></header> <main class="container"><form role="group"><textarea class="source" placeholder="처리할 텍스트를 입력해주세요."></textarea> <button type="button">붙여넣기</button></form> <select name="처리 알고리즘"><option>Base64</option><option>투명 인코딩</option><option>투명 인코딩 With Base64</option><option>PGP-대칭 암호</option></select> <!> <form role="group"><textarea class="result" name="read-only" readonly=""></textarea> <button type="button">복사</button></form> <button type="button">↑ 처리 필드로 이동</button> <button type="button">메모리에 추가 ↓</button> <form role="group"><textarea class="memory" placeholder="메모리"></textarea> <button type="button">메모리 복사</button></form><br/> <fieldset><label><input type="checkbox" role="switch"/> <span data-tooltip="입력 필드에 투명 인코딩이 감지되면 필드가 초록색으로 강조됩니다">투명 인코딩 자동 감지</span></label></fieldset></main> <footer class="container"><p>이 도구는 클라이언트 측에서만 작동하며, 어떠한 데이터도 서버로 전송되지 않습니다.</p></footer>',1);!function(t){for(var e=0;e<t.length;e++)hr.add(t[e]);for(var r of yr)r(t)}(["click"]),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(t=>{console.log("SW registered: ",t)}).catch(t=>{console.log("SW registration failed: ",t)})}),Br(function(t,e){st(e,!0),async function(){await ln()}();let r=Vt(""),n=Vt(""),i=Vt(""),s=Vt(""),a=Vt(!1),o=Vt("base64");var c=vg(),u=pe(de(c),2),l=ye(u),f=ye(l);Ae(f),pe(f,2).__click=[eg,r],j(l);var h=pe(l,2),y=ye(h);y.value=y.__value="base64";var d=pe(y);d.value=d.__value="rawinv";var p=pe(d);p.value=p.__value="inv";var g=pe(p);g.value=g.__value="aes256",j(h);var A=pe(h,2),w=t=>{var e=sg(),i=de(e);i.__click=[rg,n,r];var s=pe(i,2);s.__click=[ng,n,r],pe(s,2).__click=[ig,n,r],mr(t,e)},b=t=>{var e=br(),i=de(e),a=t=>{var e=cg(),i=pe(de(e),3);i.__click=[ag,n,r],pe(i,2).__click=[og,n,r],mr(t,e)},c=t=>{var e=br(),i=de(e),a=t=>{var e=fg(),i=de(e);i.__click=[ug,n,r],pe(i,2).__click=[lg,n,r],mr(t,e)},c=t=>{var e=br(),i=de(e),a=t=>{var e=pg(),i=de(e),a=ye(i);Ae(a),pe(a,2).__click=[hg,s],j(i);var o=pe(i,2);o.__click=[yg,r,s,n],pe(o,2).__click=[dg,r,s,n],Lr(a,()=>or(s),t=>qt(s,t)),mr(t,e)},c=t=>{mr(t,gg())};Dr(i,t=>{"aes256"===or(o)?t(a):t(c,!1)},!0),mr(t,e)};Dr(i,t=>{"inv"===or(o)?t(a):t(c,!1)},!0),mr(t,e)};Dr(i,t=>{"rawinv"===or(o)?t(a):t(c,!1)},!0),mr(t,e)};Dr(A,t=>{"base64"===or(o)?t(w):t(b,!1)});var m=pe(A,2),v=ye(m);Ae(v),pe(v,2).__click=[Ag,n],j(m);var E=pe(m,2);E.__click=[wg,r,n];var k=pe(E,2);k.__click=[bg,i,n];var B=pe(k,2),I=ye(B);Ae(I),pe(I,2).__click=[mg,i],j(B);var S=pe(B,3),C=ye(S),K=ye(C);(function(t){if(H){var e=!1,r=()=>{if(!e){if(e=!0,t.hasAttribute("value")){var r=t.value;Tr(t,"value",null),t.value=r}if(t.hasAttribute("checked")){var n=t.checked;Tr(t,"checked",null),t.checked=n}}};t.__on_r=r,n=r,0===ht.length&&lt(dt),ht.push(n),be()}var n})(K),V(2),j(C),j(S),j(u),V(2),Ie(t=>{var e,r,i;Tr(f,"aria-invalid",t),e=v,r=or(n),(i=Mr(e)).value!==(i.value=r??void 0)&&(e.value!==r||0===r&&"PROGRESS"===e.nodeName)&&(e.value=r??"")},[()=>or(a)&&function(t){const e=rn(t,jr.__wbindgen_malloc,jr.__wbindgen_realloc),r=Xr;return 0!==jr.inv_detect(e,r)}(or(r))?"false":null]),Lr(f,()=>or(r),t=>qt(r,t)),Pr(h,()=>or(o),t=>qt(o,t)),Lr(I,()=>or(i),t=>qt(i,t)),function(t,e,r=e){ve(t,"change",e=>{var n=e?t.defaultChecked:t.checked;r(n)}),(H&&t.defaultChecked!==t.checked||null==ur(e))&&r(t.checked),Be(()=>{var r=e();t.checked=Boolean(r)})}(K,()=>or(a),t=>qt(a,t)),mr(t,c),at()},{target:document.body})})()})();